<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R入門 - 24&nbsp; 確率分布と乱数</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter25.html" rel="next">
<link href="./chapter23.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter24.html">統計解析の基礎</a></li><li class="breadcrumb-item"><a href="./chapter24.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">確率分布と乱数</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R入門</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Rプログラミングの基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rのインストール</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rを使ってみよう</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">オブジェクトと変数・定数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">条件判断（Control structures）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">繰り返し文（Looping）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ライブラリ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">エラー処理（error handler）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">数値</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">文字列</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">因子（factor）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ベクター</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">リスト・データフレーム・行列</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">データの読み込みと書き出し（I/O）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">データセット</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Rでのデータの取り扱い</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">apply関数群</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">tidyr・dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">日時データの取り扱い</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">オブジェクト指向とクラス</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">コーディング規約</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Rでのグラフ作成</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">グラフ作成：高レベルグラフィック関数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">グラフ作成：低レベルグラフィック関数とグラフィックパラメータ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">plotly</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">統計解析の基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter24.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">確率分布と乱数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">検定</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">相関と回帰</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">分類</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">教師なし学習</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">時系列分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">生存時間解析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">アドバンスな手法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">purrr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">地理空間情報</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ネットワーク解析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">R markdown・Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Shiny</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">おわりに</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#乱数と種seed" id="toc-乱数と種seed" class="nav-link active" data-scroll-target="#乱数と種seed"><span class="header-section-number">24.1</span> 乱数と種（seed）</a></li>
  <li><a href="#復元抽出と非復元抽出" id="toc-復元抽出と非復元抽出" class="nav-link" data-scroll-target="#復元抽出と非復元抽出"><span class="header-section-number">24.2</span> 復元抽出と非復元抽出</a></li>
  <li><a href="#確率密度" id="toc-確率密度" class="nav-link" data-scroll-target="#確率密度"><span class="header-section-number">24.3</span> 確率密度</a></li>
  <li><a href="#累積分布" id="toc-累積分布" class="nav-link" data-scroll-target="#累積分布"><span class="header-section-number">24.4</span> 累積分布</a></li>
  <li><a href="#分位点" id="toc-分位点" class="nav-link" data-scroll-target="#分位点"><span class="header-section-number">24.5</span> 分位点</a></li>
  <li><a href="#確率分布に従った乱数" id="toc-確率分布に従った乱数" class="nav-link" data-scroll-target="#確率分布に従った乱数"><span class="header-section-number">24.6</span> 確率分布に従った乱数</a></li>
  <li><a href="#rで用いることのできる確率分布の一覧" id="toc-rで用いることのできる確率分布の一覧" class="nav-link" data-scroll-target="#rで用いることのできる確率分布の一覧"><span class="header-section-number">24.7</span> Rで用いることのできる確率分布の一覧</a></li>
  <li><a href="#二項分布" id="toc-二項分布" class="nav-link" data-scroll-target="#二項分布"><span class="header-section-number">24.8</span> 二項分布</a></li>
  <li><a href="#幾何分布" id="toc-幾何分布" class="nav-link" data-scroll-target="#幾何分布"><span class="header-section-number">24.9</span> 幾何分布</a></li>
  <li><a href="#超幾何分布" id="toc-超幾何分布" class="nav-link" data-scroll-target="#超幾何分布"><span class="header-section-number">24.10</span> 超幾何分布</a></li>
  <li><a href="#負の二項分布" id="toc-負の二項分布" class="nav-link" data-scroll-target="#負の二項分布"><span class="header-section-number">24.11</span> 負の二項分布</a></li>
  <li><a href="#ポアソン分布" id="toc-ポアソン分布" class="nav-link" data-scroll-target="#ポアソン分布"><span class="header-section-number">24.12</span> ポアソン分布</a></li>
  <li><a href="#正規分布" id="toc-正規分布" class="nav-link" data-scroll-target="#正規分布"><span class="header-section-number">24.13</span> 正規分布</a></li>
  <li><a href="#t分布" id="toc-t分布" class="nav-link" data-scroll-target="#t分布"><span class="header-section-number">24.14</span> t分布</a></li>
  <li><a href="#コーシー分布" id="toc-コーシー分布" class="nav-link" data-scroll-target="#コーシー分布"><span class="header-section-number">24.15</span> コーシー分布</a></li>
  <li><a href="#ロジスティック分布" id="toc-ロジスティック分布" class="nav-link" data-scroll-target="#ロジスティック分布"><span class="header-section-number">24.16</span> ロジスティック分布</a></li>
  <li><a href="#対数正規分布" id="toc-対数正規分布" class="nav-link" data-scroll-target="#対数正規分布"><span class="header-section-number">24.17</span> 対数正規分布</a></li>
  <li><a href="#ベータ分布" id="toc-ベータ分布" class="nav-link" data-scroll-target="#ベータ分布"><span class="header-section-number">24.18</span> ベータ分布</a></li>
  <li><a href="#カイ二乗分布" id="toc-カイ二乗分布" class="nav-link" data-scroll-target="#カイ二乗分布"><span class="header-section-number">24.19</span> カイ二乗分布</a></li>
  <li><a href="#f分布" id="toc-f分布" class="nav-link" data-scroll-target="#f分布"><span class="header-section-number">24.20</span> F分布</a></li>
  <li><a href="#ガンマ分布" id="toc-ガンマ分布" class="nav-link" data-scroll-target="#ガンマ分布"><span class="header-section-number">24.21</span> ガンマ分布</a></li>
  <li><a href="#指数分布" id="toc-指数分布" class="nav-link" data-scroll-target="#指数分布"><span class="header-section-number">24.22</span> 指数分布</a></li>
  <li><a href="#ワイブル分布" id="toc-ワイブル分布" class="nav-link" data-scroll-target="#ワイブル分布"><span class="header-section-number">24.23</span> ワイブル分布</a></li>
  <li><a href="#一様分布" id="toc-一様分布" class="nav-link" data-scroll-target="#一様分布"><span class="header-section-number">24.24</span> 一様分布</a></li>
  <li><a href="#多項分布" id="toc-多項分布" class="nav-link" data-scroll-target="#多項分布"><span class="header-section-number">24.25</span> 多項分布</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter24.html">統計解析の基礎</a></li><li class="breadcrumb-item"><a href="./chapter24.html"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">確率分布と乱数</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">確率分布と乱数</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="乱数と種seed" class="level2" data-number="24.1">
<h2 data-number="24.1" class="anchored" data-anchor-id="乱数と種seed"><span class="header-section-number">24.1</span> 乱数と種（seed）</h2>
<p>プログラミングでは、ランダムに生成された数値、<strong>乱数</strong>を使った処理を行うことがあります。例えばゲームなどで偶然性を表現する場合には、整数の乱数が用いられています。Rで整数の乱数を得る時には、<code>sample</code>関数を用います。<code>sample</code>関数は数列のベクターから引数で指定した数だけランダムに取り出し、ベクターとして返します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>1～100の整数からランダムに20個取り出す</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1]  22  79  89  50  63  68  98   4  49  99  40  74 100  19 100  83  89  31  96</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [20]  72</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>乱数は完全にランダムな数値というわけではなく、ランダムに見える繰り返し計算から生成されています（<strong>疑似乱数</strong>）。この疑似乱数を生成するアルゴリズムにはいろいろな種類があるのですが、Rではデフォルトの乱数生成アルゴリズムとして、<strong><a href="http://www.math.sci.hiroshima-u.ac.jp/m-mat/TEACH/ichimura-sho-koen.pdf">メルセンヌ・ツイスター法</a>（mersenne twister）</strong> <span class="citation" data-cites="10.1145/272991.272995">(<a href="references.html#ref-10.1145/272991.272995" role="doc-biblioref">Matsumoto and Nishimura 1998</a>)</span> が用いられています。メルセンヌ・ツイスターは乱数生成アルゴリズムの中でも偏りのない乱数を得られるもので、現在ではExcelでも用いられています。</p>
<p>Rでの乱数生成アルゴリズムを確認、設定する場合には、<code>RNGkind</code>関数を用います。<code>RNGkind</code>関数を用いれば、乱数生成アルゴリズムを変更することもできますが、メルセンヌ・ツイスターから変更する必要は特にないでしょう。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数生成アルゴリズムの確認</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ?RNGkindで利用可能な乱数生成アルゴリズムの一覧を確認できる</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">RNGkind</span>()</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "Mersenne-Twister" "Inversion"        "Rejection"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>乱数生成アルゴリズムは繰り返し計算で乱数を生成するため、乱数を生成するときに乱数の初期値が必要となります。この乱数の初期値のことを<strong>乱数の種（seed）</strong>と呼びます。Rでは乱数の種を<code>set.seed</code>関数で指定することができます。乱数の種をある値に設定しておくと、乱数を何度生成しても同じ結果を得ることができます。乱数を用いた計算で統計を行う場合には、計算の再現性を保つためにseedを設定しておく方がよいでしょう。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>set.seed関数で乱数のシードを設定</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># seedが0のときの乱数</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 14 68 39  1 34 87 43 14 82 59 51 97 85 21 54 74  7 73 79 85</span></span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, <span class="dv">20</span>, <span class="at">replace=</span><span class="cn">TRUE</span>) <span class="co"># seedを0にしているので、値が上と同じ</span></span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 14 68 39  1 34 87 43 14 82 59 51 97 85 21 54 74  7 73 79 85</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="復元抽出と非復元抽出" class="level2" data-number="24.2">
<h2 data-number="24.2" class="anchored" data-anchor-id="復元抽出と非復元抽出"><span class="header-section-number">24.2</span> 復元抽出と非復元抽出</h2>
<p><code>sample</code>関数では、第1引数として設定したベクターから選択された場合、その値がもう一度選択することができる場合（復元抽出）と、できない場合（非復元抽出）の設定を<code>replace</code>引数で設定することができます。<code>replace=TRUE</code>の場合は復元抽出、<code>replace=FALSE</code>の場合は非復元抽出となります。非復元抽出の場合には、第1引数の長さ以上の数の値を呼び出すことはできません。<code>replace</code>引数のデフォルトは<code>FALSE</code>ですので、<code>replece</code>引数を指定しない場合には非復元抽出が行われます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>復元抽出と非復元抽出</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 復元抽出</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 1 1 2 1</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 非復元抽出</span></span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 非復元抽出で取り出す値の数がベクターより長いと、エラーとなる</span></span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a><span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">5</span>, <span class="at">replace =</span> <span class="cn">FALSE</span>)</span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in sample.int(length(x), size, replace, prob): cannot take a sample larger than the population when 'replace = FALSE'</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>また、統計では乱数を使った計算（<strong><a href="https://ja.wikipedia.org/wiki/%E3%83%A2%E3%83%B3%E3%83%86%E3%82%AB%E3%83%AB%E3%83%AD%E6%B3%95">モンテカルロ法</a></strong>）を用いることがあります。特に<strong>確率分布に従った乱数</strong>を用いた計算が統計では有用です。このような確率分布に従った乱数計算を行う場合には、<code>sample</code>関数ではなく、確率分布に関連した一連の関数を用いるのが一般的です。</p>
<p><strong>確率分布</strong>とは、ランダムに起こる事象（例えばコイントスや身長・体重の大きさなど）がそれぞれの値を取る確率を関数の形で表現したものです。もっとも一般的に用いられている確率分布は、<strong>正規分布（Normal distribution）</strong>です。正規分布は平均値と標準偏差をパラメータとした確率分布で、平均値を取る確率が最も高く、平均値から離れるほど確率が低くなっていく、釣鐘型の形を取る分布です。</p>
<p>Rでは、この正規分布の<strong>確率密度</strong>、<strong>累積分布</strong>、<strong>分位点での値</strong>、<strong>乱数</strong>をそれぞれ<strong><code>dnorm</code>、<code>pnorm</code>、<code>qnorm</code>、<code>rnorm</code></strong>関数を用いて計算することができます。</p>
</section>
<section id="確率密度" class="level2" data-number="24.3">
<h2 data-number="24.3" class="anchored" data-anchor-id="確率密度"><span class="header-section-number">24.3</span> 確率密度</h2>
<p><strong>確率密度</strong>は上で述べた通り、ランダムに起こる事象がそれぞれの値を取る確率を示したものです。この確率密度は<strong>確率密度関数</strong>（離散的な分布では<strong>確率質量関数</strong>）という関数で表現されます。この確率密度関数を返すのが、<strong>「<code>d</code> + 分布の名前」</strong>で示される関数です。正規分布の確率密度関数は、<code>dnorm</code>関数で計算することができます。この<code>dnorm</code>関数は、<code>mean</code>引数で指定した平均値、<code>sd</code>引数で指定した標準編差の正規分布において、第一引数で指定した値（<code>x</code>）における確率密度を返す関数です。ただし、確率密度はその値が確率なのではなく、確率密度の積分が確率となりますので、この<code>dnorm</code>の返り値が確率ではありません（ただし、確率質量分布、つまり離散的な分布では確率質量分布の返り値が確率となります）。</p>
<p>確率密度には連続的なものと離散的なものがあり、確率分布ごとに値を取りうる範囲があります。例えば正規分布は<span class="math inline">\(+\infty\)</span>から<span class="math inline">\(-\infty\)</span>の範囲の有理数すべてを取ることができる連続的な分布です。別の分布、ポアソン分布は正の整数のみを取ることができる、離散的な分布となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>正規分布の確率密度</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dnorm</span>(<span class="at">x =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 正規分布の確率密度</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.2419707</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
確率分布の平均と分散
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>確率分布f(x)はその積分が確率となる関数で表されます。確率は合計すると必ず1となるため、確率分布をその分布の範囲で積分すると1になります。また、積分すると1となることが確率分布であることの条件にもなります。</p>
<p><span class="math display">\[\int_{-\infty}^{\infty}f(x)dx=1\]</span></p>
<p>確率分布の平均値（<span class="math inline">\(E[f(x)]\)</span>）と分散（<span class="math inline">\(V[f(x)]\)</span>）は以下の積分で計算できます。</p>
<p><span class="math display">\[E[f(x)]=\int_{-\infty}^{\infty}x \cdot f(x)dx\]</span></p>
<p><span class="math display">\[V[f(x)]=\int_{-\infty}^{\infty}(x-\mu)^2 \cdot f(x)dx\]</span></p>
</div>
</div>
</div>
</section>
<section id="累積分布" class="level2" data-number="24.4">
<h2 data-number="24.4" class="anchored" data-anchor-id="累積分布"><span class="header-section-number">24.4</span> 累積分布</h2>
<p>確率密度をx軸方向に積分して得られる関数のことを、<strong>累積分布関数</strong>と呼びます。上に述べた通り、確率密度を積分したものが確率となりますので、累積分布関数を用いると、正規分布する値がある一定の範囲を取る確率を計算することができます。Rで累積分布関数を返すのが、<strong>「<code>p</code> + 分布の名前」</strong>で示される関数です。</p>
<p>正規分布の累積分布関数は、<code>pnorm</code>関数で計算することができます。正規分布の累積分布関数では、正規分布する値が<span class="math inline">\(-\infty\)</span>からその値までの範囲を取る確率が計算されるため、正規分布する値が第一引数<code>q</code>で指定した値以下となる確率を計算することになります。平均値を<code>mean</code>引数、標準偏差を<code>sd</code>引数で指定するのはすべての<code>norm</code>関数で共通しています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>正規分布の累積分布関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="at">q =</span> <span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 正規分布の累積分布関数（q（1）以下となる確率）</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8413447</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># 平均0、標準偏差1の正規分布での標準偏差の区間（-1 ~ 1）の値が得られる確率</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) </span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.6826895</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 平均0、標準偏差1の正規分布で、-1.96~1.96の値が得られる確率（95％区間）</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="fl">1.96</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">-</span> <span class="fu">pnorm</span>(<span class="sc">-</span><span class="fl">1.96</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) </span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.9500042</span></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a><span class="co"># 累積分布関数の形（正規分布）</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>), <span class="fu">pnorm</span>(<span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">by =</span> <span class="fl">0.1</span>)), <span class="at">type =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="chapter24_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="分位点" class="level2" data-number="24.5">
<h2 data-number="24.5" class="anchored" data-anchor-id="分位点"><span class="header-section-number">24.5</span> 分位点</h2>
<p>逆に、累積分布関数で求まる確率から、その確率となる値を求める関数が、<strong>「<code>q</code> + 分布の名前」</strong>で示される関数です。第一引数である<code>p</code>には確率（0～1）を指定し、その確率が得られる累積分布関数でのx軸上の値を得ることができます。正規分布では、<code>qnorm</code>関数でこの計算を行うことができます。<code>pnorm</code>関数と<code>qnorm</code>関数では、第一引数と返り値の関係がちょうど逆になります。</p>
<p>引数<code>p</code>に対して、<code>qnorm</code>関数で得られる値のことを、「<code>100*p</code>%分位点」と呼ぶのが一般的です。<code>p=0.25</code>なら25％分位点、<code>p=0.75</code>なら75％分位点が得られることになります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>正規分布の分位点</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">qnorm</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 正規分布の97.5%分位点における値</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.959964</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># qnormの形はpnorm（累積分布関数）のx、yが入れ替わったものとなる</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>), <span class="fu">qnorm</span>(<span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)), <span class="at">type =</span> <span class="st">"l"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="chapter24_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>確率密度（<code>dnorm</code>）、累積分布（<code>pnorm</code>）、分位点（<code>qnorm</code>）の関係を図で示すと、以下のような関係になっています。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./image/dpqnorm_image.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3" data-glightbox="description: .lightbox-desc-3" title="確率密度、累積分布、分位点の関係"><img src="./image/dpqnorm_image.png" class="img-fluid figure-img" alt="確率密度、累積分布、分位点の関係"></a></p>
<figcaption>確率密度、累積分布、分位点の関係</figcaption>
</figure>
</div>
</section>
<section id="確率分布に従った乱数" class="level2" data-number="24.6">
<h2 data-number="24.6" class="anchored" data-anchor-id="確率分布に従った乱数"><span class="header-section-number">24.6</span> 確率分布に従った乱数</h2>
<p>確率分布に従った乱数を得ることができれば、その確率分布に従う現象をシミュレートすることができます。Rで確率分布に従った乱数を求める関数が、<strong>「<code>r</code> + 分布の名前」</strong>で示される関数です。正規分布では、<code>rnorm</code>関数で乱数（正規乱数）を得ることができます。第一引数（<code>n</code>）で、乱数の個数を指定します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>正規分布の確率密度</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="co"># 正規分布の乱数</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1]  0.25222345 -0.89192113  0.43568330 -1.23753842 -0.22426789  0.37739565</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7]  0.13333636  0.80418951 -0.05710677  0.50360797</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 乱数をたくさん生成し、ヒストグラムを描画する</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">10000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>) <span class="sc">|&gt;</span> <span class="fu">hist</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="chapter24_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
確率分布に従う乱数を得る
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>通常、確率分布に従う形の乱数を得る場合には、累積分布関数の<strong><a href="https://ja.wikipedia.org/wiki/%E9%80%86%E9%96%A2%E6%95%B0%E6%B3%95">逆関数</a></strong>というものを用います。逆関数はy=f(x)の関数をx=g(y)という形に、xについて解いたものを指します。確率密度関数の逆関数に一様乱数を入れると、確率分布に従った乱数を得ることができます。<code>rnorm</code>などの乱数生成アルゴリズムはC言語で記載されていて、逆関数を用いているのかはわかりませんが、メルセンヌ・ツイスターで生成されるのは一様乱数ですので、内部的には同様の変換が行われているのだと思います。</p>
</div>
</div>
</div>
</section>
<section id="rで用いることのできる確率分布の一覧" class="level2" data-number="24.7">
<h2 data-number="24.7" class="anchored" data-anchor-id="rで用いることのできる確率分布の一覧"><span class="header-section-number">24.7</span> Rで用いることのできる確率分布の一覧</h2>
<p>Rでは、norm（正規分布）の他に、以下の表1で示す確率分布に関する関数が登録されています。各確率分布の「記号」の前に<code>d</code>を付けると確率密度関数、<code>p</code>を付けると累積分布関数、<code>q</code>を付けると分位点、<code>r</code>を付けると乱数を得る関数となります。</p>
<div class="cell">
<div class="cell-output-display">
<table class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;">記号</th>
<th style="text-align: left;">分布</th>
<th style="text-align: left;">英語での分布名</th>
<th style="text-align: left;">パラメータ</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">binom</td>
<td style="text-align: left;">二項分布</td>
<td style="text-align: left;">binomial</td>
<td style="text-align: left;">size, prob</td>
</tr>
<tr class="even">
<td style="text-align: left;">geom</td>
<td style="text-align: left;">幾何分布</td>
<td style="text-align: left;">geometric</td>
<td style="text-align: left;">prob</td>
</tr>
<tr class="odd">
<td style="text-align: left;">hyper</td>
<td style="text-align: left;">超幾何分布</td>
<td style="text-align: left;">hypergeometric</td>
<td style="text-align: left;">m, n, k</td>
</tr>
<tr class="even">
<td style="text-align: left;">nbinom</td>
<td style="text-align: left;">負の二項分布</td>
<td style="text-align: left;">negative binomial</td>
<td style="text-align: left;">size, prob</td>
</tr>
<tr class="odd">
<td style="text-align: left;">pois</td>
<td style="text-align: left;">ポアソン分布</td>
<td style="text-align: left;">Poisson</td>
<td style="text-align: left;">lambda</td>
</tr>
<tr class="even">
<td style="text-align: left;">norm</td>
<td style="text-align: left;">正規分布</td>
<td style="text-align: left;">normal</td>
<td style="text-align: left;">mean, sd</td>
</tr>
<tr class="odd">
<td style="text-align: left;">t</td>
<td style="text-align: left;">Studentのt分布</td>
<td style="text-align: left;">Student’s t</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="even">
<td style="text-align: left;">cauchy</td>
<td style="text-align: left;">コーシー分布</td>
<td style="text-align: left;">Cauchy</td>
<td style="text-align: left;">location, scale</td>
</tr>
<tr class="odd">
<td style="text-align: left;">logis</td>
<td style="text-align: left;">ロジスティック分布</td>
<td style="text-align: left;">logistic</td>
<td style="text-align: left;">location, scale</td>
</tr>
<tr class="even">
<td style="text-align: left;">lnorm</td>
<td style="text-align: left;">対数正規分布</td>
<td style="text-align: left;">log-normal</td>
<td style="text-align: left;">meanlog, sdlog</td>
</tr>
<tr class="odd">
<td style="text-align: left;">beta</td>
<td style="text-align: left;">ベータ分布</td>
<td style="text-align: left;">beta</td>
<td style="text-align: left;">shape1, shape2</td>
</tr>
<tr class="even">
<td style="text-align: left;">chisq</td>
<td style="text-align: left;">カイ二乗分布</td>
<td style="text-align: left;">chi-squared</td>
<td style="text-align: left;">df</td>
</tr>
<tr class="odd">
<td style="text-align: left;">f</td>
<td style="text-align: left;">F分布</td>
<td style="text-align: left;">F</td>
<td style="text-align: left;">df1, df2</td>
</tr>
<tr class="even">
<td style="text-align: left;">gamma</td>
<td style="text-align: left;">ガンマ分布</td>
<td style="text-align: left;">gamma</td>
<td style="text-align: left;">shape, scale</td>
</tr>
<tr class="odd">
<td style="text-align: left;">exp</td>
<td style="text-align: left;">指数分布</td>
<td style="text-align: left;">exponential</td>
<td style="text-align: left;">rate</td>
</tr>
<tr class="even">
<td style="text-align: left;">weibull</td>
<td style="text-align: left;">ワイブル分布</td>
<td style="text-align: left;">Weibull</td>
<td style="text-align: left;">shape, scale</td>
</tr>
<tr class="odd">
<td style="text-align: left;">unif</td>
<td style="text-align: left;">一様分布</td>
<td style="text-align: left;">uniform</td>
<td style="text-align: left;">min, max</td>
</tr>
<tr class="even">
<td style="text-align: left;">multinom</td>
<td style="text-align: left;">多項分布</td>
<td style="text-align: left;">multinomial</td>
<td style="text-align: left;">size, prob</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
その他の確率分布
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>上記の表1に示した以外にも、Rではライブラリを用いることで様々な確率分布の関数を用いることができます。ライブラリの一覧に関しては、CRAN Task Viewの<a href="https://cran.r-project.org/web/views/Distributions.html">Probability Distributions</a>が参考になります。また、それぞれの確率分布の関係については、<a href="https://www.math.wm.edu/~leemis/chart/UDR/UDR.html">Univariate Distribution Relationships</a>に詳しく記載されているので、興味のある方は一読するとよいでしょう。日本語では、こちらの<a href="https://www.yodosha.co.jp/smart-lab-life/statics_pitfalls/statics_pitfalls09.html">三中先生の解説ページ</a>に書かれています。また、確率分布を表示する<a href="https://statdist.ksmzn.com/">Webアプリ</a>を触ってみるのも良いでしょう。</p>
</div>
</div>
</div>
<p>以下に、各確率分布の簡単な説明と、各関数を用いたグラフを示します。</p>
</section>
<section id="二項分布" class="level2" data-number="24.8">
<h2 data-number="24.8" class="anchored" data-anchor-id="二項分布"><span class="header-section-number">24.8</span> 二項分布</h2>
<p><strong>二項分布</strong>は<strong>ベルヌーイ試行</strong>（コイントスのように、1と0だけが確率的に結果として得られる試行）の試行回数（<code>size</code>）と成功確率（<code>prob</code>）から、成功回数<code>x</code>が得られる確率を示したものです。二項分布の確率質量関数は以下の式で表されます。</p>
<p><span class="math display">\[Binom(x,n,p)=_{n}C_{x} \cdot p^{x} \cdot (1-p)^{n-x}\]</span></p>
<p>nが試行回数、pが成功確率、xが成功回数を表しています。Rでは、nを<code>size</code>引数、pを<code>prob</code>引数で指定します。コイントスですので、整数でない成功回数（4.21回成功など）が起こることはありませんし、マイナスの試行数も取りません。ですので、二項分布は成功回数<code>x</code>が正の整数のみの離散的な確率分布になります。分布の範囲は<strong>0～試行回数</strong>です。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">確率質量</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">二項乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>二項分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">20</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p01 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ20、確率0.1</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p05 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ20、確率0.5</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p08 =</span> <span class="fu">dbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ20、確率0.8</span></span>
<span id="cb9-7"><a href="#cb9-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb9-8"><a href="#cb9-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-9"><a href="#cb9-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb9-10"><a href="#cb9-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb9-11"><a href="#cb9-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb9-12"><a href="#cb9-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="chapter24_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>二項分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p01 =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ20、確率0.1</span></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p05 =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ20、確率0.5</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p08 =</span> <span class="fu">pbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ20、確率0.8</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="chapter24_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqbinomでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p01 =</span> <span class="fu">qbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ20、確率0.1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p05 =</span> <span class="fu">qbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ20、確率0.5</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p08 =</span> <span class="fu">qbinom</span>(x, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ20、確率0.8</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="chapter24_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数のヒストグラムをプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p01 =</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ20、確率0.1</span></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p05 =</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ20、確率0.5</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s20p08 =</span> <span class="fu">rbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">20</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ20、確率0.8</span></span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-13-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="chapter24_files/figure-html/unnamed-chunk-13-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="幾何分布" class="level2" data-number="24.9">
<h2 data-number="24.9" class="anchored" data-anchor-id="幾何分布"><span class="header-section-number">24.9</span> 幾何分布</h2>
<p><strong>幾何分布</strong>は、ベルヌーイ試行を始めて成功させたときの試行数が<code>x</code>となる確率を指します。2項分布との違いは、成功回数が必ず1回であるところになります。<code>x</code>以外には、成功確率（<code>prob</code>）のみをパラメータとして設定します。分布の範囲は0～<span class="math inline">\(+\infty\)</span>です。幾何分布の確率質量関数は以下の式で表されます。</p>
<p><span class="math display">\[Geom(x,p)=p  \cdot (1-p)^{x-1}\]</span></p>
<p>Rでは、pを<code>prob</code>引数で設定します。</p>
<p>1回成功するまでに失敗した回数も同じく幾何分布で表現することができます。失敗した回数とする場合には、上の式のx-1をxとするだけです。Rの<code>geom</code>関数で計算されるのは上の式の結果です。</p>
<p><span class="math display">\[Geom(x,p)=p \cdot (1-p)^{x}\]</span></p>
<p>試行数<code>x</code>は必ず整数となるため、幾何分布も二項分布と同じく、離散的な分布で、<code>x</code>は正の整数を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">確率質量</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">幾何乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>幾何分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">50</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r01 =</span> <span class="fu">dgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># 確率0.1</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r05 =</span> <span class="fu">dgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># 確率0.5</span></span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r08 =</span> <span class="fu">dgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># 確率0.8</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="chapter24_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>幾何分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r01 =</span> <span class="fu">pgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># 確率0.1</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r05 =</span> <span class="fu">pgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># 確率0.5</span></span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r08 =</span> <span class="fu">pgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># 確率0.8</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="chapter24_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r01 =</span> <span class="fu">qgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># 確率0.1</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r05 =</span> <span class="fu">qgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># 確率0.5</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r08 =</span> <span class="fu">qgeom</span>(x, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># 確率0.8</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="chapter24_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r01 =</span> <span class="fu">rgeom</span>(<span class="dv">1000</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># 確率0.1</span></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r05 =</span> <span class="fu">rgeom</span>(<span class="dv">1000</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># 確率0.5</span></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r08 =</span> <span class="fu">rgeom</span>(<span class="dv">1000</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># 確率0.8</span></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="chapter24_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="超幾何分布" class="level2" data-number="24.10">
<h2 data-number="24.10" class="anchored" data-anchor-id="超幾何分布"><span class="header-section-number">24.10</span> 超幾何分布</h2>
<p><strong>超幾何分布</strong>は、ツボの中に白と黒のボールが入っていて、このツボからボールを取り出す試行（<strong>非復元抽出</strong>）を表現した確率分布です。超幾何分布の確率質量関数は以下の式で表されます。</p>
<p><span class="math display">\[ Hyper(x,m,n,k)= \frac{_{m}C_{k} \cdot _{n}C_{x-k}}{_{m+n}C_{x}}\]</span></p>
<p>Rの<code>hyper</code>関数では、白ボール<code>m</code>個、黒ボール<code>n</code>個が入ったツボから<code>k</code>個ボールを取ったとき、<code>x</code>個の白ボールが取れる確率を計算します。<code>dhyper</code>関数の引数は<code>m</code>、<code>n</code>、<code>k</code>で、<code>x</code>は整数のみを取る離散的な分布です。分布の範囲は0～kとなります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">確率質量</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">超幾何乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>超幾何分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">6</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n5k5 =</span> <span class="fu">dhyper</span>(x, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 5, 黒 5, 取るボールの数 5</span></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m10n5k5 =</span> <span class="fu">dhyper</span>(x, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 10, 黒 5, 取るボールの数 5</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n20k10 =</span> <span class="fu">dhyper</span>(x, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">k =</span> <span class="dv">10</span>) <span class="co"># 白 5, 黒 20, 取るボールの数 10</span></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-18-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="chapter24_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>超幾何分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n5k5 =</span> <span class="fu">phyper</span>(x, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 5, 赤 5, 取るボールの数 5</span></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m10n5k5 =</span> <span class="fu">phyper</span>(x, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 10, 赤 5, 取るボールの数 5</span></span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n20k10 =</span> <span class="fu">phyper</span>(x, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">k =</span> <span class="dv">10</span>) <span class="co"># 白 5, 赤 20, 取るボールの数 10</span></span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="chapter24_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n5k5 =</span> <span class="fu">qhyper</span>(x, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 5, 赤 5, 取るボールの数 5</span></span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m10n5k5 =</span> <span class="fu">qhyper</span>(x, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 10, 赤 5, 取るボールの数 5</span></span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n20k10 =</span> <span class="fu">qhyper</span>(x, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">k =</span> <span class="dv">10</span>) <span class="co"># 白 5, 赤 20, 取るボールの数 10</span></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="chapter24_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n5k5 =</span> <span class="fu">rhyper</span>(<span class="dv">1000</span>, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 5, 赤 5, 取るボールの数 5</span></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m10n5k5 =</span> <span class="fu">rhyper</span>(<span class="dv">1000</span>, <span class="at">m =</span> <span class="dv">10</span>, <span class="at">n =</span> <span class="dv">5</span>, <span class="at">k =</span> <span class="dv">5</span>), <span class="co"># 白 10, 赤 5, 取るボールの数 5</span></span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m5n20k10 =</span> <span class="fu">rhyper</span>(<span class="dv">1000</span>, <span class="at">m =</span> <span class="dv">5</span>, <span class="at">n =</span> <span class="dv">20</span>, <span class="at">k =</span> <span class="dv">10</span>) <span class="co"># 白 5, 赤 20, 取るボールの数 10</span></span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="chapter24_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="負の二項分布" class="level2" data-number="24.11">
<h2 data-number="24.11" class="anchored" data-anchor-id="負の二項分布"><span class="header-section-number">24.11</span> 負の二項分布</h2>
<p><strong>負の二項分布</strong>は、ベルヌーイ試行を行ったとき、n回成功する間にx回失敗する確率を反映した確率分布です。成功の回数がn、失敗回数をx、成功確率をpとしたとき、負の二項分布の確率質量関数は以下の式で表されます。</p>
<p><span class="math display">\[Nbinom(x,n,p)=_{x+n+1}C_{x} \cdot p^x(1-p)^n\]</span></p>
<p>Rでの負の二項分布の確率質量関数は<code>dnbinom</code>関数で計算することができます。成功の回数nは<code>size</code>引数、成功確率pは<code>prob</code>引数で設定します。負の二項分布は正の整数のみを取る離散的な分布で、その範囲は0～<span class="math inline">\(\infty\)</span>となります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">確率質量</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">負の二項乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>負の二項分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">100</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p01 =</span> <span class="fu">dnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ5、確率0.1</span></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">p05 =</span> <span class="fu">dnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ5、確率0.5</span></span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">p08 =</span> <span class="fu">dnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ5、確率0.8</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="chapter24_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>負の二項分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p01 =</span> <span class="fu">pnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ5、確率0.1</span></span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p05 =</span> <span class="fu">pnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ5、確率0.5</span></span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">p08 =</span> <span class="fu">pnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ5、確率0.8</span></span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="chapter24_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p01 =</span> <span class="fu">qnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ5、確率0.1</span></span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">p05 =</span> <span class="fu">qnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ5、確率0.5</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">p08 =</span> <span class="fu">qnbinom</span>(x, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ5、確率0.8</span></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="chapter24_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">p01 =</span> <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.1</span>), <span class="co"># サイズ5、確率0.1</span></span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">p05 =</span> <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.5</span>), <span class="co"># サイズ5、確率0.5</span></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">p08 =</span> <span class="fu">rnbinom</span>(<span class="dv">1000</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">prob =</span> <span class="fl">0.8</span>) <span class="co"># サイズ5、確率0.8</span></span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">10</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="chapter24_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ポアソン分布" class="level2" data-number="24.12">
<h2 data-number="24.12" class="anchored" data-anchor-id="ポアソン分布"><span class="header-section-number">24.12</span> ポアソン分布</h2>
<p><strong>ポアソン分布</strong>は、起こる確率が非常に低い現象が、ある一定の時間に何回起こるかを確率として表した確率分布です。ポアソン分布の確率質量関数は二項分布の確率を0に、試行回数を<span class="math inline">\(\infty\)</span>に近づけた極限として計算されます。ポアソン分布のパラメータはλのみで、ポアソン分布は平均値も標準偏差もλとなる特徴があります。ポアソン分布の確率質量関数は以下の式で表されます。分布が取りうる範囲は0～<span class="math inline">\(\infty\)</span>となります。</p>
<p><span class="math display">\[Poisson(x, \lambda)=\frac{\lambda^x \cdot \exp(-\lambda)}{x!}\]</span></p>
<p>Rではポアソン分布の確率質量関数は<code>dpois</code>関数で計算することができます。<code>dpois</code>関数のλは引数<code>lambda</code>で設定します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">確率質量</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">ポアソン乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ポアソン分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="dv">0</span><span class="sc">:</span><span class="dv">25</span></span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l3 =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l8 =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">8</span>), <span class="co"># ラムダ8</span></span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">l11 =</span> <span class="fu">dpois</span>(x, <span class="at">lambda =</span> <span class="dv">11</span>) <span class="co"># ラムダ11</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="chapter24_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ポアソン分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">l3 =</span> <span class="fu">ppois</span>(x, <span class="at">lambda =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l8 =</span> <span class="fu">ppois</span>(x, <span class="at">lambda =</span> <span class="dv">8</span>), <span class="co"># ラムダ8</span></span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l11 =</span> <span class="fu">ppois</span>(x, <span class="at">lambda =</span> <span class="dv">11</span>) <span class="co"># ラムダ11</span></span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="chapter24_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l3 =</span> <span class="fu">qpois</span>(x, <span class="at">lambda =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l8 =</span> <span class="fu">qpois</span>(x, <span class="at">lambda =</span> <span class="dv">8</span>), <span class="co"># ラムダ8</span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">l11 =</span> <span class="fu">qpois</span>(x, <span class="at">lambda =</span> <span class="dv">11</span>) <span class="co"># ラムダ11</span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="chapter24_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">l3 =</span> <span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">l8 =</span> <span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">8</span>), <span class="co"># ラムダ8</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l11 =</span> <span class="fu">rpois</span>(<span class="dv">1000</span>, <span class="at">lambda =</span> <span class="dv">11</span>) <span class="co"># ラムダ11</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-29-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="chapter24_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="正規分布" class="level2" data-number="24.13">
<h2 data-number="24.13" class="anchored" data-anchor-id="正規分布"><span class="header-section-number">24.13</span> 正規分布</h2>
<p><strong>正規分布</strong>は、様々な分布での値の平均値の分布を反映したもので（<a href="https://ja.wikipedia.org/wiki/%E4%B8%AD%E5%BF%83%E6%A5%B5%E9%99%90%E5%AE%9A%E7%90%86">中心極限定理</a>）、統計では最も一般的に用いられているものです。正規分布のパラメータは平均値（μ）と標準偏差（σ）です。正規分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[ Norm(x, \mu, \sigma)=\frac{1}{\sqrt{2\pi \sigma^2}} \cdot \exp \left( \frac{(x-\mu)^2}{2\sigma^2} \right) \]</span></p>
<p>Rでは、正規分布の確率密度関数は<code>dnorm</code>関数で計算することができます。<code>dnorm</code>関数では、平均値は<code>mean</code>引数、標準偏差は<code>sd</code>引数で設定します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">正規乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>正規分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="co"># 平均0、標準偏差1</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m1s2 =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># 平均1、標準偏差2</span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s05 =</span> <span class="fu">dnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>) <span class="co"># 平均2、標準偏差0.5</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb29-11"><a href="#cb29-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb29-12"><a href="#cb29-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="chapter24_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>正規分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">pnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="co"># 平均0、標準偏差1</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m1s2 =</span> <span class="fu">pnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># 平均1、標準偏差2</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s05 =</span> <span class="fu">pnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>) <span class="co"># 平均2、標準偏差0.5</span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb30-11"><a href="#cb30-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="chapter24_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqnormでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">qnorm</span>(x, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="co"># 平均0、標準偏差1</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m1s2 =</span> <span class="fu">qnorm</span>(x, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># 平均1、標準偏差2</span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s05 =</span> <span class="fu">qnorm</span>(x, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>) <span class="co"># 平均2、標準偏差0.5</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb31-11"><a href="#cb31-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb31-12"><a href="#cb31-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-32-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="chapter24_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> <span class="dv">1</span>), <span class="co"># 平均0、標準偏差1</span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m1s2 =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">1</span>, <span class="at">sd =</span> <span class="dv">2</span>), <span class="co"># 平均1、標準偏差2</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s05 =</span> <span class="fu">rnorm</span>(<span class="dv">1000</span>, <span class="at">mean =</span> <span class="dv">2</span>, <span class="at">sd =</span> <span class="fl">0.5</span>) <span class="co"># 平均2、標準偏差0.5</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-33-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="chapter24_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="t分布" class="level2" data-number="24.14">
<h2 data-number="24.14" class="anchored" data-anchor-id="t分布"><span class="header-section-number">24.14</span> t分布</h2>
<p><strong>t分布</strong>は標本サイズが小さいときの母平均と標本平均の差の分布を反映した確率分布です。t分布は<strong>t統計量</strong>と呼ばれるものの分布を示します。t統計量は以下の式で計算できます。</p>
<p><span class="math display">\[t=\frac{x-\mu}{s \sqrt n}\]</span></p>
<p>この式で、xはサンプルの平均値、μは母平均値、sは標準偏差、nはサンプルの数を指します。t分布は主にt検定（平均値の差の検定）に用いられます。t分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[t(x, \nu)=\frac{\Gamma(\nu+1)/2}{\sqrt{\nu \pi} \cdot \Gamma(\nu/2)} \cdot (1+x^2/\nu)^{-(\nu+1)/2}\]</span></p>
<p>上の式のνは自由度で、サンプル数から1を引いたものとなります。Rでは、<code>dt</code>関数でt分布の確率密度関数を計算することができます。<code>dt</code>関数の引数には、自由度<code>df</code>を設定します。t分布は<span class="math inline">\(-\infty\)</span>～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取り、平均値は0です。t分布は正規分布とよく似た釣鐘型の分布ですが、正規分布と比較して裾が重い、0から遠い値の確率が大きくなる性質を持ちます。自由度<code>df</code>が<span class="math inline">\(-\infty\)</span>に近づくと、t分布の形は正規分布と一致します。</p>
<p>また、t分布には検出力の計算等に用いられる非心パラメータと呼ばれるものがあり、<code>ncp</code>という引数で非心パラメータを指定することもできます。非心パラメータを0よりも大きく設定すると、t分布は左にゆがみ、平均値が0よりも大きくなります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">t分布の乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>t分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">15</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d8n0 =</span> <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">8</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度8、非心パラメータ0</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n3 =</span> <span class="fu">dt</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">3</span>) <span class="co"># 自由度3、非心パラメータ3</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="chapter24_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>t分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">pt</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d8n0 =</span> <span class="fu">pt</span>(x, <span class="at">df =</span> <span class="dv">8</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度8、非心パラメータ0</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n3 =</span> <span class="fu">pt</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">3</span>) <span class="co"># 自由度3、非心パラメータ3</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb34-7"><a href="#cb34-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-8"><a href="#cb34-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb34-9"><a href="#cb34-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb34-10"><a href="#cb34-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb34-11"><a href="#cb34-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-35-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="chapter24_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">qt</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d8n0 =</span> <span class="fu">qt</span>(x, <span class="at">df =</span> <span class="dv">8</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度8、非心パラメータ0</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n3 =</span> <span class="fu">qt</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">3</span>) <span class="co"># 自由度3、非心パラメータ3</span></span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb35-10"><a href="#cb35-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb35-11"><a href="#cb35-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb35-12"><a href="#cb35-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="chapter24_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d8n0 =</span> <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">8</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度8、非心パラメータ0</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n3 =</span> <span class="fu">rt</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">3</span>) <span class="co"># 自由度3、非心パラメータ3</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-7"><a href="#cb36-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb36-8"><a href="#cb36-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb36-9"><a href="#cb36-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb36-10"><a href="#cb36-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="chapter24_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="コーシー分布" class="level2" data-number="24.15">
<h2 data-number="24.15" class="anchored" data-anchor-id="コーシー分布"><span class="header-section-number">24.15</span> コーシー分布</h2>
<p><strong>コーシー分布</strong>はt分布で自由度が1のときの分布です。コーシー分布はt分布よりもさらに裾が重く、平均値も標準偏差も定義できない分布です。コーシー分布のパラメータは中央値であるtとスケールパラメータであるsの2つです。コーシー分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Cauchy(x, t, s)=\frac{1}{s \cdot \pi (1+((x-t)/s)^2)} \]</span></p>
<p>Rでは、コーシー分布の確率密度関数は<code>dcauchy</code>関数で計算することができます。<code>dcauchy</code>関数の引数は中央値tである<code>location</code>とスケールパラメータsである<code>scale</code>の2つです。コーシー分布も正規分布やt分布と同じく、<span class="math inline">\(-\infty\)</span>～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">コーシー乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>コーシー分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">dcauchy</span>(x, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># 中央値0、スケール1</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm2s05 =</span> <span class="fu">dcauchy</span>(x, <span class="at">location =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>), <span class="co"># 中央値-2、スケール0.5</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s2 =</span> <span class="fu">dcauchy</span>(x, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>) <span class="co"># 中央値2、スケール2</span></span>
<span id="cb37-7"><a href="#cb37-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb37-8"><a href="#cb37-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-9"><a href="#cb37-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb37-10"><a href="#cb37-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb37-11"><a href="#cb37-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb37-12"><a href="#cb37-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="chapter24_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>コーシー分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">pcauchy</span>(x, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># 中央値20、スケール0.1</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm2s05 =</span> <span class="fu">pcauchy</span>(x, <span class="at">location =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>), <span class="co"># 中央値20、スケール0.5</span></span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s2 =</span> <span class="fu">pcauchy</span>(x, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>) <span class="co"># 中央値20、スケール0.8</span></span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()<span class="sc">+</span></span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">y=</span><span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-39-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="chapter24_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqcauchyでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">qcauchy</span>(x, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># 中央値20、スケール0.1</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm2s05 =</span> <span class="fu">qcauchy</span>(x, <span class="at">location =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>), <span class="co"># 中央値20、スケール0.5</span></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s2 =</span> <span class="fu">qcauchy</span>(x, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>) <span class="co"># 中央値20、スケール0.8</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="chapter24_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数のヒストグラムをプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">rcauchy</span>(<span class="dv">1000</span>, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># 中央値20、スケール0.1</span></span>
<span id="cb40-4"><a href="#cb40-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">lm2s05 =</span> <span class="fu">rcauchy</span>(<span class="dv">1000</span>, <span class="at">location =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>), <span class="co"># 中央値20、スケール0.5</span></span>
<span id="cb40-5"><a href="#cb40-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s2 =</span> <span class="fu">rcauchy</span>(<span class="dv">1000</span>, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>) <span class="co"># 中央値20、スケール0.8</span></span>
<span id="cb40-6"><a href="#cb40-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb40-7"><a href="#cb40-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-8"><a href="#cb40-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb40-9"><a href="#cb40-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb40-10"><a href="#cb40-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.2</span>)) <span class="sc">+</span></span>
<span id="cb40-11"><a href="#cb40-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">50</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-41-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="chapter24_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ロジスティック分布" class="level2" data-number="24.16">
<h2 data-number="24.16" class="anchored" data-anchor-id="ロジスティック分布"><span class="header-section-number">24.16</span> ロジスティック分布</h2>
<p><strong>ロジスティック分布</strong>は<strong>ロジスティック関数</strong>を微分したものを分布としたもの、つまり、ロジスティック分布の積分である累積分布関数がロジスティック関数を取る分布のことを指します。ロジスティック関数は線形回帰で用いられる関数で、以下の式で表されます。</p>
<p><span class="math display">\[logis(x)=\frac{1}{(1+\exp(-(ax+b))}\]</span></p>
<p>ロジスティック関数は<a href="https://ja.wikipedia.org/wiki/%E5%80%8B%E4%BD%93%E7%BE%A4%E5%8B%95%E6%85%8B%E8%AB%96">個体群モデル</a>の数式化と関連のある関数です。統計では、逆関数である<strong>ロジット関数</strong>から導出されます。ロジット関数は以下の式で表されます。</p>
<p><span class="math display">\[log(\frac{p}{1-p})=ax+b\]</span></p>
<p>ロジット関数のpはベルヌーイ試行の成功確率p、ax+bは線形回帰の式です。<span class="math inline">\(p/1-p\)</span>は<strong>オッズ比</strong>と呼ばれるもので、成功確率と失敗確率の比を指します。</p>
<p>ロジスティック分布は以下の式で表されます。</p>
<p><span class="math display">\[Logistic(x, \mu, s)=\frac{\exp(-x)}{s(1+\exp(-(x-\mu)/s)^2)}\]</span></p>
<p>上の式のμは中央値、sはスケールパラメータです。Rでは、ロジスティック分布の確率密度関数は<code>dlogis</code>関数で計算することができます。<code>dlogis</code>関数の引数には、中央値μである<code>location</code>とスケールパラメータsである<code>scale</code>を指定します。ロジスティック分布は<span class="math inline">\(-\infty\)</span>～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-9-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-1" role="tab" aria-controls="tabset-9-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-2" role="tab" aria-controls="tabset-9-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-3" role="tab" aria-controls="tabset-9-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-9-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-9-4" role="tab" aria-controls="tabset-9-4" aria-selected="false">ロジスティック乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-9-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-9-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ロジスティック分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">dlogis</span>(x, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># location 0、scale1</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l1s2 =</span> <span class="fu">dlogis</span>(x, <span class="at">location =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># location 1、scale2</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s05 =</span> <span class="fu">dlogis</span>(x, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># location 2、scale0.5</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-42-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="chapter24_files/figure-html/unnamed-chunk-42-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ロジスティック分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">plogis</span>(x, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># location 0、scale1</span></span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l1s2 =</span> <span class="fu">plogis</span>(x, <span class="at">location =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># location 1、scale2</span></span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s05 =</span> <span class="fu">plogis</span>(x, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># location 2、scale0.5</span></span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-43-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="chapter24_files/figure-html/unnamed-chunk-43-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqlogisでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">qlogis</span>(x, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># location 0、scale1</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">l1s2 =</span> <span class="fu">qlogis</span>(x, <span class="at">location =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># location 1、scale2</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s05 =</span> <span class="fu">qlogis</span>(x, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># location 2、scale0.5</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb43-11"><a href="#cb43-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb43-12"><a href="#cb43-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-44-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="chapter24_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-9-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-9-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">l0s1 =</span> <span class="fu">rlogis</span>(<span class="dv">1000</span>, <span class="at">location =</span> <span class="dv">0</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># location 0、scale1</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">l1s2 =</span> <span class="fu">rlogis</span>(<span class="dv">1000</span>, <span class="at">location =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># location 1、scale2</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">l2s05 =</span> <span class="fu">rlogis</span>(<span class="dv">1000</span>, <span class="at">location =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># location 2、scale0.5</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-45-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="chapter24_files/figure-html/unnamed-chunk-45-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="対数正規分布" class="level2" data-number="24.17">
<h2 data-number="24.17" class="anchored" data-anchor-id="対数正規分布"><span class="header-section-number">24.17</span> 対数正規分布</h2>
<p><strong>対数正規分布</strong>は正規分布を指数変換した分布です。年収がこの分布に従うことで有名です。パラメータは正規分布と同じくμとσですが、μとσは分布の平均値・標準偏差ではありません。対数正規分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Lognorm(x, \mu, \sigma)=\frac{1}{x\sigma\sqrt{2\pi}} \cdot \exp(-\frac{(\ln x-\mu)^2}{2\sigma^2})\]</span></p>
<p>Rで対数正規分布の確率密度関数を計算するには、<code>dlnorm</code>関数を用います。<code>dlnorm</code>関数の引数には、μとして<code>meanlog</code>、σとして<code>sdlog</code>を指定します。対数正規分布は左に歪み、右側の裾が長い分布を示し、0～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-10-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-1" role="tab" aria-controls="tabset-10-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-2" role="tab" aria-controls="tabset-10-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-3" role="tab" aria-controls="tabset-10-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-10-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-10-4" role="tab" aria-controls="tabset-10-4" aria-selected="false">対数正規乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-10-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-10-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>対数正規分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">dlnorm</span>(x, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>), <span class="co"># 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s2 =</span> <span class="fu">dlnorm</span>(x, <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">2</span>), <span class="co"># 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm2s05 =</span> <span class="fu">dlnorm</span>(x, <span class="at">meanlog =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>) <span class="co"># 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-46-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="chapter24_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>対数正規分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">plnorm</span>(x, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>), <span class="co"># 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s2 =</span> <span class="fu">plnorm</span>(x, <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">2</span>), <span class="co"># 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm2s05 =</span> <span class="fu">plnorm</span>(x, <span class="at">meanlog =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>) <span class="co"># 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-47-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="chapter24_files/figure-html/unnamed-chunk-47-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">qlnorm</span>(x, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>), <span class="co"># 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s2 =</span> <span class="fu">qlnorm</span>(x, <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">2</span>), <span class="co"># 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm2s05 =</span> <span class="fu">qlnorm</span>(x, <span class="at">meanlog =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>) <span class="co"># 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-48-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="chapter24_files/figure-html/unnamed-chunk-48-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-10-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-10-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0s1 =</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="at">meanlog =</span> <span class="dv">0</span>, <span class="at">sdlog =</span> <span class="dv">1</span>), <span class="co"># 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2s2 =</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="at">meanlog =</span> <span class="dv">2</span>, <span class="at">sdlog =</span> <span class="dv">2</span>), <span class="co"># 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm2s05 =</span> <span class="fu">rlnorm</span>(<span class="dv">1000</span>, <span class="at">meanlog =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">sdlog =</span> <span class="fl">0.5</span>) <span class="co"># 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">100</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-49-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="chapter24_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ベータ分布" class="level2" data-number="24.18">
<h2 data-number="24.18" class="anchored" data-anchor-id="ベータ分布"><span class="header-section-number">24.18</span> ベータ分布</h2>
<p><strong>ベータ分布</strong>は、ベルヌーイ試行などの成功確率をモデル化する際に用いられる分布です。ベータ分布の確率密度関数には2つのパラメータがあり、それぞれα、βと呼ばれます。どちらも形状パラメータを意味しています。ベータ分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Beta(x, \alpha, \beta)=\frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)} \cdot x^{\alpha-1} \cdot (1-x)^{\beta-1}\]</span></p>
<p>Rでは、ベータ分布の確率密度関数は<code>dbeta</code>関数で計算することができます。<code>dbeta</code>分布の引数として、αを<code>shape1</code>、βを<code>shape2</code>として指定します。ベータ分布は0～1までの連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-11-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-1" role="tab" aria-controls="tabset-11-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-2" role="tab" aria-controls="tabset-11-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-3" role="tab" aria-controls="tabset-11-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-11-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-11-4" role="tab" aria-controls="tabset-11-4" aria-selected="false">ベータ分布乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-11-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-11-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ベータ分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s075 =</span> <span class="fu">dbeta</span>(x, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.75</span>), <span class="co"># shape1が0.5、shape2が0.75</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1  =</span> <span class="fu">dbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>), <span class="co"># shape1が1、shape2が1</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s3s2 =</span> <span class="fu">dbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>) <span class="co"># shape1が3、shape2が2</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-50-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="chapter24_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ベータ分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s075 =</span> <span class="fu">pbeta</span>(x, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.75</span>), <span class="co"># shape1が0.5、shape2が0.75</span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1  =</span> <span class="fu">pbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>), <span class="co"># shape1が1、shape2が1</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s3s2 =</span> <span class="fu">pbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>) <span class="co"># shape1が3、shape2が2</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-51-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="chapter24_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqbetaでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s075 =</span> <span class="fu">qbeta</span>(x, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.75</span>), <span class="co"># shape1が0.5、shape2が0.75</span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1  =</span> <span class="fu">qbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>), <span class="co"># shape1が1、shape2が1</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s3s2 =</span> <span class="fu">qbeta</span>(x, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>) <span class="co"># shape1が3、shape2が2</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-11"><a href="#cb51-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb51-12"><a href="#cb51-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-52-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="chapter24_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-11-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-11-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数のヒストグラムをプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s075 =</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="at">shape1 =</span> <span class="fl">0.5</span>, <span class="at">shape2 =</span> <span class="fl">0.75</span>), <span class="co"># shape1が0.5、shape2が0.75</span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1  =</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="at">shape1 =</span> <span class="dv">1</span>, <span class="at">shape2 =</span> <span class="dv">1</span>), <span class="co"># shape1が1、shape2が1</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s3s2 =</span> <span class="fu">rbeta</span>(<span class="dv">1000</span>, <span class="at">shape1 =</span> <span class="dv">3</span>, <span class="at">shape2 =</span> <span class="dv">2</span>) <span class="co"># shape1が3、shape2が2</span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-53-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="chapter24_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="カイ二乗分布" class="level2" data-number="24.19">
<h2 data-number="24.19" class="anchored" data-anchor-id="カイ二乗分布"><span class="header-section-number">24.19</span> カイ二乗分布</h2>
<p><strong>カイ二乗分布</strong>は正規分布に従う確率変数の二乗和の確率分布です。カイ二乗分布は度数の検定に用いられる分布で、そのパラメータは自由度νのみです。カイ二乗分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Chisq(x, \nu)=\frac{\exp(-x/2) \cdot \exp(\nu/2-1)}{2^{\nu/2} \cdot \Gamma(\nu/2)}\]</span></p>
<p>Rでは、カイ二乗分布は<code>dchisq</code>関数で計算することができます。<code>dchisq</code>関数の引数として、自由度νを<code>df</code>として指定します。カイ二乗分布は右側の裾が長い分布を示し、0～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-12-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-1" role="tab" aria-controls="tabset-12-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-2" role="tab" aria-controls="tabset-12-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-3" role="tab" aria-controls="tabset-12-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-12-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-12-4" role="tab" aria-controls="tabset-12-4" aria-selected="false">カイ二乗乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-12-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-12-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>カイ二乗分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d5n05 =</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">5</span>, <span class="at">ncp =</span> <span class="fl">0.5</span>), <span class="co"># 自由度5、非心パラメータ0.5</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">d10n2 =</span> <span class="fu">dchisq</span>(x, <span class="at">df =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">2</span>) <span class="co"># 自由度10、非心パラメータ2</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb53-10"><a href="#cb53-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb53-11"><a href="#cb53-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb53-12"><a href="#cb53-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-54-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="chapter24_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>カイ二乗分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">pchisq</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d5n05 =</span> <span class="fu">pchisq</span>(x, <span class="at">df =</span> <span class="dv">5</span>, <span class="at">ncp =</span> <span class="fl">0.5</span>), <span class="co"># 自由度5、非心パラメータ0.5</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d10n2 =</span> <span class="fu">pchisq</span>(x, <span class="at">df =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">2</span>) <span class="co"># 自由度10、非心パラメータ2</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb54-11"><a href="#cb54-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-55-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="chapter24_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqchisqでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">qchisq</span>(x, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">d5n05 =</span> <span class="fu">qchisq</span>(x, <span class="at">df =</span> <span class="dv">5</span>, <span class="at">ncp =</span> <span class="fl">0.5</span>), <span class="co"># 自由度5、非心パラメータ0.5</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">d10n2 =</span> <span class="fu">qchisq</span>(x, <span class="at">df =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">2</span>) <span class="co"># 自由度10、非心パラメータ2</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-56-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="chapter24_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-12-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-12-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数のヒストグラムをプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">d3n0 =</span> <span class="fu">rchisq</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">3</span>, <span class="at">ncp =</span> <span class="dv">0</span>), <span class="co"># 自由度3、非心パラメータ0</span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">d5n05 =</span> <span class="fu">rchisq</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">5</span>, <span class="at">ncp =</span> <span class="fl">0.5</span>), <span class="co"># 自由度5、非心パラメータ0.5</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">d10n2 =</span> <span class="fu">rchisq</span>(<span class="dv">1000</span>, <span class="at">df =</span> <span class="dv">10</span>, <span class="at">ncp =</span> <span class="dv">2</span>) <span class="co"># 自由度10、非心パラメータ2</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb56-9"><a href="#cb56-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb56-10"><a href="#cb56-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-57-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52"><img src="chapter24_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="f分布" class="level2" data-number="24.20">
<h2 data-number="24.20" class="anchored" data-anchor-id="f分布"><span class="header-section-number">24.20</span> F分布</h2>
<p><strong>F分布</strong>はカイ二乗に従う2つの独立な変数の比の分布です。F分布は<strong>分散分析</strong>で用いられる分布です。F分布のパラメータは独立の2変数それぞれの自由度（ν<sub>1</sub>とν<sub>2</sub>）です。F分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[F(x, \nu_{1}, \nu_{2})=
\frac{\Gamma(\frac{\nu_{1}+\nu_{2}}{2}) \cdot (\frac{\nu_{1}}{\nu_{2}})^{\nu_{1}/2 \cdot x^{\nu_{1}/2-1}}}
{\Gamma(\frac{\nu_{1}}{2}) \cdot \Gamma(\frac{\nu_{2}}{2}) \cdot (1+\frac{\nu_{1}x}{\nu_{2}})^{\frac{\nu_{1}+\nu_{2}}{2}}}\]</span></p>
<p>RではF分布の確率密度関数を<code>df</code>関数で計算することができます。<code>df</code>関数では自由度2つをそれぞれ<code>df1</code>、<code>df2</code>引数として指定します。F分布も右側の裾が長い分布を示し、0～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-13-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-1" role="tab" aria-controls="tabset-13-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-2" role="tab" aria-controls="tabset-13-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-3" role="tab" aria-controls="tabset-13-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-13-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-13-4" role="tab" aria-controls="tabset-13-4" aria-selected="false">F乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-13-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-13-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>F分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">df</span>(x, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">5</span>), <span class="co"># 自由度1 5、自由度2 5</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">df</span>(x, <span class="at">df1 =</span> <span class="dv">10</span>, <span class="at">df2 =</span> <span class="dv">15</span>), <span class="co"># 自由度1 10、自由度2 15</span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">df</span>(x, <span class="at">df1 =</span> <span class="dv">20</span>, <span class="at">df2 =</span> <span class="dv">15</span>) <span class="co"># 自由度1 20、自由度2 15</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-9"><a href="#cb57-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb57-10"><a href="#cb57-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb57-11"><a href="#cb57-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb57-12"><a href="#cb57-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-58-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53"><img src="chapter24_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>F分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">pf</span>(x, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">5</span>), <span class="co"># 自由度1 5、自由度2 5</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">pf</span>(x, <span class="at">df1 =</span> <span class="dv">10</span>, <span class="at">df2 =</span> <span class="dv">15</span>), <span class="co"># 自由度1 10、自由度2 15</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">pf</span>(x, <span class="at">df1 =</span> <span class="dv">20</span>, <span class="at">df2 =</span> <span class="dv">15</span>) <span class="co"># 自由度1 20、自由度2 15</span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb58-9"><a href="#cb58-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb58-10"><a href="#cb58-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb58-11"><a href="#cb58-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-59-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54"><img src="chapter24_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">qf</span>(x, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">5</span>), <span class="co"># 自由度1 5、自由度2 5</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">qf</span>(x, <span class="at">df1 =</span> <span class="dv">10</span>, <span class="at">df2 =</span> <span class="dv">15</span>), <span class="co"># 自由度1 10、自由度2 15</span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">qf</span>(x, <span class="at">df1 =</span> <span class="dv">20</span>, <span class="at">df2 =</span> <span class="dv">15</span>) <span class="co"># 自由度1 20、自由度2 15</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-9"><a href="#cb59-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb59-10"><a href="#cb59-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb59-11"><a href="#cb59-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb59-12"><a href="#cb59-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-60-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55"><img src="chapter24_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-13-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-13-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">5</span>, <span class="at">df2 =</span> <span class="dv">5</span>), <span class="co"># 自由度1 5、自由度2 5</span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">10</span>, <span class="at">df2 =</span> <span class="dv">15</span>), <span class="co"># 自由度1 10、自由度2 15</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">rf</span>(<span class="dv">1000</span>, <span class="at">df1 =</span> <span class="dv">20</span>, <span class="at">df2 =</span> <span class="dv">15</span>) <span class="co"># 自由度1 20、自由度2 15</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb60-9"><a href="#cb60-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb60-10"><a href="#cb60-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-61-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56"><img src="chapter24_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
データフレームの変数名
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Rでデータフレームを変数に代入する場合、<code>data.frame</code>から変数名を<code>df</code>とする場合があるのですが、この<code>df</code>にデータフレームを代入してしまうと、F関数の確率密度関数である<code>df</code>関数を上書きしてしまいます。正直<code>df</code>関数を使う機会はほとんどないのですが、データフレームの変数名には<code>d</code>の一文字を用いたり、きちんと意味のある名前を用いた方がよいでしょう。</p>
</div>
</div>
</div>
</section>
<section id="ガンマ分布" class="level2" data-number="24.21">
<h2 data-number="24.21" class="anchored" data-anchor-id="ガンマ分布"><span class="header-section-number">24.21</span> ガンマ分布</h2>
<p><strong>ガンマ分布</strong>は機械の信頼性や降雨量などの説明に用いられる分布です。ガンマ分布のパラメータは形状パラメータγとスケールパラメータβの2つです。ガンマ分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Gamma(x, \gamma, \beta)=\frac{(\frac{x}{\beta})^{\gamma-1} \cdot \exp(-\frac{x}{\beta})}{\beta \cdot \Gamma(\gamma)}\]</span></p>
<p>Rでのガンマ分布の確率密度関数は<code>dgamma</code>関数で計算することができます。ガンマ分布のパラメータである形状パラメータは<code>shape</code>引数、スケールパラメータは<code>scale</code>引数で指定します。ガンマ分布は右側の裾が長い分布で、最頻値が0以上となる形状を示し、0～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-14-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-1" role="tab" aria-controls="tabset-14-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-2" role="tab" aria-controls="tabset-14-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-3" role="tab" aria-controls="tabset-14-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-14-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-14-4" role="tab" aria-controls="tabset-14-4" aria-selected="false">ガンマ乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-14-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-14-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ガンマ分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">100</span>, <span class="at">by =</span> <span class="fl">0.1</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 5 scale 2</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">10</span>, <span class="at">scale =</span> <span class="dv">4</span>), <span class="co"># shape 10 scale 4</span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">dgamma</span>(x, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">6</span>) <span class="co"># shape 1 scale 6</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-9"><a href="#cb61-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb61-10"><a href="#cb61-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb61-11"><a href="#cb61-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb61-12"><a href="#cb61-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-62-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57"><img src="chapter24_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ガンマ分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">pgamma</span>(x, <span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 5 scale 2</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">pgamma</span>(x, <span class="at">shape =</span> <span class="dv">10</span>, <span class="at">scale =</span> <span class="dv">4</span>), <span class="co"># shape 10 scale 4</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">pgamma</span>(x, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">6</span>) <span class="co"># shape 1 scale 6</span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb62-9"><a href="#cb62-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb62-10"><a href="#cb62-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb62-11"><a href="#cb62-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-63-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58"><img src="chapter24_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">qgamma</span>(x, <span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 5 scale 2</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">qgamma</span>(x, <span class="at">shape =</span> <span class="dv">10</span>, <span class="at">scale =</span> <span class="dv">4</span>), <span class="co"># shape 10 scale 4</span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">qgamma</span>(x, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">6</span>) <span class="co"># shape 1 scale 6</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb63-12"><a href="#cb63-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-64-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59"><img src="chapter24_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-14-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-14-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">df5df5 =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 5 scale 2</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">df10df15 =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">10</span>, <span class="at">scale =</span> <span class="dv">4</span>), <span class="co"># shape 10 scale 4</span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">df15df20 =</span> <span class="fu">rgamma</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">6</span>) <span class="co"># shape 1 scale 6</span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-65-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60"><img src="chapter24_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="指数分布" class="level2" data-number="24.22">
<h2 data-number="24.22" class="anchored" data-anchor-id="指数分布"><span class="header-section-number">24.22</span> 指数分布</h2>
<p><strong>指数分布</strong>はポアソン分布する事象（まれに起こる事象）が起こる時間間隔の分布を示す確率分布です。指数分布は<strong>生存時間解析</strong>などの、イベントの発生数と時間の関係を解析するのに用いられています。指数分布のパラメータはλのみで、λは正の値を取ります。指数分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Exp(x, \lambda)=\lambda \cdot \exp(-\lambda x)\]</span></p>
<p>Rでは指数分布の確率密度関数は<code>dexp</code>関数で計算することができます。<code>dexp</code>関数では、λを<code>rate</code>引数で指定します。指数分布は単調減少で、0～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-15-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-1" role="tab" aria-controls="tabset-15-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-2" role="tab" aria-controls="tabset-15-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-3" role="tab" aria-controls="tabset-15-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-15-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-15-4" role="tab" aria-controls="tabset-15-4" aria-selected="false">指数乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-15-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-15-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>指数分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1 =</span> <span class="fu">dexp</span>(x, <span class="at">rate =</span> <span class="dv">1</span>), <span class="co"># ラムダ1</span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r3 =</span> <span class="fu">dexp</span>(x, <span class="at">rate =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r5 =</span> <span class="fu">dexp</span>(x, <span class="at">rate =</span> <span class="dv">5</span>) <span class="co"># ラムダ5</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-66-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61"><img src="chapter24_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>指数分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1 =</span> <span class="fu">pexp</span>(x, <span class="at">rate =</span> <span class="dv">1</span>), <span class="co"># ラムダ1</span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r3 =</span> <span class="fu">pexp</span>(x, <span class="at">rate =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r5 =</span> <span class="fu">pexp</span>(x, <span class="at">rate =</span> <span class="dv">5</span>) <span class="co"># ラムダ5</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-67-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62"><img src="chapter24_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqexpでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1 =</span> <span class="fu">qexp</span>(x, <span class="at">rate =</span> <span class="dv">1</span>), <span class="co"># ラムダ1</span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">r3 =</span> <span class="fu">qexp</span>(x, <span class="at">rate =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">r5 =</span> <span class="fu">qexp</span>(x, <span class="at">rate =</span> <span class="dv">5</span>) <span class="co"># ラムダ5</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-68-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-63"><img src="chapter24_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-15-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-15-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">r1 =</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="at">rate =</span> <span class="dv">1</span>), <span class="co"># ラムダ1</span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">r3 =</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="at">rate =</span> <span class="dv">3</span>), <span class="co"># ラムダ3</span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">r5 =</span> <span class="fu">rexp</span>(<span class="dv">1000</span>, <span class="at">rate =</span> <span class="dv">5</span>) <span class="co"># ラムダ5</span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-69-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64"><img src="chapter24_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ワイブル分布" class="level2" data-number="24.23">
<h2 data-number="24.23" class="anchored" data-anchor-id="ワイブル分布"><span class="header-section-number">24.23</span> ワイブル分布</h2>
<p><strong>ワイブル分布</strong>は指数分布を拡張したような確率分布です。指数分布では、ポアソン分布する事象（イベント）が起きる確率は常に一定であることを仮定していますが、ワイブル分布を用いると単調増加・単調減少でイベントが起きる確率が変化する場合を表現することができます。ワイブル分布のパラメータは形状パラメータのλとスケールパラメータのkの2つです。ワイブル分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Weibull(x, \lambda, k)=\frac{k}{\lambda}(\frac{x}{\lambda})^{k-1} \cdot \exp(-\frac{x}{\lambda})^k\]</span></p>
<p>Rでは、ワイブル分布の確率密度関数を<code>dweibull</code>関数で計算することができます。<code>dweibull</code>関数の引数は形状パラメータλである<code>shape</code>と、スケールパラメータkである<code>scale</code>の2つです。ワイブル分布はガンマ分布と同じく、右側の裾が長い分布で、最頻値が0以上となる形状を示し、0～<span class="math inline">\(\infty\)</span>の範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-16-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-1" role="tab" aria-controls="tabset-16-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-2" role="tab" aria-controls="tabset-16-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-3" role="tab" aria-controls="tabset-16-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-16-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-16-4" role="tab" aria-controls="tabset-16-4" aria-selected="false">ワイブル乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-16-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-16-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ワイブル分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1 =</span> <span class="fu">dweibull</span>(x, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># shape 1、scale 1</span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s2s2 =</span> <span class="fu">dweibull</span>(x, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 2、scale 2</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s05 =</span> <span class="fu">dweibull</span>(x, <span class="at">shape =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># shape 0.5、scale 0.5</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-70-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65"><img src="chapter24_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ワイブル分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1 =</span> <span class="fu">pweibull</span>(x, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># shape 1、scale 1</span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s2s2 =</span> <span class="fu">pweibull</span>(x, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 2、scale 2</span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s05 =</span> <span class="fu">pweibull</span>(x, <span class="at">shape =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># shape 0.5、scale 0.5</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-71-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66"><img src="chapter24_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1 =</span> <span class="fu">qweibull</span>(x, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># shape 1、scale 1</span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">s2s2 =</span> <span class="fu">qweibull</span>(x, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 2、scale 2</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s05 =</span> <span class="fu">qweibull</span>(x, <span class="at">shape =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># shape 0.5、scale 0.5</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-72-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67"><img src="chapter24_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-16-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-16-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">s1s1 =</span> <span class="fu">rweibull</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">1</span>, <span class="at">scale =</span> <span class="dv">1</span>), <span class="co"># shape 1、scale 1</span></span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">s2s2 =</span> <span class="fu">rweibull</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="dv">2</span>, <span class="at">scale =</span> <span class="dv">2</span>), <span class="co"># shape 2、scale 2</span></span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">s05s05 =</span> <span class="fu">rweibull</span>(<span class="dv">1000</span>, <span class="at">shape =</span> <span class="fl">0.5</span>, <span class="at">scale =</span> <span class="fl">0.5</span>) <span class="co"># shape 0.5、scale 0.5</span></span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb72-7"><a href="#cb72-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb72-8"><a href="#cb72-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb72-9"><a href="#cb72-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb72-10"><a href="#cb72-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="fl">0.2</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-73-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-68"><img src="chapter24_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="一様分布" class="level2" data-number="24.24">
<h2 data-number="24.24" class="anchored" data-anchor-id="一様分布"><span class="header-section-number">24.24</span> 一様分布</h2>
<p><strong>一様分布</strong>は、最小値（a）から最大値（b）まで、一定の確率で現れる現象を示す分布です。この章の始めに示した<code>sample</code>関数の乱数やサイコロなどが一様分布の典型的な例です。一様分布のパラメータは最小値aと最大値bの2つです。一様分布の確率密度関数は以下の式で表されます。</p>
<p><span class="math display">\[Unif(x, a, b)=\frac{1}{b-a}\]</span></p>
<p>Rでは、一様分布の確率密度関数を<code>dunif</code>関数で計算することができます。<code>dunif</code>関数では最小値aとして<code>min</code>、最大値bとして<code>max</code>の2つのパラメータを引数に指定します。一様分布はその名の通り確率密度が一定で、a～bの範囲を持つ連続値を取ります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-17-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-1" role="tab" aria-controls="tabset-17-1" aria-selected="true">確率密度</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-2" role="tab" aria-controls="tabset-17-2" aria-selected="false">累積分布関数</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-3" role="tab" aria-controls="tabset-17-3" aria-selected="false">分位点の値</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-17-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-17-4" role="tab" aria-controls="tabset-17-4" aria-selected="false">一様乱数</a></li></ul>
<div class="tab-content">
<div id="tabset-17-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-17-1-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>一様分布の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="fl">4.5</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0m1 =</span> <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小0、最大1</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm1m1 =</span> <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小-1、最大1</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2m4 =</span> <span class="fu">dunif</span>(x, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">4</span>) <span class="co"># 最小2、最大4</span></span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-74-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-69"><img src="chapter24_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-2-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>一様分布の累積分布関数をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0m1 =</span> <span class="fu">punif</span>(x, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小0、最大1</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm1m1 =</span> <span class="fu">punif</span>(x, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小-1、最大1</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2m4 =</span> <span class="fu">punif</span>(x, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">4</span>) <span class="co"># 最小2、最大4</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-75-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-70"><img src="chapter24_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-3-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>累積分布関数の分位点と値の関係をqfでプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.01</span>)</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>  x,</span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0m1 =</span> <span class="fu">qunif</span>(x, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小0、最大1</span></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm1m1 =</span> <span class="fu">qunif</span>(x, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小-1、最大1</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2m4 =</span> <span class="fu">qunif</span>(x, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">4</span>) <span class="co"># 最小2、最大4</span></span>
<span id="cb75-7"><a href="#cb75-7" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb75-8"><a href="#cb75-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-9"><a href="#cb75-9" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb75-10"><a href="#cb75-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">4</span>) <span class="sc">|&gt;</span> </span>
<span id="cb75-11"><a href="#cb75-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> value, <span class="at">color =</span> name)) <span class="sc">+</span></span>
<span id="cb75-12"><a href="#cb75-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-76-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-71"><img src="chapter24_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-17-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-17-4-tab">
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>乱数の確率密度をプロット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">m0m1 =</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="dv">0</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小0、最大1</span></span>
<span id="cb76-3"><a href="#cb76-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">mm1m1 =</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">max =</span> <span class="dv">1</span>), <span class="co"># 最小-1、最大1</span></span>
<span id="cb76-4"><a href="#cb76-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">m2m4 =</span> <span class="fu">runif</span>(<span class="dv">1000</span>, <span class="at">min =</span> <span class="dv">2</span>, <span class="at">max =</span> <span class="dv">4</span>) <span class="co"># 最小2、最大4</span></span>
<span id="cb76-5"><a href="#cb76-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb76-6"><a href="#cb76-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb76-7"><a href="#cb76-7" aria-hidden="true" tabindex="-1"></a>d <span class="sc">|&gt;</span> </span>
<span id="cb76-8"><a href="#cb76-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb76-9"><a href="#cb76-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>)) <span class="sc">+</span></span>
<span id="cb76-10"><a href="#cb76-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position=</span><span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-77-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-72"><img src="chapter24_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="多項分布" class="level2" data-number="24.25">
<h2 data-number="24.25" class="anchored" data-anchor-id="多項分布"><span class="header-section-number">24.25</span> 多項分布</h2>
<p>多項分布はここまでに示した確率分布とは異なり、Rには累積分布関数や分位点の関数が設定されていない確率分布です。多項分布は、複数の事象、例えばツボに白・赤・黒のボールを違う数で入れておき、取り出しては戻すような試行（<strong>復元抽出</strong>）を行うとき、それぞれの色のボールを特定の数だけ取り出す確率を計算するときに用います。各色のボールを取り出す確率はそれぞれ異なりますが、足し合わせれば確率が1となるような状況で多項分布は用いられます。</p>
<p>多項分布の確率質量関数のパラメータはボールの色がk色の時、ボールを取り出す回数n、各色のボールを取り出す数x<sub>1</sub>～x<sub>k</sub>、各色のボールを取り出す確率p<sub>1</sub>p<sub>k</sub>の4種類となります。nはx<sub>1</sub>～x<sub>k</sub>の和となります。</p>
<p><span class="math display">\[Multinomial(n, x_{1}, x_{2}, \cdots x_{k}, p_{1}, p_{2}, \cdots p_{k})=\frac{n!}{x_{1}! \cdot x_{2}! \cdot \cdots \cdot x_{k}!} \cdot p_{1}^{x_{1}} \cdot p_{2}^{x_{2}} \cdot \cdots p_{k}^{x_{k}}\]</span></p>
<p>Rでは、<code>dmultinom</code>関数で多項分布の確率質量関数を計算することができます。<code>dmultinom</code>関数の引数はボールを取り出す回数nを表す<code>size</code>、各色のボールを取り出す数のx<sub>1</sub>～x<sub>k</sub>をベクターで表した<code>x</code>、各色のボールを取り出す確率であるp<sub>1</sub>p<sub>k</sub>を同じくベクターで表した<code>prob</code>の3つとなります。</p>
<p>また、多項分布の乱数を得る関数である<code>rmultinom</code>関数も他の確率分布を示す乱数の関数とはやや使い方が異なります。<code>size</code>と<code>prob</code>の2つの引数を指定するのは上と同じですが、返り値は合計が<code>size</code>で指定した数値となるボールの数k個の乱数です。<code>prob</code>で確率を指定したそれぞれに対する値（ボールの数のようなもの）が第一引数（<code>n</code>）で示した数だけ、列として並ぶ行列が返ってきます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>多項分布の関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 0.1、0.3、0.6の確率で起こる事象がそれぞれ1、2、4回同時に起こる確率</span></span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dmultinom</span>(<span class="at">x =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">4</span>), <span class="at">size =</span> <span class="dv">7</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>))</span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.122472</span></span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 足し合わせると20になるものが10個、列として返ってくる。</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 行の上から、0.1、0.3、0.6の確率で現れている</span></span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a><span class="fu">rmultinom</span>(<span class="dv">10</span>, <span class="at">size=</span><span class="dv">20</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>))</span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    3    2    1    3    4    2    1    0    2     0</span></span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    4    6    2    4    6    5    5    9    3     8</span></span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]   13   12   17   13   10   13   14   11   15    12</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>多項分布の乱数をグラフで示す</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>rmnom <span class="ot">&lt;-</span> <span class="fu">rmultinom</span>(<span class="dv">1000</span>, <span class="at">size=</span><span class="dv">20</span>, <span class="at">prob =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.6</span>))</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>rmnom <span class="sc">|&gt;</span> </span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">t</span>() <span class="sc">|&gt;</span> </span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tibble</span>() <span class="sc">|&gt;</span> </span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="sc">|&gt;</span> </span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> value, <span class="at">color =</span> name, <span class="at">fill =</span> name, <span class="at">alpha =</span> <span class="fl">0.5</span>))<span class="sc">+</span></span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">position =</span> <span class="st">"identity"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter24_files/figure-html/unnamed-chunk-79-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73"><img src="chapter24_files/figure-html/unnamed-chunk-79-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-3">確率密度、累積分布、分位点の関係</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-10.1145/272991.272995" class="csl-entry" role="listitem">
Matsumoto, Makoto, and Takuji Nishimura. 1998. <span>“Mersenne Twister: A 623-Dimensionally Equidistributed Uniform Pseudo-Random Number Generator.”</span> <em>ACM Trans. Model. Comput. Simul.</em> 8 (1): 3–30. <a href="https://doi.org/10.1145/272991.272995">https://doi.org/10.1145/272991.272995</a>.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter23.html" class="pagination-link" aria-label="plotly">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">plotly</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter25.html" class="pagination-link" aria-label="検定">
        <span class="nav-page-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">検定</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb79" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 確率分布と乱数</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, include=FALSE, echo=FALSE}</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="in">  collapse = TRUE</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse)</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## 乱数と種（seed）</span></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a>プログラミングでは、ランダムに生成された数値、**乱数**を使った処理を行うことがあります。例えばゲームなどで偶然性を表現する場合には、整数の乱数が用いられています。Rで整数の乱数を得る時には、<span class="in">`sample`</span>関数を用います。<span class="in">`sample`</span>関数は数列のベクターから引数で指定した数だけランダムに取り出し、ベクターとして返します。</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="1～100の整数からランダムに20個取り出す"}</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="in">sample(1:100, 20, replace=TRUE)</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a>乱数は完全にランダムな数値というわけではなく、ランダムに見える繰り返し計算から生成されています（**疑似乱数**）。この疑似乱数を生成するアルゴリズムにはいろいろな種類があるのですが、Rではデフォルトの乱数生成アルゴリズムとして、**[メルセンヌ・ツイスター法](http://www.math.sci.hiroshima-u.ac.jp/m-mat/TEACH/ichimura-sho-koen.pdf)（mersenne twister）** <span class="co">[</span><span class="ot">@10.1145/272991.272995</span><span class="co">]</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>が用いられています。メルセンヌ・ツイスターは乱数生成アルゴリズムの中でも偏りのない乱数を得られるもので、現在ではExcelでも用いられています。</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>Rでの乱数生成アルゴリズムを確認、設定する場合には、<span class="in">`RNGkind`</span>関数を用います。<span class="in">`RNGkind`</span>関数を用いれば、乱数生成アルゴリズムを変更することもできますが、メルセンヌ・ツイスターから変更する必要は特にないでしょう。</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数生成アルゴリズムの確認"}</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="in"># ?RNGkindで利用可能な乱数生成アルゴリズムの一覧を確認できる</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="in">RNGkind()</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a>乱数生成アルゴリズムは繰り返し計算で乱数を生成するため、乱数を生成するときに乱数の初期値が必要となります。この乱数の初期値のことを**乱数の種（seed）**と呼びます。Rでは乱数の種を<span class="in">`set.seed`</span>関数で指定することができます。乱数の種をある値に設定しておくと、乱数を何度生成しても同じ結果を得ることができます。乱数を用いた計算で統計を行う場合には、計算の再現性を保つためにseedを設定しておく方がよいでしょう。</span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="set.seed関数で乱数のシードを設定"}</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(0)</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="in">sample(1:100, 20, replace=TRUE) # seedが0のときの乱数</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(0)</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="in">sample(1:100, 20, replace=TRUE) # seedを0にしているので、値が上と同じ</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="fu">## 復元抽出と非復元抽出</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="in">`sample`</span>関数では、第1引数として設定したベクターから選択された場合、その値がもう一度選択することができる場合（復元抽出）と、できない場合（非復元抽出）の設定を<span class="in">`replace`</span>引数で設定することができます。<span class="in">`replace=TRUE`</span>の場合は復元抽出、<span class="in">`replace=FALSE`</span>の場合は非復元抽出となります。非復元抽出の場合には、第1引数の長さ以上の数の値を呼び出すことはできません。<span class="in">`replace`</span>引数のデフォルトは<span class="in">`FALSE`</span>ですので、<span class="in">`replece`</span>引数を指定しない場合には非復元抽出が行われます。</span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="復元抽出と非復元抽出", error=TRUE}</span></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a><span class="in"># 復元抽出</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a><span class="in">sample(1:3, 5, replace = TRUE)</span></span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a><span class="in"># 非復元抽出</span></span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a><span class="in">sample(1:3, 3, replace = FALSE)</span></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a><span class="in"># 非復元抽出で取り出す値の数がベクターより長いと、エラーとなる</span></span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a><span class="in">sample(1:3, 5, replace = FALSE)</span></span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a>また、統計では乱数を使った計算（**[モンテカルロ法](https://ja.wikipedia.org/wiki/%E3%83%A2%E3%83%B3%E3%83%86%E3%82%AB%E3%83%AB%E3%83%AD%E6%B3%95)**）を用いることがあります。特に**確率分布に従った乱数**を用いた計算が統計では有用です。このような確率分布に従った乱数計算を行う場合には、<span class="in">`sample`</span>関数ではなく、確率分布に関連した一連の関数を用いるのが一般的です。</span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>**確率分布**とは、ランダムに起こる事象（例えばコイントスや身長・体重の大きさなど）がそれぞれの値を取る確率を関数の形で表現したものです。もっとも一般的に用いられている確率分布は、**正規分布（Normal distribution）**です。正規分布は平均値と標準偏差をパラメータとした確率分布で、平均値を取る確率が最も高く、平均値から離れるほど確率が低くなっていく、釣鐘型の形を取る分布です。</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a>Rでは、この正規分布の**確率密度**、**累積分布**、**分位点での値**、**乱数**をそれぞれ**`dnorm`、`pnorm`、`qnorm`、`rnorm`**関数を用いて計算することができます。</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a>**確率密度**は上で述べた通り、ランダムに起こる事象がそれぞれの値を取る確率を示したものです。この確率密度は**確率密度関数**（離散的な分布では**確率質量関数**）という関数で表現されます。この確率密度関数を返すのが、**「`d` + 分布の名前」**で示される関数です。正規分布の確率密度関数は、<span class="in">`dnorm`</span>関数で計算することができます。この<span class="in">`dnorm`</span>関数は、<span class="in">`mean`</span>引数で指定した平均値、<span class="in">`sd`</span>引数で指定した標準編差の正規分布において、第一引数で指定した値（<span class="in">`x`</span>）における確率密度を返す関数です。ただし、確率密度はその値が確率なのではなく、確率密度の積分が確率となりますので、この<span class="in">`dnorm`</span>の返り値が確率ではありません（ただし、確率質量分布、つまり離散的な分布では確率質量分布の返り値が確率となります）。</span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a>確率密度には連続的なものと離散的なものがあり、確率分布ごとに値を取りうる範囲があります。例えば正規分布は$+\infty$から$-\infty$の範囲の有理数すべてを取ることができる連続的な分布です。別の分布、ポアソン分布は正の整数のみを取ることができる、離散的な分布となります。</span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="正規分布の確率密度"}</span></span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a><span class="in">dnorm(x = 1, mean = 0, sd = 1) # 正規分布の確率密度</span></span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率分布の平均と分散</span></span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a>確率分布f(x)はその積分が確率となる関数で表されます。確率は合計すると必ず1となるため、確率分布をその分布の範囲で積分すると1になります。また、積分すると1となることが確率分布であることの条件にもなります。</span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a>$$\int_{-\infty}^{\infty}f(x)dx=1$$</span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a>確率分布の平均値（$E<span class="co">[</span><span class="ot">f(x)</span><span class="co">]</span>$）と分散（$V<span class="co">[</span><span class="ot">f(x)</span><span class="co">]</span>$）は以下の積分で計算できます。</span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a>$$E<span class="co">[</span><span class="ot">f(x)</span><span class="co">]</span>=\int_{-\infty}^{\infty}x \cdot f(x)dx$$</span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a>$$V<span class="co">[</span><span class="ot">f(x)</span><span class="co">]</span>=\int_{-\infty}^{\infty}(x-\mu)^2 \cdot f(x)dx$$</span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布</span></span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a>確率密度をx軸方向に積分して得られる関数のことを、**累積分布関数**と呼びます。上に述べた通り、確率密度を積分したものが確率となりますので、累積分布関数を用いると、正規分布する値がある一定の範囲を取る確率を計算することができます。Rで累積分布関数を返すのが、**「`p` + 分布の名前」**で示される関数です。</span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a>正規分布の累積分布関数は、<span class="in">`pnorm`</span>関数で計算することができます。正規分布の累積分布関数では、正規分布する値が$-\infty$からその値までの範囲を取る確率が計算されるため、正規分布する値が第一引数<span class="in">`q`</span>で指定した値以下となる確率を計算することになります。平均値を<span class="in">`mean`</span>引数、標準偏差を<span class="in">`sd`</span>引数で指定するのはすべての<span class="in">`norm`</span>関数で共通しています。</span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="正規分布の累積分布関数"}</span></span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a><span class="in">pnorm(q = 1, mean = 0, sd = 1) # 正規分布の累積分布関数（q（1）以下となる確率）</span></span>
<span id="cb79-94"><a href="#cb79-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-95"><a href="#cb79-95" aria-hidden="true" tabindex="-1"></a><span class="in"># 平均0、標準偏差1の正規分布での標準偏差の区間（-1 ~ 1）の値が得られる確率</span></span>
<span id="cb79-96"><a href="#cb79-96" aria-hidden="true" tabindex="-1"></a><span class="in">pnorm(1, mean = 0, sd = 1) - pnorm(-1, mean = 0, sd = 1) </span></span>
<span id="cb79-97"><a href="#cb79-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-98"><a href="#cb79-98" aria-hidden="true" tabindex="-1"></a><span class="in"># 平均0、標準偏差1の正規分布で、-1.96~1.96の値が得られる確率（95％区間）</span></span>
<span id="cb79-99"><a href="#cb79-99" aria-hidden="true" tabindex="-1"></a><span class="in">pnorm(1.96, mean = 0, sd = 1) - pnorm(-1.96, mean = 0, sd = 1) </span></span>
<span id="cb79-100"><a href="#cb79-100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-101"><a href="#cb79-101" aria-hidden="true" tabindex="-1"></a><span class="in"># 累積分布関数の形（正規分布）</span></span>
<span id="cb79-102"><a href="#cb79-102" aria-hidden="true" tabindex="-1"></a><span class="in">plot(seq(-3, 3, by = 0.1), pnorm(seq(-3, 3, by = 0.1)), type = "l")</span></span>
<span id="cb79-103"><a href="#cb79-103" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-104"><a href="#cb79-104" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-105"><a href="#cb79-105" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点</span></span>
<span id="cb79-106"><a href="#cb79-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-107"><a href="#cb79-107" aria-hidden="true" tabindex="-1"></a>逆に、累積分布関数で求まる確率から、その確率となる値を求める関数が、**「`q` + 分布の名前」**で示される関数です。第一引数である<span class="in">`p`</span>には確率（0～1）を指定し、その確率が得られる累積分布関数でのx軸上の値を得ることができます。正規分布では、<span class="in">`qnorm`</span>関数でこの計算を行うことができます。<span class="in">`pnorm`</span>関数と<span class="in">`qnorm`</span>関数では、第一引数と返り値の関係がちょうど逆になります。</span>
<span id="cb79-108"><a href="#cb79-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-109"><a href="#cb79-109" aria-hidden="true" tabindex="-1"></a>引数<span class="in">`p`</span>に対して、<span class="in">`qnorm`</span>関数で得られる値のことを、「<span class="in">`100*p`</span>%分位点」と呼ぶのが一般的です。<span class="in">`p=0.25`</span>なら25％分位点、<span class="in">`p=0.75`</span>なら75％分位点が得られることになります。</span>
<span id="cb79-110"><a href="#cb79-110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-111"><a href="#cb79-111" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="正規分布の分位点"}</span></span>
<span id="cb79-112"><a href="#cb79-112" aria-hidden="true" tabindex="-1"></a><span class="in">qnorm(p = 0.975, mean = 0, sd = 1) # 正規分布の97.5%分位点における値</span></span>
<span id="cb79-113"><a href="#cb79-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-114"><a href="#cb79-114" aria-hidden="true" tabindex="-1"></a><span class="in"># qnormの形はpnorm（累積分布関数）のx、yが入れ替わったものとなる</span></span>
<span id="cb79-115"><a href="#cb79-115" aria-hidden="true" tabindex="-1"></a><span class="in">plot(seq(0, 1, by = 0.01), qnorm(seq(0, 1, by = 0.01)), type = "l")</span></span>
<span id="cb79-116"><a href="#cb79-116" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-117"><a href="#cb79-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-118"><a href="#cb79-118" aria-hidden="true" tabindex="-1"></a>確率密度（<span class="in">`dnorm`</span>）、累積分布（<span class="in">`pnorm`</span>）、分位点（<span class="in">`qnorm`</span>）の関係を図で示すと、以下のような関係になっています。</span>
<span id="cb79-119"><a href="#cb79-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-120"><a href="#cb79-120" aria-hidden="true" tabindex="-1"></a><span class="al">![確率密度、累積分布、分位点の関係](./image/dpqnorm_image.png)</span></span>
<span id="cb79-121"><a href="#cb79-121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-122"><a href="#cb79-122" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率分布に従った乱数</span></span>
<span id="cb79-123"><a href="#cb79-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-124"><a href="#cb79-124" aria-hidden="true" tabindex="-1"></a>確率分布に従った乱数を得ることができれば、その確率分布に従う現象をシミュレートすることができます。Rで確率分布に従った乱数を求める関数が、**「`r` + 分布の名前」**で示される関数です。正規分布では、<span class="in">`rnorm`</span>関数で乱数（正規乱数）を得ることができます。第一引数（<span class="in">`n`</span>）で、乱数の個数を指定します。</span>
<span id="cb79-125"><a href="#cb79-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-126"><a href="#cb79-126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="正規分布の確率密度"}</span></span>
<span id="cb79-127"><a href="#cb79-127" aria-hidden="true" tabindex="-1"></a><span class="in">rnorm(n = 10, mean = 0, sd = 1) # 正規分布の乱数</span></span>
<span id="cb79-128"><a href="#cb79-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-129"><a href="#cb79-129" aria-hidden="true" tabindex="-1"></a><span class="in"># 乱数をたくさん生成し、ヒストグラムを描画する</span></span>
<span id="cb79-130"><a href="#cb79-130" aria-hidden="true" tabindex="-1"></a><span class="in">rnorm(10000, mean = 0, sd = 1) |&gt; hist() </span></span>
<span id="cb79-131"><a href="#cb79-131" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-132"><a href="#cb79-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-133"><a href="#cb79-133" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-134"><a href="#cb79-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-135"><a href="#cb79-135" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率分布に従う乱数を得る</span></span>
<span id="cb79-136"><a href="#cb79-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-137"><a href="#cb79-137" aria-hidden="true" tabindex="-1"></a>通常、確率分布に従う形の乱数を得る場合には、累積分布関数の**[逆関数](https://ja.wikipedia.org/wiki/%E9%80%86%E9%96%A2%E6%95%B0%E6%B3%95)**というものを用います。逆関数はy=f(x)の関数をx=g(y)という形に、xについて解いたものを指します。確率密度関数の逆関数に一様乱数を入れると、確率分布に従った乱数を得ることができます。<span class="in">`rnorm`</span>などの乱数生成アルゴリズムはC言語で記載されていて、逆関数を用いているのかはわかりませんが、メルセンヌ・ツイスターで生成されるのは一様乱数ですので、内部的には同様の変換が行われているのだと思います。</span>
<span id="cb79-138"><a href="#cb79-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-139"><a href="#cb79-139" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-140"><a href="#cb79-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-141"><a href="#cb79-141" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rで用いることのできる確率分布の一覧</span></span>
<span id="cb79-142"><a href="#cb79-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-143"><a href="#cb79-143" aria-hidden="true" tabindex="-1"></a>Rでは、norm（正規分布）の他に、以下の表1で示す確率分布に関する関数が登録されています。各確率分布の「記号」の前に<span class="in">`d`</span>を付けると確率密度関数、<span class="in">`p`</span>を付けると累積分布関数、<span class="in">`q`</span>を付けると分位点、<span class="in">`r`</span>を付けると乱数を得る関数となります。</span>
<span id="cb79-144"><a href="#cb79-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-145"><a href="#cb79-145" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb79-146"><a href="#cb79-146" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- readxl::read_excel("./data/chapter24_distributions.xlsx", sheet=1)</span></span>
<span id="cb79-147"><a href="#cb79-147" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::kable(d, label="表1：分布を表す記号")</span></span>
<span id="cb79-148"><a href="#cb79-148" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-149"><a href="#cb79-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-150"><a href="#cb79-150" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-151"><a href="#cb79-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-152"><a href="#cb79-152" aria-hidden="true" tabindex="-1"></a><span class="fu">## その他の確率分布</span></span>
<span id="cb79-153"><a href="#cb79-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-154"><a href="#cb79-154" aria-hidden="true" tabindex="-1"></a>上記の表1に示した以外にも、Rではライブラリを用いることで様々な確率分布の関数を用いることができます。ライブラリの一覧に関しては、CRAN Task Viewの<span class="co">[</span><span class="ot">Probability Distributions</span><span class="co">](https://cran.r-project.org/web/views/Distributions.html)</span>が参考になります。また、それぞれの確率分布の関係については、<span class="co">[</span><span class="ot">Univariate Distribution Relationships</span><span class="co">](https://www.math.wm.edu/~leemis/chart/UDR/UDR.html)</span>に詳しく記載されているので、興味のある方は一読するとよいでしょう。日本語では、こちらの<span class="co">[</span><span class="ot">三中先生の解説ページ</span><span class="co">](https://www.yodosha.co.jp/smart-lab-life/statics_pitfalls/statics_pitfalls09.html)</span>に書かれています。また、確率分布を表示する<span class="co">[</span><span class="ot">Webアプリ</span><span class="co">](https://statdist.ksmzn.com/)</span>を触ってみるのも良いでしょう。</span>
<span id="cb79-155"><a href="#cb79-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-156"><a href="#cb79-156" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-157"><a href="#cb79-157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-158"><a href="#cb79-158" aria-hidden="true" tabindex="-1"></a>以下に、各確率分布の簡単な説明と、各関数を用いたグラフを示します。</span>
<span id="cb79-159"><a href="#cb79-159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-160"><a href="#cb79-160" aria-hidden="true" tabindex="-1"></a><span class="fu">## 二項分布</span></span>
<span id="cb79-161"><a href="#cb79-161" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-162"><a href="#cb79-162" aria-hidden="true" tabindex="-1"></a>**二項分布**は**ベルヌーイ試行**（コイントスのように、1と0だけが確率的に結果として得られる試行）の試行回数（<span class="in">`size`</span>）と成功確率（<span class="in">`prob`</span>）から、成功回数<span class="in">`x`</span>が得られる確率を示したものです。二項分布の確率質量関数は以下の式で表されます。</span>
<span id="cb79-163"><a href="#cb79-163" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-164"><a href="#cb79-164" aria-hidden="true" tabindex="-1"></a>$$Binom(x,n,p)=_{n}C_{x} \cdot p^{x} \cdot (1-p)^{n-x}$$</span>
<span id="cb79-165"><a href="#cb79-165" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-166"><a href="#cb79-166" aria-hidden="true" tabindex="-1"></a>nが試行回数、pが成功確率、xが成功回数を表しています。Rでは、nを<span class="in">`size`</span>引数、pを<span class="in">`prob`</span>引数で指定します。コイントスですので、整数でない成功回数（4.21回成功など）が起こることはありませんし、マイナスの試行数も取りません。ですので、二項分布は成功回数<span class="in">`x`</span>が正の整数のみの離散的な確率分布になります。分布の範囲は**0～試行回数**です。</span>
<span id="cb79-167"><a href="#cb79-167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-168"><a href="#cb79-168" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-169"><a href="#cb79-169" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-170"><a href="#cb79-170" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率質量</span></span>
<span id="cb79-171"><a href="#cb79-171" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-172"><a href="#cb79-172" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="二項分布の確率密度をプロット"}</span></span>
<span id="cb79-173"><a href="#cb79-173" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 0:20</span></span>
<span id="cb79-174"><a href="#cb79-174" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-175"><a href="#cb79-175" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-176"><a href="#cb79-176" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p01 = dbinom(x, size = 20, prob = 0.1), # サイズ20、確率0.1</span></span>
<span id="cb79-177"><a href="#cb79-177" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p05 = dbinom(x, size = 20, prob = 0.5), # サイズ20、確率0.5</span></span>
<span id="cb79-178"><a href="#cb79-178" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p08 = dbinom(x, size = 20, prob = 0.8) # サイズ20、確率0.8</span></span>
<span id="cb79-179"><a href="#cb79-179" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-180"><a href="#cb79-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-181"><a href="#cb79-181" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-182"><a href="#cb79-182" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-183"><a href="#cb79-183" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-184"><a href="#cb79-184" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-185"><a href="#cb79-185" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-186"><a href="#cb79-186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-187"><a href="#cb79-187" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-188"><a href="#cb79-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-189"><a href="#cb79-189" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="二項分布の累積分布関数をプロット"}</span></span>
<span id="cb79-190"><a href="#cb79-190" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-191"><a href="#cb79-191" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-192"><a href="#cb79-192" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p01 = pbinom(x, size = 20, prob = 0.1), # サイズ20、確率0.1</span></span>
<span id="cb79-193"><a href="#cb79-193" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p05 = pbinom(x, size = 20, prob = 0.5), # サイズ20、確率0.5</span></span>
<span id="cb79-194"><a href="#cb79-194" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p08 = pbinom(x, size = 20, prob = 0.8) # サイズ20、確率0.8</span></span>
<span id="cb79-195"><a href="#cb79-195" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-196"><a href="#cb79-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-197"><a href="#cb79-197" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-198"><a href="#cb79-198" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-199"><a href="#cb79-199" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-200"><a href="#cb79-200" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-201"><a href="#cb79-201" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-202"><a href="#cb79-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-203"><a href="#cb79-203" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-204"><a href="#cb79-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-205"><a href="#cb79-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqbinomでプロット"}</span></span>
<span id="cb79-206"><a href="#cb79-206" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-207"><a href="#cb79-207" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-208"><a href="#cb79-208" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-209"><a href="#cb79-209" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p01 = qbinom(x, size = 20, prob = 0.1), # サイズ20、確率0.1</span></span>
<span id="cb79-210"><a href="#cb79-210" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p05 = qbinom(x, size = 20, prob = 0.5), # サイズ20、確率0.5</span></span>
<span id="cb79-211"><a href="#cb79-211" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p08 = qbinom(x, size = 20, prob = 0.8) # サイズ20、確率0.8</span></span>
<span id="cb79-212"><a href="#cb79-212" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-213"><a href="#cb79-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-214"><a href="#cb79-214" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-215"><a href="#cb79-215" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-216"><a href="#cb79-216" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-217"><a href="#cb79-217" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-218"><a href="#cb79-218" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-219"><a href="#cb79-219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-220"><a href="#cb79-220" aria-hidden="true" tabindex="-1"></a><span class="fu">## 二項乱数</span></span>
<span id="cb79-221"><a href="#cb79-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-222"><a href="#cb79-222" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数のヒストグラムをプロット"}</span></span>
<span id="cb79-223"><a href="#cb79-223" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-224"><a href="#cb79-224" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p01 = rbinom(1000, size = 20, prob = 0.1), # サイズ20、確率0.1</span></span>
<span id="cb79-225"><a href="#cb79-225" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p05 = rbinom(1000, size = 20, prob = 0.5), # サイズ20、確率0.5</span></span>
<span id="cb79-226"><a href="#cb79-226" aria-hidden="true" tabindex="-1"></a><span class="in">  s20p08 = rbinom(1000, size = 20, prob = 0.8) # サイズ20、確率0.8</span></span>
<span id="cb79-227"><a href="#cb79-227" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-228"><a href="#cb79-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-229"><a href="#cb79-229" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-230"><a href="#cb79-230" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-231"><a href="#cb79-231" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-232"><a href="#cb79-232" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-233"><a href="#cb79-233" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-234"><a href="#cb79-234" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-235"><a href="#cb79-235" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-236"><a href="#cb79-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-237"><a href="#cb79-237" aria-hidden="true" tabindex="-1"></a><span class="fu">## 幾何分布</span></span>
<span id="cb79-238"><a href="#cb79-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-239"><a href="#cb79-239" aria-hidden="true" tabindex="-1"></a>**幾何分布**は、ベルヌーイ試行を始めて成功させたときの試行数が<span class="in">`x`</span>となる確率を指します。2項分布との違いは、成功回数が必ず1回であるところになります。<span class="in">`x`</span>以外には、成功確率（<span class="in">`prob`</span>）のみをパラメータとして設定します。分布の範囲は0～$+\infty$です。幾何分布の確率質量関数は以下の式で表されます。</span>
<span id="cb79-240"><a href="#cb79-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-241"><a href="#cb79-241" aria-hidden="true" tabindex="-1"></a>$$Geom(x,p)=p  \cdot (1-p)^{x-1}$$</span>
<span id="cb79-242"><a href="#cb79-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-243"><a href="#cb79-243" aria-hidden="true" tabindex="-1"></a>Rでは、pを<span class="in">`prob`</span>引数で設定します。</span>
<span id="cb79-244"><a href="#cb79-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-245"><a href="#cb79-245" aria-hidden="true" tabindex="-1"></a>1回成功するまでに失敗した回数も同じく幾何分布で表現することができます。失敗した回数とする場合には、上の式のx-1をxとするだけです。Rの<span class="in">`geom`</span>関数で計算されるのは上の式の結果です。</span>
<span id="cb79-246"><a href="#cb79-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-247"><a href="#cb79-247" aria-hidden="true" tabindex="-1"></a>$$Geom(x,p)=p \cdot (1-p)^{x}$$</span>
<span id="cb79-248"><a href="#cb79-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-249"><a href="#cb79-249" aria-hidden="true" tabindex="-1"></a>試行数<span class="in">`x`</span>は必ず整数となるため、幾何分布も二項分布と同じく、離散的な分布で、<span class="in">`x`</span>は正の整数を取ります。</span>
<span id="cb79-250"><a href="#cb79-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-251"><a href="#cb79-251" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-252"><a href="#cb79-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-253"><a href="#cb79-253" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率質量</span></span>
<span id="cb79-254"><a href="#cb79-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-255"><a href="#cb79-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="幾何分布の確率密度をプロット"}</span></span>
<span id="cb79-256"><a href="#cb79-256" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 1:50</span></span>
<span id="cb79-257"><a href="#cb79-257" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-258"><a href="#cb79-258" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-259"><a href="#cb79-259" aria-hidden="true" tabindex="-1"></a><span class="in">  r01 = dgeom(x, prob = 0.1), # 確率0.1</span></span>
<span id="cb79-260"><a href="#cb79-260" aria-hidden="true" tabindex="-1"></a><span class="in">  r05 = dgeom(x, prob = 0.5), # 確率0.5</span></span>
<span id="cb79-261"><a href="#cb79-261" aria-hidden="true" tabindex="-1"></a><span class="in">  r08 = dgeom(x, prob = 0.8) # 確率0.8</span></span>
<span id="cb79-262"><a href="#cb79-262" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-263"><a href="#cb79-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-264"><a href="#cb79-264" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-265"><a href="#cb79-265" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-266"><a href="#cb79-266" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-267"><a href="#cb79-267" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-268"><a href="#cb79-268" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-269"><a href="#cb79-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-270"><a href="#cb79-270" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-271"><a href="#cb79-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-272"><a href="#cb79-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="幾何分布の累積分布関数をプロット"}</span></span>
<span id="cb79-273"><a href="#cb79-273" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-274"><a href="#cb79-274" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-275"><a href="#cb79-275" aria-hidden="true" tabindex="-1"></a><span class="in">  r01 = pgeom(x, prob = 0.1), # 確率0.1</span></span>
<span id="cb79-276"><a href="#cb79-276" aria-hidden="true" tabindex="-1"></a><span class="in">  r05 = pgeom(x, prob = 0.5), # 確率0.5</span></span>
<span id="cb79-277"><a href="#cb79-277" aria-hidden="true" tabindex="-1"></a><span class="in">  r08 = pgeom(x, prob = 0.8) # 確率0.8</span></span>
<span id="cb79-278"><a href="#cb79-278" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-279"><a href="#cb79-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-280"><a href="#cb79-280" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-281"><a href="#cb79-281" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-282"><a href="#cb79-282" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-283"><a href="#cb79-283" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-284"><a href="#cb79-284" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-285"><a href="#cb79-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-286"><a href="#cb79-286" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-287"><a href="#cb79-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-288"><a href="#cb79-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-289"><a href="#cb79-289" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-290"><a href="#cb79-290" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-291"><a href="#cb79-291" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-292"><a href="#cb79-292" aria-hidden="true" tabindex="-1"></a><span class="in">  r01 = qgeom(x, prob = 0.1), # 確率0.1</span></span>
<span id="cb79-293"><a href="#cb79-293" aria-hidden="true" tabindex="-1"></a><span class="in">  r05 = qgeom(x, prob = 0.5), # 確率0.5</span></span>
<span id="cb79-294"><a href="#cb79-294" aria-hidden="true" tabindex="-1"></a><span class="in">  r08 = qgeom(x, prob = 0.8) # 確率0.8</span></span>
<span id="cb79-295"><a href="#cb79-295" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-296"><a href="#cb79-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-297"><a href="#cb79-297" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-298"><a href="#cb79-298" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-299"><a href="#cb79-299" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-300"><a href="#cb79-300" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-301"><a href="#cb79-301" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-302"><a href="#cb79-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-303"><a href="#cb79-303" aria-hidden="true" tabindex="-1"></a><span class="fu">## 幾何乱数</span></span>
<span id="cb79-304"><a href="#cb79-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-305"><a href="#cb79-305" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-306"><a href="#cb79-306" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-307"><a href="#cb79-307" aria-hidden="true" tabindex="-1"></a><span class="in">  r01 = rgeom(1000, prob = 0.1), # 確率0.1</span></span>
<span id="cb79-308"><a href="#cb79-308" aria-hidden="true" tabindex="-1"></a><span class="in">  r05 = rgeom(1000, prob = 0.5), # 確率0.5</span></span>
<span id="cb79-309"><a href="#cb79-309" aria-hidden="true" tabindex="-1"></a><span class="in">  r08 = rgeom(1000, prob = 0.8) # 確率0.8</span></span>
<span id="cb79-310"><a href="#cb79-310" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-311"><a href="#cb79-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-312"><a href="#cb79-312" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-313"><a href="#cb79-313" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-314"><a href="#cb79-314" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-315"><a href="#cb79-315" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 5, position = "identity")</span></span>
<span id="cb79-316"><a href="#cb79-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-317"><a href="#cb79-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-318"><a href="#cb79-318" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-319"><a href="#cb79-319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-320"><a href="#cb79-320" aria-hidden="true" tabindex="-1"></a><span class="fu">## 超幾何分布</span></span>
<span id="cb79-321"><a href="#cb79-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-322"><a href="#cb79-322" aria-hidden="true" tabindex="-1"></a>**超幾何分布**は、ツボの中に白と黒のボールが入っていて、このツボからボールを取り出す試行（**非復元抽出**）を表現した確率分布です。超幾何分布の確率質量関数は以下の式で表されます。</span>
<span id="cb79-323"><a href="#cb79-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-324"><a href="#cb79-324" aria-hidden="true" tabindex="-1"></a>$$ Hyper(x,m,n,k)= \frac{_{m}C_{k} \cdot _{n}C_{x-k}}{_{m+n}C_{x}}$$</span>
<span id="cb79-325"><a href="#cb79-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-326"><a href="#cb79-326" aria-hidden="true" tabindex="-1"></a>Rの<span class="in">`hyper`</span>関数では、白ボール<span class="in">`m`</span>個、黒ボール<span class="in">`n`</span>個が入ったツボから<span class="in">`k`</span>個ボールを取ったとき、<span class="in">`x`</span>個の白ボールが取れる確率を計算します。<span class="in">`dhyper`</span>関数の引数は<span class="in">`m`</span>、<span class="in">`n`</span>、<span class="in">`k`</span>で、<span class="in">`x`</span>は整数のみを取る離散的な分布です。分布の範囲は0～kとなります。</span>
<span id="cb79-327"><a href="#cb79-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-328"><a href="#cb79-328" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-329"><a href="#cb79-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-330"><a href="#cb79-330" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率質量</span></span>
<span id="cb79-331"><a href="#cb79-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-332"><a href="#cb79-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="超幾何分布の確率密度をプロット"}</span></span>
<span id="cb79-333"><a href="#cb79-333" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 1:6</span></span>
<span id="cb79-334"><a href="#cb79-334" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-335"><a href="#cb79-335" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-336"><a href="#cb79-336" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n5k5 = dhyper(x, m = 5, n = 5, k = 5), # 白 5, 黒 5, 取るボールの数 5</span></span>
<span id="cb79-337"><a href="#cb79-337" aria-hidden="true" tabindex="-1"></a><span class="in">  m10n5k5 = dhyper(x, m = 10, n = 5, k = 5), # 白 10, 黒 5, 取るボールの数 5</span></span>
<span id="cb79-338"><a href="#cb79-338" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n20k10 = dhyper(x, m = 5, n = 20, k = 10) # 白 5, 黒 20, 取るボールの数 10</span></span>
<span id="cb79-339"><a href="#cb79-339" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-340"><a href="#cb79-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-341"><a href="#cb79-341" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-342"><a href="#cb79-342" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-343"><a href="#cb79-343" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-344"><a href="#cb79-344" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-345"><a href="#cb79-345" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-346"><a href="#cb79-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-347"><a href="#cb79-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-348"><a href="#cb79-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-349"><a href="#cb79-349" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="超幾何分布の累積分布関数をプロット"}</span></span>
<span id="cb79-350"><a href="#cb79-350" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-351"><a href="#cb79-351" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-352"><a href="#cb79-352" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n5k5 = phyper(x, m = 5, n = 5, k = 5), # 白 5, 赤 5, 取るボールの数 5</span></span>
<span id="cb79-353"><a href="#cb79-353" aria-hidden="true" tabindex="-1"></a><span class="in">  m10n5k5 = phyper(x, m = 10, n = 5, k = 5), # 白 10, 赤 5, 取るボールの数 5</span></span>
<span id="cb79-354"><a href="#cb79-354" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n20k10 = phyper(x, m = 5, n = 20, k = 10) # 白 5, 赤 20, 取るボールの数 10</span></span>
<span id="cb79-355"><a href="#cb79-355" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-356"><a href="#cb79-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-357"><a href="#cb79-357" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-358"><a href="#cb79-358" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-359"><a href="#cb79-359" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-360"><a href="#cb79-360" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-361"><a href="#cb79-361" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-362"><a href="#cb79-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-363"><a href="#cb79-363" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-364"><a href="#cb79-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-365"><a href="#cb79-365" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-366"><a href="#cb79-366" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-367"><a href="#cb79-367" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-368"><a href="#cb79-368" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-369"><a href="#cb79-369" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n5k5 = qhyper(x, m = 5, n = 5, k = 5), # 白 5, 赤 5, 取るボールの数 5</span></span>
<span id="cb79-370"><a href="#cb79-370" aria-hidden="true" tabindex="-1"></a><span class="in">  m10n5k5 = qhyper(x, m = 10, n = 5, k = 5), # 白 10, 赤 5, 取るボールの数 5</span></span>
<span id="cb79-371"><a href="#cb79-371" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n20k10 = qhyper(x, m = 5, n = 20, k = 10) # 白 5, 赤 20, 取るボールの数 10</span></span>
<span id="cb79-372"><a href="#cb79-372" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-373"><a href="#cb79-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-374"><a href="#cb79-374" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-375"><a href="#cb79-375" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-376"><a href="#cb79-376" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-377"><a href="#cb79-377" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-378"><a href="#cb79-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-379"><a href="#cb79-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-380"><a href="#cb79-380" aria-hidden="true" tabindex="-1"></a><span class="fu">## 超幾何乱数</span></span>
<span id="cb79-381"><a href="#cb79-381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-382"><a href="#cb79-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-383"><a href="#cb79-383" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-384"><a href="#cb79-384" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n5k5 = rhyper(1000, m = 5, n = 5, k = 5), # 白 5, 赤 5, 取るボールの数 5</span></span>
<span id="cb79-385"><a href="#cb79-385" aria-hidden="true" tabindex="-1"></a><span class="in">  m10n5k5 = rhyper(1000, m = 10, n = 5, k = 5), # 白 10, 赤 5, 取るボールの数 5</span></span>
<span id="cb79-386"><a href="#cb79-386" aria-hidden="true" tabindex="-1"></a><span class="in">  m5n20k10 = rhyper(1000, m = 5, n = 20, k = 10) # 白 5, 赤 20, 取るボールの数 10</span></span>
<span id="cb79-387"><a href="#cb79-387" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-388"><a href="#cb79-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-389"><a href="#cb79-389" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-390"><a href="#cb79-390" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-391"><a href="#cb79-391" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-392"><a href="#cb79-392" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 0.1, position = "identity")</span></span>
<span id="cb79-393"><a href="#cb79-393" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-394"><a href="#cb79-394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-395"><a href="#cb79-395" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-396"><a href="#cb79-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-397"><a href="#cb79-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## 負の二項分布</span></span>
<span id="cb79-398"><a href="#cb79-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-399"><a href="#cb79-399" aria-hidden="true" tabindex="-1"></a>**負の二項分布**は、ベルヌーイ試行を行ったとき、n回成功する間にx回失敗する確率を反映した確率分布です。成功の回数がn、失敗回数をx、成功確率をpとしたとき、負の二項分布の確率質量関数は以下の式で表されます。</span>
<span id="cb79-400"><a href="#cb79-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-401"><a href="#cb79-401" aria-hidden="true" tabindex="-1"></a>$$Nbinom(x,n,p)=_{x+n+1}C_{x} \cdot p^x(1-p)^n$$</span>
<span id="cb79-402"><a href="#cb79-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-403"><a href="#cb79-403" aria-hidden="true" tabindex="-1"></a>Rでの負の二項分布の確率質量関数は<span class="in">`dnbinom`</span>関数で計算することができます。成功の回数nは<span class="in">`size`</span>引数、成功確率pは<span class="in">`prob`</span>引数で設定します。負の二項分布は正の整数のみを取る離散的な分布で、その範囲は0～$\infty$となります。</span>
<span id="cb79-404"><a href="#cb79-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-405"><a href="#cb79-405" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-406"><a href="#cb79-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-407"><a href="#cb79-407" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率質量</span></span>
<span id="cb79-408"><a href="#cb79-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-409"><a href="#cb79-409" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="負の二項分布の確率密度をプロット"}</span></span>
<span id="cb79-410"><a href="#cb79-410" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 0:100</span></span>
<span id="cb79-411"><a href="#cb79-411" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-412"><a href="#cb79-412" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-413"><a href="#cb79-413" aria-hidden="true" tabindex="-1"></a><span class="in">  p01 = dnbinom(x, size = 5, prob = 0.1), # サイズ5、確率0.1</span></span>
<span id="cb79-414"><a href="#cb79-414" aria-hidden="true" tabindex="-1"></a><span class="in">  p05 = dnbinom(x, size = 5, prob = 0.5), # サイズ5、確率0.5</span></span>
<span id="cb79-415"><a href="#cb79-415" aria-hidden="true" tabindex="-1"></a><span class="in">  p08 = dnbinom(x, size = 5, prob = 0.8) # サイズ5、確率0.8</span></span>
<span id="cb79-416"><a href="#cb79-416" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-417"><a href="#cb79-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-418"><a href="#cb79-418" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-419"><a href="#cb79-419" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-420"><a href="#cb79-420" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-421"><a href="#cb79-421" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-422"><a href="#cb79-422" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-423"><a href="#cb79-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-424"><a href="#cb79-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-425"><a href="#cb79-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-426"><a href="#cb79-426" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="負の二項分布の累積分布関数をプロット"}</span></span>
<span id="cb79-427"><a href="#cb79-427" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-428"><a href="#cb79-428" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-429"><a href="#cb79-429" aria-hidden="true" tabindex="-1"></a><span class="in">  p01 = pnbinom(x, size = 5, prob = 0.1), # サイズ5、確率0.1</span></span>
<span id="cb79-430"><a href="#cb79-430" aria-hidden="true" tabindex="-1"></a><span class="in">  p05 = pnbinom(x, size = 5, prob = 0.5), # サイズ5、確率0.5</span></span>
<span id="cb79-431"><a href="#cb79-431" aria-hidden="true" tabindex="-1"></a><span class="in">  p08 = pnbinom(x, size = 5, prob = 0.8) # サイズ5、確率0.8</span></span>
<span id="cb79-432"><a href="#cb79-432" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-433"><a href="#cb79-433" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-434"><a href="#cb79-434" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-435"><a href="#cb79-435" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-436"><a href="#cb79-436" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-437"><a href="#cb79-437" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-438"><a href="#cb79-438" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-439"><a href="#cb79-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-440"><a href="#cb79-440" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-441"><a href="#cb79-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-442"><a href="#cb79-442" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-443"><a href="#cb79-443" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-444"><a href="#cb79-444" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-445"><a href="#cb79-445" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-446"><a href="#cb79-446" aria-hidden="true" tabindex="-1"></a><span class="in">  p01 = qnbinom(x, size = 5, prob = 0.1), # サイズ5、確率0.1</span></span>
<span id="cb79-447"><a href="#cb79-447" aria-hidden="true" tabindex="-1"></a><span class="in">  p05 = qnbinom(x, size = 5, prob = 0.5), # サイズ5、確率0.5</span></span>
<span id="cb79-448"><a href="#cb79-448" aria-hidden="true" tabindex="-1"></a><span class="in">  p08 = qnbinom(x, size = 5, prob = 0.8) # サイズ5、確率0.8</span></span>
<span id="cb79-449"><a href="#cb79-449" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-450"><a href="#cb79-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-451"><a href="#cb79-451" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-452"><a href="#cb79-452" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-453"><a href="#cb79-453" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-454"><a href="#cb79-454" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-455"><a href="#cb79-455" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-456"><a href="#cb79-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-457"><a href="#cb79-457" aria-hidden="true" tabindex="-1"></a><span class="fu">## 負の二項乱数</span></span>
<span id="cb79-458"><a href="#cb79-458" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-459"><a href="#cb79-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-460"><a href="#cb79-460" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-461"><a href="#cb79-461" aria-hidden="true" tabindex="-1"></a><span class="in">  p01 = rnbinom(1000, size = 5, prob = 0.1), # サイズ5、確率0.1</span></span>
<span id="cb79-462"><a href="#cb79-462" aria-hidden="true" tabindex="-1"></a><span class="in">  p05 = rnbinom(1000, size = 5, prob = 0.5), # サイズ5、確率0.5</span></span>
<span id="cb79-463"><a href="#cb79-463" aria-hidden="true" tabindex="-1"></a><span class="in">  p08 = rnbinom(1000, size = 5, prob = 0.8) # サイズ5、確率0.8</span></span>
<span id="cb79-464"><a href="#cb79-464" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-465"><a href="#cb79-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-466"><a href="#cb79-466" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-467"><a href="#cb79-467" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-468"><a href="#cb79-468" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-469"><a href="#cb79-469" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 10, position = "identity")</span></span>
<span id="cb79-470"><a href="#cb79-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-471"><a href="#cb79-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-472"><a href="#cb79-472" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-473"><a href="#cb79-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-474"><a href="#cb79-474" aria-hidden="true" tabindex="-1"></a><span class="fu">## ポアソン分布</span></span>
<span id="cb79-475"><a href="#cb79-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-476"><a href="#cb79-476" aria-hidden="true" tabindex="-1"></a>**ポアソン分布**は、起こる確率が非常に低い現象が、ある一定の時間に何回起こるかを確率として表した確率分布です。ポアソン分布の確率質量関数は二項分布の確率を0に、試行回数を$\infty$に近づけた極限として計算されます。ポアソン分布のパラメータはλのみで、ポアソン分布は平均値も標準偏差もλとなる特徴があります。ポアソン分布の確率質量関数は以下の式で表されます。分布が取りうる範囲は0～$\infty$となります。</span>
<span id="cb79-477"><a href="#cb79-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-478"><a href="#cb79-478" aria-hidden="true" tabindex="-1"></a>$$Poisson(x, \lambda)=\frac{\lambda^x \cdot \exp(-\lambda)}{x!}$$</span>
<span id="cb79-479"><a href="#cb79-479" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-480"><a href="#cb79-480" aria-hidden="true" tabindex="-1"></a>Rではポアソン分布の確率質量関数は<span class="in">`dpois`</span>関数で計算することができます。<span class="in">`dpois`</span>関数のλは引数<span class="in">`lambda`</span>で設定します。</span>
<span id="cb79-481"><a href="#cb79-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-482"><a href="#cb79-482" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-483"><a href="#cb79-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-484"><a href="#cb79-484" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率質量</span></span>
<span id="cb79-485"><a href="#cb79-485" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-486"><a href="#cb79-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ポアソン分布の確率密度をプロット"}</span></span>
<span id="cb79-487"><a href="#cb79-487" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- 0:25</span></span>
<span id="cb79-488"><a href="#cb79-488" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-489"><a href="#cb79-489" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-490"><a href="#cb79-490" aria-hidden="true" tabindex="-1"></a><span class="in">  l3 = dpois(x, lambda = 3), # ラムダ3</span></span>
<span id="cb79-491"><a href="#cb79-491" aria-hidden="true" tabindex="-1"></a><span class="in">  l8 = dpois(x, lambda = 8), # ラムダ8</span></span>
<span id="cb79-492"><a href="#cb79-492" aria-hidden="true" tabindex="-1"></a><span class="in">  l11 = dpois(x, lambda = 11) # ラムダ11</span></span>
<span id="cb79-493"><a href="#cb79-493" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-494"><a href="#cb79-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-495"><a href="#cb79-495" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-496"><a href="#cb79-496" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-497"><a href="#cb79-497" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-498"><a href="#cb79-498" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-499"><a href="#cb79-499" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-500"><a href="#cb79-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-501"><a href="#cb79-501" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-502"><a href="#cb79-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-503"><a href="#cb79-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ポアソン分布の累積分布関数をプロット"}</span></span>
<span id="cb79-504"><a href="#cb79-504" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-505"><a href="#cb79-505" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-506"><a href="#cb79-506" aria-hidden="true" tabindex="-1"></a><span class="in">  l3 = ppois(x, lambda = 3), # ラムダ3</span></span>
<span id="cb79-507"><a href="#cb79-507" aria-hidden="true" tabindex="-1"></a><span class="in">  l8 = ppois(x, lambda = 8), # ラムダ8</span></span>
<span id="cb79-508"><a href="#cb79-508" aria-hidden="true" tabindex="-1"></a><span class="in">  l11 = ppois(x, lambda = 11) # ラムダ11</span></span>
<span id="cb79-509"><a href="#cb79-509" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-510"><a href="#cb79-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-511"><a href="#cb79-511" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-512"><a href="#cb79-512" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-513"><a href="#cb79-513" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-514"><a href="#cb79-514" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-515"><a href="#cb79-515" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-516"><a href="#cb79-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-517"><a href="#cb79-517" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-518"><a href="#cb79-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-519"><a href="#cb79-519" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-520"><a href="#cb79-520" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-521"><a href="#cb79-521" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-522"><a href="#cb79-522" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-523"><a href="#cb79-523" aria-hidden="true" tabindex="-1"></a><span class="in">  l3 = qpois(x, lambda = 3), # ラムダ3</span></span>
<span id="cb79-524"><a href="#cb79-524" aria-hidden="true" tabindex="-1"></a><span class="in">  l8 = qpois(x, lambda = 8), # ラムダ8</span></span>
<span id="cb79-525"><a href="#cb79-525" aria-hidden="true" tabindex="-1"></a><span class="in">  l11 = qpois(x, lambda = 11) # ラムダ11</span></span>
<span id="cb79-526"><a href="#cb79-526" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-527"><a href="#cb79-527" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-528"><a href="#cb79-528" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-529"><a href="#cb79-529" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-530"><a href="#cb79-530" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-531"><a href="#cb79-531" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-532"><a href="#cb79-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-533"><a href="#cb79-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-534"><a href="#cb79-534" aria-hidden="true" tabindex="-1"></a><span class="fu">## ポアソン乱数</span></span>
<span id="cb79-535"><a href="#cb79-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-536"><a href="#cb79-536" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-537"><a href="#cb79-537" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-538"><a href="#cb79-538" aria-hidden="true" tabindex="-1"></a><span class="in">  l3 = rpois(1000, lambda = 3), # ラムダ3</span></span>
<span id="cb79-539"><a href="#cb79-539" aria-hidden="true" tabindex="-1"></a><span class="in">  l8 = rpois(1000, lambda = 8), # ラムダ8</span></span>
<span id="cb79-540"><a href="#cb79-540" aria-hidden="true" tabindex="-1"></a><span class="in">  l11 = rpois(1000, lambda = 11) # ラムダ11</span></span>
<span id="cb79-541"><a href="#cb79-541" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-542"><a href="#cb79-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-543"><a href="#cb79-543" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-544"><a href="#cb79-544" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-545"><a href="#cb79-545" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-546"><a href="#cb79-546" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-547"><a href="#cb79-547" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-548"><a href="#cb79-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-549"><a href="#cb79-549" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-550"><a href="#cb79-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-551"><a href="#cb79-551" aria-hidden="true" tabindex="-1"></a><span class="fu">## 正規分布</span></span>
<span id="cb79-552"><a href="#cb79-552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-553"><a href="#cb79-553" aria-hidden="true" tabindex="-1"></a>**正規分布**は、様々な分布での値の平均値の分布を反映したもので（<span class="co">[</span><span class="ot">中心極限定理</span><span class="co">](https://ja.wikipedia.org/wiki/%E4%B8%AD%E5%BF%83%E6%A5%B5%E9%99%90%E5%AE%9A%E7%90%86)</span>）、統計では最も一般的に用いられているものです。正規分布のパラメータは平均値（μ）と標準偏差（σ）です。正規分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-554"><a href="#cb79-554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-555"><a href="#cb79-555" aria-hidden="true" tabindex="-1"></a>$$ Norm(x, \mu, \sigma)=\frac{1}{\sqrt{2\pi \sigma^2}} \cdot \exp \left( \frac{(x-\mu)^2}{2\sigma^2} \right) $$</span>
<span id="cb79-556"><a href="#cb79-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-557"><a href="#cb79-557" aria-hidden="true" tabindex="-1"></a>Rでは、正規分布の確率密度関数は<span class="in">`dnorm`</span>関数で計算することができます。<span class="in">`dnorm`</span>関数では、平均値は<span class="in">`mean`</span>引数、標準偏差は<span class="in">`sd`</span>引数で設定します。</span>
<span id="cb79-558"><a href="#cb79-558" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-559"><a href="#cb79-559" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-560"><a href="#cb79-560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-561"><a href="#cb79-561" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-562"><a href="#cb79-562" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-563"><a href="#cb79-563" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="正規分布の確率密度をプロット"}</span></span>
<span id="cb79-564"><a href="#cb79-564" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-5, 5, by = 0.01)</span></span>
<span id="cb79-565"><a href="#cb79-565" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-566"><a href="#cb79-566" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-567"><a href="#cb79-567" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = dnorm(x, mean = 0, sd = 1), # 平均0、標準偏差1</span></span>
<span id="cb79-568"><a href="#cb79-568" aria-hidden="true" tabindex="-1"></a><span class="in">  m1s2 = dnorm(x, mean = 1, sd = 2), # 平均1、標準偏差2</span></span>
<span id="cb79-569"><a href="#cb79-569" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s05 = dnorm(x, mean = 2, sd = 0.5) # 平均2、標準偏差0.5</span></span>
<span id="cb79-570"><a href="#cb79-570" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-571"><a href="#cb79-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-572"><a href="#cb79-572" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-573"><a href="#cb79-573" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-574"><a href="#cb79-574" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-575"><a href="#cb79-575" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-576"><a href="#cb79-576" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-577"><a href="#cb79-577" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-578"><a href="#cb79-578" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-579"><a href="#cb79-579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-580"><a href="#cb79-580" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="正規分布の累積分布関数をプロット"}</span></span>
<span id="cb79-581"><a href="#cb79-581" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-582"><a href="#cb79-582" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-583"><a href="#cb79-583" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = pnorm(x, mean = 0, sd = 1), # 平均0、標準偏差1</span></span>
<span id="cb79-584"><a href="#cb79-584" aria-hidden="true" tabindex="-1"></a><span class="in">  m1s2 = pnorm(x, mean = 1, sd = 2), # 平均1、標準偏差2</span></span>
<span id="cb79-585"><a href="#cb79-585" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s05 = pnorm(x, mean = 2, sd = 0.5) # 平均2、標準偏差0.5</span></span>
<span id="cb79-586"><a href="#cb79-586" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-587"><a href="#cb79-587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-588"><a href="#cb79-588" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-589"><a href="#cb79-589" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-590"><a href="#cb79-590" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-591"><a href="#cb79-591" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-592"><a href="#cb79-592" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-593"><a href="#cb79-593" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-594"><a href="#cb79-594" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-595"><a href="#cb79-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-596"><a href="#cb79-596" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqnormでプロット"}</span></span>
<span id="cb79-597"><a href="#cb79-597" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-598"><a href="#cb79-598" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-599"><a href="#cb79-599" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-600"><a href="#cb79-600" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = qnorm(x, mean = 0, sd = 1), # 平均0、標準偏差1</span></span>
<span id="cb79-601"><a href="#cb79-601" aria-hidden="true" tabindex="-1"></a><span class="in">  m1s2 = qnorm(x, mean = 1, sd = 2), # 平均1、標準偏差2</span></span>
<span id="cb79-602"><a href="#cb79-602" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s05 = qnorm(x, mean = 2, sd = 0.5) # 平均2、標準偏差0.5</span></span>
<span id="cb79-603"><a href="#cb79-603" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-604"><a href="#cb79-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-605"><a href="#cb79-605" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-606"><a href="#cb79-606" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-607"><a href="#cb79-607" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-608"><a href="#cb79-608" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-609"><a href="#cb79-609" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-610"><a href="#cb79-610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-611"><a href="#cb79-611" aria-hidden="true" tabindex="-1"></a><span class="fu">## 正規乱数</span></span>
<span id="cb79-612"><a href="#cb79-612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-613"><a href="#cb79-613" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-614"><a href="#cb79-614" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-615"><a href="#cb79-615" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = rnorm(1000, mean = 0, sd = 1), # 平均0、標準偏差1</span></span>
<span id="cb79-616"><a href="#cb79-616" aria-hidden="true" tabindex="-1"></a><span class="in">  m1s2 = rnorm(1000, mean = 1, sd = 2), # 平均1、標準偏差2</span></span>
<span id="cb79-617"><a href="#cb79-617" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s05 = rnorm(1000, mean = 2, sd = 0.5) # 平均2、標準偏差0.5</span></span>
<span id="cb79-618"><a href="#cb79-618" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-619"><a href="#cb79-619" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-620"><a href="#cb79-620" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-621"><a href="#cb79-621" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-622"><a href="#cb79-622" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-623"><a href="#cb79-623" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-624"><a href="#cb79-624" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-625"><a href="#cb79-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-626"><a href="#cb79-626" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-627"><a href="#cb79-627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-628"><a href="#cb79-628" aria-hidden="true" tabindex="-1"></a><span class="fu">## t分布</span></span>
<span id="cb79-629"><a href="#cb79-629" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-630"><a href="#cb79-630" aria-hidden="true" tabindex="-1"></a>**t分布**は標本サイズが小さいときの母平均と標本平均の差の分布を反映した確率分布です。t分布は**t統計量**と呼ばれるものの分布を示します。t統計量は以下の式で計算できます。</span>
<span id="cb79-631"><a href="#cb79-631" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-632"><a href="#cb79-632" aria-hidden="true" tabindex="-1"></a>$$t=\frac{x-\mu}{s \sqrt n}$$</span>
<span id="cb79-633"><a href="#cb79-633" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-634"><a href="#cb79-634" aria-hidden="true" tabindex="-1"></a>この式で、xはサンプルの平均値、μは母平均値、sは標準偏差、nはサンプルの数を指します。t分布は主にt検定（平均値の差の検定）に用いられます。t分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-635"><a href="#cb79-635" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-636"><a href="#cb79-636" aria-hidden="true" tabindex="-1"></a>$$t(x, \nu)=\frac{\Gamma(\nu+1)/2}{\sqrt{\nu \pi} \cdot \Gamma(\nu/2)} \cdot (1+x^2/\nu)^{-(\nu+1)/2}$$</span>
<span id="cb79-637"><a href="#cb79-637" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-638"><a href="#cb79-638" aria-hidden="true" tabindex="-1"></a>上の式のνは自由度で、サンプル数から1を引いたものとなります。Rでは、<span class="in">`dt`</span>関数でt分布の確率密度関数を計算することができます。<span class="in">`dt`</span>関数の引数には、自由度<span class="in">`df`</span>を設定します。t分布は$-\infty$～$\infty$の範囲を持つ連続値を取り、平均値は0です。t分布は正規分布とよく似た釣鐘型の分布ですが、正規分布と比較して裾が重い、0から遠い値の確率が大きくなる性質を持ちます。自由度<span class="in">`df`</span>が$-\infty$に近づくと、t分布の形は正規分布と一致します。</span>
<span id="cb79-639"><a href="#cb79-639" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-640"><a href="#cb79-640" aria-hidden="true" tabindex="-1"></a>また、t分布には検出力の計算等に用いられる非心パラメータと呼ばれるものがあり、<span class="in">`ncp`</span>という引数で非心パラメータを指定することもできます。非心パラメータを0よりも大きく設定すると、t分布は左にゆがみ、平均値が0よりも大きくなります。</span>
<span id="cb79-641"><a href="#cb79-641" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-642"><a href="#cb79-642" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-643"><a href="#cb79-643" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-644"><a href="#cb79-644" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-645"><a href="#cb79-645" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-646"><a href="#cb79-646" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="t分布の確率密度をプロット"}</span></span>
<span id="cb79-647"><a href="#cb79-647" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-5, 15, by = 0.01)</span></span>
<span id="cb79-648"><a href="#cb79-648" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-649"><a href="#cb79-649" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-650"><a href="#cb79-650" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = dt(x, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-651"><a href="#cb79-651" aria-hidden="true" tabindex="-1"></a><span class="in">  d8n0 = dt(x, df = 8, ncp = 0), # 自由度8、非心パラメータ0</span></span>
<span id="cb79-652"><a href="#cb79-652" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n3 = dt(x, df = 3, ncp = 3) # 自由度3、非心パラメータ3</span></span>
<span id="cb79-653"><a href="#cb79-653" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-654"><a href="#cb79-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-655"><a href="#cb79-655" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-656"><a href="#cb79-656" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-657"><a href="#cb79-657" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-658"><a href="#cb79-658" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-659"><a href="#cb79-659" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-660"><a href="#cb79-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-661"><a href="#cb79-661" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-662"><a href="#cb79-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-663"><a href="#cb79-663" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="t分布の累積分布関数をプロット"}</span></span>
<span id="cb79-664"><a href="#cb79-664" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-665"><a href="#cb79-665" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-666"><a href="#cb79-666" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = pt(x, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-667"><a href="#cb79-667" aria-hidden="true" tabindex="-1"></a><span class="in">  d8n0 = pt(x, df = 8, ncp = 0), # 自由度8、非心パラメータ0</span></span>
<span id="cb79-668"><a href="#cb79-668" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n3 = pt(x, df = 3, ncp = 3) # 自由度3、非心パラメータ3</span></span>
<span id="cb79-669"><a href="#cb79-669" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-670"><a href="#cb79-670" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-671"><a href="#cb79-671" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-672"><a href="#cb79-672" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-673"><a href="#cb79-673" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-674"><a href="#cb79-674" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-675"><a href="#cb79-675" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-676"><a href="#cb79-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-677"><a href="#cb79-677" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-678"><a href="#cb79-678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-679"><a href="#cb79-679" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-680"><a href="#cb79-680" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-681"><a href="#cb79-681" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-682"><a href="#cb79-682" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-683"><a href="#cb79-683" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = qt(x, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-684"><a href="#cb79-684" aria-hidden="true" tabindex="-1"></a><span class="in">  d8n0 = qt(x, df = 8, ncp = 0), # 自由度8、非心パラメータ0</span></span>
<span id="cb79-685"><a href="#cb79-685" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n3 = qt(x, df = 3, ncp = 3) # 自由度3、非心パラメータ3</span></span>
<span id="cb79-686"><a href="#cb79-686" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-687"><a href="#cb79-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-688"><a href="#cb79-688" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-689"><a href="#cb79-689" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-690"><a href="#cb79-690" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-691"><a href="#cb79-691" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-692"><a href="#cb79-692" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-693"><a href="#cb79-693" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-694"><a href="#cb79-694" aria-hidden="true" tabindex="-1"></a><span class="fu">## t分布の乱数</span></span>
<span id="cb79-695"><a href="#cb79-695" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-696"><a href="#cb79-696" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-697"><a href="#cb79-697" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-698"><a href="#cb79-698" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = rt(1000, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-699"><a href="#cb79-699" aria-hidden="true" tabindex="-1"></a><span class="in">  d8n0 = rt(1000, df = 8, ncp = 0), # 自由度8、非心パラメータ0</span></span>
<span id="cb79-700"><a href="#cb79-700" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n3 = rt(1000, df = 3, ncp = 3) # 自由度3、非心パラメータ3</span></span>
<span id="cb79-701"><a href="#cb79-701" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-702"><a href="#cb79-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-703"><a href="#cb79-703" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-704"><a href="#cb79-704" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-705"><a href="#cb79-705" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-706"><a href="#cb79-706" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-707"><a href="#cb79-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-708"><a href="#cb79-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-709"><a href="#cb79-709" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-710"><a href="#cb79-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-711"><a href="#cb79-711" aria-hidden="true" tabindex="-1"></a><span class="fu">## コーシー分布</span></span>
<span id="cb79-712"><a href="#cb79-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-713"><a href="#cb79-713" aria-hidden="true" tabindex="-1"></a>**コーシー分布**はt分布で自由度が1のときの分布です。コーシー分布はt分布よりもさらに裾が重く、平均値も標準偏差も定義できない分布です。コーシー分布のパラメータは中央値であるtとスケールパラメータであるsの2つです。コーシー分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-714"><a href="#cb79-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-715"><a href="#cb79-715" aria-hidden="true" tabindex="-1"></a>$$Cauchy(x, t, s)=\frac{1}{s \cdot \pi (1+((x-t)/s)^2)} $$</span>
<span id="cb79-716"><a href="#cb79-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-717"><a href="#cb79-717" aria-hidden="true" tabindex="-1"></a>Rでは、コーシー分布の確率密度関数は<span class="in">`dcauchy`</span>関数で計算することができます。<span class="in">`dcauchy`</span>関数の引数は中央値tである<span class="in">`location`</span>とスケールパラメータsである<span class="in">`scale`</span>の2つです。コーシー分布も正規分布やt分布と同じく、$-\infty$～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-718"><a href="#cb79-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-719"><a href="#cb79-719" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-720"><a href="#cb79-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-721"><a href="#cb79-721" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-722"><a href="#cb79-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-723"><a href="#cb79-723" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="コーシー分布の確率密度をプロット"}</span></span>
<span id="cb79-724"><a href="#cb79-724" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-5, 5, by = 0.01)</span></span>
<span id="cb79-725"><a href="#cb79-725" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-726"><a href="#cb79-726" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-727"><a href="#cb79-727" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = dcauchy(x, location = 0, scale = 1), # 中央値0、スケール1</span></span>
<span id="cb79-728"><a href="#cb79-728" aria-hidden="true" tabindex="-1"></a><span class="in">  lm2s05 = dcauchy(x, location = -2, scale = 0.5), # 中央値-2、スケール0.5</span></span>
<span id="cb79-729"><a href="#cb79-729" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s2 = dcauchy(x, location = 2, scale = 2) # 中央値2、スケール2</span></span>
<span id="cb79-730"><a href="#cb79-730" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-731"><a href="#cb79-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-732"><a href="#cb79-732" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-733"><a href="#cb79-733" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-734"><a href="#cb79-734" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-735"><a href="#cb79-735" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-736"><a href="#cb79-736" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-737"><a href="#cb79-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-738"><a href="#cb79-738" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-739"><a href="#cb79-739" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-740"><a href="#cb79-740" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="コーシー分布の累積分布関数をプロット"}</span></span>
<span id="cb79-741"><a href="#cb79-741" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-742"><a href="#cb79-742" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-743"><a href="#cb79-743" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = pcauchy(x, location = 0, scale = 1), # 中央値20、スケール0.1</span></span>
<span id="cb79-744"><a href="#cb79-744" aria-hidden="true" tabindex="-1"></a><span class="in">  lm2s05 = pcauchy(x, location = -2, scale = 0.5), # 中央値20、スケール0.5</span></span>
<span id="cb79-745"><a href="#cb79-745" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s2 = pcauchy(x, location = 2, scale = 2) # 中央値20、スケール0.8</span></span>
<span id="cb79-746"><a href="#cb79-746" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-747"><a href="#cb79-747" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-748"><a href="#cb79-748" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-749"><a href="#cb79-749" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-750"><a href="#cb79-750" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-751"><a href="#cb79-751" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()+</span></span>
<span id="cb79-752"><a href="#cb79-752" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_limits(y=0)</span></span>
<span id="cb79-753"><a href="#cb79-753" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-754"><a href="#cb79-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-755"><a href="#cb79-755" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-756"><a href="#cb79-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-757"><a href="#cb79-757" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqcauchyでプロット"}</span></span>
<span id="cb79-758"><a href="#cb79-758" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-759"><a href="#cb79-759" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-760"><a href="#cb79-760" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-761"><a href="#cb79-761" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = qcauchy(x, location = 0, scale = 1), # 中央値20、スケール0.1</span></span>
<span id="cb79-762"><a href="#cb79-762" aria-hidden="true" tabindex="-1"></a><span class="in">  lm2s05 = qcauchy(x, location = -2, scale = 0.5), # 中央値20、スケール0.5</span></span>
<span id="cb79-763"><a href="#cb79-763" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s2 = qcauchy(x, location = 2, scale = 2) # 中央値20、スケール0.8</span></span>
<span id="cb79-764"><a href="#cb79-764" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-765"><a href="#cb79-765" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-766"><a href="#cb79-766" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-767"><a href="#cb79-767" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-768"><a href="#cb79-768" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-769"><a href="#cb79-769" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-770"><a href="#cb79-770" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-771"><a href="#cb79-771" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-772"><a href="#cb79-772" aria-hidden="true" tabindex="-1"></a><span class="fu">## コーシー乱数</span></span>
<span id="cb79-773"><a href="#cb79-773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-774"><a href="#cb79-774" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数のヒストグラムをプロット"}</span></span>
<span id="cb79-775"><a href="#cb79-775" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(0)</span></span>
<span id="cb79-776"><a href="#cb79-776" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-777"><a href="#cb79-777" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = rcauchy(1000, location = 0, scale = 1), # 中央値20、スケール0.1</span></span>
<span id="cb79-778"><a href="#cb79-778" aria-hidden="true" tabindex="-1"></a><span class="in">  lm2s05 = rcauchy(1000, location = -2, scale = 0.5), # 中央値20、スケール0.5</span></span>
<span id="cb79-779"><a href="#cb79-779" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s2 = rcauchy(1000, location = 2, scale = 2) # 中央値20、スケール0.8</span></span>
<span id="cb79-780"><a href="#cb79-780" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-781"><a href="#cb79-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-782"><a href="#cb79-782" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-783"><a href="#cb79-783" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-784"><a href="#cb79-784" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.2)) +</span></span>
<span id="cb79-785"><a href="#cb79-785" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 50, position = "identity")</span></span>
<span id="cb79-786"><a href="#cb79-786" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-787"><a href="#cb79-787" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-788"><a href="#cb79-788" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-789"><a href="#cb79-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-790"><a href="#cb79-790" aria-hidden="true" tabindex="-1"></a><span class="fu">## ロジスティック分布</span></span>
<span id="cb79-791"><a href="#cb79-791" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-792"><a href="#cb79-792" aria-hidden="true" tabindex="-1"></a>**ロジスティック分布**は**ロジスティック関数**を微分したものを分布としたもの、つまり、ロジスティック分布の積分である累積分布関数がロジスティック関数を取る分布のことを指します。ロジスティック関数は線形回帰で用いられる関数で、以下の式で表されます。</span>
<span id="cb79-793"><a href="#cb79-793" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-794"><a href="#cb79-794" aria-hidden="true" tabindex="-1"></a>$$logis(x)=\frac{1}{(1+\exp(-(ax+b))}$$</span>
<span id="cb79-795"><a href="#cb79-795" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-796"><a href="#cb79-796" aria-hidden="true" tabindex="-1"></a>ロジスティック関数は<span class="co">[</span><span class="ot">個体群モデル</span><span class="co">](https://ja.wikipedia.org/wiki/%E5%80%8B%E4%BD%93%E7%BE%A4%E5%8B%95%E6%85%8B%E8%AB%96)</span>の数式化と関連のある関数です。統計では、逆関数である**ロジット関数**から導出されます。ロジット関数は以下の式で表されます。</span>
<span id="cb79-797"><a href="#cb79-797" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-798"><a href="#cb79-798" aria-hidden="true" tabindex="-1"></a>$$log(\frac{p}{1-p})=ax+b$$</span>
<span id="cb79-799"><a href="#cb79-799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-800"><a href="#cb79-800" aria-hidden="true" tabindex="-1"></a>ロジット関数のpはベルヌーイ試行の成功確率p、ax+bは線形回帰の式です。$p/1-p$は**オッズ比**と呼ばれるもので、成功確率と失敗確率の比を指します。</span>
<span id="cb79-801"><a href="#cb79-801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-802"><a href="#cb79-802" aria-hidden="true" tabindex="-1"></a>ロジスティック分布は以下の式で表されます。</span>
<span id="cb79-803"><a href="#cb79-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-804"><a href="#cb79-804" aria-hidden="true" tabindex="-1"></a>$$Logistic(x, \mu, s)=\frac{\exp(-x)}{s(1+\exp(-(x-\mu)/s)^2)}$$</span>
<span id="cb79-805"><a href="#cb79-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-806"><a href="#cb79-806" aria-hidden="true" tabindex="-1"></a>上の式のμは中央値、sはスケールパラメータです。Rでは、ロジスティック分布の確率密度関数は<span class="in">`dlogis`</span>関数で計算することができます。<span class="in">`dlogis`</span>関数の引数には、中央値μである<span class="in">`location`</span>とスケールパラメータsである<span class="in">`scale`</span>を指定します。ロジスティック分布は$-\infty$～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-807"><a href="#cb79-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-808"><a href="#cb79-808" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-809"><a href="#cb79-809" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-810"><a href="#cb79-810" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-811"><a href="#cb79-811" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-812"><a href="#cb79-812" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ロジスティック分布の確率密度をプロット"}</span></span>
<span id="cb79-813"><a href="#cb79-813" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-5, 5, by = 0.01)</span></span>
<span id="cb79-814"><a href="#cb79-814" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-815"><a href="#cb79-815" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-816"><a href="#cb79-816" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = dlogis(x, location = 0, scale = 1), # location 0、scale1</span></span>
<span id="cb79-817"><a href="#cb79-817" aria-hidden="true" tabindex="-1"></a><span class="in">  l1s2 = dlogis(x, location = 1, scale = 2), # location 1、scale2</span></span>
<span id="cb79-818"><a href="#cb79-818" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s05 = dlogis(x, location = 2, scale = 0.5) # location 2、scale0.5</span></span>
<span id="cb79-819"><a href="#cb79-819" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-820"><a href="#cb79-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-821"><a href="#cb79-821" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-822"><a href="#cb79-822" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-823"><a href="#cb79-823" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-824"><a href="#cb79-824" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-825"><a href="#cb79-825" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-826"><a href="#cb79-826" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-827"><a href="#cb79-827" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-828"><a href="#cb79-828" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-829"><a href="#cb79-829" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ロジスティック分布の累積分布関数をプロット"}</span></span>
<span id="cb79-830"><a href="#cb79-830" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-831"><a href="#cb79-831" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-832"><a href="#cb79-832" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = plogis(x, location = 0, scale = 1), # location 0、scale1</span></span>
<span id="cb79-833"><a href="#cb79-833" aria-hidden="true" tabindex="-1"></a><span class="in">  l1s2 = plogis(x, location = 1, scale = 2), # location 1、scale2</span></span>
<span id="cb79-834"><a href="#cb79-834" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s05 = plogis(x, location = 2, scale = 0.5) # location 2、scale0.5</span></span>
<span id="cb79-835"><a href="#cb79-835" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-836"><a href="#cb79-836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-837"><a href="#cb79-837" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-838"><a href="#cb79-838" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-839"><a href="#cb79-839" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-840"><a href="#cb79-840" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-841"><a href="#cb79-841" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-842"><a href="#cb79-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-843"><a href="#cb79-843" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-844"><a href="#cb79-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-845"><a href="#cb79-845" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqlogisでプロット"}</span></span>
<span id="cb79-846"><a href="#cb79-846" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-847"><a href="#cb79-847" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-848"><a href="#cb79-848" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-849"><a href="#cb79-849" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = qlogis(x, location = 0, scale = 1), # location 0、scale1</span></span>
<span id="cb79-850"><a href="#cb79-850" aria-hidden="true" tabindex="-1"></a><span class="in">  l1s2 = qlogis(x, location = 1, scale = 2), # location 1、scale2</span></span>
<span id="cb79-851"><a href="#cb79-851" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s05 = qlogis(x, location = 2, scale = 0.5) # location 2、scale0.5</span></span>
<span id="cb79-852"><a href="#cb79-852" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-853"><a href="#cb79-853" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-854"><a href="#cb79-854" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-855"><a href="#cb79-855" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-856"><a href="#cb79-856" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-857"><a href="#cb79-857" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-858"><a href="#cb79-858" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-859"><a href="#cb79-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-860"><a href="#cb79-860" aria-hidden="true" tabindex="-1"></a><span class="fu">## ロジスティック乱数</span></span>
<span id="cb79-861"><a href="#cb79-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-862"><a href="#cb79-862" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-863"><a href="#cb79-863" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-864"><a href="#cb79-864" aria-hidden="true" tabindex="-1"></a><span class="in">  l0s1 = rlogis(1000, location = 0, scale = 1), # location 0、scale1</span></span>
<span id="cb79-865"><a href="#cb79-865" aria-hidden="true" tabindex="-1"></a><span class="in">  l1s2 = rlogis(1000, location = 1, scale = 2), # location 1、scale2</span></span>
<span id="cb79-866"><a href="#cb79-866" aria-hidden="true" tabindex="-1"></a><span class="in">  l2s05 = rlogis(1000, location = 2, scale = 0.5) # location 2、scale0.5</span></span>
<span id="cb79-867"><a href="#cb79-867" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-868"><a href="#cb79-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-869"><a href="#cb79-869" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-870"><a href="#cb79-870" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-871"><a href="#cb79-871" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-872"><a href="#cb79-872" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-873"><a href="#cb79-873" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-874"><a href="#cb79-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-875"><a href="#cb79-875" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-876"><a href="#cb79-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-877"><a href="#cb79-877" aria-hidden="true" tabindex="-1"></a><span class="fu">## 対数正規分布</span></span>
<span id="cb79-878"><a href="#cb79-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-879"><a href="#cb79-879" aria-hidden="true" tabindex="-1"></a>**対数正規分布**は正規分布を指数変換した分布です。年収がこの分布に従うことで有名です。パラメータは正規分布と同じくμとσですが、μとσは分布の平均値・標準偏差ではありません。対数正規分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-880"><a href="#cb79-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-881"><a href="#cb79-881" aria-hidden="true" tabindex="-1"></a>$$Lognorm(x, \mu, \sigma)=\frac{1}{x\sigma\sqrt{2\pi}} \cdot \exp(-\frac{(\ln x-\mu)^2}{2\sigma^2})$$</span>
<span id="cb79-882"><a href="#cb79-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-883"><a href="#cb79-883" aria-hidden="true" tabindex="-1"></a>Rで対数正規分布の確率密度関数を計算するには、<span class="in">`dlnorm`</span>関数を用います。<span class="in">`dlnorm`</span>関数の引数には、μとして<span class="in">`meanlog`</span>、σとして<span class="in">`sdlog`</span>を指定します。対数正規分布は左に歪み、右側の裾が長い分布を示し、0～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-884"><a href="#cb79-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-885"><a href="#cb79-885" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-886"><a href="#cb79-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-887"><a href="#cb79-887" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-888"><a href="#cb79-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-889"><a href="#cb79-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="対数正規分布の確率密度をプロット"}</span></span>
<span id="cb79-890"><a href="#cb79-890" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 5, by = 0.01)</span></span>
<span id="cb79-891"><a href="#cb79-891" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-892"><a href="#cb79-892" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-893"><a href="#cb79-893" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = dlnorm(x, meanlog = 0, sdlog = 1), # 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb79-894"><a href="#cb79-894" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s2 = dlnorm(x, meanlog = 2, sdlog = 2), # 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb79-895"><a href="#cb79-895" aria-hidden="true" tabindex="-1"></a><span class="in">  mm2s05 = dlnorm(x, meanlog = -2, sdlog = 0.5) # 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb79-896"><a href="#cb79-896" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-897"><a href="#cb79-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-898"><a href="#cb79-898" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-899"><a href="#cb79-899" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-900"><a href="#cb79-900" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-901"><a href="#cb79-901" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-902"><a href="#cb79-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-903"><a href="#cb79-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-904"><a href="#cb79-904" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-905"><a href="#cb79-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-906"><a href="#cb79-906" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="対数正規分布の累積分布関数をプロット"}</span></span>
<span id="cb79-907"><a href="#cb79-907" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-908"><a href="#cb79-908" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-909"><a href="#cb79-909" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = plnorm(x, meanlog = 0, sdlog = 1), # 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb79-910"><a href="#cb79-910" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s2 = plnorm(x, meanlog = 2, sdlog = 2), # 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb79-911"><a href="#cb79-911" aria-hidden="true" tabindex="-1"></a><span class="in">  mm2s05 = plnorm(x, meanlog = -2, sdlog = 0.5) # 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb79-912"><a href="#cb79-912" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-913"><a href="#cb79-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-914"><a href="#cb79-914" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-915"><a href="#cb79-915" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-916"><a href="#cb79-916" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-917"><a href="#cb79-917" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-918"><a href="#cb79-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-919"><a href="#cb79-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-920"><a href="#cb79-920" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-921"><a href="#cb79-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-922"><a href="#cb79-922" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-923"><a href="#cb79-923" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-924"><a href="#cb79-924" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-925"><a href="#cb79-925" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-926"><a href="#cb79-926" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = qlnorm(x, meanlog = 0, sdlog = 1), # 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb79-927"><a href="#cb79-927" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s2 = qlnorm(x, meanlog = 2, sdlog = 2), # 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb79-928"><a href="#cb79-928" aria-hidden="true" tabindex="-1"></a><span class="in">  mm2s05 = qlnorm(x, meanlog = -2, sdlog = 0.5) # 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb79-929"><a href="#cb79-929" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-930"><a href="#cb79-930" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-931"><a href="#cb79-931" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-932"><a href="#cb79-932" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-933"><a href="#cb79-933" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-934"><a href="#cb79-934" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-935"><a href="#cb79-935" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-936"><a href="#cb79-936" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-937"><a href="#cb79-937" aria-hidden="true" tabindex="-1"></a><span class="fu">## 対数正規乱数</span></span>
<span id="cb79-938"><a href="#cb79-938" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-939"><a href="#cb79-939" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-940"><a href="#cb79-940" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-941"><a href="#cb79-941" aria-hidden="true" tabindex="-1"></a><span class="in">  m0s1 = rlnorm(1000, meanlog = 0, sdlog = 1), # 平均（対数）0、標準偏差（対数）1</span></span>
<span id="cb79-942"><a href="#cb79-942" aria-hidden="true" tabindex="-1"></a><span class="in">  m2s2 = rlnorm(1000, meanlog = 2, sdlog = 2), # 平均（対数）2、標準偏差（対数）2</span></span>
<span id="cb79-943"><a href="#cb79-943" aria-hidden="true" tabindex="-1"></a><span class="in">  mm2s05 = rlnorm(1000, meanlog = -2, sdlog = 0.5) # 平均（対数）-2、標準偏差（対数）0.5</span></span>
<span id="cb79-944"><a href="#cb79-944" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-945"><a href="#cb79-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-946"><a href="#cb79-946" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-947"><a href="#cb79-947" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-948"><a href="#cb79-948" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-949"><a href="#cb79-949" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 100, position = "identity")</span></span>
<span id="cb79-950"><a href="#cb79-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-951"><a href="#cb79-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-952"><a href="#cb79-952" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-953"><a href="#cb79-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-954"><a href="#cb79-954" aria-hidden="true" tabindex="-1"></a><span class="fu">## ベータ分布</span></span>
<span id="cb79-955"><a href="#cb79-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-956"><a href="#cb79-956" aria-hidden="true" tabindex="-1"></a>**ベータ分布**は、ベルヌーイ試行などの成功確率をモデル化する際に用いられる分布です。ベータ分布の確率密度関数には2つのパラメータがあり、それぞれα、βと呼ばれます。どちらも形状パラメータを意味しています。ベータ分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-957"><a href="#cb79-957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-958"><a href="#cb79-958" aria-hidden="true" tabindex="-1"></a>$$Beta(x, \alpha, \beta)=\frac{\Gamma(\alpha + \beta)}{\Gamma(\alpha)\Gamma(\beta)} \cdot x^{\alpha-1} \cdot (1-x)^{\beta-1}$$</span>
<span id="cb79-959"><a href="#cb79-959" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-960"><a href="#cb79-960" aria-hidden="true" tabindex="-1"></a>Rでは、ベータ分布の確率密度関数は<span class="in">`dbeta`</span>関数で計算することができます。<span class="in">`dbeta`</span>分布の引数として、αを<span class="in">`shape1`</span>、βを<span class="in">`shape2`</span>として指定します。ベータ分布は0～1までの連続値を取ります。</span>
<span id="cb79-961"><a href="#cb79-961" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-962"><a href="#cb79-962" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-963"><a href="#cb79-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-964"><a href="#cb79-964" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-965"><a href="#cb79-965" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-966"><a href="#cb79-966" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ベータ分布の確率密度をプロット"}</span></span>
<span id="cb79-967"><a href="#cb79-967" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-968"><a href="#cb79-968" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-969"><a href="#cb79-969" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-970"><a href="#cb79-970" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s075 = dbeta(x, shape1 = 0.5, shape2 = 0.75), # shape1が0.5、shape2が0.75</span></span>
<span id="cb79-971"><a href="#cb79-971" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1  = dbeta(x, shape1 = 1, shape2 = 1), # shape1が1、shape2が1</span></span>
<span id="cb79-972"><a href="#cb79-972" aria-hidden="true" tabindex="-1"></a><span class="in">  s3s2 = dbeta(x, shape1 = 3, shape2 = 2) # shape1が3、shape2が2</span></span>
<span id="cb79-973"><a href="#cb79-973" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-974"><a href="#cb79-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-975"><a href="#cb79-975" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-976"><a href="#cb79-976" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-977"><a href="#cb79-977" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-978"><a href="#cb79-978" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-979"><a href="#cb79-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-980"><a href="#cb79-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-981"><a href="#cb79-981" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-982"><a href="#cb79-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-983"><a href="#cb79-983" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ベータ分布の累積分布関数をプロット"}</span></span>
<span id="cb79-984"><a href="#cb79-984" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-985"><a href="#cb79-985" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-986"><a href="#cb79-986" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-987"><a href="#cb79-987" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s075 = pbeta(x, shape1 = 0.5, shape2 = 0.75), # shape1が0.5、shape2が0.75</span></span>
<span id="cb79-988"><a href="#cb79-988" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1  = pbeta(x, shape1 = 1, shape2 = 1), # shape1が1、shape2が1</span></span>
<span id="cb79-989"><a href="#cb79-989" aria-hidden="true" tabindex="-1"></a><span class="in">  s3s2 = pbeta(x, shape1 = 3, shape2 = 2) # shape1が3、shape2が2</span></span>
<span id="cb79-990"><a href="#cb79-990" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-991"><a href="#cb79-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-992"><a href="#cb79-992" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-993"><a href="#cb79-993" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-994"><a href="#cb79-994" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-995"><a href="#cb79-995" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-996"><a href="#cb79-996" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-997"><a href="#cb79-997" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-998"><a href="#cb79-998" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-999"><a href="#cb79-999" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1000"><a href="#cb79-1000" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqbetaでプロット"}</span></span>
<span id="cb79-1001"><a href="#cb79-1001" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1002"><a href="#cb79-1002" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1003"><a href="#cb79-1003" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1004"><a href="#cb79-1004" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s075 = qbeta(x, shape1 = 0.5, shape2 = 0.75), # shape1が0.5、shape2が0.75</span></span>
<span id="cb79-1005"><a href="#cb79-1005" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1  = qbeta(x, shape1 = 1, shape2 = 1), # shape1が1、shape2が1</span></span>
<span id="cb79-1006"><a href="#cb79-1006" aria-hidden="true" tabindex="-1"></a><span class="in">  s3s2 = qbeta(x, shape1 = 3, shape2 = 2) # shape1が3、shape2が2</span></span>
<span id="cb79-1007"><a href="#cb79-1007" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1008"><a href="#cb79-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1009"><a href="#cb79-1009" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1010"><a href="#cb79-1010" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1011"><a href="#cb79-1011" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1012"><a href="#cb79-1012" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1013"><a href="#cb79-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1014"><a href="#cb79-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1015"><a href="#cb79-1015" aria-hidden="true" tabindex="-1"></a><span class="fu">## ベータ分布乱数</span></span>
<span id="cb79-1016"><a href="#cb79-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1017"><a href="#cb79-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数のヒストグラムをプロット"}</span></span>
<span id="cb79-1018"><a href="#cb79-1018" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1019"><a href="#cb79-1019" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s075 = rbeta(1000, shape1 = 0.5, shape2 = 0.75), # shape1が0.5、shape2が0.75</span></span>
<span id="cb79-1020"><a href="#cb79-1020" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1  = rbeta(1000, shape1 = 1, shape2 = 1), # shape1が1、shape2が1</span></span>
<span id="cb79-1021"><a href="#cb79-1021" aria-hidden="true" tabindex="-1"></a><span class="in">  s3s2 = rbeta(1000, shape1 = 3, shape2 = 2) # shape1が3、shape2が2</span></span>
<span id="cb79-1022"><a href="#cb79-1022" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1023"><a href="#cb79-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1024"><a href="#cb79-1024" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1025"><a href="#cb79-1025" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1026"><a href="#cb79-1026" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1027"><a href="#cb79-1027" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 0.1, position = "identity")</span></span>
<span id="cb79-1028"><a href="#cb79-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1029"><a href="#cb79-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1030"><a href="#cb79-1030" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1031"><a href="#cb79-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1032"><a href="#cb79-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">## カイ二乗分布</span></span>
<span id="cb79-1033"><a href="#cb79-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1034"><a href="#cb79-1034" aria-hidden="true" tabindex="-1"></a>**カイ二乗分布**は正規分布に従う確率変数の二乗和の確率分布です。カイ二乗分布は度数の検定に用いられる分布で、そのパラメータは自由度νのみです。カイ二乗分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-1035"><a href="#cb79-1035" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1036"><a href="#cb79-1036" aria-hidden="true" tabindex="-1"></a>$$Chisq(x, \nu)=\frac{\exp(-x/2) \cdot \exp(\nu/2-1)}{2^{\nu/2} \cdot \Gamma(\nu/2)}$$</span>
<span id="cb79-1037"><a href="#cb79-1037" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1038"><a href="#cb79-1038" aria-hidden="true" tabindex="-1"></a>Rでは、カイ二乗分布は<span class="in">`dchisq`</span>関数で計算することができます。<span class="in">`dchisq`</span>関数の引数として、自由度νを<span class="in">`df`</span>として指定します。カイ二乗分布は右側の裾が長い分布を示し、0～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-1039"><a href="#cb79-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1040"><a href="#cb79-1040" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-1041"><a href="#cb79-1041" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1042"><a href="#cb79-1042" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-1043"><a href="#cb79-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1044"><a href="#cb79-1044" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="カイ二乗分布の確率密度をプロット"}</span></span>
<span id="cb79-1045"><a href="#cb79-1045" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 30, by = 0.01)</span></span>
<span id="cb79-1046"><a href="#cb79-1046" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1047"><a href="#cb79-1047" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1048"><a href="#cb79-1048" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = dchisq(x, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-1049"><a href="#cb79-1049" aria-hidden="true" tabindex="-1"></a><span class="in">  d5n05 = dchisq(x, df = 5, ncp = 0.5), # 自由度5、非心パラメータ0.5</span></span>
<span id="cb79-1050"><a href="#cb79-1050" aria-hidden="true" tabindex="-1"></a><span class="in">  d10n2 = dchisq(x, df = 10, ncp = 2) # 自由度10、非心パラメータ2</span></span>
<span id="cb79-1051"><a href="#cb79-1051" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1052"><a href="#cb79-1052" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1053"><a href="#cb79-1053" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1054"><a href="#cb79-1054" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1055"><a href="#cb79-1055" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1056"><a href="#cb79-1056" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1057"><a href="#cb79-1057" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1058"><a href="#cb79-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1059"><a href="#cb79-1059" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-1060"><a href="#cb79-1060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1061"><a href="#cb79-1061" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="カイ二乗分布の累積分布関数をプロット"}</span></span>
<span id="cb79-1062"><a href="#cb79-1062" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1063"><a href="#cb79-1063" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1064"><a href="#cb79-1064" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = pchisq(x, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-1065"><a href="#cb79-1065" aria-hidden="true" tabindex="-1"></a><span class="in">  d5n05 = pchisq(x, df = 5, ncp = 0.5), # 自由度5、非心パラメータ0.5</span></span>
<span id="cb79-1066"><a href="#cb79-1066" aria-hidden="true" tabindex="-1"></a><span class="in">  d10n2 = pchisq(x, df = 10, ncp = 2) # 自由度10、非心パラメータ2</span></span>
<span id="cb79-1067"><a href="#cb79-1067" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1068"><a href="#cb79-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1069"><a href="#cb79-1069" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1070"><a href="#cb79-1070" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1071"><a href="#cb79-1071" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1072"><a href="#cb79-1072" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1073"><a href="#cb79-1073" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1074"><a href="#cb79-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1075"><a href="#cb79-1075" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-1076"><a href="#cb79-1076" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1077"><a href="#cb79-1077" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqchisqでプロット"}</span></span>
<span id="cb79-1078"><a href="#cb79-1078" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1079"><a href="#cb79-1079" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1080"><a href="#cb79-1080" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1081"><a href="#cb79-1081" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = qchisq(x, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-1082"><a href="#cb79-1082" aria-hidden="true" tabindex="-1"></a><span class="in">  d5n05 = qchisq(x, df = 5, ncp = 0.5), # 自由度5、非心パラメータ0.5</span></span>
<span id="cb79-1083"><a href="#cb79-1083" aria-hidden="true" tabindex="-1"></a><span class="in">  d10n2 = qchisq(x, df = 10, ncp = 2) # 自由度10、非心パラメータ2</span></span>
<span id="cb79-1084"><a href="#cb79-1084" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1085"><a href="#cb79-1085" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1086"><a href="#cb79-1086" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1087"><a href="#cb79-1087" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1088"><a href="#cb79-1088" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1089"><a href="#cb79-1089" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1090"><a href="#cb79-1090" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1091"><a href="#cb79-1091" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1092"><a href="#cb79-1092" aria-hidden="true" tabindex="-1"></a><span class="fu">## カイ二乗乱数</span></span>
<span id="cb79-1093"><a href="#cb79-1093" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1094"><a href="#cb79-1094" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数のヒストグラムをプロット"}</span></span>
<span id="cb79-1095"><a href="#cb79-1095" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1096"><a href="#cb79-1096" aria-hidden="true" tabindex="-1"></a><span class="in">  d3n0 = rchisq(1000, df = 3, ncp = 0), # 自由度3、非心パラメータ0</span></span>
<span id="cb79-1097"><a href="#cb79-1097" aria-hidden="true" tabindex="-1"></a><span class="in">  d5n05 = rchisq(1000, df = 5, ncp = 0.5), # 自由度5、非心パラメータ0.5</span></span>
<span id="cb79-1098"><a href="#cb79-1098" aria-hidden="true" tabindex="-1"></a><span class="in">  d10n2 = rchisq(1000, df = 10, ncp = 2) # 自由度10、非心パラメータ2</span></span>
<span id="cb79-1099"><a href="#cb79-1099" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1100"><a href="#cb79-1100" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1101"><a href="#cb79-1101" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1102"><a href="#cb79-1102" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1103"><a href="#cb79-1103" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1104"><a href="#cb79-1104" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-1105"><a href="#cb79-1105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1106"><a href="#cb79-1106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1107"><a href="#cb79-1107" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1108"><a href="#cb79-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1109"><a href="#cb79-1109" aria-hidden="true" tabindex="-1"></a><span class="fu">## F分布</span></span>
<span id="cb79-1110"><a href="#cb79-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1111"><a href="#cb79-1111" aria-hidden="true" tabindex="-1"></a>**F分布**はカイ二乗に従う2つの独立な変数の比の分布です。F分布は**分散分析**で用いられる分布です。F分布のパラメータは独立の2変数それぞれの自由度（ν~1~とν~2~）です。F分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-1112"><a href="#cb79-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1113"><a href="#cb79-1113" aria-hidden="true" tabindex="-1"></a>$$F(x, \nu_{1}, \nu_{2})=</span>
<span id="cb79-1114"><a href="#cb79-1114" aria-hidden="true" tabindex="-1"></a>\frac{\Gamma(\frac{\nu_{1}+\nu_{2}}{2}) \cdot (\frac{\nu_{1}}{\nu_{2}})^{\nu_{1}/2 \cdot x^{\nu_{1}/2-1}}}</span>
<span id="cb79-1115"><a href="#cb79-1115" aria-hidden="true" tabindex="-1"></a>{\Gamma(\frac{\nu_{1}}{2}) \cdot \Gamma(\frac{\nu_{2}}{2}) \cdot (1+\frac{\nu_{1}x}{\nu_{2}})^{\frac{\nu_{1}+\nu_{2}}{2}}}$$</span>
<span id="cb79-1116"><a href="#cb79-1116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1117"><a href="#cb79-1117" aria-hidden="true" tabindex="-1"></a>RではF分布の確率密度関数を<span class="in">`df`</span>関数で計算することができます。<span class="in">`df`</span>関数では自由度2つをそれぞれ<span class="in">`df1`</span>、<span class="in">`df2`</span>引数として指定します。F分布も右側の裾が長い分布を示し、0～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-1118"><a href="#cb79-1118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1119"><a href="#cb79-1119" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-1120"><a href="#cb79-1120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1121"><a href="#cb79-1121" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-1122"><a href="#cb79-1122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1123"><a href="#cb79-1123" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="F分布の確率密度をプロット"}</span></span>
<span id="cb79-1124"><a href="#cb79-1124" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 10, by = 0.01)</span></span>
<span id="cb79-1125"><a href="#cb79-1125" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1126"><a href="#cb79-1126" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1127"><a href="#cb79-1127" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = df(x, df1 = 5, df2 = 5), # 自由度1 5、自由度2 5</span></span>
<span id="cb79-1128"><a href="#cb79-1128" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = df(x, df1 = 10, df2 = 15), # 自由度1 10、自由度2 15</span></span>
<span id="cb79-1129"><a href="#cb79-1129" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = df(x, df1 = 20, df2 = 15) # 自由度1 20、自由度2 15</span></span>
<span id="cb79-1130"><a href="#cb79-1130" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1131"><a href="#cb79-1131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1132"><a href="#cb79-1132" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1133"><a href="#cb79-1133" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1134"><a href="#cb79-1134" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1135"><a href="#cb79-1135" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1136"><a href="#cb79-1136" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1137"><a href="#cb79-1137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1138"><a href="#cb79-1138" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-1139"><a href="#cb79-1139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1140"><a href="#cb79-1140" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="F分布の累積分布関数をプロット"}</span></span>
<span id="cb79-1141"><a href="#cb79-1141" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1142"><a href="#cb79-1142" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1143"><a href="#cb79-1143" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = pf(x, df1 = 5, df2 = 5), # 自由度1 5、自由度2 5</span></span>
<span id="cb79-1144"><a href="#cb79-1144" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = pf(x, df1 = 10, df2 = 15), # 自由度1 10、自由度2 15</span></span>
<span id="cb79-1145"><a href="#cb79-1145" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = pf(x, df1 = 20, df2 = 15) # 自由度1 20、自由度2 15</span></span>
<span id="cb79-1146"><a href="#cb79-1146" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1147"><a href="#cb79-1147" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1148"><a href="#cb79-1148" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1149"><a href="#cb79-1149" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1150"><a href="#cb79-1150" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1151"><a href="#cb79-1151" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1152"><a href="#cb79-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1153"><a href="#cb79-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1154"><a href="#cb79-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-1155"><a href="#cb79-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1156"><a href="#cb79-1156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-1157"><a href="#cb79-1157" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1158"><a href="#cb79-1158" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1159"><a href="#cb79-1159" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1160"><a href="#cb79-1160" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = qf(x, df1 = 5, df2 = 5), # 自由度1 5、自由度2 5</span></span>
<span id="cb79-1161"><a href="#cb79-1161" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = qf(x, df1 = 10, df2 = 15), # 自由度1 10、自由度2 15</span></span>
<span id="cb79-1162"><a href="#cb79-1162" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = qf(x, df1 = 20, df2 = 15) # 自由度1 20、自由度2 15</span></span>
<span id="cb79-1163"><a href="#cb79-1163" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1164"><a href="#cb79-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1165"><a href="#cb79-1165" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1166"><a href="#cb79-1166" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1167"><a href="#cb79-1167" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1168"><a href="#cb79-1168" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1169"><a href="#cb79-1169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1170"><a href="#cb79-1170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1171"><a href="#cb79-1171" aria-hidden="true" tabindex="-1"></a><span class="fu">## F乱数</span></span>
<span id="cb79-1172"><a href="#cb79-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1173"><a href="#cb79-1173" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-1174"><a href="#cb79-1174" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1175"><a href="#cb79-1175" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = rf(1000, df1 = 5, df2 = 5), # 自由度1 5、自由度2 5</span></span>
<span id="cb79-1176"><a href="#cb79-1176" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = rf(1000, df1 = 10, df2 = 15), # 自由度1 10、自由度2 15</span></span>
<span id="cb79-1177"><a href="#cb79-1177" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = rf(1000, df1 = 20, df2 = 15) # 自由度1 20、自由度2 15</span></span>
<span id="cb79-1178"><a href="#cb79-1178" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1179"><a href="#cb79-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1180"><a href="#cb79-1180" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1181"><a href="#cb79-1181" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1182"><a href="#cb79-1182" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1183"><a href="#cb79-1183" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-1184"><a href="#cb79-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1185"><a href="#cb79-1185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1186"><a href="#cb79-1186" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1187"><a href="#cb79-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1188"><a href="#cb79-1188" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-1189"><a href="#cb79-1189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1190"><a href="#cb79-1190" aria-hidden="true" tabindex="-1"></a><span class="fu">## データフレームの変数名</span></span>
<span id="cb79-1191"><a href="#cb79-1191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1192"><a href="#cb79-1192" aria-hidden="true" tabindex="-1"></a>Rでデータフレームを変数に代入する場合、<span class="in">`data.frame`</span>から変数名を<span class="in">`df`</span>とする場合があるのですが、この<span class="in">`df`</span>にデータフレームを代入してしまうと、F関数の確率密度関数である<span class="in">`df`</span>関数を上書きしてしまいます。正直<span class="in">`df`</span>関数を使う機会はほとんどないのですが、データフレームの変数名には<span class="in">`d`</span>の一文字を用いたり、きちんと意味のある名前を用いた方がよいでしょう。</span>
<span id="cb79-1193"><a href="#cb79-1193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1194"><a href="#cb79-1194" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1195"><a href="#cb79-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1196"><a href="#cb79-1196" aria-hidden="true" tabindex="-1"></a><span class="fu">## ガンマ分布</span></span>
<span id="cb79-1197"><a href="#cb79-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1198"><a href="#cb79-1198" aria-hidden="true" tabindex="-1"></a>**ガンマ分布**は機械の信頼性や降雨量などの説明に用いられる分布です。ガンマ分布のパラメータは形状パラメータγとスケールパラメータβの2つです。ガンマ分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-1199"><a href="#cb79-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1200"><a href="#cb79-1200" aria-hidden="true" tabindex="-1"></a>$$Gamma(x, \gamma, \beta)=\frac{(\frac{x}{\beta})^{\gamma-1} \cdot \exp(-\frac{x}{\beta})}{\beta \cdot \Gamma(\gamma)}$$</span>
<span id="cb79-1201"><a href="#cb79-1201" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1202"><a href="#cb79-1202" aria-hidden="true" tabindex="-1"></a>Rでのガンマ分布の確率密度関数は<span class="in">`dgamma`</span>関数で計算することができます。ガンマ分布のパラメータである形状パラメータは<span class="in">`shape`</span>引数、スケールパラメータは<span class="in">`scale`</span>引数で指定します。ガンマ分布は右側の裾が長い分布で、最頻値が0以上となる形状を示し、0～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-1203"><a href="#cb79-1203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1204"><a href="#cb79-1204" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-1205"><a href="#cb79-1205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1206"><a href="#cb79-1206" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-1207"><a href="#cb79-1207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1208"><a href="#cb79-1208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ガンマ分布の確率密度をプロット"}</span></span>
<span id="cb79-1209"><a href="#cb79-1209" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 100, by = 0.1)</span></span>
<span id="cb79-1210"><a href="#cb79-1210" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1211"><a href="#cb79-1211" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1212"><a href="#cb79-1212" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = dgamma(x, shape = 5, scale = 2), # shape 5 scale 2</span></span>
<span id="cb79-1213"><a href="#cb79-1213" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = dgamma(x, shape = 10, scale = 4), # shape 10 scale 4</span></span>
<span id="cb79-1214"><a href="#cb79-1214" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = dgamma(x, shape = 1, scale = 6) # shape 1 scale 6</span></span>
<span id="cb79-1215"><a href="#cb79-1215" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1216"><a href="#cb79-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1217"><a href="#cb79-1217" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1218"><a href="#cb79-1218" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1219"><a href="#cb79-1219" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1220"><a href="#cb79-1220" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1221"><a href="#cb79-1221" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1222"><a href="#cb79-1222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1223"><a href="#cb79-1223" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-1224"><a href="#cb79-1224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1225"><a href="#cb79-1225" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ガンマ分布の累積分布関数をプロット"}</span></span>
<span id="cb79-1226"><a href="#cb79-1226" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1227"><a href="#cb79-1227" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1228"><a href="#cb79-1228" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = pgamma(x, shape = 5, scale = 2), # shape 5 scale 2</span></span>
<span id="cb79-1229"><a href="#cb79-1229" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = pgamma(x, shape = 10, scale = 4), # shape 10 scale 4</span></span>
<span id="cb79-1230"><a href="#cb79-1230" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = pgamma(x, shape = 1, scale = 6) # shape 1 scale 6</span></span>
<span id="cb79-1231"><a href="#cb79-1231" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1232"><a href="#cb79-1232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1233"><a href="#cb79-1233" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1234"><a href="#cb79-1234" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1235"><a href="#cb79-1235" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1236"><a href="#cb79-1236" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1237"><a href="#cb79-1237" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1238"><a href="#cb79-1238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1239"><a href="#cb79-1239" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-1240"><a href="#cb79-1240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1241"><a href="#cb79-1241" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-1242"><a href="#cb79-1242" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1243"><a href="#cb79-1243" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1244"><a href="#cb79-1244" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1245"><a href="#cb79-1245" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = qgamma(x, shape = 5, scale = 2), # shape 5 scale 2</span></span>
<span id="cb79-1246"><a href="#cb79-1246" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = qgamma(x, shape = 10, scale = 4), # shape 10 scale 4</span></span>
<span id="cb79-1247"><a href="#cb79-1247" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = qgamma(x, shape = 1, scale = 6) # shape 1 scale 6</span></span>
<span id="cb79-1248"><a href="#cb79-1248" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1249"><a href="#cb79-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1250"><a href="#cb79-1250" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1251"><a href="#cb79-1251" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1252"><a href="#cb79-1252" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1253"><a href="#cb79-1253" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1254"><a href="#cb79-1254" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1255"><a href="#cb79-1255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1256"><a href="#cb79-1256" aria-hidden="true" tabindex="-1"></a><span class="fu">## ガンマ乱数</span></span>
<span id="cb79-1257"><a href="#cb79-1257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1258"><a href="#cb79-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-1259"><a href="#cb79-1259" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1260"><a href="#cb79-1260" aria-hidden="true" tabindex="-1"></a><span class="in">  df5df5 = rgamma(1000, shape = 5, scale = 2), # shape 5 scale 2</span></span>
<span id="cb79-1261"><a href="#cb79-1261" aria-hidden="true" tabindex="-1"></a><span class="in">  df10df15 = rgamma(1000, shape = 10, scale = 4), # shape 10 scale 4</span></span>
<span id="cb79-1262"><a href="#cb79-1262" aria-hidden="true" tabindex="-1"></a><span class="in">  df15df20 = rgamma(1000, shape = 1, scale = 6) # shape 1 scale 6</span></span>
<span id="cb79-1263"><a href="#cb79-1263" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1264"><a href="#cb79-1264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1265"><a href="#cb79-1265" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1266"><a href="#cb79-1266" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1267"><a href="#cb79-1267" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1268"><a href="#cb79-1268" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 5, position = "identity")</span></span>
<span id="cb79-1269"><a href="#cb79-1269" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1270"><a href="#cb79-1270" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1271"><a href="#cb79-1271" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1272"><a href="#cb79-1272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1273"><a href="#cb79-1273" aria-hidden="true" tabindex="-1"></a><span class="fu">## 指数分布</span></span>
<span id="cb79-1274"><a href="#cb79-1274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1275"><a href="#cb79-1275" aria-hidden="true" tabindex="-1"></a>**指数分布**はポアソン分布する事象（まれに起こる事象）が起こる時間間隔の分布を示す確率分布です。指数分布は**生存時間解析**などの、イベントの発生数と時間の関係を解析するのに用いられています。指数分布のパラメータはλのみで、λは正の値を取ります。指数分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-1276"><a href="#cb79-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1277"><a href="#cb79-1277" aria-hidden="true" tabindex="-1"></a>$$Exp(x, \lambda)=\lambda \cdot \exp(-\lambda x)$$</span>
<span id="cb79-1278"><a href="#cb79-1278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1279"><a href="#cb79-1279" aria-hidden="true" tabindex="-1"></a>Rでは指数分布の確率密度関数は<span class="in">`dexp`</span>関数で計算することができます。<span class="in">`dexp`</span>関数では、λを<span class="in">`rate`</span>引数で指定します。指数分布は単調減少で、0～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-1280"><a href="#cb79-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1281"><a href="#cb79-1281" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-1282"><a href="#cb79-1282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1283"><a href="#cb79-1283" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-1284"><a href="#cb79-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1285"><a href="#cb79-1285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="指数分布の確率密度をプロット"}</span></span>
<span id="cb79-1286"><a href="#cb79-1286" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 10, by = 0.01)</span></span>
<span id="cb79-1287"><a href="#cb79-1287" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1288"><a href="#cb79-1288" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1289"><a href="#cb79-1289" aria-hidden="true" tabindex="-1"></a><span class="in">  r1 = dexp(x, rate = 1), # ラムダ1</span></span>
<span id="cb79-1290"><a href="#cb79-1290" aria-hidden="true" tabindex="-1"></a><span class="in">  r3 = dexp(x, rate = 3), # ラムダ3</span></span>
<span id="cb79-1291"><a href="#cb79-1291" aria-hidden="true" tabindex="-1"></a><span class="in">  r5 = dexp(x, rate = 5) # ラムダ5</span></span>
<span id="cb79-1292"><a href="#cb79-1292" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1293"><a href="#cb79-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1294"><a href="#cb79-1294" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1295"><a href="#cb79-1295" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1296"><a href="#cb79-1296" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1297"><a href="#cb79-1297" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1298"><a href="#cb79-1298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1299"><a href="#cb79-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1300"><a href="#cb79-1300" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-1301"><a href="#cb79-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1302"><a href="#cb79-1302" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="指数分布の累積分布関数をプロット"}</span></span>
<span id="cb79-1303"><a href="#cb79-1303" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1304"><a href="#cb79-1304" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1305"><a href="#cb79-1305" aria-hidden="true" tabindex="-1"></a><span class="in">  r1 = pexp(x, rate = 1), # ラムダ1</span></span>
<span id="cb79-1306"><a href="#cb79-1306" aria-hidden="true" tabindex="-1"></a><span class="in">  r3 = pexp(x, rate = 3), # ラムダ3</span></span>
<span id="cb79-1307"><a href="#cb79-1307" aria-hidden="true" tabindex="-1"></a><span class="in">  r5 = pexp(x, rate = 5) # ラムダ5</span></span>
<span id="cb79-1308"><a href="#cb79-1308" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1309"><a href="#cb79-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1310"><a href="#cb79-1310" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1311"><a href="#cb79-1311" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1312"><a href="#cb79-1312" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1313"><a href="#cb79-1313" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1314"><a href="#cb79-1314" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1315"><a href="#cb79-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1316"><a href="#cb79-1316" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-1317"><a href="#cb79-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1318"><a href="#cb79-1318" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqexpでプロット"}</span></span>
<span id="cb79-1319"><a href="#cb79-1319" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1320"><a href="#cb79-1320" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1321"><a href="#cb79-1321" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1322"><a href="#cb79-1322" aria-hidden="true" tabindex="-1"></a><span class="in">  r1 = qexp(x, rate = 1), # ラムダ1</span></span>
<span id="cb79-1323"><a href="#cb79-1323" aria-hidden="true" tabindex="-1"></a><span class="in">  r3 = qexp(x, rate = 3), # ラムダ3</span></span>
<span id="cb79-1324"><a href="#cb79-1324" aria-hidden="true" tabindex="-1"></a><span class="in">  r5 = qexp(x, rate = 5) # ラムダ5</span></span>
<span id="cb79-1325"><a href="#cb79-1325" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1326"><a href="#cb79-1326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1327"><a href="#cb79-1327" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1328"><a href="#cb79-1328" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1329"><a href="#cb79-1329" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1330"><a href="#cb79-1330" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1331"><a href="#cb79-1331" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1332"><a href="#cb79-1332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1333"><a href="#cb79-1333" aria-hidden="true" tabindex="-1"></a><span class="fu">## 指数乱数</span></span>
<span id="cb79-1334"><a href="#cb79-1334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1335"><a href="#cb79-1335" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-1336"><a href="#cb79-1336" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1337"><a href="#cb79-1337" aria-hidden="true" tabindex="-1"></a><span class="in">  r1 = rexp(1000, rate = 1), # ラムダ1</span></span>
<span id="cb79-1338"><a href="#cb79-1338" aria-hidden="true" tabindex="-1"></a><span class="in">  r3 = rexp(1000, rate = 3), # ラムダ3</span></span>
<span id="cb79-1339"><a href="#cb79-1339" aria-hidden="true" tabindex="-1"></a><span class="in">  r5 = rexp(1000, rate = 5) # ラムダ5</span></span>
<span id="cb79-1340"><a href="#cb79-1340" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1341"><a href="#cb79-1341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1342"><a href="#cb79-1342" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1343"><a href="#cb79-1343" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1344"><a href="#cb79-1344" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1345"><a href="#cb79-1345" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 0.1, position = "identity")</span></span>
<span id="cb79-1346"><a href="#cb79-1346" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1347"><a href="#cb79-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1348"><a href="#cb79-1348" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1349"><a href="#cb79-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1350"><a href="#cb79-1350" aria-hidden="true" tabindex="-1"></a><span class="fu">## ワイブル分布</span></span>
<span id="cb79-1351"><a href="#cb79-1351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1352"><a href="#cb79-1352" aria-hidden="true" tabindex="-1"></a>**ワイブル分布**は指数分布を拡張したような確率分布です。指数分布では、ポアソン分布する事象（イベント）が起きる確率は常に一定であることを仮定していますが、ワイブル分布を用いると単調増加・単調減少でイベントが起きる確率が変化する場合を表現することができます。ワイブル分布のパラメータは形状パラメータのλとスケールパラメータのkの2つです。ワイブル分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-1353"><a href="#cb79-1353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1354"><a href="#cb79-1354" aria-hidden="true" tabindex="-1"></a>$$Weibull(x, \lambda, k)=\frac{k}{\lambda}(\frac{x}{\lambda})^{k-1} \cdot \exp(-\frac{x}{\lambda})^k$$</span>
<span id="cb79-1355"><a href="#cb79-1355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1356"><a href="#cb79-1356" aria-hidden="true" tabindex="-1"></a>Rでは、ワイブル分布の確率密度関数を<span class="in">`dweibull`</span>関数で計算することができます。<span class="in">`dweibull`</span>関数の引数は形状パラメータλである<span class="in">`shape`</span>と、スケールパラメータkである<span class="in">`scale`</span>の2つです。ワイブル分布はガンマ分布と同じく、右側の裾が長い分布で、最頻値が0以上となる形状を示し、0～$\infty$の範囲を持つ連続値を取ります。</span>
<span id="cb79-1357"><a href="#cb79-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1358"><a href="#cb79-1358" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-1359"><a href="#cb79-1359" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1360"><a href="#cb79-1360" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-1361"><a href="#cb79-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1362"><a href="#cb79-1362" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ワイブル分布の確率密度をプロット"}</span></span>
<span id="cb79-1363"><a href="#cb79-1363" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 5, by = 0.01)</span></span>
<span id="cb79-1364"><a href="#cb79-1364" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1365"><a href="#cb79-1365" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1366"><a href="#cb79-1366" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1 = dweibull(x, shape = 1, scale = 1), # shape 1、scale 1</span></span>
<span id="cb79-1367"><a href="#cb79-1367" aria-hidden="true" tabindex="-1"></a><span class="in">  s2s2 = dweibull(x, shape = 2, scale = 2), # shape 2、scale 2</span></span>
<span id="cb79-1368"><a href="#cb79-1368" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s05 = dweibull(x, shape = 0.5, scale = 0.5) # shape 0.5、scale 0.5</span></span>
<span id="cb79-1369"><a href="#cb79-1369" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1370"><a href="#cb79-1370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1371"><a href="#cb79-1371" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1372"><a href="#cb79-1372" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1373"><a href="#cb79-1373" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1374"><a href="#cb79-1374" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1375"><a href="#cb79-1375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1376"><a href="#cb79-1376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1377"><a href="#cb79-1377" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-1378"><a href="#cb79-1378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1379"><a href="#cb79-1379" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ワイブル分布の累積分布関数をプロット"}</span></span>
<span id="cb79-1380"><a href="#cb79-1380" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1381"><a href="#cb79-1381" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1382"><a href="#cb79-1382" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1 = pweibull(x, shape = 1, scale = 1), # shape 1、scale 1</span></span>
<span id="cb79-1383"><a href="#cb79-1383" aria-hidden="true" tabindex="-1"></a><span class="in">  s2s2 = pweibull(x, shape = 2, scale = 2), # shape 2、scale 2</span></span>
<span id="cb79-1384"><a href="#cb79-1384" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s05 = pweibull(x, shape = 0.5, scale = 0.5) # shape 0.5、scale 0.5</span></span>
<span id="cb79-1385"><a href="#cb79-1385" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1386"><a href="#cb79-1386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1387"><a href="#cb79-1387" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1388"><a href="#cb79-1388" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1389"><a href="#cb79-1389" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1390"><a href="#cb79-1390" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1391"><a href="#cb79-1391" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1392"><a href="#cb79-1392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1393"><a href="#cb79-1393" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-1394"><a href="#cb79-1394" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1395"><a href="#cb79-1395" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-1396"><a href="#cb79-1396" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1397"><a href="#cb79-1397" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1398"><a href="#cb79-1398" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1399"><a href="#cb79-1399" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1 = qweibull(x, shape = 1, scale = 1), # shape 1、scale 1</span></span>
<span id="cb79-1400"><a href="#cb79-1400" aria-hidden="true" tabindex="-1"></a><span class="in">  s2s2 = qweibull(x, shape = 2, scale = 2), # shape 2、scale 2</span></span>
<span id="cb79-1401"><a href="#cb79-1401" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s05 = qweibull(x, shape = 0.5, scale = 0.5) # shape 0.5、scale 0.5</span></span>
<span id="cb79-1402"><a href="#cb79-1402" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1403"><a href="#cb79-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1404"><a href="#cb79-1404" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1405"><a href="#cb79-1405" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1406"><a href="#cb79-1406" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1407"><a href="#cb79-1407" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1408"><a href="#cb79-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1409"><a href="#cb79-1409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1410"><a href="#cb79-1410" aria-hidden="true" tabindex="-1"></a><span class="fu">## ワイブル乱数</span></span>
<span id="cb79-1411"><a href="#cb79-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1412"><a href="#cb79-1412" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-1413"><a href="#cb79-1413" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1414"><a href="#cb79-1414" aria-hidden="true" tabindex="-1"></a><span class="in">  s1s1 = rweibull(1000, shape = 1, scale = 1), # shape 1、scale 1</span></span>
<span id="cb79-1415"><a href="#cb79-1415" aria-hidden="true" tabindex="-1"></a><span class="in">  s2s2 = rweibull(1000, shape = 2, scale = 2), # shape 2、scale 2</span></span>
<span id="cb79-1416"><a href="#cb79-1416" aria-hidden="true" tabindex="-1"></a><span class="in">  s05s05 = rweibull(1000, shape = 0.5, scale = 0.5) # shape 0.5、scale 0.5</span></span>
<span id="cb79-1417"><a href="#cb79-1417" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1418"><a href="#cb79-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1419"><a href="#cb79-1419" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1420"><a href="#cb79-1420" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1421"><a href="#cb79-1421" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1422"><a href="#cb79-1422" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 0.2, position = "identity")</span></span>
<span id="cb79-1423"><a href="#cb79-1423" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1424"><a href="#cb79-1424" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1425"><a href="#cb79-1425" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1426"><a href="#cb79-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1427"><a href="#cb79-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">## 一様分布</span></span>
<span id="cb79-1428"><a href="#cb79-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1429"><a href="#cb79-1429" aria-hidden="true" tabindex="-1"></a>**一様分布**は、最小値（a）から最大値（b）まで、一定の確率で現れる現象を示す分布です。この章の始めに示した<span class="in">`sample`</span>関数の乱数やサイコロなどが一様分布の典型的な例です。一様分布のパラメータは最小値aと最大値bの2つです。一様分布の確率密度関数は以下の式で表されます。</span>
<span id="cb79-1430"><a href="#cb79-1430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1431"><a href="#cb79-1431" aria-hidden="true" tabindex="-1"></a>$$Unif(x, a, b)=\frac{1}{b-a}$$</span>
<span id="cb79-1432"><a href="#cb79-1432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1433"><a href="#cb79-1433" aria-hidden="true" tabindex="-1"></a>Rでは、一様分布の確率密度関数を<span class="in">`dunif`</span>関数で計算することができます。<span class="in">`dunif`</span>関数では最小値aとして<span class="in">`min`</span>、最大値bとして<span class="in">`max`</span>の2つのパラメータを引数に指定します。一様分布はその名の通り確率密度が一定で、a～bの範囲を持つ連続値を取ります。</span>
<span id="cb79-1434"><a href="#cb79-1434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1435"><a href="#cb79-1435" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-1436"><a href="#cb79-1436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1437"><a href="#cb79-1437" aria-hidden="true" tabindex="-1"></a><span class="fu">## 確率密度</span></span>
<span id="cb79-1438"><a href="#cb79-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1439"><a href="#cb79-1439" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="一様分布の確率密度をプロット"}</span></span>
<span id="cb79-1440"><a href="#cb79-1440" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(-1.5, 4.5, by = 0.01)</span></span>
<span id="cb79-1441"><a href="#cb79-1441" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1442"><a href="#cb79-1442" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1443"><a href="#cb79-1443" aria-hidden="true" tabindex="-1"></a><span class="in">  m0m1 = dunif(x, min = 0, max = 1), # 最小0、最大1</span></span>
<span id="cb79-1444"><a href="#cb79-1444" aria-hidden="true" tabindex="-1"></a><span class="in">  mm1m1 = dunif(x, min = -1, max = 1), # 最小-1、最大1</span></span>
<span id="cb79-1445"><a href="#cb79-1445" aria-hidden="true" tabindex="-1"></a><span class="in">  m2m4 = dunif(x, min = 2, max = 4) # 最小2、最大4</span></span>
<span id="cb79-1446"><a href="#cb79-1446" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1447"><a href="#cb79-1447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1448"><a href="#cb79-1448" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1449"><a href="#cb79-1449" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1450"><a href="#cb79-1450" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1451"><a href="#cb79-1451" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1452"><a href="#cb79-1452" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1453"><a href="#cb79-1453" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1454"><a href="#cb79-1454" aria-hidden="true" tabindex="-1"></a><span class="fu">## 累積分布関数</span></span>
<span id="cb79-1455"><a href="#cb79-1455" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1456"><a href="#cb79-1456" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="一様分布の累積分布関数をプロット"}</span></span>
<span id="cb79-1457"><a href="#cb79-1457" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1458"><a href="#cb79-1458" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1459"><a href="#cb79-1459" aria-hidden="true" tabindex="-1"></a><span class="in">  m0m1 = punif(x, min = 0, max = 1), # 最小0、最大1</span></span>
<span id="cb79-1460"><a href="#cb79-1460" aria-hidden="true" tabindex="-1"></a><span class="in">  mm1m1 = punif(x, min = -1, max = 1), # 最小-1、最大1</span></span>
<span id="cb79-1461"><a href="#cb79-1461" aria-hidden="true" tabindex="-1"></a><span class="in">  m2m4 = punif(x, min = 2, max = 4) # 最小2、最大4</span></span>
<span id="cb79-1462"><a href="#cb79-1462" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1463"><a href="#cb79-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1464"><a href="#cb79-1464" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1465"><a href="#cb79-1465" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1466"><a href="#cb79-1466" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1467"><a href="#cb79-1467" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1468"><a href="#cb79-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1469"><a href="#cb79-1469" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1470"><a href="#cb79-1470" aria-hidden="true" tabindex="-1"></a><span class="fu">## 分位点の値</span></span>
<span id="cb79-1471"><a href="#cb79-1471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1472"><a href="#cb79-1472" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="累積分布関数の分位点と値の関係をqfでプロット"}</span></span>
<span id="cb79-1473"><a href="#cb79-1473" aria-hidden="true" tabindex="-1"></a><span class="in">x &lt;- seq(0, 1, by = 0.01)</span></span>
<span id="cb79-1474"><a href="#cb79-1474" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1475"><a href="#cb79-1475" aria-hidden="true" tabindex="-1"></a><span class="in">  x,</span></span>
<span id="cb79-1476"><a href="#cb79-1476" aria-hidden="true" tabindex="-1"></a><span class="in">  m0m1 = qunif(x, min = 0, max = 1), # 最小0、最大1</span></span>
<span id="cb79-1477"><a href="#cb79-1477" aria-hidden="true" tabindex="-1"></a><span class="in">  mm1m1 = qunif(x, min = -1, max = 1), # 最小-1、最大1</span></span>
<span id="cb79-1478"><a href="#cb79-1478" aria-hidden="true" tabindex="-1"></a><span class="in">  m2m4 = qunif(x, min = 2, max = 4) # 最小2、最大4</span></span>
<span id="cb79-1479"><a href="#cb79-1479" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1480"><a href="#cb79-1480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1481"><a href="#cb79-1481" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1482"><a href="#cb79-1482" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:4) |&gt; </span></span>
<span id="cb79-1483"><a href="#cb79-1483" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = x, y = value, color = name)) +</span></span>
<span id="cb79-1484"><a href="#cb79-1484" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line()</span></span>
<span id="cb79-1485"><a href="#cb79-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1486"><a href="#cb79-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1487"><a href="#cb79-1487" aria-hidden="true" tabindex="-1"></a><span class="fu">## 一様乱数</span></span>
<span id="cb79-1488"><a href="#cb79-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1489"><a href="#cb79-1489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="乱数の確率密度をプロット"}</span></span>
<span id="cb79-1490"><a href="#cb79-1490" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- tibble(</span></span>
<span id="cb79-1491"><a href="#cb79-1491" aria-hidden="true" tabindex="-1"></a><span class="in">  m0m1 = runif(1000, min = 0, max = 1), # 最小0、最大1</span></span>
<span id="cb79-1492"><a href="#cb79-1492" aria-hidden="true" tabindex="-1"></a><span class="in">  mm1m1 = runif(1000, min = -1, max = 1), # 最小-1、最大1</span></span>
<span id="cb79-1493"><a href="#cb79-1493" aria-hidden="true" tabindex="-1"></a><span class="in">  m2m4 = runif(1000, min = 2, max = 4) # 最小2、最大4</span></span>
<span id="cb79-1494"><a href="#cb79-1494" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-1495"><a href="#cb79-1495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1496"><a href="#cb79-1496" aria-hidden="true" tabindex="-1"></a><span class="in">d |&gt; </span></span>
<span id="cb79-1497"><a href="#cb79-1497" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1498"><a href="#cb79-1498" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5)) +</span></span>
<span id="cb79-1499"><a href="#cb79-1499" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position="identity")</span></span>
<span id="cb79-1500"><a href="#cb79-1500" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1501"><a href="#cb79-1501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1502"><a href="#cb79-1502" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-1503"><a href="#cb79-1503" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1504"><a href="#cb79-1504" aria-hidden="true" tabindex="-1"></a><span class="fu">## 多項分布</span></span>
<span id="cb79-1505"><a href="#cb79-1505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1506"><a href="#cb79-1506" aria-hidden="true" tabindex="-1"></a>多項分布はここまでに示した確率分布とは異なり、Rには累積分布関数や分位点の関数が設定されていない確率分布です。多項分布は、複数の事象、例えばツボに白・赤・黒のボールを違う数で入れておき、取り出しては戻すような試行（**復元抽出**）を行うとき、それぞれの色のボールを特定の数だけ取り出す確率を計算するときに用います。各色のボールを取り出す確率はそれぞれ異なりますが、足し合わせれば確率が1となるような状況で多項分布は用いられます。</span>
<span id="cb79-1507"><a href="#cb79-1507" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1508"><a href="#cb79-1508" aria-hidden="true" tabindex="-1"></a>多項分布の確率質量関数のパラメータはボールの色がk色の時、ボールを取り出す回数n、各色のボールを取り出す数x~1~～x~k~、各色のボールを取り出す確率p~1~p~k~の4種類となります。nはx~1~～x~k~の和となります。</span>
<span id="cb79-1509"><a href="#cb79-1509" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1510"><a href="#cb79-1510" aria-hidden="true" tabindex="-1"></a>$$Multinomial(n, x_{1}, x_{2}, \cdots x_{k}, p_{1}, p_{2}, \cdots p_{k})=\frac{n!}{x_{1}! \cdot x_{2}! \cdot \cdots \cdot x_{k}!} \cdot p_{1}^{x_{1}} \cdot p_{2}^{x_{2}} \cdot \cdots p_{k}^{x_{k}}$$</span>
<span id="cb79-1511"><a href="#cb79-1511" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1512"><a href="#cb79-1512" aria-hidden="true" tabindex="-1"></a>Rでは、<span class="in">`dmultinom`</span>関数で多項分布の確率質量関数を計算することができます。<span class="in">`dmultinom`</span>関数の引数はボールを取り出す回数nを表す<span class="in">`size`</span>、各色のボールを取り出す数のx~1~～x~k~をベクターで表した<span class="in">`x`</span>、各色のボールを取り出す確率であるp~1~p~k~を同じくベクターで表した<span class="in">`prob`</span>の3つとなります。</span>
<span id="cb79-1513"><a href="#cb79-1513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1514"><a href="#cb79-1514" aria-hidden="true" tabindex="-1"></a>また、多項分布の乱数を得る関数である<span class="in">`rmultinom`</span>関数も他の確率分布を示す乱数の関数とはやや使い方が異なります。<span class="in">`size`</span>と<span class="in">`prob`</span>の2つの引数を指定するのは上と同じですが、返り値は合計が<span class="in">`size`</span>で指定した数値となるボールの数k個の乱数です。<span class="in">`prob`</span>で確率を指定したそれぞれに対する値（ボールの数のようなもの）が第一引数（<span class="in">`n`</span>）で示した数だけ、列として並ぶ行列が返ってきます。</span>
<span id="cb79-1515"><a href="#cb79-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1516"><a href="#cb79-1516" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, filename="多項分布の関数"}</span></span>
<span id="cb79-1517"><a href="#cb79-1517" aria-hidden="true" tabindex="-1"></a><span class="in"># 0.1、0.3、0.6の確率で起こる事象がそれぞれ1、2、4回同時に起こる確率</span></span>
<span id="cb79-1518"><a href="#cb79-1518" aria-hidden="true" tabindex="-1"></a><span class="in">dmultinom(x = c(1, 2, 4), size = 7, prob = c(0.1, 0.3, 0.6))</span></span>
<span id="cb79-1519"><a href="#cb79-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1520"><a href="#cb79-1520" aria-hidden="true" tabindex="-1"></a><span class="in"># 足し合わせると20になるものが10個、列として返ってくる。</span></span>
<span id="cb79-1521"><a href="#cb79-1521" aria-hidden="true" tabindex="-1"></a><span class="in"># 行の上から、0.1、0.3、0.6の確率で現れている</span></span>
<span id="cb79-1522"><a href="#cb79-1522" aria-hidden="true" tabindex="-1"></a><span class="in">rmultinom(10, size=20, prob = c(0.1, 0.3, 0.6))</span></span>
<span id="cb79-1523"><a href="#cb79-1523" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1524"><a href="#cb79-1524" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1525"><a href="#cb79-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1526"><a href="#cb79-1526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE, filename="多項分布の乱数をグラフで示す"}</span></span>
<span id="cb79-1527"><a href="#cb79-1527" aria-hidden="true" tabindex="-1"></a><span class="in">rmnom &lt;- rmultinom(1000, size=20, prob = c(0.1, 0.3, 0.6))</span></span>
<span id="cb79-1528"><a href="#cb79-1528" aria-hidden="true" tabindex="-1"></a><span class="in">rmnom |&gt; </span></span>
<span id="cb79-1529"><a href="#cb79-1529" aria-hidden="true" tabindex="-1"></a><span class="in">  t() |&gt; </span></span>
<span id="cb79-1530"><a href="#cb79-1530" aria-hidden="true" tabindex="-1"></a><span class="in">  as_tibble() |&gt; </span></span>
<span id="cb79-1531"><a href="#cb79-1531" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(1:3) |&gt; </span></span>
<span id="cb79-1532"><a href="#cb79-1532" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = value, color = name, fill = name, alpha = 0.5))+</span></span>
<span id="cb79-1533"><a href="#cb79-1533" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_histogram(binwidth = 1, position = "identity")</span></span>
<span id="cb79-1534"><a href="#cb79-1534" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://quarto.org/">Quarto</a>を用いてこの本を作成しました</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"closeEffect":"zoom","descPosition":"bottom","selector":".lightbox","loop":false,"openEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>