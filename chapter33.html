<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R入門 - 33&nbsp; ネットワーク解析</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter34.html" rel="next">
<link href="./chapter32.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<link href="site_libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet">

<script src="site_libs/datatables-binding-0.33/datatables.js"></script>

<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.min.css" rel="stylesheet">

<link href="site_libs/dt-core-1.13.6/css/jquery.dataTables.extra.css" rel="stylesheet">

<script src="site_libs/dt-core-1.13.6/js/jquery.dataTables.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<script src="site_libs/d3-4.5.0/d3.min.js"></script>

<script src="site_libs/forceNetwork-binding-0.4/forceNetwork.js"></script>

<script src="site_libs/dendroNetwork-binding-0.4/dendroNetwork.js"></script>

<script src="site_libs/radialNetwork-binding-0.4/radialNetwork.js"></script>

<script src="site_libs/diagonalNetwork-binding-0.4/diagonalNetwork.js"></script>

<script src="site_libs/sankey-1/sankey.js"></script>

<script src="site_libs/sankeyNetwork-binding-0.4/sankeyNetwork.js"></script>

<link href="site_libs/vis-9.1.0/vis-network.min.css" rel="stylesheet">

<script src="site_libs/vis-9.1.0/vis-network.min.js"></script>

<script src="site_libs/visNetwork-binding-2.1.2/visNetwork.js"></script>



</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter31.html">アドバンスな手法</a></li><li class="breadcrumb-item"><a href="./chapter33.html"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ネットワーク解析</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R入門</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Rプログラミングの基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rのインストール</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rを使ってみよう</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">オブジェクトと変数・定数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">条件判断（Control structures）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">繰り返し文（Looping）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ライブラリ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">エラー処理（error handler）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">数値</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">文字列</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">因子（factor）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ベクター</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">リスト・データフレーム・行列</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">データの読み込みと書き出し（I/O）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">データセット</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Rでのデータの取り扱い</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">apply関数群</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">tidyr・dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">日時データの取り扱い</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">オブジェクト指向とクラス</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">コーディング規約</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Rでのグラフ作成</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">グラフ作成：高レベルグラフィック関数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">グラフ作成：低レベルグラフィック関数とグラフィックパラメータ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">plotly</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">統計解析の基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">確率分布と乱数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">検定</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">相関と回帰</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">分類</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">教師なし学習</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter29.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">時系列分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">生存時間解析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">アドバンスな手法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">purrr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">地理空間情報</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter33.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ネットワーク解析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">R markdown・Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Shiny</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">おわりに</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ネットワーク解析とは" id="toc-ネットワーク解析とは" class="nav-link active" data-scroll-target="#ネットワーク解析とは"><span class="header-section-number">33.1</span> ネットワーク解析とは？</a></li>
  <li><a href="#rでのネットワーク解析のライブラリ" id="toc-rでのネットワーク解析のライブラリ" class="nav-link" data-scroll-target="#rでのネットワーク解析のライブラリ"><span class="header-section-number">33.2</span> Rでのネットワーク解析のライブラリ</a></li>
  <li><a href="#igraph" id="toc-igraph" class="nav-link" data-scroll-target="#igraph"><span class="header-section-number">33.3</span> igraph</a>
  <ul>
  <li><a href="#igraphでの用語" id="toc-igraphでの用語" class="nav-link" data-scroll-target="#igraphでの用語"><span class="header-section-number">33.3.1</span> igraphでの用語</a></li>
  <li><a href="#グラフを作成する" id="toc-グラフを作成する" class="nav-link" data-scroll-target="#グラフを作成する"><span class="header-section-number">33.3.2</span> グラフを作成する</a>
  <ul class="collapse">
  <li><a href="#edge-vectorから作成する" id="toc-edge-vectorから作成する" class="nav-link" data-scroll-target="#edge-vectorから作成する"><span class="header-section-number">33.3.2.1</span> edge vectorから作成する</a></li>
  <li><a href="#edge-listからグラフを作成する" id="toc-edge-listからグラフを作成する" class="nav-link" data-scroll-target="#edge-listからグラフを作成する"><span class="header-section-number">33.3.2.2</span> edge listからグラフを作成する</a></li>
  <li><a href="#adjacency-matrixからグラフを作成する" id="toc-adjacency-matrixからグラフを作成する" class="nav-link" data-scroll-target="#adjacency-matrixからグラフを作成する"><span class="header-section-number">33.3.2.3</span> adjacency matrixからグラフを作成する</a></li>
  <li><a href="#literalからグラフを作成する" id="toc-literalからグラフを作成する" class="nav-link" data-scroll-target="#literalからグラフを作成する"><span class="header-section-number">33.3.2.4</span> literalからグラフを作成する</a></li>
  <li><a href="#data.frameからグラフを作成する" id="toc-data.frameからグラフを作成する" class="nav-link" data-scroll-target="#data.frameからグラフを作成する"><span class="header-section-number">33.3.2.5</span> data.frameからグラフを作成する</a></li>
  <li><a href="#グラフの表示とattributes" id="toc-グラフの表示とattributes" class="nav-link" data-scroll-target="#グラフの表示とattributes"><span class="header-section-number">33.3.2.6</span> グラフの表示とattributes</a></li>
  <li><a href="#edgevertexをgraphから取り出す" id="toc-edgevertexをgraphから取り出す" class="nav-link" data-scroll-target="#edgevertexをgraphから取り出す"><span class="header-section-number">33.3.2.7</span> edge/vertexをgraphから取り出す</a></li>
  </ul></li>
  <li><a href="#ネットワークを描画する" id="toc-ネットワークを描画する" class="nav-link" data-scroll-target="#ネットワークを描画する"><span class="header-section-number">33.3.3</span> ネットワークを描画する</a>
  <ul class="collapse">
  <li><a href="#layout" id="toc-layout" class="nav-link" data-scroll-target="#layout"><span class="header-section-number">33.3.3.1</span> layout</a></li>
  </ul></li>
  </ul></li>
  <li><a href="#zacharys-karate-club" id="toc-zacharys-karate-club" class="nav-link" data-scroll-target="#zacharys-karate-club"><span class="header-section-number">33.4</span> Zachary’s karate club</a>
  <ul>
  <li><a href="#中心性" id="toc-中心性" class="nav-link" data-scroll-target="#中心性"><span class="header-section-number">33.4.1</span> 中心性</a>
  <ul class="collapse">
  <li><a href="#pagerank" id="toc-pagerank" class="nav-link" data-scroll-target="#pagerank"><span class="header-section-number">33.4.1.1</span> PageRank</a></li>
  <li><a href="#edge-betweenness" id="toc-edge-betweenness" class="nav-link" data-scroll-target="#edge-betweenness"><span class="header-section-number">33.4.1.2</span> Edge betweenness</a></li>
  </ul></li>
  <li><a href="#ネットワークのクラスターコミュニティ" id="toc-ネットワークのクラスターコミュニティ" class="nav-link" data-scroll-target="#ネットワークのクラスターコミュニティ"><span class="header-section-number">33.4.2</span> ネットワークのクラスター（コミュニティ）</a>
  <ul class="collapse">
  <li><a href="#クリークcliques" id="toc-クリークcliques" class="nav-link" data-scroll-target="#クリークcliques"><span class="header-section-number">33.4.2.1</span> クリーク（cliques）</a></li>
  </ul></li>
  <li><a href="#ネットワークの特徴を評価する" id="toc-ネットワークの特徴を評価する" class="nav-link" data-scroll-target="#ネットワークの特徴を評価する"><span class="header-section-number">33.4.3</span> ネットワークの特徴を評価する</a>
  <ul class="collapse">
  <li><a href="#edgeの密度edge-density" id="toc-edgeの密度edge-density" class="nav-link" data-scroll-target="#edgeの密度edge-density"><span class="header-section-number">33.4.3.1</span> edgeの密度（edge density）</a></li>
  <li><a href="#次数の分布" id="toc-次数の分布" class="nav-link" data-scroll-target="#次数の分布"><span class="header-section-number">33.4.3.2</span> 次数の分布</a></li>
  <li><a href="#その他の評価尺度vertexの距離ネットワークの直径" id="toc-その他の評価尺度vertexの距離ネットワークの直径" class="nav-link" data-scroll-target="#その他の評価尺度vertexの距離ネットワークの直径"><span class="header-section-number">33.4.3.3</span> その他の評価尺度：vertexの距離・ネットワークの直径</a></li>
  </ul></li>
  <li><a href="#経路を探索する" id="toc-経路を探索する" class="nav-link" data-scroll-target="#経路を探索する"><span class="header-section-number">33.4.4</span> 経路を探索する</a>
  <ul class="collapse">
  <li><a href="#vertex間の距離行列" id="toc-vertex間の距離行列" class="nav-link" data-scroll-target="#vertex間の距離行列"><span class="header-section-number">33.4.4.1</span> vertex間の距離行列</a></li>
  <li><a href="#最短距離の探索" id="toc-最短距離の探索" class="nav-link" data-scroll-target="#最短距離の探索"><span class="header-section-number">33.4.4.2</span> 最短距離の探索</a></li>
  </ul></li>
  <li><a href="#その他の分析について" id="toc-その他の分析について" class="nav-link" data-scroll-target="#その他の分析について"><span class="header-section-number">33.4.5</span> その他の分析について</a></li>
  <li><a href="#部グラフ" id="toc-部グラフ" class="nav-link" data-scroll-target="#部グラフ"><span class="header-section-number">33.4.6</span> 2部グラフ</a></li>
  </ul></li>
  <li><a href="#tidygraph" id="toc-tidygraph" class="nav-link" data-scroll-target="#tidygraph"><span class="header-section-number">33.5</span> tidygraph</a>
  <ul>
  <li><a href="#tidygraphの基礎とグラフの作成" id="toc-tidygraphの基礎とグラフの作成" class="nav-link" data-scroll-target="#tidygraphの基礎とグラフの作成"><span class="header-section-number">33.5.1</span> tidygraphの基礎とグラフの作成</a></li>
  <li><a href="#nodeedgeをactivateする" id="toc-nodeedgeをactivateする" class="nav-link" data-scroll-target="#nodeedgeをactivateする"><span class="header-section-number">33.5.2</span> node/edgeをactivateする</a></li>
  <li><a href="#focus" id="toc-focus" class="nav-link" data-scroll-target="#focus"><span class="header-section-number">33.5.3</span> focus</a></li>
  <li><a href="#morphunmorphとcrystalise" id="toc-morphunmorphとcrystalise" class="nav-link" data-scroll-target="#morphunmorphとcrystalise"><span class="header-section-number">33.5.4</span> morph・unmorphとcrystalise</a></li>
  <li><a href="#中心性-1" id="toc-中心性-1" class="nav-link" data-scroll-target="#中心性-1"><span class="header-section-number">33.5.5</span> 中心性</a></li>
  <li><a href="#nodeedgegraphの評価" id="toc-nodeedgegraphの評価" class="nav-link" data-scroll-target="#nodeedgegraphの評価"><span class="header-section-number">33.5.6</span> node・edge・graphの評価</a></li>
  <li><a href="#create_関数とplay_関数" id="toc-create_関数とplay_関数" class="nav-link" data-scroll-target="#create_関数とplay_関数"><span class="header-section-number">33.5.7</span> create_関数とplay_関数</a></li>
  <li><a href="#map_関数群" id="toc-map_関数群" class="nav-link" data-scroll-target="#map_関数群"><span class="header-section-number">33.5.8</span> map_関数群</a></li>
  </ul></li>
  <li><a href="#グラフ表示のライブラリ" id="toc-グラフ表示のライブラリ" class="nav-link" data-scroll-target="#グラフ表示のライブラリ"><span class="header-section-number">33.6</span> グラフ表示のライブラリ</a>
  <ul>
  <li><a href="#ggraph" id="toc-ggraph" class="nav-link" data-scroll-target="#ggraph"><span class="header-section-number">33.6.1</span> ggraph</a>
  <ul class="collapse">
  <li><a href="#ggraphのlayout" id="toc-ggraphのlayout" class="nav-link" data-scroll-target="#ggraphのlayout"><span class="header-section-number">33.6.1.1</span> ggraphのlayout</a></li>
  <li><a href="#nodeの表示" id="toc-nodeの表示" class="nav-link" data-scroll-target="#nodeの表示"><span class="header-section-number">33.6.1.2</span> nodeの表示</a></li>
  <li><a href="#edgeの表示" id="toc-edgeの表示" class="nav-link" data-scroll-target="#edgeの表示"><span class="header-section-number">33.6.1.3</span> edgeの表示</a></li>
  <li><a href="#faceting" id="toc-faceting" class="nav-link" data-scroll-target="#faceting"><span class="header-section-number">33.6.1.4</span> faceting</a></li>
  </ul></li>
  <li><a href="#networkd3" id="toc-networkd3" class="nav-link" data-scroll-target="#networkd3"><span class="header-section-number">33.6.2</span> networkD3</a>
  <ul class="collapse">
  <li><a href="#データの準備" id="toc-データの準備" class="nav-link" data-scroll-target="#データの準備"><span class="header-section-number">33.6.2.1</span> データの準備</a></li>
  <li><a href="#simplenetwork関数" id="toc-simplenetwork関数" class="nav-link" data-scroll-target="#simplenetwork関数"><span class="header-section-number">33.6.2.2</span> simpleNetwork関数</a></li>
  <li><a href="#forcenetwork" id="toc-forcenetwork" class="nav-link" data-scroll-target="#forcenetwork"><span class="header-section-number">33.6.2.3</span> forceNetwork</a></li>
  <li><a href="#dendronetwork" id="toc-dendronetwork" class="nav-link" data-scroll-target="#dendronetwork"><span class="header-section-number">33.6.2.4</span> dendroNetwork</a></li>
  <li><a href="#その他の関数" id="toc-その他の関数" class="nav-link" data-scroll-target="#その他の関数"><span class="header-section-number">33.6.2.5</span> その他の関数</a></li>
  </ul></li>
  <li><a href="#visnetwork" id="toc-visnetwork" class="nav-link" data-scroll-target="#visnetwork"><span class="header-section-number">33.6.3</span> visNetwork</a>
  <ul class="collapse">
  <li><a href="#visnetwork関数" id="toc-visnetwork関数" class="nav-link" data-scroll-target="#visnetwork関数"><span class="header-section-number">33.6.3.1</span> visNetwork関数</a></li>
  </ul></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter31.html">アドバンスな手法</a></li><li class="breadcrumb-item"><a href="./chapter33.html"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ネットワーク解析</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ネットワーク解析</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="ネットワーク解析とは" class="level2" data-number="33.1">
<h2 data-number="33.1" class="anchored" data-anchor-id="ネットワーク解析とは"><span class="header-section-number">33.1</span> ネットワーク解析とは？</h2>
<p><strong>ネットワーク解析</strong>とは、たくさんの人や都市、ウェブページなどの関係性（ネットワーク）を解析する一連の解析手法のことを指します。ここでのネットワークとは、例えば友人関係やメールの送付、電車の路線での駅同士のつながりや物資のやり取りなど、多岐に渡ります。生物学であれば代謝経路や遺伝子の誘導・抑制の関係性、会社であれば命令系統などもネットワークの例となります。これらのネットワークを表示し、特徴を抽出することでネットワークを評価する手法がネットワーク解析です。</p>
<p>ネットワークの基本は、人や都市などの要素と、そのつながりの2つです。ネットワーク解析では、人や都市などの要素のことを<strong>node</strong>や<strong>vertex</strong>、つながりのことを<strong>link</strong>や<strong>edge</strong>と呼びます。また、このネットワーク全体のことを<strong>graph</strong>と呼びます。</p>
<p>linkやedge、つまりネットワークのつながりには、大きく分けて2つのタイプがあります。一つは友人関係や線路での結合など、方向性が無いもので、もう一つはメールの送付や物資の輸送などの方向性があるものです。方向性のないつながりのことを<strong>無向（undirected）</strong>、方向性のあるつながりのことを<strong>有向（directed）</strong>と呼びます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./image/network_graph.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1" data-glightbox="description: .lightbox-desc-1" title="図1：ネットワークの用語"><img src="./image/network_graph.png" class="img-fluid figure-img" alt="図1：ネットワークの用語"></a></p>
<figcaption>図1：ネットワークの用語</figcaption>
</figure>
</div>
<p>主要なネットワーク解析の目的は以下の通りです。</p>
<ul>
<li>ネットワークを作成し、取り扱う</li>
<li>ネットワークを表示する</li>
<li>重要なnodeを抽出する（中心性）</li>
<li>nodeをグループ分けする（クラスター化）</li>
<li>グラフの特徴を評価する</li>
<li>nodeからnodeへの経路を探索する</li>
</ul>
<p>この他にランダムなグラフの作成、グラフの類似性の評価や検定を用いたネットワーク解析もあります。</p>
</section>
<section id="rでのネットワーク解析のライブラリ" class="level2" data-number="33.2">
<h2 data-number="33.2" class="anchored" data-anchor-id="rでのネットワーク解析のライブラリ"><span class="header-section-number">33.2</span> Rでのネットワーク解析のライブラリ</h2>
<p>Rでのネットワーク解析には、<a href="https://statnet.org/"><code>statnet</code></a><span class="citation" data-cites="statnet_bib1 statnet_bib2">(<a href="references.html#ref-statnet_bib1" role="doc-biblioref">Handcock et al. 2018</a>; <a href="references.html#ref-statnet_bib2" role="doc-biblioref">Hunter et al. 2008</a>)</span>系ライブラリと<a href="https://r.igraph.org/index.html"><code>igraph</code></a><span class="citation" data-cites="igraph_bib1 igraph_bib2">(<a href="references.html#ref-igraph_bib1" role="doc-biblioref">Csardi and Nepusz 2006</a>; <a href="references.html#ref-igraph_bib2" role="doc-biblioref">Csárdi et al. 2024</a>)</span>系ライブラリの2系統があります。どちらもネットワーク解析を行うために必要十分な機能を備えていますが、オブジェクトの取り扱いや関数名の特徴が異なります。どちらを使うかは好みで決めてしまってよいですが、<code>igraph</code>系の方が情報が多いため比較的使いやすいと思います。</p>
<p><code>statnet</code>は<code>sna</code><span class="citation" data-cites="sna_bib">(<a href="references.html#ref-sna_bib" role="doc-biblioref">Butts 2023</a>)</span>や<code>network</code><span class="citation" data-cites="network_bib1 network_bib2">(<a href="references.html#ref-network_bib1" role="doc-biblioref">Butts 2015</a>, <a href="references.html#ref-network_bib2" role="doc-biblioref">2008</a>)</span>などの一連のネットワーク解析用ライブラリの総称で、<code>tidyverse</code>のように<code>install.packages("statnet")</code>で一度にインストールし、<code>library(statnet)</code>で一度にロードすることができます。<code>statnet</code>はよくできたライブラリ群だと思うのですが、解説文（Documentation）があまり充実しておらず、なかなか手を付けにくい印象があります。</p>
<p><code>igraph</code>はネットワーク解析に必要な関数を一通り備えたライブラリで、RだけでなくpythonやMathematica、Cにも機能を提供しています。ネット上にも<code>igraph</code>の情報はたくさん落ちており、<code>statnet</code>よりは間口が広く学びやすいかと思います。ただし、<code>statnet</code>も<code>igraph</code>もたくさんの機能を備えたライブラリであり、学習コストは高めです。</p>
<p>この<code>igraph</code>、非常にたくさんの関数を備えたライブラリではあるのですが、関数の命名規則や引数の形が一定ではなく、そのまま使うとやや使いにくいです。また、<code>tidyverse</code>などのRの標準的なパッケージとの相性もあまりよくありません。この命名や<code>tidyverse</code>との整合性を取るためのライブラリが<code>tidygraph</code><span class="citation" data-cites="tidygraph_bib">(<a href="references.html#ref-tidygraph_bib" role="doc-biblioref">Pedersen 2024b</a>)</span>です。<code>tidygraph</code>はほぼ<code>igraph</code>のwrapper（関数名と引数の形を整えたもの）ですが、<code>igraph</code>をそのまま使うよりは使いやすく、パイプ演算子との相性も悪くありません。</p>
<p>この章ではまず<code>igraph</code>について説明し、その後に<code>tidygraph</code>と<code>igraph</code>の関数との対応を説明することにします。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ライブラリのロード</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(igraph, tidygraph, tidyverse)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="igraph" class="level2" data-number="33.3">
<h2 data-number="33.3" class="anchored" data-anchor-id="igraph"><span class="header-section-number">33.3</span> igraph</h2>
<section id="igraphでの用語" class="level3" data-number="33.3.1">
<h3 data-number="33.3.1" class="anchored" data-anchor-id="igraphでの用語"><span class="header-section-number">33.3.1</span> igraphでの用語</h3>
<p><code>igraph</code>では、ネットワーク全体を<strong>graph</strong>、ノードを<strong>vertex</strong>、リンクを<strong>edge</strong>と呼びます。それぞれをnetwork、node、linkと呼ぶことは基本的にありません（ただし、一部の関数の引数としてnodeを使っていたりします）。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./image/graph_at_igraph.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2" data-glightbox="description: .lightbox-desc-2" title="図2：igraphでの呼び方"><img src="./image/graph_at_igraph.png" class="img-fluid figure-img" alt="図2：igraphでの呼び方"></a></p>
<figcaption>図2：igraphでの呼び方</figcaption>
</figure>
</div>
</section>
<section id="グラフを作成する" class="level3" data-number="33.3.2">
<h3 data-number="33.3.2" class="anchored" data-anchor-id="グラフを作成する"><span class="header-section-number">33.3.2</span> グラフを作成する</h3>
<p><code>igraph</code>でグラフ、つまりネットワークの全体図を作成する方法はいくつかあります。</p>
<ul>
<li><strong>edge vector</strong>から作成する</li>
<li><strong>edge list</strong>から作成する</li>
<li><strong>adjacent matrix</strong>から作成する</li>
<li><strong>literal</strong>から作成する</li>
<li>formulaから作成する</li>
<li><strong>data.frame</strong>から作成する</li>
</ul>
<p>単純なグラフを作成するのであればedge vectorやedge listから、vertexやnodeに特性（<code>attribute</code>）を付けた複雑なグラフを作成するのであれば<code>data.frame</code>を用いるのが比較的簡単だと思います。</p>
<section id="edge-vectorから作成する" class="level4" data-number="33.3.2.1">
<h4 data-number="33.3.2.1" class="anchored" data-anchor-id="edge-vectorから作成する"><span class="header-section-number">33.3.2.1</span> edge vectorから作成する</h4>
<p>まずはベクターから作成する方法を説明します。</p>
<p>ベクターでネットワークを表現する場合には、ベクターに、edgeで繋ぎたいvertex2つをセットで記載します。例えば、<code>c("A", "B")</code>であれば、AとBというvertexをedgeで繋いだグラフとなります。edgeでつなぐvertexは必ず2つセットになりますので、もう一つedgeを設定したい場合には、1つ目のedgeを示す2つのvertexの後に、さらに2つのvertexを記載します。つまり、<code>c("A","B", "A","C")</code>といった形で表現することで、A-B、A-Cのedgeを持つ、A、B、Cのvertexを表現することができます。このようなベクターを<code>igraph</code>では<strong>edge vector</strong>と呼びます。</p>
<p>とは言っても、edge vectorはただのベクターですので、このedge vectorからグラフを作成する必要があります。グラフの作成には、<code>make_graph</code>関数を用います。edge vectorを<code>make_graph</code>関数の引数とすることで、グラフを作成することができます。</p>
<p>edge vectorでは、基本的に1つ目のvertexから2つ目のvertexの方向にedgeを繋ぐ、有向グラフが作成されます。無向グラフを作成する場合には、引数に<code>directed=FALSE</code>と指定します。</p>
<p>グラフを作成し表示すると、グラフの情報が示されます。このグラフの情報については後ほど説明します。</p>
<div class="cell" data-filenamae="edge vectorからグラフを作成する">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 有向グラフ</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">3</span>,</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="do">## IGRAPH 84409ba D--- 3 3 -- </span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="do">## + edges from 84409ba:</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1-&gt;2 2-&gt;3 3-&gt;1</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co"># 無向グラフ</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">3</span>,</span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>, <span class="dv">1</span>),</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">directed =</span> <span class="cn">FALSE</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a><span class="do">## IGRAPH 84418ca U--- 3 3 -- </span></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="do">## + edges from 84418ca:</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1--2 2--3 1--3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="グラフを描画する" class="level5" data-number="33.3.2.1.1">
<h5 data-number="33.3.2.1.1" class="anchored" data-anchor-id="グラフを描画する"><span class="header-section-number">33.3.2.1.1</span> グラフを描画する</h5>
<p>グラフを描画するには、先ほど作成したグラフを<code>plot</code>関数の引数に取ります。より複雑なグラフの描画方法については後ほど説明します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>グラフを表示する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>,</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    <span class="dv">2</span>, <span class="dv">3</span>,</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="dv">3</span>, <span class="dv">1</span>)</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="chapter33_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="edge-listからグラフを作成する" class="level4" data-number="33.3.2.2">
<h4 data-number="33.3.2.2" class="anchored" data-anchor-id="edge-listからグラフを作成する"><span class="header-section-number">33.3.2.2</span> edge listからグラフを作成する</h4>
<p><strong>edge list</strong>はedge vectorと似ており、edgeでつなぐvertexを1、2列目にそれぞれ記載した行列（edge list）を用いてグラフを作成する方法です。下の例では、A→B、B→C、C→Aのそれぞれのedgeを2列の行列で表現しています。edge listからグラフを作成する場合には、<code>graph_from_edgelist</code>関数を用います。<code>make_graph</code>関数と同様に、無向グラフを作成する場合には引数に<code>directed=FALSE</code>を指定します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>edge listからグラフを作成する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># byrow=TRUEを指定すると表記と一致してわかりやすい</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>edgelist_matrix <span class="ot">&lt;-</span> </span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="st">"A"</span>,<span class="st">"B"</span>, </span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"B"</span>,<span class="st">"C"</span>, </span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>      <span class="st">"C"</span>,<span class="st">"A"</span>),</span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="dv">2</span>,</span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow=</span><span class="cn">TRUE</span></span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a><span class="co"># edgelistを表示する</span></span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>edgelist_matrix</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2]</span></span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,] "A"  "B" </span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,] "B"  "C" </span></span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,] "C"  "A"</span></span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_from_edgelist</span>(edgelist_matrix) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="chapter33_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="adjacency-matrixからグラフを作成する" class="level4" data-number="33.3.2.3">
<h4 data-number="33.3.2.3" class="anchored" data-anchor-id="adjacency-matrixからグラフを作成する"><span class="header-section-number">33.3.2.3</span> adjacency matrixからグラフを作成する</h4>
<p>edge vector、edge listを用いないグラフの作成方法として、<strong>adjacency matrix（隣接行列）</strong>を用いる方法があります。隣接行列は行数と列数が同じ行列（正方行列）で、行名・列名をvertexの名前とした行列です。隣接行列では、行方向に見て0であればedgeなし、1以上であればedgeありとなります。例えば下の例では、Aの行を見ると、A列は0、B列に1、C列に1となっています。これは、AからAはedgeがなく、AからB、AからCへのedgeがあることを示しています。</p>
<p>隣接行列からグラフを作成するための関数が<code>graph_from_adjacency_matrix</code>です。<code>graph_from_adjacency_matrix</code>関数では、有向グラフ・無向グラフを指定する引数として<code>directed</code>ではなく、<code>mode</code>が用いられます。デフォルトは<code>mode="directed"</code>で、有向グラフが作成されます。無向グラフを作成する場合には<code>mode="undirected"</code>を指定します。</p>
<p>隣接行列には1以上の値を設定することができます。1以上の値を設定した場合には、そのedgeが複数、平行なedgeとして設定されます。ただし、<code>weighted=TRUE</code>とした場合には、edgeの数ではなく、edgeの<code>weight</code>という特性（attribute）の値が指定されることになります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>adjacency matrixからグラフを作成する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mat <span class="ot">&lt;-</span> </span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="co"># vertex名は行・列名で設定する</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(mat) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="co"># 隣接行列を表示する</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>mat</span>
<span id="cb5-16"><a href="#cb5-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   A B C</span></span>
<span id="cb5-17"><a href="#cb5-17" aria-hidden="true" tabindex="-1"></a><span class="do">## A 0 1 1</span></span>
<span id="cb5-18"><a href="#cb5-18" aria-hidden="true" tabindex="-1"></a><span class="do">## B 1 0 1</span></span>
<span id="cb5-19"><a href="#cb5-19" aria-hidden="true" tabindex="-1"></a><span class="do">## C 1 1 0</span></span>
<span id="cb5-20"><a href="#cb5-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-21"><a href="#cb5-21" aria-hidden="true" tabindex="-1"></a><span class="co"># 有向グラフ</span></span>
<span id="cb5-22"><a href="#cb5-22" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_from_adjacency_matrix</span>(mat) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="chapter33_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 無向グラフ</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_from_adjacency_matrix</span>(mat, <span class="at">mode =</span> <span class="st">"undirected"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-5-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="chapter33_files/figure-html/unnamed-chunk-5-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>上の例ではA、B、Cを繋ぐすべてのedgeが両方向になっていますが、片方向にする場合には、例えばA行B列を1、B行A列を0とします。このように設定することで、A→Bのみの有向グラフを作成することができます。また、対角成分（A行A列など）が1以上に設定されている場合には、AからAへの<strong>ループ</strong>となるedgeが設定されます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>adjacency matrixで方向を設定する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mat2 <span class="ot">&lt;-</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">matrix</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>,</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>      <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>,</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>mat2</span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a><span class="do">##      [,1] [,2] [,3]</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [1,]    0    1    0</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [2,]    0    0    1</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [3,]    1    0    0</span></span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 有向グラフ</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_from_adjacency_matrix</span>(mat2) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="chapter33_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="co"># vertex自身へのedge（ループ）</span></span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a><span class="fu">matrix</span>(</span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>,</span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>    <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>),</span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">nrow =</span> <span class="dv">3</span>,</span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">byrow =</span> <span class="cn">TRUE</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">graph_from_adjacency_matrix</span>() <span class="sc">|&gt;</span> </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-6-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="chapter33_files/figure-html/unnamed-chunk-6-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="literalからグラフを作成する" class="level4" data-number="33.3.2.4">
<h4 data-number="33.3.2.4" class="anchored" data-anchor-id="literalからグラフを作成する"><span class="header-section-number">33.3.2.4</span> literalからグラフを作成する</h4>
<p>グラフの表現として、<code>--</code>や<code>-+</code>などの記号を用いる、literalでもグラフを作成することができます。グラフの表現はそれぞれ以下の通りです。</p>
<table class="table">
<thead>
<tr class="header">
<th>literal</th>
<th>graph</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>A – B</td>
<td>A－B（無向グラフ）</td>
</tr>
<tr class="even">
<td>A -+ B</td>
<td>A→B</td>
</tr>
<tr class="odd">
<td>A +- B</td>
<td>A←B</td>
</tr>
<tr class="even">
<td>A ++ B</td>
<td>A↔︎B</td>
</tr>
<tr class="odd">
<td>A —-+ B</td>
<td>A→B</td>
</tr>
</tbody>
</table>
<p>要は、+側が矢印の先になるような記法がliteralです。矢印の反対側は-になります。左端と右端の-、+の間には-を複数挟むこともできます。無向グラフと有向グラフを同じグラフに含めることはできませんので、<code>--</code>を用いた場合にはすべてのedgeを<code>--</code>で表現する必要があります。</p>
<p>このliteralからグラフを作成する関数が<code>graph_from_literal</code>です。literalは文字列ではなく、そのまま引数として取り、edgeの表現として必要な分だけコンマで繋ぎます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>literalからグラフを作成する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_from_literal</span>(</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  A<span class="sc">-+</span>B, B<span class="sc">-+</span>C, C<span class="sc">-+</span>D, D<span class="sc">++</span>A </span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-7-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="chapter33_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="formulaでグラフを作成する" class="level5" data-number="33.3.2.4.1">
<h5 data-number="33.3.2.4.1" class="anchored" data-anchor-id="formulaでグラフを作成する"><span class="header-section-number">33.3.2.4.1</span> formulaでグラフを作成する</h5>
<p>また、このliteralに似た表現を用いてグラフを作成する方法もあります。引数としてベクターではなく、チルダ（<code>~</code>）で始まり、edgeとvertexを表現した<code>―</code>と<code>:</code>から成る式（formula）を用いる方法です。グラフの作成にはedge vectorの際に用いた<code>make_graph</code>を用います。<code>-</code>がedge、<code>:</code>は複数のvertexへの接続を表します。Rでは<code>:</code>の表現が数列（<code>1:3</code>など）と異なり混乱しやすいので、あまりお勧めできる表記方法ではないように思います。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>formulaを用いてグラフを作成する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="sc">~</span> A<span class="sc">-</span>B, B<span class="sc">-</span>C, C<span class="sc">-</span>A<span class="sc">:</span>D) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># C-A、C-Dを設定</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-8-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-10"><img src="chapter33_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="data.frameからグラフを作成する" class="level4" data-number="33.3.2.5">
<h4 data-number="33.3.2.5" class="anchored" data-anchor-id="data.frameからグラフを作成する"><span class="header-section-number">33.3.2.5</span> data.frameからグラフを作成する</h4>
<p>Rで最も頻繁に用いられるデータ型の一つである、データフレームを用いてもグラフを作成することができます。グラフの作成方法はedge listとよく似ていて、1列目と2列目にedgeで接続するvertexを表記したデータフレームを用います。列名はわかりやすいようにそれぞれ<code>from</code>と<code>to</code>にしておきます。このデータフレームがグラフ作成の基本となります。</p>
<p>また、データフレームを用いると、edgeやvertexに特性（<code>attributes</code>）を持たせたいときに便利です。例えば人間関係であれば、edgeにはメールのやり取りの回数であったり、交友関係の深さを設定することがあります。また、人間関係におけるvertex、つまり人には性別や年齢、所属する組織などを設定したい場合もあるでしょう。データフレームからグラフを作成すると、このような特性を比較的簡単にグラフに持たせることができます。</p>
<p>edgeに特性を持たせたい場合には、上記の<code>from</code>と<code>to</code>からなるデータフレームに列を追加します。edgeに設定される主な特性は<code>weight</code>です。上記のメールの数や交友関係の深さなどを<code>weight</code>として数値で設定します。</p>
<p>同じように、vertexにも特性を持たせることができます。edgeを示したデータフレームとは別に、vertexを表現するためのデータフレームを準備します。このデータフレームの1列目には、edgeのデータフレームに示したvertexをすべて含める必要があります。また、edgeのデータフレームに含まれないvertexを含めることもできます（edgeによる接続のない、独立したvertexが追加されます）。2列目以降には、vertexの特性、例えば人であれば年齢や性別の列を作成しておきます。</p>
<p>この2つのデータフレームを用いて、グラフを作成します。データフレームからグラフを作成するための関数が<code>graph_from_data_frame</code>です。<code>graph_from_data_frame</code>では、edgeを表現したデータフレームだけあればグラフを作成することができます。また、<code>vertices</code>引数にvertexを表現したデータフレームを設定することで、edgeとは別にvertexやその特性を設定することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>データフレームからグラフを作成する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edgeのデータフレーム（weightは特性）</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>d_edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">from =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">to =</span> <span class="fu">c</span>(<span class="st">"B"</span>, <span class="st">"C"</span>, <span class="st">"A"</span>),</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">weight =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="co"># vertexのデータフレーム（age、sexは特性）</span></span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>d_vertex <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">name =</span> <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"C"</span>),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">age =</span> <span class="fu">c</span>(<span class="dv">20</span>, <span class="dv">25</span>, <span class="dv">30</span>),</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">sex =</span> <span class="fu">c</span>(<span class="st">"F"</span>, <span class="st">"M"</span>, <span class="st">"F"</span>)</span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-14"><a href="#cb11-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-15"><a href="#cb11-15" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(d_edge, <span class="at">vertices =</span> d_vertex)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
attribute
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>attribute</code>については<a href="./chapter3.html">3章</a>や<a href="./chapter18.html">18章</a>で簡単に説明しています。ベクターの名前（<code>names</code>）や行列の次元（<code>dim</code>）は<code>attribute</code>として設定されており、関数から呼び出したり、演算に用いたりすることができます。<code>igraph</code>ではこの<code>attribute</code>を設定することで、vertexやedgeの性質をリストのように呼び出すことができます。</p>
</div>
</div>
</div>
</section>
<section id="グラフの表示とattributes" class="level4" data-number="33.3.2.6">
<h4 data-number="33.3.2.6" class="anchored" data-anchor-id="グラフの表示とattributes"><span class="header-section-number">33.3.2.6</span> グラフの表示とattributes</h4>
<p>ここまでで、グラフを作成する方法について述べてきました。作成したグラフは<code>igraph</code>クラスのオブジェクトで、表示させるとedgeの一覧と色々な情報が表示されます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>igraphクラス</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(g)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "igraph"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>igraphクラスのオブジェクトを表示する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="do">## IGRAPH 8487b93 DNW- 3 3 -- </span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="do">## + attr: name (v/c), age (v/n), sex (v/c), weight (e/n)</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a><span class="do">## + edges from 8487b93 (vertex names):</span></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] A-&gt;B B-&gt;C C-&gt;A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>この表示のうち、1行目の<code>DNW-</code>という部分はこのグラフの性質を示しています。始めの<code>D</code>はDirected（有向グラフ）の略です。無向グラフの場合には<code>U</code>（Undirected）と表示されます。</p>
<p>次の<code>N</code>はNamedの略で、vertexに名前（<code>name</code>）の特性（<code>attribute</code>）がついていることを示しています。その次の<code>W</code>はWeightedの略で、edgeに<code>weight</code>が設定されていることを示しています。vertexに名前がついていない場合には<code>N</code>の位置が<code>-</code>に、edgeに<code>weight</code>が設定されていない場合には<code>W</code>の位置が<code>―</code>になります。</p>
<p>最後の<code>―</code>は<strong>2部グラフ（Bipartite graph）</strong>であるかどうかを示しており、2部グラフの場合は<code>B</code>、2部グラフでない場合には<code>―</code>が表示されます。2部グラフについては後ほど説明します。</p>
<p>次の<code>3 3</code>の部分はvertexとedgeの数を示しており、前がvertexの数、後ろがedgeの数になります。</p>
<p>次の行の<code>+ attr</code>は設定されている<code>attribute</code>を示しています。<code>name</code>、<code>sex</code>には<code>(v/c)</code>と表示されています。この<code>(v/c)</code>はvertexの<code>attribute</code>であり、characterであることを示しています。<code>age</code>は<code>(v/n)</code>、つまりvertexの<code>attribute</code>でnumericであること、<code>weight</code>は<code>(e/n)</code>、edgeの<code>attribute</code>でnumericであることが表示されています。この他にグラフ自体にも<code>attribute</code>を設定することができます。グラフの<code>attribute</code>は<code>(g/c)</code>や<code>(g/n)</code>で示されます。</p>
<p>最後の行はedgeのリストです。この場合は有向グラフであり、A→B、B→C、C→Aの3つのedgeがあることが示されています。</p>
</section>
<section id="edgevertexをgraphから取り出す" class="level4" data-number="33.3.2.7">
<h4 data-number="33.3.2.7" class="anchored" data-anchor-id="edgevertexをgraphから取り出す"><span class="header-section-number">33.3.2.7</span> edge/vertexをgraphから取り出す</h4>
<p>グラフからedgeを取り出す場合には<code>E</code>関数、vertexを取り出す場合には<code>V</code>関数をそれぞれ用います。取り出したedgeやvertexには<code>attribute</code>が付いたままになっています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>vertex・edgeを取り出す</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="do">## + 3/3 edges from 8487b93 (vertex names):</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] A-&gt;B B-&gt;C C-&gt;A</span></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a><span class="do">## + 3/3 vertices, named, from 8487b93:</span></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] A B C</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>上記のように、グラフには<code>attribute</code>を設定することができます。<code>attribute</code>を設定することができるのは、graph全体と、edge、vertexの3種類です。それぞれの<code>attribute</code>は<code>graph_attr</code>、<code>edge_attr</code>、<code>vertex_attr</code>関数でそれぞれリストとして取り出すことができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>attributesを取り出す</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_attr</span>(g)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="do">## named list()</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_attr</span>(g)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a><span class="do">## $weight</span></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_attr</span>(g)</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $name</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "A" "B" "C"</span></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="do">## $age</span></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 20 25 30</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="do">## $sex</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "F" "M" "F"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>他のRの関数と同様に、<code>graph_attr</code>、<code>edge_attr</code>、<code>vertex_attr</code>関数にベクターやリストを代入することで、グラフに後から<code>attribute</code>を設定することもできます。代入により<code>attribute</code>を設定する場合には、関数の第一引数にグラフ、第二引数に<code>attribute</code>の名前を文字列で設定します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>attributeを設定する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">graph_attr</span>(g, <span class="st">"name"</span>) <span class="ot">&lt;-</span> <span class="st">"ABC"</span></span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_attr</span>(g, <span class="st">"degree"</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a><span class="fu">vertex_attr</span>(g, <span class="st">"height"</span>) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">167</span>, <span class="dv">182</span>, <span class="dv">153</span>)</span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a><span class="co"># attributeが増えている</span></span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a><span class="do">## IGRAPH 8487b93 DNW- 3 3 -- ABC</span></span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a><span class="do">## + attr: name (g/c), name (v/c), age (v/n), sex (v/c), height (v/n),</span></span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a><span class="do">## | weight (e/n), degree (e/n)</span></span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a><span class="do">## + edges from 8487b93 (vertex names):</span></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] A-&gt;B B-&gt;C C-&gt;A</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><code>attribute</code>の取り出しには、<code>graph_attr</code>、<code>edge_attr</code>、<code>vertex_attr</code>関数だけでなく、上記の<code>E</code>関数、<code>V</code>関数を用いることもできます。<code>E</code>関数、<code>V</code>関数の返り値には<code>attribute</code>がくっついているので、<code>E</code>関数、<code>V</code>関数の後に<code>$ + attribute名</code>をつけることで<code>attribute</code>をリストのように取り出すことができます。<code>attribute</code>を用いて演算を行う場合（たとえばネットワークを<code>plot</code>関数で表示するときのオプション設定に<code>attribute</code>を用いる場合など）には<code>E</code>、<code>V</code>関数からの<code>attribute</code>の呼び出しを用いることになります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>edgeのattributeをE関数から呼び出す</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edgeに指定したweightを呼び出し</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(g)<span class="sc">$</span>weight</span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3</span></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a><span class="co"># edgeの太さをweightに従い決める</span></span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">edge.width =</span> <span class="fu">E</span>(g)<span class="sc">$</span>weight)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-15-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="chapter33_files/figure-html/unnamed-chunk-15-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>同じように、vertexの<code>attribute</code>もノードの色調整などに用いることができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>vertexのattributeをV関数から呼び出す</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>sex</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "F" "M" "F"</span></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  g, </span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge.width =</span> <span class="fu">E</span>(g)<span class="sc">$</span>weight, </span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 男性のvertexはlightblue、女性のvertexはlightpinkで表示する</span></span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.color =</span> <span class="fu">if_else</span>(<span class="fu">V</span>(g)<span class="sc">$</span>sex <span class="sc">==</span> <span class="st">"M"</span>, <span class="st">"lightblue"</span>, <span class="st">"lightpink"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-16-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="chapter33_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ネットワークを描画する" class="level3" data-number="33.3.3">
<h3 data-number="33.3.3" class="anchored" data-anchor-id="ネットワークを描画する"><span class="header-section-number">33.3.3</span> ネットワークを描画する</h3>
<p>上記の通り、ネットワークを描画する場合には、<code>plot</code>関数の引数にグラフのオブジェクトを取ります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>plot関数でネットワークを表示する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-17-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="chapter33_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>ただし、これだけではedgeやvertexの特性をグラフに反映することはできませんし、場合によっては表示が見にくく、ネットワークの構造をきちんととらえることができないこともあります。</p>
<p><code>igraph</code>では、<code>plot</code>関数の引数や<code>layout</code>（vertexの位置を決める要素）を設定する一連の関数により、ネットワークを自由に描画できるようになっています。以下に<code>plot</code>関数の引数の一覧を示します。</p>
<div class="cell">
<div class="cell-output-display">
<div class="datatables html-widget html-fill-item" id="htmlwidget-71c9a76b5bfab47173f9" style="width:100%;height:auto;"></div>
<script type="application/json" data-for="htmlwidget-71c9a76b5bfab47173f9">{"x":{"filter":"none","vertical":false,"caption":"<caption>表1：plot.igraph関数の引数一覧<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47"],["axes","add","xlim","ylim","mark.groups","mark.shape","mark.col","mark.border","mark.expand","loop.size","vertex.size","vertex.color","vertex.frame.color","vertex.frame.width","vertex.shape","vertex.label","vertex.label.family","vertex.label.font","vertex.label.cex","vertex.label.dist","vertex.label.degree","vertex.label.color","edge.color","edge.width","edge.arrow.size","edge.arrow.width","edge.lty","edge.label","edge.label.family","edge.label.font","edge.label.cex","edge.label.color","edge.label.x","edge.label.y","edge.curved","edge.arrow.mode","edge.loop.angle","layout","margin","palette","rescale","asp","frame","main","sub","xlab","ylab"],["論理型","論理型","ベクター","ベクター","vertex idのベクターのリスト","数値ベクター（－1～1）","ベクター","ベクター","ベクター","数値","数値","文字列（\"red\"など）","文字列（\"red\"など）","数値","文字列（\"circle\"、\"square\"など）","文字列、NA","文字列","数値（2：太字、3：イタリックなど）","数値","数値","数値","文字列（\"red\"など）","文字列（\"red\"など）","数値","数値","数値","数値（2：破線、3：点線など）","文字列","文字列","数値（2：太字、3：イタリックなど）","数値","文字列（\"red\"など）","数値","数値","論理型、数値","数値","数値","関数","数値","文字列","論理型","数値","論理型","文字列","文字列","文字列、論理型","文字列"],["軸を表示するかどうか","デバイスに追加するか","x軸の範囲","y軸の範囲","vertexをグループ化する","vertexグループの表示形","vertexグループの色","vertexグループの周辺の色","vertexグループのサイズ","ループするedgeのサイズ","vertexのサイズ","vertexの色","vertexの周辺の色","vertexの周辺の太さ","vertexの形","vertexの文字ラベル","vertexの文字ラベルのフォント","vertexの文字ラベルの修飾","vertexの文字ラベルのサイズ","vertexの文字ラベルの位置","vertexの文字ラベルの角度","vertexの文字ラベルの色","edgeの色","edgeの太さ","矢印の大きさ","矢印の幅","edgeの線種","edgeの文字ラベル","edgeの文字ラベルのフォント","edgeの文字ラベルの修飾","edgeの文字ラベルのサイズ","edgeの文字ラベルの色","edgeの文字ラベルの位置（x方向）","edgeの文字ラベルの位置（y方向）","edgeを曲線にするかどうか","矢印の形","ループするedgeの角度","指定するlayout","図のマージンのサイズ","vertexの色のカラーパレット","サイズを調整するかどうか","アスペクトレシオ（縦横比）","フレームをつけるかどうか","メインタイトル","サブタイトル","x軸のタイトル","y軸のタイトル"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>引数名<\/th>\n      <th>設定する値<\/th>\n      <th>意味<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"columnDefs":[{"orderable":false,"targets":0},{"name":" ","targets":0},{"name":"引数名","targets":1},{"name":"設定する値","targets":2},{"name":"意味","targets":3}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>いくつかの引数を指定した例を以下に示します。いろいろ試してみることで自由にネットワークを表示できるようになるでしょう。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>vertexのグループ化</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">mark.groups=</span><span class="fu">list</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), <span class="fu">c</span>(<span class="dv">3</span>)), <span class="at">mark.col =</span> <span class="fu">c</span>(<span class="st">"red"</span>, <span class="st">"blue"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-19-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="chapter33_files/figure-html/unnamed-chunk-19-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="layout" class="level4" data-number="33.3.3.1">
<h4 data-number="33.3.3.1" class="anchored" data-anchor-id="layout"><span class="header-section-number">33.3.3.1</span> layout</h4>
<p>ネットワークを表示する際には、上記のような引数による細かな表示の変更の他に、ネットワーク自体の形を大きく変える<strong>layout</strong>というものを指定することができます。<code>plot</code>関数内の<code>layout</code>引数にlayoutを指定するための関数を指定することで、ネットワークの見た目を大きく変えることができます。また、layoutを指定するための関数を前もって宣言しておくことでもlayoutを変更することができます。各<code>layout</code>関数にはそれぞれ引数も設定されているので、同じlayout内で見た目を微調整することもできます。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">star</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">tree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">circle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-4" role="tab" aria-controls="tabset-1-4" aria-selected="false">nicely</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-5" role="tab" aria-controls="tabset-1-5" aria-selected="false">grid</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-6" role="tab" aria-controls="tabset-1-6" aria-selected="false">sphere</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-7" role="tab" aria-controls="tabset-1-7" aria-selected="false">randomly</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-8" role="tab" aria-controls="tabset-1-8" aria-selected="false">with_dh</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-9" role="tab" aria-controls="tabset-1-9" aria-selected="false">with_fr</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-10" role="tab" aria-controls="tabset-1-10" aria-selected="false">with_gem</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-11" role="tab" aria-controls="tabset-1-11" aria-selected="false">with_graphopt</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-12" role="tab" aria-controls="tabset-1-12" aria-selected="false">with_kk</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-13" role="tab" aria-controls="tabset-1-13" aria-selected="false">with_lgl</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-14" role="tab" aria-controls="tabset-1-14" aria-selected="false">with_mds</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-15" role="tab" aria-controls="tabset-1-15" aria-selected="false">with_sugiyama</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-16-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-16" role="tab" aria-controls="tabset-1-16" aria-selected="false">with_drl</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_as_star</span>(karate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-20-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="chapter33_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_as_tree</span>(karate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-21-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="chapter33_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_in_circle</span>(karate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-22-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="chapter33_files/figure-html/unnamed-chunk-22-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_nicely</span>(karate)) <span class="co"># plotのデフォルト</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-23-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="chapter33_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_on_grid</span>(karate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-24-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="chapter33_files/figure-html/unnamed-chunk-24-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_on_sphere</span>(karate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-25-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="chapter33_files/figure-html/unnamed-chunk-25-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_randomly</span>(karate))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-26-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="chapter33_files/figure-html/unnamed-chunk-26-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_dh</span>(karate)) <span class="co"># Davidson-Harel layout algorithm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-27-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="chapter33_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_fr</span>(karate)) <span class="co"># Fruchterman-Reingold layout algorithm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-28-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="chapter33_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_gem</span>(karate)) <span class="co"># GEM layout algorithm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-29-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-24"><img src="chapter33_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_graphopt</span>(karate)) <span class="co"># graphopt layout algorithm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="chapter33_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-12-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_kk</span>(karate)) <span class="co"># Kamada-Kawai layout algorithm</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-26"><img src="chapter33_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-13-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_lgl</span>(karate)) <span class="co"># Large Graph layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-32-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-27"><img src="chapter33_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-14-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_mds</span>(karate)) <span class="co"># multidimensional scaling</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-33-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-28"><img src="chapter33_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-15-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_sugiyama</span>(karate)) <span class="co"># Sugiyama graph layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-29"><img src="chapter33_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-16" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-16-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_drl</span>(karate)) <span class="co"># force-directed graph layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-35-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-30"><img src="chapter33_files/figure-html/unnamed-chunk-35-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ネットワークの表記と情報としての正しさ
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>ネットワークをグラフとしてプロットすると、何となくそのネットワークが分かったような気がします。ですので、ネットワーク解析においてプロットすること、ネットワークの表記は非常に重要です。一方で、上記のようにネットワークの表記の方法は様々であり、どのようなネットワークの表記がネットワークの正確な理解につながるのかは難しい問題です。</p>
<p>ネットワークに関する<a href="https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2018.01742/full">論文</a> <span class="citation" data-cites="Jones_2018_f_in_psycho_bib">(<a href="references.html#ref-Jones_2018_f_in_psycho_bib" role="doc-biblioref">Jones, Mair, and McNally 2018</a>)</span>では、ネットワークの表記において勘違いしやすい点が4点挙げられています。</p>
<ul>
<li>vertexの位置が近いとvertexの関係が密接で、遠いと密接ではないように思う</li>
<li>vertexの縦横の位置に意味があるように思う</li>
<li>ネットワークの中心に表記されているvertexが重要だと思う</li>
<li>2つのネットワークの図が全然違うと、ネットワークは全く異なっていると思う</li>
</ul>
<p>上記の4点は表記法により正しかったり間違っていたりするため、必ずしも表示されたネットワークがネットワークの正確な情報を伝えているというわけではありません。ネットワークの描画は乱数依存であるため、例えば下図のように同じグラフを2回表示するだけでも、グラフは同じ形には表記されません。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>同じネットワークを2度表示する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>karate <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>karate <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># seedを指定しないと見た目が変わる</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-31"><img src="chapter33_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>上記で紹介した<a href="https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2018.01742/full">論文</a>には、ネットワークの情報を正確に伝えるためのプロットの手法について記載されています。ご一読されるとよいでしょう。</p>
</div>
</div>
</div>
</section>
</section>
</section>
<section id="zacharys-karate-club" class="level2" data-number="33.4">
<h2 data-number="33.4" class="anchored" data-anchor-id="zacharys-karate-club"><span class="header-section-number">33.4</span> Zachary’s karate club</h2>
<p>上記のlayoutでは、<code>karate &lt;- make_graph("Zachary")</code>という形で<code>igraph</code>に登録されているネットワークである、<code>"Zachary"</code>を読み込んで利用しています。<code>make_graph</code>関数では、<code>igraph</code>に登録されているネットワーク（<a href="https://r.igraph.org/reference/make_graph.html">Notable graphs</a>）を文字列で指定することで、<code>igraph</code>に保存されているネットワークを呼び出すことができます。</p>
<p>これらのネットワークの中でも有名なものの一つが上記の<a href="https://en.wikipedia.org/wiki/Zachary%27s_karate_club"><strong>Zachary’s karate club</strong></a>です。この空手クラブのデータは<a href="https://www.researchgate.net/publication/248519014_An_Information_Flow_Model_for_Conflict_and_Fission_in_Small_Groups1">Zachary et al.&nbsp;(1976)</a><span class="citation" data-cites="Zachary1976">(<a href="references.html#ref-Zachary1976" role="doc-biblioref">Zachary 1976</a>)</span>で人類学的な解析に用いられたもので、アメリカの大学の空手クラブにおけるメンバー間の交友関係をネットワークとしたものです。この空手クラブ、1番と34番のメンバーを中心とした2つのグループに別れたことで有名で、ネットワークについての教科書などで頻出するデータとなっています。</p>
<p>以下のネットワーク図はメンバーが分離した後の2グループを色で示したものになっています。次に説明する中心性の評価、クラスターの評価にはこのデータを用います。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>Zachary`s karate club</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 2つに分離した後のグループ</span></span>
<span id="cb38-4"><a href="#cb38-4" aria-hidden="true" tabindex="-1"></a>karate_col <span class="ot">&lt;-</span> </span>
<span id="cb38-5"><a href="#cb38-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">c</span>(<span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, </span>
<span id="cb38-6"><a href="#cb38-6" aria-hidden="true" tabindex="-1"></a>    <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, </span>
<span id="cb38-7"><a href="#cb38-7" aria-hidden="true" tabindex="-1"></a>    <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, </span>
<span id="cb38-8"><a href="#cb38-8" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"A"</span>, </span>
<span id="cb38-9"><a href="#cb38-9" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B"</span>, <span class="st">"A"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>,</span>
<span id="cb38-10"><a href="#cb38-10" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, </span>
<span id="cb38-11"><a href="#cb38-11" aria-hidden="true" tabindex="-1"></a>    <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>)</span>
<span id="cb38-12"><a href="#cb38-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-13"><a href="#cb38-13" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">1</span>)</span>
<span id="cb38-14"><a href="#cb38-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb38-15"><a href="#cb38-15" aria-hidden="true" tabindex="-1"></a>  karate, </span>
<span id="cb38-16"><a href="#cb38-16" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.color=</span></span>
<span id="cb38-17"><a href="#cb38-17" aria-hidden="true" tabindex="-1"></a>    <span class="fu">if_else</span>(</span>
<span id="cb38-18"><a href="#cb38-18" aria-hidden="true" tabindex="-1"></a>      karate_col <span class="sc">==</span> <span class="st">"A"</span>, </span>
<span id="cb38-19"><a href="#cb38-19" aria-hidden="true" tabindex="-1"></a>      <span class="st">"lightblue"</span>, </span>
<span id="cb38-20"><a href="#cb38-20" aria-hidden="true" tabindex="-1"></a>      <span class="st">"orange"</span>), </span>
<span id="cb38-21"><a href="#cb38-21" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.size =</span> <span class="dv">25</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-37-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-32"><img src="chapter33_files/figure-html/unnamed-chunk-37-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="中心性" class="level3" data-number="33.4.1">
<h3 data-number="33.4.1" class="anchored" data-anchor-id="中心性"><span class="header-section-number">33.4.1</span> 中心性</h3>
<p>上記の通り、Zachary’s karate clubのネットワークは1と34のメンバーを中心に2つのグループに分離しました。上のネットワーク図を見ると、確かに1と34にはたくさんのedgeが接続しているように見えます。しかし、実際に1と34がネットワークで中心的な役割があるのかと言われると、グラフだけを見ていてもいまいちよくわかりません。</p>
<p>ネットワークで中心的でかつ重要なvertexを抽出するための手法の一つが、<strong>中心性（centrality）</strong>の評価です。ネットワーク解析でよく用いられる中心性は以下の4種類です。</p>
<ul>
<li><strong>次数中心性</strong>（degree centrality）</li>
<li><strong>媒介中心性</strong>（betweenness centrality）</li>
<li><strong>近接中心性</strong>（closeness centrality）</li>
<li><strong>固有ベクトル中心性</strong>（eigenvector centrality）</li>
</ul>
<p><strong>次数中心性</strong>は最も単純な中心性で、そのvertexに接続しているedgeの数を表します。<code>igraph</code>では<code>degree</code>関数で次数中心性を計算することができます。</p>
<p><strong>媒介中心性</strong>はそのvertexが他のvertexの間に存在する頻度を表したものです。<code>igraph</code>では<code>betweenness</code>関数で媒介中心性を計算することができます。</p>
<p><strong>近接中心性</strong>はそのvertexから他のvertexまでの距離の和を反映したもので、<code>igraph</code>では<code>closeness</code>関数で近接中心性を計算することができます。</p>
<p><strong>固有ベクトル中心性</strong>は隣接行列から演算できる中心性の指標です。<code>igraph</code>では<code>eigen_centrality</code>関数で固有ベクトル中心性を計算することができます。</p>
<p>この他にも様々な中心性の指標はありますが、とりあえずこの4つを比較するとある程度は中心的なvertexを特定することができるでしょう。以下はkarate clubのネットワークでのvertexの中心性を評価したものです。いずれの中心性でも、1と34が高い値を示しており、この2人が重要なvertexであったことがわかります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>中心性の演算</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 次数中心性</span></span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a><span class="fu">degree</span>(karate)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 16  9 10  6  3  4  4  4  5  2  3  1  2  5  2  2  2  2  2  3  2  2  2  5  3</span></span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [26]  3  2  4  3  4  4  6 12 17</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-6"><a href="#cb39-6" aria-hidden="true" tabindex="-1"></a><span class="co"># 媒介中心性</span></span>
<span id="cb39-7"><a href="#cb39-7" aria-hidden="true" tabindex="-1"></a><span class="fu">betweenness</span>(karate)</span>
<span id="cb39-8"><a href="#cb39-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 231.0714286  28.4785714  75.8507937   6.2880952   0.3333333  15.8333333</span></span>
<span id="cb39-9"><a href="#cb39-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7]  15.8333333   0.0000000  29.5293651   0.4476190   0.3333333   0.0000000</span></span>
<span id="cb39-10"><a href="#cb39-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [13]   0.0000000  24.2158730   0.0000000   0.0000000   0.0000000   0.0000000</span></span>
<span id="cb39-11"><a href="#cb39-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [19]   0.0000000  17.1468254   0.0000000   0.0000000   0.0000000   9.3000000</span></span>
<span id="cb39-12"><a href="#cb39-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [25]   1.1666667   2.0277778   0.0000000  11.7920635   0.9476190   1.5428571</span></span>
<span id="cb39-13"><a href="#cb39-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [31]   7.6095238  73.0095238  76.6904762 160.5515873</span></span>
<span id="cb39-14"><a href="#cb39-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-15"><a href="#cb39-15" aria-hidden="true" tabindex="-1"></a><span class="co"># 近接中心性</span></span>
<span id="cb39-16"><a href="#cb39-16" aria-hidden="true" tabindex="-1"></a><span class="fu">closeness</span>(karate)</span>
<span id="cb39-17"><a href="#cb39-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 0.01724138 0.01470588 0.01694915 0.01408451 0.01149425 0.01162791</span></span>
<span id="cb39-18"><a href="#cb39-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] 0.01162791 0.01333333 0.01562500 0.01315789 0.01149425 0.01111111</span></span>
<span id="cb39-19"><a href="#cb39-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] 0.01123596 0.01562500 0.01123596 0.01123596 0.00862069 0.01136364</span></span>
<span id="cb39-20"><a href="#cb39-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [19] 0.01123596 0.01515152 0.01123596 0.01136364 0.01123596 0.01190476</span></span>
<span id="cb39-21"><a href="#cb39-21" aria-hidden="true" tabindex="-1"></a><span class="do">## [25] 0.01136364 0.01136364 0.01098901 0.01388889 0.01369863 0.01162791</span></span>
<span id="cb39-22"><a href="#cb39-22" aria-hidden="true" tabindex="-1"></a><span class="do">## [31] 0.01388889 0.01639344 0.01562500 0.01666667</span></span>
<span id="cb39-23"><a href="#cb39-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-24"><a href="#cb39-24" aria-hidden="true" tabindex="-1"></a><span class="co"># 固有ベクトル中心性</span></span>
<span id="cb39-25"><a href="#cb39-25" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen_centrality</span>(karate)<span class="sc">$</span>vector</span>
<span id="cb39-26"><a href="#cb39-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 0.95213237 0.71233514 0.84955420 0.56561431 0.20347148 0.21288383</span></span>
<span id="cb39-27"><a href="#cb39-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] 0.21288383 0.45789093 0.60906844 0.27499812 0.20347148 0.14156633</span></span>
<span id="cb39-28"><a href="#cb39-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] 0.22566382 0.60657439 0.27159396 0.27159396 0.06330461 0.24747879</span></span>
<span id="cb39-29"><a href="#cb39-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [19] 0.27159396 0.39616224 0.27159396 0.24747879 0.27159396 0.40207086</span></span>
<span id="cb39-30"><a href="#cb39-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [25] 0.15280670 0.15857597 0.20242852 0.35749923 0.35107297 0.36147301</span></span>
<span id="cb39-31"><a href="#cb39-31" aria-hidden="true" tabindex="-1"></a><span class="do">## [31] 0.46806481 0.51165649 0.82665886 1.00000000</span></span>
<span id="cb39-32"><a href="#cb39-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb39-33"><a href="#cb39-33" aria-hidden="true" tabindex="-1"></a><span class="co"># それぞれをプロットする</span></span>
<span id="cb39-34"><a href="#cb39-34" aria-hidden="true" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">2</span>))</span>
<span id="cb39-35"><a href="#cb39-35" aria-hidden="true" tabindex="-1"></a><span class="fu">degree</span>(karate) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb39-36"><a href="#cb39-36" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"次数中心性"</span>)</span>
<span id="cb39-37"><a href="#cb39-37" aria-hidden="true" tabindex="-1"></a><span class="fu">betweenness</span>(karate) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb39-38"><a href="#cb39-38" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"媒介中心性"</span>)</span>
<span id="cb39-39"><a href="#cb39-39" aria-hidden="true" tabindex="-1"></a><span class="fu">closeness</span>(karate) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb39-40"><a href="#cb39-40" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"近接中心性"</span>)</span>
<span id="cb39-41"><a href="#cb39-41" aria-hidden="true" tabindex="-1"></a><span class="fu">eigen_centrality</span>(karate)<span class="sc">$</span>vector <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb39-42"><a href="#cb39-42" aria-hidden="true" tabindex="-1"></a><span class="fu">title</span>(<span class="st">"固有ベクトル中心性"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-33"><img src="chapter33_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
</div>
<section id="pagerank" class="level4" data-number="33.4.1.1">
<h4 data-number="33.4.1.1" class="anchored" data-anchor-id="pagerank"><span class="header-section-number">33.4.1.1</span> PageRank</h4>
<p>上記の中心性と似た中心性の評価基準として、<strong>PageRank</strong>があります。PageRankは<a href="https://ja.wikipedia.org/wiki/%E3%83%9A%E3%83%BC%E3%82%B8%E3%83%A9%E3%83%B3%E3%82%AF">Googleが検索エンジンにおいてホームページの順位付けをする</a>のに用いた評価方法です。<code>igraph</code>では<code>page_rank</code>関数でPageRankの演算を行うことができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>PageRankによるvertexの評価</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="fu">page_rank</span>(karate)[[<span class="dv">1</span>]] <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-39-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-34"><img src="chapter33_files/figure-html/unnamed-chunk-39-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="edge-betweenness" class="level4" data-number="33.4.1.2">
<h4 data-number="33.4.1.2" class="anchored" data-anchor-id="edge-betweenness"><span class="header-section-number">33.4.1.2</span> Edge betweenness</h4>
<p>vertexの媒介性ではなく、edgeの媒介性、つまりvertexとvertexの経路の間にあるedgeを評価する方法がedge betweenness（辺の媒介性）です。edge betweennessが高い辺が切れてしまった場合には、ネットワークが大きく分断されることになります。以下の通り、karate clubでは1と32の間のedge betweennessが高く、ココが切れるとネットワークが2つに分離しやすくなります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>edge betweenness</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co"># edge betweennessを演算</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_betweenness</span>(karate)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 14.166667 43.638889 11.500000 29.333333 43.833333 43.833333 12.802381</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  [8] 41.648413 29.333333 33.000000 26.100000 23.770635 22.509524 25.770635</span></span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [15] 22.509524 71.392857 13.033333  4.333333  4.164286  6.959524 10.490476</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [22]  8.209524 10.490476 18.109524 12.583333 14.145238 23.108730 12.780952</span></span>
<span id="cb41-7"><a href="#cb41-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [29] 38.701587 17.280952  5.147619  4.280952  1.888095  6.900000  8.371429</span></span>
<span id="cb41-8"><a href="#cb41-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [36]  2.666667  1.666667  1.666667  2.666667 16.500000 16.500000  5.500000</span></span>
<span id="cb41-9"><a href="#cb41-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [43] 17.077778 22.684921 16.614286 38.049206 13.511111 19.488889 13.511111</span></span>
<span id="cb41-10"><a href="#cb41-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [50] 19.488889 13.511111 19.488889 33.313492 13.511111 19.488889 13.511111</span></span>
<span id="cb41-11"><a href="#cb41-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [57] 19.488889 11.094444  5.911111 12.533333 18.327778  3.733333  2.366667</span></span>
<span id="cb41-12"><a href="#cb41-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [64] 10.466667 22.500000 23.594444  2.542857 30.457143 17.097619  8.333333</span></span>
<span id="cb41-13"><a href="#cb41-13" aria-hidden="true" tabindex="-1"></a><span class="do">## [71] 13.780952 13.087302 16.722222  9.566667 15.042857 23.244444 29.953968</span></span>
<span id="cb41-14"><a href="#cb41-14" aria-hidden="true" tabindex="-1"></a><span class="do">## [78]  4.614286</span></span>
<span id="cb41-15"><a href="#cb41-15" aria-hidden="true" tabindex="-1"></a>edge <span class="ot">&lt;-</span> karate <span class="sc">|&gt;</span> <span class="fu">as_edgelist</span>() <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb41-16"><a href="#cb41-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb41-17"><a href="#cb41-17" aria-hidden="true" tabindex="-1"></a><span class="co"># Edge betweennessをグラフで表示</span></span>
<span id="cb41-18"><a href="#cb41-18" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(edge , <span class="at">betweenness =</span> <span class="fu">edge_betweenness</span>(karate)) <span class="sc">|&gt;</span> </span>
<span id="cb41-19"><a href="#cb41-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">edge =</span> <span class="fu">paste0</span>(V1, <span class="st">"-"</span>, V2)) <span class="sc">|&gt;</span> </span>
<span id="cb41-20"><a href="#cb41-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> edge, <span class="at">y =</span> betweenness))<span class="sc">+</span></span>
<span id="cb41-21"><a href="#cb41-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">3</span>)<span class="sc">+</span></span>
<span id="cb41-22"><a href="#cb41-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-40-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-35"><img src="chapter33_files/figure-html/unnamed-chunk-40-1.png" class="img-fluid figure-img" width="960"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="ネットワークのクラスターコミュニティ" class="level3" data-number="33.4.2">
<h3 data-number="33.4.2" class="anchored" data-anchor-id="ネットワークのクラスターコミュニティ"><span class="header-section-number">33.4.2</span> ネットワークのクラスター（コミュニティ）</h3>
<p>ネットワーク解析の目的の一つは、ネットワーク上のクラスター（コミュニティ）を明らかにすることです。karate clubの例であれば、2つのクラスターが存在することがあらかじめ分かっていれば、グループが割れないように対策することができたかもしれません。</p>
<p><a href="./chapter28.html">28章</a>で説明したようにクラスター解析には様々な方法があります。同じように、ネットワーク解析におけるクラスター解析にも様々なものがあります。<code>igraph</code>に登録されているクラスター解析だけで10種以上あります。どれがいいのかは時と場合によりますが、いずれも<code>igraph</code>では名前が<code>cluster_</code>から始まる一連の関数で演算することができます。</p>
<p>以下に<code>igraph</code>が備えているクラスター解析とkarate clubの分離後の2グループを比較したものを示します（一番左の<code>karate</code>が分離後のグループ）。グラフで左側に示したものほど<code>karate</code>との一致度が高くなっています。それぞれの関数には解析方法を調整するための引数が多数準備されているので、うまく調整することでより精度の高いクラスター解析を行うこともできます。したがって、必ずしも以下の例のように<code>cluster_fluid_communities</code>が優れているというわけではありません。時と場合により手法を使い分けるのが良いでしょう。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ネットワークのクラスターの演算</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a><span class="co"># クラスターを計算</span></span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a>karate_clus <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex =</span> <span class="fu">as.character</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">34</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(<span class="at">levels=</span><span class="dv">1</span><span class="sc">:</span><span class="dv">34</span>),</span>
<span id="cb42-4"><a href="#cb42-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">karate =</span> <span class="fu">if_else</span>(karate_col <span class="sc">==</span> <span class="st">"A"</span>, <span class="dv">1</span>, <span class="dv">2</span>),</span>
<span id="cb42-5"><a href="#cb42-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">edge_betweenness =</span> <span class="fu">cluster_edge_betweenness</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-6"><a href="#cb42-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">fast_greedy =</span> <span class="fu">cluster_fast_greedy</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-7"><a href="#cb42-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">fluid_communities =</span> <span class="fu">cluster_fluid_communities</span>(karate, <span class="at">no.of.communities =</span> <span class="dv">2</span>)<span class="sc">$</span>membership,</span>
<span id="cb42-8"><a href="#cb42-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">infomap =</span> <span class="fu">cluster_infomap</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-9"><a href="#cb42-9" aria-hidden="true" tabindex="-1"></a>  <span class="at">label_prop =</span> <span class="fu">cluster_label_prop</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-10"><a href="#cb42-10" aria-hidden="true" tabindex="-1"></a>  <span class="at">leading_eigen =</span> <span class="fu">cluster_leading_eigen</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-11"><a href="#cb42-11" aria-hidden="true" tabindex="-1"></a>  <span class="at">optimal =</span> <span class="fu">cluster_optimal</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-12"><a href="#cb42-12" aria-hidden="true" tabindex="-1"></a>  <span class="at">spinglass =</span> <span class="fu">cluster_spinglass</span>(karate)<span class="sc">$</span>membership,</span>
<span id="cb42-13"><a href="#cb42-13" aria-hidden="true" tabindex="-1"></a>  <span class="at">walktrap =</span> <span class="fu">cluster_walktrap</span>(karate)<span class="sc">$</span>membership</span>
<span id="cb42-14"><a href="#cb42-14" aria-hidden="true" tabindex="-1"></a>) </span>
<span id="cb42-15"><a href="#cb42-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-16"><a href="#cb42-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 同一クラスターのvertexを同じ色で表示する</span></span>
<span id="cb42-17"><a href="#cb42-17" aria-hidden="true" tabindex="-1"></a>karate_clus<span class="sc">|&gt;</span> </span>
<span id="cb42-18"><a href="#cb42-18" aria-hidden="true" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="dv">2</span><span class="sc">:</span><span class="dv">11</span>, <span class="at">names_to =</span> <span class="st">"type"</span>, <span class="at">values_to =</span> <span class="st">"cluster"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb42-19"><a href="#cb42-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>( <span class="co"># 見やすいように順番を入れ替え</span></span>
<span id="cb42-20"><a href="#cb42-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">type =</span> </span>
<span id="cb42-21"><a href="#cb42-21" aria-hidden="true" tabindex="-1"></a>      <span class="fu">fct_relevel</span>(</span>
<span id="cb42-22"><a href="#cb42-22" aria-hidden="true" tabindex="-1"></a>        type, </span>
<span id="cb42-23"><a href="#cb42-23" aria-hidden="true" tabindex="-1"></a>        <span class="fu">c</span>(</span>
<span id="cb42-24"><a href="#cb42-24" aria-hidden="true" tabindex="-1"></a>          <span class="st">"karate"</span>, </span>
<span id="cb42-25"><a href="#cb42-25" aria-hidden="true" tabindex="-1"></a>          <span class="st">"fluid_communities"</span>, </span>
<span id="cb42-26"><a href="#cb42-26" aria-hidden="true" tabindex="-1"></a>          <span class="st">"fast_greedy"</span>, </span>
<span id="cb42-27"><a href="#cb42-27" aria-hidden="true" tabindex="-1"></a>          <span class="st">"leading_eigen"</span>, </span>
<span id="cb42-28"><a href="#cb42-28" aria-hidden="true" tabindex="-1"></a>          <span class="st">"edge_betweenness"</span>, </span>
<span id="cb42-29"><a href="#cb42-29" aria-hidden="true" tabindex="-1"></a>          <span class="st">"walktrap"</span>, <span class="st">"infomap"</span>, </span>
<span id="cb42-30"><a href="#cb42-30" aria-hidden="true" tabindex="-1"></a>          <span class="st">"label_prop"</span>, </span>
<span id="cb42-31"><a href="#cb42-31" aria-hidden="true" tabindex="-1"></a>          <span class="st">"optimal"</span>, </span>
<span id="cb42-32"><a href="#cb42-32" aria-hidden="true" tabindex="-1"></a>          <span class="st">"spinglass"</span>))) <span class="sc">|&gt;</span> </span>
<span id="cb42-33"><a href="#cb42-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> type, <span class="at">y =</span> vertex, <span class="at">color =</span> <span class="fu">factor</span>(cluster), <span class="at">fill =</span> <span class="fu">factor</span>(cluster))) <span class="sc">+</span></span>
<span id="cb42-34"><a href="#cb42-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_tile</span>()<span class="sc">+</span></span>
<span id="cb42-35"><a href="#cb42-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">90</span>, <span class="at">vjust =</span> <span class="fl">0.5</span>, <span class="at">hjust =</span> <span class="dv">1</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-41-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-36"><img src="chapter33_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="クリークcliques" class="level4" data-number="33.4.2.1">
<h4 data-number="33.4.2.1" class="anchored" data-anchor-id="クリークcliques"><span class="header-section-number">33.4.2.1</span> クリーク（cliques）</h4>
<p>類似の解析方法として、クリーク（cliques、小集団）という、サブグループを見つけるための解析方法もあります。こちらはすべてのvertexをクラスターに所属させるようなものではなく、内部に存在する小集団（例えば、会社の一部署のメンバーなど）を求める手法となっています。<code>clique_num</code>関数はクリークに含まれる最大のvertex数を返す関数です。この<code>clique_num</code>の返り値を<code>cliques</code>関数の<code>min</code>引数に取ることで、クリークを比較的簡単に見つけることができます。下の例では、5人のクリークを2つ検出しています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>クリーク（clique）の演算</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">clique_num</span>(karate)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 5</span></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a><span class="fu">cliques</span>(karate, <span class="at">min =</span> <span class="dv">5</span>)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="do">## [[1]]</span></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="do">## + 5/34 vertices, from 859f39c:</span></span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  1  2  3  4 14</span></span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [[2]]</span></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="do">## + 5/34 vertices, from 859f39c:</span></span>
<span id="cb43-10"><a href="#cb43-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1 2 3 4 8</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="ネットワークの特徴を評価する" class="level3" data-number="33.4.3">
<h3 data-number="33.4.3" class="anchored" data-anchor-id="ネットワークの特徴を評価する"><span class="header-section-number">33.4.3</span> ネットワークの特徴を評価する</h3>
<section id="edgeの密度edge-density" class="level4" data-number="33.4.3.1">
<h4 data-number="33.4.3.1" class="anchored" data-anchor-id="edgeの密度edge-density"><span class="header-section-number">33.4.3.1</span> edgeの密度（edge density）</h4>
<p>ネットワーク解析では、ネットワーク全体を評価することもあります。代表的な特徴として、ネットワークの密度（edge density）があります。密度とは、現在のedgeの数の、そのvertex数で実現可能な最大のedgeの数に対する割合を指します。karateの例では、edgeの数は78ですが、34人のネットワークですべての人がedgeでつながっている場合、つまりedgeの最大数は<code>sum(33:1)</code>、つまり561となります。この78と561の比、<code>78/561</code>がedge densityとなります。</p>
<p><code>igraph</code>ではedge densityを<code>edge_density</code>関数で演算することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>edgeの密度（edge density）</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">edge_density</span>(karate) <span class="co"># edgeの密度</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1390374</span></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(karate) <span class="co"># 78 edge</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="do">## + 78/78 edges from 859f39c:</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1]  1-- 2  1-- 3  1-- 4  1-- 5  1-- 6  1-- 7  1-- 8  1-- 9  1--11  1--12</span></span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [11]  1--13  1--14  1--18  1--20  1--22  1--32  2-- 3  2-- 4  2-- 8  2--14</span></span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [21]  2--18  2--20  2--22  2--31  3-- 4  3-- 8  3--28  3--29  3--33  3--10</span></span>
<span id="cb44-8"><a href="#cb44-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [31]  3-- 9  3--14  4-- 8  4--13  4--14  5-- 7  5--11  6-- 7  6--11  6--17</span></span>
<span id="cb44-9"><a href="#cb44-9" aria-hidden="true" tabindex="-1"></a><span class="do">## [41]  7--17  9--31  9--33  9--34 10--34 14--34 15--33 15--34 16--33 16--34</span></span>
<span id="cb44-10"><a href="#cb44-10" aria-hidden="true" tabindex="-1"></a><span class="do">## [51] 19--33 19--34 20--34 21--33 21--34 23--33 23--34 24--26 24--28 24--33</span></span>
<span id="cb44-11"><a href="#cb44-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [61] 24--34 24--30 25--26 25--28 25--32 26--32 27--30 27--34 28--34 29--32</span></span>
<span id="cb44-12"><a href="#cb44-12" aria-hidden="true" tabindex="-1"></a><span class="do">## [71] 29--34 30--33 30--34 31--33 31--34 32--33 32--34 33--34</span></span>
<span id="cb44-13"><a href="#cb44-13" aria-hidden="true" tabindex="-1"></a><span class="fu">E</span>(<span class="fu">make_full_graph</span>(<span class="at">n=</span><span class="dv">34</span>)) <span class="co"># full graph(すべてのvertexがedgeでつながっている場合)：561 edge</span></span>
<span id="cb44-14"><a href="#cb44-14" aria-hidden="true" tabindex="-1"></a><span class="do">## + 561/561 edges from 866841b:</span></span>
<span id="cb44-15"><a href="#cb44-15" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1] 1-- 2 1-- 3 1-- 4 1-- 5 1-- 6 1-- 7 1-- 8 1-- 9 1--10 1--11 1--12 1--13</span></span>
<span id="cb44-16"><a href="#cb44-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  [13] 1--14 1--15 1--16 1--17 1--18 1--19 1--20 1--21 1--22 1--23 1--24 1--25</span></span>
<span id="cb44-17"><a href="#cb44-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  [25] 1--26 1--27 1--28 1--29 1--30 1--31 1--32 1--33 1--34 2-- 3 2-- 4 2-- 5</span></span>
<span id="cb44-18"><a href="#cb44-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  [37] 2-- 6 2-- 7 2-- 8 2-- 9 2--10 2--11 2--12 2--13 2--14 2--15 2--16 2--17</span></span>
<span id="cb44-19"><a href="#cb44-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  [49] 2--18 2--19 2--20 2--21 2--22 2--23 2--24 2--25 2--26 2--27 2--28 2--29</span></span>
<span id="cb44-20"><a href="#cb44-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  [61] 2--30 2--31 2--32 2--33 2--34 3-- 4 3-- 5 3-- 6 3-- 7 3-- 8 3-- 9 3--10</span></span>
<span id="cb44-21"><a href="#cb44-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  [73] 3--11 3--12 3--13 3--14 3--15 3--16 3--17 3--18 3--19 3--20 3--21 3--22</span></span>
<span id="cb44-22"><a href="#cb44-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  [85] 3--23 3--24 3--25 3--26 3--27 3--28 3--29 3--30 3--31 3--32 3--33 3--34</span></span>
<span id="cb44-23"><a href="#cb44-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  [97] 4-- 5 4-- 6 4-- 7 4-- 8 4-- 9 4--10 4--11 4--12 4--13 4--14 4--15 4--16</span></span>
<span id="cb44-24"><a href="#cb44-24" aria-hidden="true" tabindex="-1"></a><span class="do">## [109] 4--17 4--18 4--19 4--20 4--21 4--22 4--23 4--24 4--25 4--26 4--27 4--28</span></span>
<span id="cb44-25"><a href="#cb44-25" aria-hidden="true" tabindex="-1"></a><span class="do">## + ... omitted several edges</span></span>
<span id="cb44-26"><a href="#cb44-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-27"><a href="#cb44-27" aria-hidden="true" tabindex="-1"></a><span class="dv">78</span> <span class="sc">/</span> <span class="dv">561</span> <span class="co"># edge_densityの結果と同じ</span></span>
<span id="cb44-28"><a href="#cb44-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.1390374</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="次数の分布" class="level4" data-number="33.4.3.2">
<h4 data-number="33.4.3.2" class="anchored" data-anchor-id="次数の分布"><span class="header-section-number">33.4.3.2</span> 次数の分布</h4>
<p>次数（degree）、つまりそれぞれのvertexから出ているedgeの数もネットワークの構造を反映するパラメータとなります。次数をヒストグラムとして表示すれば、edgeの分布やその偏りを図示することができます。<code>igraph</code>では、<code>degree_distribution</code>関数で次数の頻度を計算することができます。また、この関数の返り値を<code>hist</code>関数の引数とすることで、次数のヒストグラムを表示することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>次数の分布</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">degree_distribution</span>(karate) <span class="sc">|&gt;</span> <span class="fu">hist</span>() <span class="co"># 次数の分布</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-44-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-37"><img src="chapter33_files/figure-html/unnamed-chunk-44-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="その他の評価尺度vertexの距離ネットワークの直径" class="level4" data-number="33.4.3.3">
<h4 data-number="33.4.3.3" class="anchored" data-anchor-id="その他の評価尺度vertexの距離ネットワークの直径"><span class="header-section-number">33.4.3.3</span> その他の評価尺度：vertexの距離・ネットワークの直径</h4>
<p>上記のedgeの密度や次数の分布に加えて、vertex間の平均距離や距離の分布、ネットワークの直径もネットワークの性質を表すパラメータとして用いられています。vertex間の距離の分布は<code>distance_table</code>関数で、ネットワークの直径は<code>girth</code>関数で計算することができます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean_distance</span>(karate) <span class="co"># vertex間の平均距離</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2.4082</span></span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="fu">distance_table</span>(karate) <span class="co"># vertex間の距離の要約</span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="do">## $res</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1]  78 265 137  73   8</span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="do">## $unconnected</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="fu">girth</span>(karate) <span class="co"># ネットワークの直径</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="do">## $girth</span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 3</span></span>
<span id="cb46-12"><a href="#cb46-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb46-13"><a href="#cb46-13" aria-hidden="true" tabindex="-1"></a><span class="do">## $circle</span></span>
<span id="cb46-14"><a href="#cb46-14" aria-hidden="true" tabindex="-1"></a><span class="do">## + 3/34 vertices, from 859f39c:</span></span>
<span id="cb46-15"><a href="#cb46-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 2 1 3</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
</section>
<section id="経路を探索する" class="level3" data-number="33.4.4">
<h3 data-number="33.4.4" class="anchored" data-anchor-id="経路を探索する"><span class="header-section-number">33.4.4</span> 経路を探索する</h3>
<p>ネットワーク解析では、上記のような中心性やクラスター以外に、vertexからvertexまでの経路を探索することも目的となります。karate clubでは経路を調べる意味はあまりありませんが、例えば鉄道の路線図や飛行機の航路であれば、最短経路や複数の経路を求める必要があるでしょう。</p>
<p>経路の探索の例として、路線図のデータを利用します。以下は奈良の鉄道（近鉄・JR）の路線のネットワーク（路線図）です。この路線図を利用して経路の探索を説明します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>奈良の路線図</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 駅同士の接続（d）と駅（vt）のデータを読み込む</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/chapter33_nara_stations.csv"</span>)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>vt <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/chapter33_nara_stations_vertex_list.csv"</span>)</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="co"># dとvtからネットワークを作成</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a>nara_stations <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(d, <span class="at">vertices =</span> vt, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ネットワークの表示</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a>nara_stations</span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="do">## IGRAPH 867f392 UN-- 119 120 -- </span></span>
<span id="cb47-11"><a href="#cb47-11" aria-hidden="true" tabindex="-1"></a><span class="do">## + attr: name (v/c), lat (v/n), lon (v/n), linename (v/c), company</span></span>
<span id="cb47-12"><a href="#cb47-12" aria-hidden="true" tabindex="-1"></a><span class="do">## | (v/c), linename (e/c), company (e/c)</span></span>
<span id="cb47-13"><a href="#cb47-13" aria-hidden="true" tabindex="-1"></a><span class="do">## + edges from 867f392 (vertex names):</span></span>
<span id="cb47-14"><a href="#cb47-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 奈良    --京終     京終    --帯解     帯解    --櫟本     櫟本    --天理    </span></span>
<span id="cb47-15"><a href="#cb47-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  [5] 天理    --長柄     長柄    --柳本     柳本    --巻向     巻向    --三輪    </span></span>
<span id="cb47-16"><a href="#cb47-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] 三輪    --桜井     桜井    --香久山   香久山  --畝傍     金橋    --高田    </span></span>
<span id="cb47-17"><a href="#cb47-17" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] 王寺    --畠田     畠田    --志都美   志都美  --香芝     香芝    --JR五位堂</span></span>
<span id="cb47-18"><a href="#cb47-18" aria-hidden="true" tabindex="-1"></a><span class="do">## [17] JR五位堂--高田     高田    --大和新庄 大和新庄--御所     御所    --玉手    </span></span>
<span id="cb47-19"><a href="#cb47-19" aria-hidden="true" tabindex="-1"></a><span class="do">## [21] 玉手    --掖上     掖上    --吉野口   吉野口  --北宇智   北宇智  --五条    </span></span>
<span id="cb47-20"><a href="#cb47-20" aria-hidden="true" tabindex="-1"></a><span class="do">## [25] 五条    --大和二見 王寺    --三郷     王寺    --法隆寺   法隆寺  --大和小泉</span></span>
<span id="cb47-21"><a href="#cb47-21" aria-hidden="true" tabindex="-1"></a><span class="do">## + ... omitted several edges</span></span>
<span id="cb47-22"><a href="#cb47-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb47-23"><a href="#cb47-23" aria-hidden="true" tabindex="-1"></a><span class="co"># ネットワークを図にする</span></span>
<span id="cb47-24"><a href="#cb47-24" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(</span>
<span id="cb47-25"><a href="#cb47-25" aria-hidden="true" tabindex="-1"></a>  nara_stations, </span>
<span id="cb47-26"><a href="#cb47-26" aria-hidden="true" tabindex="-1"></a>  <span class="at">curved =</span> <span class="cn">TRUE</span>, </span>
<span id="cb47-27"><a href="#cb47-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">layout =</span> <span class="fu">cbind</span>(<span class="fu">V</span>(nara_stations)<span class="sc">$</span>lon, <span class="fu">V</span>(nara_stations)<span class="sc">$</span>lat), </span>
<span id="cb47-28"><a href="#cb47-28" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.label =</span> <span class="cn">NA</span>, </span>
<span id="cb47-29"><a href="#cb47-29" aria-hidden="true" tabindex="-1"></a>  <span class="at">vertex.size =</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-46-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-38"><img src="chapter33_files/figure-html/unnamed-chunk-46-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="vertex間の距離行列" class="level4" data-number="33.4.4.1">
<h4 data-number="33.4.4.1" class="anchored" data-anchor-id="vertex間の距離行列"><span class="header-section-number">33.4.4.1</span> vertex間の距離行列</h4>
<p>vertex間の距離は行列の形で、<code>distances</code>関数を用いることで求めることができます。到達可能性が無いvertexとの間の距離は無限大（<code>Inf</code>）となります。<code>distances</code>関数には到着点（<code>to</code>引数）を設定することができます。</p>
<p>奈良の鉄道路線の例であれば、田原本線は独立線になっている（王寺-新王寺、西田原本-田原本間は路線としては接続しておらず、別の駅）ので、奈良へは到達不可能（<code>Inf</code>）になっています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>vertex間の距離を調べる</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">distances</span>(nara_stations)[<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>]</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="do">##      奈良 京終 帯解 櫟本 天理</span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="do">## 奈良    0    1    2    3    4</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="do">## 京終    1    0    1    2    3</span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="do">## 帯解    2    1    0    1    2</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="do">## 櫟本    3    2    1    0    1</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="do">## 天理    4    3    2    1    0</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="fu">distances</span>(nara_stations, <span class="at">to=</span><span class="st">"奈良"</span>)[<span class="dv">40</span><span class="sc">:</span><span class="dv">50</span>,]</span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="do">##   信貴山下     新王寺     大輪田   佐味田川       池部       箸尾       但馬 </span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="do">##          5        Inf        Inf        Inf        Inf        Inf        Inf </span></span>
<span id="cb48-11"><a href="#cb48-11" aria-hidden="true" tabindex="-1"></a><span class="do">##       黒田     高の原       平城 大和西大寺 </span></span>
<span id="cb48-12"><a href="#cb48-12" aria-hidden="true" tabindex="-1"></a><span class="do">##        Inf         15         14         13</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="最短距離の探索" class="level4" data-number="33.4.4.2">
<h4 data-number="33.4.4.2" class="anchored" data-anchor-id="最短距離の探索"><span class="header-section-number">33.4.4.2</span> 最短距離の探索</h4>
<p>最短距離の探索には、<code>shortest_paths</code>関数、<code>all_shortest_paths</code>関数を用います。<code>shortest_paths</code>関数は最短距離を1つだけ、<code>all_shortest_paths</code>関数はすべての最短距離を返します。路線ではなかなか最短距離が複数存在する場合はありませんので、下の例では<code>all_shortest_paths</code>は一つの経路を返しています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>最短距離の探索</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">shortest_paths</span>(nara_stations, <span class="at">from =</span> <span class="st">"奈良"</span>, <span class="at">to =</span> <span class="st">"吉野口"</span>)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">## $vpath</span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="do">## $vpath[[1]]</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="do">## + 15/119 vertices, named, from 867f392:</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 奈良     郡山     大和小泉 法隆寺   王寺     畠田     志都美   香芝    </span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="do">##  [9] JR五位堂 高田     大和新庄 御所     玉手     掖上     吉野口  </span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="do">## $epath</span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="do">## NULL</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a><span class="do">## $predecessors</span></span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a><span class="do">## NULL</span></span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a><span class="do">## $inbound_edges</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a><span class="do">## NULL</span></span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a><span class="fu">all_shortest_paths</span>(nara_stations, <span class="at">from =</span> <span class="st">"桜井"</span>, <span class="at">to =</span> <span class="st">"吉野口"</span>)</span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a><span class="do">## $vpaths</span></span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a><span class="do">## $vpaths[[1]]</span></span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a><span class="do">## + 13/119 vertices, named, from 867f392:</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 桜井       大福       耳成       大和八木   八木西口   畝傍御陵前</span></span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] 橿原神宮前 岡寺       飛鳥       壺阪山     市尾       葛        </span></span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] 吉野口    </span></span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a><span class="do">## $epaths</span></span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a><span class="do">## $epaths[[1]]</span></span>
<span id="cb49-28"><a href="#cb49-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 112 111 110  65  66  67  77  78  79  80  81  82</span></span>
<span id="cb49-29"><a href="#cb49-29" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-30"><a href="#cb49-30" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-31"><a href="#cb49-31" aria-hidden="true" tabindex="-1"></a><span class="do">## $nrgeo</span></span>
<span id="cb49-32"><a href="#cb49-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1] 1 1 1 1 1 1 1 1 1 1 1 0 0 0 0 0 0 0 0 0 0 0 1 0 0 0 1 1 1 0 0 0 0 0 0 0 0</span></span>
<span id="cb49-33"><a href="#cb49-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  [38] 0 0 0 0 0 0 0 0 0 0 0 0 0 0 1 1 1 1 1 2 1 1 1 1 1 1 1 1 0 0 0 1 1 1 1 1 1</span></span>
<span id="cb49-34"><a href="#cb49-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  [75] 1 1 1 1 1 1 0 0 0 0 0 0 0 0 1 0 0 0 0 0 0 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1</span></span>
<span id="cb49-35"><a href="#cb49-35" aria-hidden="true" tabindex="-1"></a><span class="do">## [112] 1 0 1 0 0 0 0 1</span></span>
<span id="cb49-36"><a href="#cb49-36" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-37"><a href="#cb49-37" aria-hidden="true" tabindex="-1"></a><span class="do">## $res</span></span>
<span id="cb49-38"><a href="#cb49-38" aria-hidden="true" tabindex="-1"></a><span class="do">## $res[[1]]</span></span>
<span id="cb49-39"><a href="#cb49-39" aria-hidden="true" tabindex="-1"></a><span class="do">## + 13/119 vertices, named, from 867f392:</span></span>
<span id="cb49-40"><a href="#cb49-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] 桜井       大福       耳成       大和八木   八木西口   畝傍御陵前</span></span>
<span id="cb49-41"><a href="#cb49-41" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] 橿原神宮前 岡寺       飛鳥       壺阪山     市尾       葛        </span></span>
<span id="cb49-42"><a href="#cb49-42" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] 吉野口</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>距離行列・最短距離の探索には、幅優先探索（breadth-first search）や深さ優先探索（depth-first search）などのアルゴリズムが用いられています。また、edgeの特性に<code>weight</code>を設定していた場合には、<code>weight</code>を考慮した評価を行うこともできます。</p>
</section>
</section>
<section id="その他の分析について" class="level3" data-number="33.4.5">
<h3 data-number="33.4.5" class="anchored" data-anchor-id="その他の分析について"><span class="header-section-number">33.4.5</span> その他の分析について</h3>
<p>ネットワーク解析には、上記に示した解析方法に加えて、ランダムなグラフの作成、グラフの類似性や検定を用いたネットワーク解析などがあります。</p>
<p><code>igraph</code>ではランダムなグラフの作成には関数名が<code>sample_</code>から始まる一連の関数が、一定の構造を持つグラフの作成には<code>make_ring</code>や<code>make_star</code>関数などの関数が備わっています。ランダムなグラフの作成では、それぞれの関数に設定されたアルゴリズムに従いネットワークが作成されます。また、<code>make_</code>関数でのグラフ作成では、一定の構造を持つグラフが作成されるため、グラフ作成時の基礎構造を準備するのに便利です。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ランダム・一定の構造を持つグラフの作成</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">sample_tree</span>(<span class="at">n =</span> <span class="dv">30</span>) <span class="co"># ランダムな木構造型ネットワークを作成</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(g, <span class="at">layout=</span><span class="fu">layout_as_tree</span>(g))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-49-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-39"><img src="chapter33_files/figure-html/unnamed-chunk-49-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>とは言っても<code>igraph</code>に登録されている<code>sample_</code>関数だけでも10種以上あり、それぞれのアルゴリズムも複雑です。また、グラフの類似性や検定を用いたネットワーク解析に関しては<code>igraph</code>のみでは対応できず、別のライブラリ（<code>statnet</code>、<code>sna</code>）が必要となります。上記のネットワーク解析に関しても詳細な説明は加えていませんので、詳細を理解したい方は教科書（<a href="https://www.amazon.co.jp/%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E5%88%86%E6%9E%90-%E7%AC%AC2%E7%89%88-R%E3%81%A7%E5%AD%A6%E3%81%B6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B5%E3%82%A4%E3%82%A8%E3%83%B3%E3%82%B9-%E9%88%B4%E6%9C%A8-%E5%8A%AA/dp/4320113152">Rで学ぶデータサイエンス ネットワーク分析</a>）を一読されることをおすすめいたします。</p>
<p>以下に<code>sample_</code>と<code>make_</code>関数の一覧を示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">sample_bipartite</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">sample_gnp</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">sample_correlated_gnp</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">sample_degseq</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">sample_dot_product</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">sample_fitness</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">sample_fitness_pl</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-8" role="tab" aria-controls="tabset-2-8" aria-selected="false">sample_gnm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-9" role="tab" aria-controls="tabset-2-9" aria-selected="false">sample_grg</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-10" role="tab" aria-controls="tabset-2-10" aria-selected="false">sample_growing</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-11" role="tab" aria-controls="tabset-2-11" aria-selected="false">sample_islands</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-12" role="tab" aria-controls="tabset-2-12" aria-selected="false">sample_k_regular</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-13" role="tab" aria-controls="tabset-2-13" aria-selected="false">sample_last_cit</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-14" role="tab" aria-controls="tabset-2-14" aria-selected="false">sample_pa</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-15" role="tab" aria-controls="tabset-2-15" aria-selected="false">sample_pa_age</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-16-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-16" role="tab" aria-controls="tabset-2-16" aria-selected="false">sample_pref</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-17-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-17" role="tab" aria-controls="tabset-2-17" aria-selected="false">sample_sbm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-18-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-18" role="tab" aria-controls="tabset-2-18" aria-selected="false">sample_smallworld</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-19-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-19" role="tab" aria-controls="tabset-2-19" aria-selected="false">sample_traits_callaway</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-20-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-20" role="tab" aria-controls="tabset-2-20" aria-selected="false">sample_tree</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ランダムな2部グラフを作成する</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_bipartite</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="at">layout =</span> layout_as_bipartite) <span class="co"># pはedgeの頻度</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-50-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-40"><img src="chapter33_files/figure-html/unnamed-chunk-50-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">sample_gnp</span>(<span class="dv">20</span>, <span class="at">p =</span> <span class="fl">0.3</span>) <span class="co"># Erdos-Renyi modelに従い作成（20はvertex数、pはedgeの頻度）</span></span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>gr <span class="sc">|&gt;</span> <span class="fu">plot</span>() </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-51-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-41"><img src="chapter33_files/figure-html/unnamed-chunk-51-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>gr <span class="sc">|&gt;</span>  <span class="fu">sample_correlated_gnp</span>(<span class="at">corr =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># edgeをランダムに付け加え・取り除く</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-52-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-42"><img src="chapter33_files/figure-html/unnamed-chunk-52-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_degseq</span>(<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">10</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># nodeのdegree（次数、この例では4）を指定したグラフ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-53-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-43"><img src="chapter33_files/figure-html/unnamed-chunk-53-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">nrow =</span> <span class="dv">9</span>) <span class="co"># matrixを引数に取る</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_dot_product</span>(ma) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># 各列がvertexになる</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-54-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-44"><img src="chapter33_files/figure-html/unnamed-chunk-54-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_fitness</span>(<span class="dv">10</span>, <span class="fu">runif</span>(<span class="dv">10</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-55-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-45"><img src="chapter33_files/figure-html/unnamed-chunk-55-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_fitness_pl</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="at">exponent.out =</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、edgeの数、degreeの分布を指定する引数</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-56-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-46"><img src="chapter33_files/figure-html/unnamed-chunk-56-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_gnm</span>(<span class="dv">10</span>, <span class="dv">15</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、nodeの数を指定</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-57-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-47"><img src="chapter33_files/figure-html/unnamed-chunk-57-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_grg</span>(<span class="dv">10</span>, <span class="fl">0.85</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、radiusを指定</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-58-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-48"><img src="chapter33_files/figure-html/unnamed-chunk-58-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_growing</span>(<span class="dv">10</span>, <span class="at">m =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、ランダムに追加するedgeの数</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-59-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-49"><img src="chapter33_files/figure-html/unnamed-chunk-59-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_islands</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="fl">0.3</span>, <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># gnpでのvertex3つのグラフを5つつないだもの</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-60-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-50"><img src="chapter33_files/figure-html/unnamed-chunk-60-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-12-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_k_regular</span>(<span class="dv">10</span>, <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-61-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-51"><img src="chapter33_files/figure-html/unnamed-chunk-61-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-13-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_last_cit</span>(<span class="dv">10</span>, <span class="at">agebins =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-62-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-52"><img src="chapter33_files/figure-html/unnamed-chunk-62-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-14-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_pa</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-63-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-53"><img src="chapter33_files/figure-html/unnamed-chunk-63-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-15-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_pa_age</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-64-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-54"><img src="chapter33_files/figure-html/unnamed-chunk-64-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-16" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-16-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_pref</span>(<span class="dv">30</span>, <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-65-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-55"><img src="chapter33_files/figure-html/unnamed-chunk-65-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-17" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-17-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sbm</span>(<span class="dv">10</span>, <span class="at">pref.matrix =</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">9</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>), <span class="at">nrow=</span><span class="dv">3</span>), <span class="at">block.sizes =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">directed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-66-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-56"><img src="chapter33_files/figure-html/unnamed-chunk-66-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-18" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-18-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_smallworld</span>(<span class="at">dim =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">nei =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-67-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-57"><img src="chapter33_files/figure-html/unnamed-chunk-67-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-19" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-19-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_traits_callaway</span>(<span class="dv">10</span>, <span class="at">types =</span> <span class="dv">3</span>, <span class="at">edge.per.step =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-68-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-58"><img src="chapter33_files/figure-html/unnamed-chunk-68-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-2-20" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-20-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>g_tree <span class="ot">&lt;-</span> <span class="fu">sample_tree</span>(<span class="dv">20</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>g_tree <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="at">layout =</span> <span class="fu">layout_as_tree</span>(g_tree))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-69-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-59"><img src="chapter33_files/figure-html/unnamed-chunk-69-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">make_star</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">make_ring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">make_chordal_ring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">make_empty_graph</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">make_full_graph</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">make_lattice</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">make_tree</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_star</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mode =</span> <span class="st">"undirected"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-70-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-60"><img src="chapter33_files/figure-html/unnamed-chunk-70-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_ring</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-71-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-61"><img src="chapter33_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_chordal_ring</span>(<span class="dv">12</span>, <span class="at">w =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-72-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-62"><img src="chapter33_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_empty_graph</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-73-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-63"><img src="chapter33_files/figure-html/unnamed-chunk-73-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_full_graph</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-74-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-64"><img src="chapter33_files/figure-html/unnamed-chunk-74-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_lattice</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-75-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-65"><img src="chapter33_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_tree</span>(<span class="dv">16</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-76-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-66"><img src="chapter33_files/figure-html/unnamed-chunk-76-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="部グラフ" class="level3" data-number="33.4.6">
<h3 data-number="33.4.6" class="anchored" data-anchor-id="部グラフ"><span class="header-section-number">33.4.6</span> 2部グラフ</h3>
<p><strong>2部グラフ（Bipartite graph）</strong>とは、vertexが2つのタイプからなるグラフのことです。この2つのタイプとは、例えば人物と所属するクラブのような、互いに関係性はあるけれども同じタイプ同士のvertex間のつながりは無視できるようなものになります。</p>
<p>以下に2部グラフの例を示します。2部グラフを作成する場合、専用の関数（<code>make_bipartite_graph</code>）がありますが、この関数を用いるよりはedge listや<code>data.frame</code>からグラフを作成した後、vertexの<code>type</code>という<code>attribute</code>に論理型で2部のどちらであるか（上の例では人物を<code>TRUE</code>、所属するクラブを<code>FALSE</code>で指定）を指定する方が作成しやすいと思います。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>2部グラフ</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a><span class="co"># edgeを示したデータフレームを作成する</span></span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a>d_edge <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">club =</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"野球"</span>, <span class="st">"サッカー"</span>, <span class="st">"バスケットボール"</span>, <span class="st">"バレーボール"</span>), <span class="dv">52</span>, <span class="at">replace =</span> <span class="cn">TRUE</span>),</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">person =</span> <span class="fu">c</span>(LETTERS, LETTERS)</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">distinct</span>()</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a><span class="co"># データフレームから2部グラフを作成する</span></span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(d_edge, <span class="at">directed =</span> F)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a><span class="co"># typeのattributeを追加する（TRUE、FALSEで2部のどちらであるかを指定する）</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>type <span class="ot">&lt;-</span> <span class="fu">V</span>(g)<span class="sc">$</span>name <span class="sc">%in%</span> d_edge[,<span class="dv">2</span>]</span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>type</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] FALSE FALSE FALSE FALSE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span></span>
<span id="cb78-15"><a href="#cb78-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [13]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span></span>
<span id="cb78-16"><a href="#cb78-16" aria-hidden="true" tabindex="-1"></a><span class="do">## [25]  TRUE  TRUE  TRUE  TRUE  TRUE  TRUE</span></span>
<span id="cb78-17"><a href="#cb78-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-18"><a href="#cb78-18" aria-hidden="true" tabindex="-1"></a><span class="co"># 2部グラフ（UN-B、BがBipartiteの意味）になっている</span></span>
<span id="cb78-19"><a href="#cb78-19" aria-hidden="true" tabindex="-1"></a>g</span>
<span id="cb78-20"><a href="#cb78-20" aria-hidden="true" tabindex="-1"></a><span class="do">## IGRAPH 87759e8 UN-B 30 48 -- </span></span>
<span id="cb78-21"><a href="#cb78-21" aria-hidden="true" tabindex="-1"></a><span class="do">## + attr: name (v/c), type (v/l)</span></span>
<span id="cb78-22"><a href="#cb78-22" aria-hidden="true" tabindex="-1"></a><span class="do">## + edges from 87759e8 (vertex names):</span></span>
<span id="cb78-23"><a href="#cb78-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  [1] サッカー        --A 野球            --B バレーボール    --C</span></span>
<span id="cb78-24"><a href="#cb78-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  [4] バスケットボール--D 野球            --E サッカー        --F</span></span>
<span id="cb78-25"><a href="#cb78-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  [7] 野球            --G バスケットボール--H バスケットボール--I</span></span>
<span id="cb78-26"><a href="#cb78-26" aria-hidden="true" tabindex="-1"></a><span class="do">## [10] サッカー        --J サッカー        --K バスケットボール--L</span></span>
<span id="cb78-27"><a href="#cb78-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [13] バスケットボール--M 野球            --N 野球            --O</span></span>
<span id="cb78-28"><a href="#cb78-28" aria-hidden="true" tabindex="-1"></a><span class="do">## [16] 野球            --P サッカー        --Q サッカー        --R</span></span>
<span id="cb78-29"><a href="#cb78-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [19] サッカー        --S サッカー        --T バスケットボール--U</span></span>
<span id="cb78-30"><a href="#cb78-30" aria-hidden="true" tabindex="-1"></a><span class="do">## [22] 野球            --V バスケットボール--W 野球            --X</span></span>
<span id="cb78-31"><a href="#cb78-31" aria-hidden="true" tabindex="-1"></a><span class="do">## + ... omitted several edges</span></span>
<span id="cb78-32"><a href="#cb78-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-33"><a href="#cb78-33" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="at">layout =</span> layout_as_bipartite, <span class="at">vertex.color =</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"lightblue"</span>)[<span class="fu">V</span>(g)<span class="sc">$</span>type <span class="sc">+</span> <span class="dv">1</span>], <span class="at">vertex.shape =</span> <span class="fu">c</span>(<span class="st">"square"</span>, <span class="st">"circle"</span>)[<span class="fu">V</span>(g)<span class="sc">$</span>type <span class="sc">+</span> <span class="dv">1</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-77-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-67"><img src="chapter33_files/figure-html/unnamed-chunk-77-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="tidygraph" class="level2" data-number="33.5">
<h2 data-number="33.5" class="anchored" data-anchor-id="tidygraph"><span class="header-section-number">33.5</span> tidygraph</h2>
<p>ここまで説明してきた<code>igraph</code>は非常に多機能でよくできたパッケージではありますが、関数名や引数名があまり一定ではなく、使用する際に関数名や引数名をチェックしないとうまく使うことができません。引数の指定方法も多岐に渡っており、統一した手法でグラフを取り扱うことができず、使いにくさがあります。</p>
<p>このような問題を解決するためのライブラリが<code>tidygraph</code>パッケージです。<code>tidygraph</code>パッケージは基本的に<code>tibble</code>を用いてグラフを作成し、<code>tidyverse</code>（特に<code>dplyr</code>）とパイプ演算子を用いてグラフを編集することを目的として構成されています。</p>
<p>とは言え、<code>igraph</code>が非常に機能豊富なパッケージであったのと同様に、<code>tidygraph</code>も機能豊富で、利用の難易度は高めです。また、解説文等が少ないため、使い方を理解するのが難しい関数もあります。<code>dplyr::mutate</code>関数内以外では使えない関数がたくさんあるなど、使い方もやや複雑です。</p>
<section id="tidygraphの基礎とグラフの作成" class="level3" data-number="33.5.1">
<h3 data-number="33.5.1" class="anchored" data-anchor-id="tidygraphの基礎とグラフの作成"><span class="header-section-number">33.5.1</span> tidygraphの基礎とグラフの作成</h3>
<p><code>tidygraph</code>ではグラフはnodeとedgeで表されます。<code>igraph</code>とは異なり、nodeがvertexと呼ばれることはありません。</p>
<p><code>tidygraph</code>では、<code>igraph</code>と同じく、データフレームからグラフを作成します。また、<code>igraph</code>で作成したグラフオブジェクトやedge vector、adjacency matrixからもグラフを作成することができます。データフレームからグラフを作成する場合には<code>tbl_graph</code>関数、その他のオブジェクトや<code>igraph</code>のグラフから<code>tidygraph</code>のグラフを作成する場合には<code>as_tbl_graph</code>関数を用います。</p>
<p>作成したグラフのクラスは<code>igraph</code>と<code>tbl_graph</code>となっており、表示するとnodeとedgeのデータフレームが示されます。<code>igraph</code>ではvertexに指定するデータフレームの2列目以降、edgeに指定するデータフレームの3列目以降はattributeとして登録されますが、<code>tbl_graph</code>ではnodeとedgeのtibbleとして表示されます。<code>tbl_graph</code>は<code>igraph</code>のオブジェクトでもあるので、<code>igraph</code>と同じように<code>attributes</code>としてtibbleの列を呼び出すこともできます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>tbl_graphを作成する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tidygraph)</span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/chapter33_nara_stations.csv"</span>) <span class="co"># edgeのデータフレーム</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>vt <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/chapter33_nara_stations_vertex_list.csv"</span>) <span class="co"># nodeのデータフレーム</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(vt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"name"</span>, <span class="st">"lat"</span>, <span class="st">"lon"</span>, <span class="st">"linename"</span>, <span class="st">"company"</span>) <span class="co"># vertex名はname列から取り込まれる</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>, <span class="st">"linename"</span>, <span class="st">"company"</span>) <span class="co"># edgeはfrom→toになる</span></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="co"># tbl_graphをデータフレームから作成する</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a>g <span class="ot">&lt;-</span> <span class="fu">tbl_graph</span>(<span class="at">nodes =</span> vt, <span class="at">edges =</span> d, <span class="at">directed =</span> <span class="cn">FALSE</span>) </span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a><span class="co"># igraphオブジェクトをtbl_graphに変換する</span></span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a><span class="fu">as_tbl_graph</span>(karate)</span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 34 nodes and 78 edges</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 1 component</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 34 × 0 (active)</span></span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 78 × 2</span></span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to</span></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt;</span></span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2</span></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     1     3</span></span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     1     4</span></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 75 more rows</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a><span class="fu">class</span>(g) <span class="co"># クラスはtbl_graph</span></span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "tbl_graph" "igraph"</span></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a><span class="fu">V</span>(g)<span class="sc">$</span>lat <span class="co"># igraphとして取り扱い、attributeとして2列目以降を呼び出すこともできる</span></span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a><span class="do">##   [1] 34.68078 34.66998 34.64340 34.62101 34.60120 34.57420 34.55911 34.54543</span></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   [9] 34.52719 34.51347 34.51078 34.50962 34.59772 34.57763 34.56155 34.54335</span></span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a><span class="do">##  [17] 34.52765 34.51627 34.48867 34.46466 34.45834 34.45236 34.42085 34.38266</span></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a><span class="do">##  [25] 34.35572 34.58930 34.60150 34.62228 34.64797 34.69332 34.68555 34.67593</span></span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a><span class="do">##  [33] 34.66550 34.65655 34.64814 34.64007 34.62917 34.61748 34.60600 34.60099</span></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a><span class="do">##  [41] 34.59775 34.58913 34.58517 34.57857 34.57032 34.56935 34.56830 34.72374</span></span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a><span class="do">##  [49] 34.70172 34.69391 34.68151 34.67054 34.65923 34.64620 34.62042 34.60662</span></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="do">##  [57] 34.59827 34.58458 34.57194 34.55330 34.54179 34.52551 34.51320 34.50925</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="do">##  [65] 34.49337 34.53911 34.53162 34.51647 34.51115 34.50855 34.50694 34.49796</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="do">##  [73] 34.49332 34.48612 34.48344 34.47411 34.46487 34.44984 34.44186 34.43160</span></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a><span class="do">##  [81] 34.40729 34.39511 34.38841 34.38366 34.38612 34.39027 34.39549 34.39022</span></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="do">##  [89] 34.48940 34.47598 34.69171 34.69411 34.69694 34.69816 34.68543 34.55387</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a><span class="do">##  [97] 34.54635 34.54144 34.53485 34.52618 34.51961 34.52069 34.51978 34.51253</span></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a><span class="do">## [105] 34.51292 34.51614 34.52662 34.52975 34.56603 34.60225 34.60100 34.50834</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a><span class="do">## [113] 34.34589 34.71070 34.55366 34.37661 34.46474 34.68436 34.57828</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="nodeedgeをactivateする" class="level3" data-number="33.5.2">
<h3 data-number="33.5.2" class="anchored" data-anchor-id="nodeedgeをactivateする"><span class="header-section-number">33.5.2</span> node/edgeをactivateする</h3>
<p><code>igraph</code>ではnode（vertex）やedgeを呼び出す場合、<code>V</code>関数と<code>E</code>関数を用いますが、<code>tidygraph</code>ではnode・edgeの呼び出しに<code>activate</code>関数を用います。<code>activate</code>関数はパイプ演算子を用いて呼び出すことが想定されている関数で、パイプ演算子でつないでグラフに適用します。第2引数として<code>nodes</code>と<code>edges</code>を用います。<code>activate</code>関数をグラフに適用すると、<code>node</code>・<code>edge</code>のtibbleに「activate」と表示されます。この状態でさらにパイプ演算子をつなぐと、activateされている側のtibbleを編集することができます。</p>
<p>node・edgeのどちらがactiveであるかを調べる場合には、<code>active</code>関数を用います。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>activate関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb80"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a><span class="co"># node・edgeをactivateする</span></span>
<span id="cb80-2"><a href="#cb80-2" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">active</span>() <span class="co"># nodeがactiveになっている</span></span>
<span id="cb80-3"><a href="#cb80-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "nodes"</span></span>
<span id="cb80-4"><a href="#cb80-4" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">activate</span>(edges) <span class="co"># edgeをactiveにする（nodeはactiveではなくなる）</span></span>
<span id="cb80-5"><a href="#cb80-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb80-6"><a href="#cb80-6" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb80-7"><a href="#cb80-7" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb80-8"><a href="#cb80-8" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb80-9"><a href="#cb80-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4 (active)</span></span>
<span id="cb80-10"><a href="#cb80-10" aria-hidden="true" tabindex="-1"></a><span class="do">##     from    to linename       company</span></span>
<span id="cb80-11"><a href="#cb80-11" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb80-12"><a href="#cb80-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb80-13"><a href="#cb80-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb80-14"><a href="#cb80-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb80-15"><a href="#cb80-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  4     4     5 万葉まほろば線 JR     </span></span>
<span id="cb80-16"><a href="#cb80-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  5     5     6 万葉まほろば線 JR     </span></span>
<span id="cb80-17"><a href="#cb80-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  6     6     7 万葉まほろば線 JR     </span></span>
<span id="cb80-18"><a href="#cb80-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  7     7     8 万葉まほろば線 JR     </span></span>
<span id="cb80-19"><a href="#cb80-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  8     8     9 万葉まほろば線 JR     </span></span>
<span id="cb80-20"><a href="#cb80-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  9     9    10 万葉まほろば線 JR     </span></span>
<span id="cb80-21"><a href="#cb80-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    10    11 万葉まほろば線 JR     </span></span>
<span id="cb80-22"><a href="#cb80-22" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 110 more rows</span></span>
<span id="cb80-23"><a href="#cb80-23" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb80-24"><a href="#cb80-24" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 5</span></span>
<span id="cb80-25"><a href="#cb80-25" aria-hidden="true" tabindex="-1"></a><span class="do">##   name    lat   lon linename       company</span></span>
<span id="cb80-26"><a href="#cb80-26" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb80-27"><a href="#cb80-27" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 奈良   34.7  136. 万葉まほろば線 JR     </span></span>
<span id="cb80-28"><a href="#cb80-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 京終   34.7  136. 万葉まほろば線 JR     </span></span>
<span id="cb80-29"><a href="#cb80-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 帯解   34.6  136. 万葉まほろば線 JR     </span></span>
<span id="cb80-30"><a href="#cb80-30" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 116 more rows</span></span>
<span id="cb80-31"><a href="#cb80-31" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">activate</span>(edges) <span class="sc">|&gt;</span> <span class="fu">active</span>() <span class="co"># edgeがactiveになっている</span></span>
<span id="cb80-32"><a href="#cb80-32" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "edges"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="focus" class="level3" data-number="33.5.3">
<h3 data-number="33.5.3" class="anchored" data-anchor-id="focus"><span class="header-section-number">33.5.3</span> focus</h3>
<p><code>tidygraph</code>では、基本的に<code>activate</code>でnode・edgeのいずれかを選択した後、<code>mutate</code>など<code>dplyr</code>の関数を用いてグラフの要素であるtibbleを編集していきます。</p>
<p><code>mutate</code>などで編集を行うために、行を選択するための関数が<code>focus</code>です。<code>focus</code>関数の引数には論理型を用い、<code>TRUE</code>の行のみを<code>dplyr</code>の関数での編集の対象とすることができます。以下の例では、nodeのはじめの5行を選択し、その行だけを<code>mutate</code>での演算の対象としています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>focusで行を選択して編集する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb81-2"><a href="#cb81-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb81-3"><a href="#cb81-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">focus</span>(<span class="fu">c</span>(T, T, T, T, T, <span class="fu">rep</span>(F, <span class="dv">114</span>))) <span class="sc">|&gt;</span> <span class="co"># 始めの5つのnodeにfocusする</span></span>
<span id="cb81-4"><a href="#cb81-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lat =</span> lat <span class="sc">-</span> <span class="dv">50</span>) <span class="co"># 初めの5つのnodeのlatから50を引く</span></span>
<span id="cb81-5"><a href="#cb81-5" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb81-6"><a href="#cb81-6" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb81-7"><a href="#cb81-7" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb81-8"><a href="#cb81-8" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb81-9"><a href="#cb81-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # Focused on 5 nodes</span></span>
<span id="cb81-10"><a href="#cb81-10" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 5 (active)</span></span>
<span id="cb81-11"><a href="#cb81-11" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename       company</span></span>
<span id="cb81-12"><a href="#cb81-12" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb81-13"><a href="#cb81-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良  -15.3  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-14"><a href="#cb81-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終  -15.3  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-15"><a href="#cb81-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解  -15.4  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-16"><a href="#cb81-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本  -15.4  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-17"><a href="#cb81-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理  -15.4  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-18"><a href="#cb81-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-19"><a href="#cb81-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-20"><a href="#cb81-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-21"><a href="#cb81-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-22"><a href="#cb81-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろば線 JR     </span></span>
<span id="cb81-23"><a href="#cb81-23" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb81-24"><a href="#cb81-24" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb81-25"><a href="#cb81-25" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4</span></span>
<span id="cb81-26"><a href="#cb81-26" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb81-27"><a href="#cb81-27" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb81-28"><a href="#cb81-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb81-29"><a href="#cb81-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb81-30"><a href="#cb81-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb81-31"><a href="#cb81-31" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 117 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="morphunmorphとcrystalise" class="level3" data-number="33.5.4">
<h3 data-number="33.5.4" class="anchored" data-anchor-id="morphunmorphとcrystalise"><span class="header-section-number">33.5.4</span> morph・unmorphとcrystalise</h3>
<p>上記の<code>igraph</code>で説明したクラスター計算では、nodeを各クラスターに分離することができます。ただし、分離したクラスターごとに何らかの演算をしたい場合や、nodeのグループごとに演算を行いたい場合、<code>igraph</code>には簡単に計算する方法はありません。<code>tidygraph</code>では、このようなグループごとの演算を<code>morph</code>関数を用いて簡単に行うことができます。</p>
<p><code>morph</code>関数はnode・edgeのtibbleを一時的に変換するための関数です。<code>tidygraph</code>の開発者（Dr.&nbsp; Thomas Lin Pedersen、<code>patchwork</code>や<code>gganimate</code>の開発者）は、この<code>morph</code>/<code>unmorph</code>/<code>crystalise</code>を<a href="https://www.data-imaginist.com/posts/2018-02-12-tidygraph-1-1-a-tidy-hope/index.html"><code>tidygraph</code>の最も代表的な関数の一つ</a>だと考えているようで、使い方を理解すれば非常に便利な関数群です。</p>
<p>以下の例では<code>group_infomap</code>関数（<code>igraph</code>の<code>cluster_infomap</code>関数のwrapper）でnodeをクラスター分けし、<code>morph</code>関数内ではそのクラスター（<code>group</code>）に従い<code>to_split</code>関数でtibbleを一時的に<code>nest</code>しています（<code>tidyr::nest</code>に関しては<a href="./chapter16.html">16章</a>を参照。複数の要素をtibbleの「セル」として設定する方法のこと）。</p>
<p><code>nest</code>したtibbleに対して<code>graph_diameter</code>関数（<code>igraph</code>の<code>diameter</code>関数のwrapper）と<code>centrality_degree</code>関数（<code>igraph</code>の<code>degree</code>関数のwrapper）を適用することで、クラスターごとのネットワークの直径、nodeの中心性を演算して行に追加しています。ただし、このままではtibbleが<code>nest</code>されたままです。</p>
<p>この<code>nest</code>されたtibbleをもとに戻すのが<code>unmorph</code>関数です。<code>unmorph</code>関数を適用することで、nodeのtibbleの<code>nest</code>が解除される、つまり<code>unnest</code>されて元のグラフに戻ります。</p>
<p>このように、<code>morph</code>/<code>unmorph</code>を用いることで、node・edgeのグループごとの演算を簡単に行うことができます。<code>morph</code>でのグループ分けのための関数には<code>to_subgraph</code>関数（<code>dplyr::filter</code>に近い演算を行うもの）や<code>to_components</code>関数などが準備されています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>morph・unmorph関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="co"># サブグループ内での演算を行うときにはmorph/unmorphを用いる</span></span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a><span class="co"># morph内の関数はto_から始まる関数群を用いる</span></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb82-4"><a href="#cb82-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> <span class="co"># nodeをactiveにして</span></span>
<span id="cb82-5"><a href="#cb82-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">group_infomap</span>()) <span class="sc">|&gt;</span> <span class="co"># クラスターに分けて</span></span>
<span id="cb82-6"><a href="#cb82-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">morph</span>(to_split, group) <span class="sc">|&gt;</span> <span class="co"># グループで一時的に分割・ネストして</span></span>
<span id="cb82-7"><a href="#cb82-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb82-8"><a href="#cb82-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">group_diameter =</span> <span class="fu">graph_diameter</span>(), </span>
<span id="cb82-9"><a href="#cb82-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">centrality =</span> <span class="fu">centrality_degree</span>()) <span class="sc">|&gt;</span> <span class="co"># グループごとに直径を計算して</span></span>
<span id="cb82-10"><a href="#cb82-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">unmorph</span>() <span class="co"># morphをもとに戻す</span></span>
<span id="cb82-11"><a href="#cb82-11" aria-hidden="true" tabindex="-1"></a><span class="do">## Splitting by nodes</span></span>
<span id="cb82-12"><a href="#cb82-12" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb82-13"><a href="#cb82-13" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb82-14"><a href="#cb82-14" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb82-15"><a href="#cb82-15" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb82-16"><a href="#cb82-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 8 (active)</span></span>
<span id="cb82-17"><a href="#cb82-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename       company group group_diameter centrality</span></span>
<span id="cb82-18"><a href="#cb82-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;   &lt;int&gt;          &lt;dbl&gt;      &lt;dbl&gt;</span></span>
<span id="cb82-19"><a href="#cb82-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良   34.7  136. 万葉まほろば線 JR          2              5          3</span></span>
<span id="cb82-20"><a href="#cb82-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終   34.7  136. 万葉まほろば線 JR          2              5          2</span></span>
<span id="cb82-21"><a href="#cb82-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解   34.6  136. 万葉まほろば線 JR          2              5          1</span></span>
<span id="cb82-22"><a href="#cb82-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本   34.6  136. 万葉まほろば線 JR         11              4          1</span></span>
<span id="cb82-23"><a href="#cb82-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理   34.6  136. 万葉まほろば線 JR         11              4          2</span></span>
<span id="cb82-24"><a href="#cb82-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろば線 JR          3              6          1</span></span>
<span id="cb82-25"><a href="#cb82-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろば線 JR          3              6          2</span></span>
<span id="cb82-26"><a href="#cb82-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろば線 JR          3              6          2</span></span>
<span id="cb82-27"><a href="#cb82-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろば線 JR          3              6          2</span></span>
<span id="cb82-28"><a href="#cb82-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろば線 JR          3              6          2</span></span>
<span id="cb82-29"><a href="#cb82-29" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb82-30"><a href="#cb82-30" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb82-31"><a href="#cb82-31" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4</span></span>
<span id="cb82-32"><a href="#cb82-32" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb82-33"><a href="#cb82-33" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb82-34"><a href="#cb82-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb82-35"><a href="#cb82-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb82-36"><a href="#cb82-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb82-37"><a href="#cb82-37" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 117 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><code>morph</code>で変形したグラフをそのまま固定するための関数が<code>crystallise</code>関数です。<code>crystallise</code>関数を用いると、<code>morph</code>で指定した変形の状態などが固定され、tibbleとしてデータが返ってきます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>crystallise関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">group_infomap</span>()) <span class="sc">|&gt;</span> <span class="co"># クラスターに分けて</span></span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">morph</span>(to_split, group) <span class="sc">|&gt;</span> <span class="co"># グループで一時的に分割して</span></span>
<span id="cb83-4"><a href="#cb83-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crystallise</span>() <span class="co"># crystalliseして固定してしまう</span></span>
<span id="cb83-5"><a href="#cb83-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Splitting by nodes</span></span>
<span id="cb83-6"><a href="#cb83-6" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 22 × 2</span></span>
<span id="cb83-7"><a href="#cb83-7" aria-hidden="true" tabindex="-1"></a><span class="do">##    name      graph     </span></span>
<span id="cb83-8"><a href="#cb83-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt;     &lt;list&gt;    </span></span>
<span id="cb83-9"><a href="#cb83-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 group: 1  &lt;tbl_grph&gt;</span></span>
<span id="cb83-10"><a href="#cb83-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 group: 2  &lt;tbl_grph&gt;</span></span>
<span id="cb83-11"><a href="#cb83-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 group: 3  &lt;tbl_grph&gt;</span></span>
<span id="cb83-12"><a href="#cb83-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 group: 4  &lt;tbl_grph&gt;</span></span>
<span id="cb83-13"><a href="#cb83-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 group: 5  &lt;tbl_grph&gt;</span></span>
<span id="cb83-14"><a href="#cb83-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 group: 6  &lt;tbl_grph&gt;</span></span>
<span id="cb83-15"><a href="#cb83-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 group: 7  &lt;tbl_grph&gt;</span></span>
<span id="cb83-16"><a href="#cb83-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 group: 8  &lt;tbl_grph&gt;</span></span>
<span id="cb83-17"><a href="#cb83-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 group: 9  &lt;tbl_grph&gt;</span></span>
<span id="cb83-18"><a href="#cb83-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 group: 10 &lt;tbl_grph&gt;</span></span>
<span id="cb83-19"><a href="#cb83-19" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 12 more rows</span></span>
<span id="cb83-20"><a href="#cb83-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb83-21"><a href="#cb83-21" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb83-22"><a href="#cb83-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">group_infomap</span>()) <span class="sc">|&gt;</span> </span>
<span id="cb83-23"><a href="#cb83-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">morph</span>(to_split, group) <span class="sc">|&gt;</span> </span>
<span id="cb83-24"><a href="#cb83-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">crystallise</span>() <span class="sc">|&gt;</span> </span>
<span id="cb83-25"><a href="#cb83-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">class</span>() <span class="co"># classからgraph関係のものがなくなり、tibbleになっている</span></span>
<span id="cb83-26"><a href="#cb83-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Splitting by nodes</span></span>
<span id="cb83-27"><a href="#cb83-27" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "tbl_df"     "tbl"        "data.frame"</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="中心性-1" class="level3" data-number="33.5.5">
<h3 data-number="33.5.5" class="anchored" data-anchor-id="中心性-1"><span class="header-section-number">33.5.5</span> 中心性</h3>
<p><code>igraph</code>と同様に、<code>tidygraph</code>にも中心性を評価する関数群（<code>centrality_</code>から始まる関数）が設定されています。<code>igraph</code>との違いは、これらの<code>centrality_</code>関数群は単独で呼び出すことができず、nodeをactiveにした上で<code>mutate</code>関数の中で呼び出すような使い方をする点です。単独で使用するとエラーが返ってきます。</p>
<p><code>tidygraph</code>にはこの<code>centrality_</code>関数が30個以上も設定されています（<code>igraph</code>の中心性演算の関数に加えて、<code>netrankr</code><span class="citation" data-cites="netrankr_bib">(<a href="references.html#ref-netrankr_bib" role="doc-biblioref">Schoch 2022</a>)</span>パッケージから方法を引用しています）。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>中心性：centrality_関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="fu">centrality_degree</span>(g) <span class="co"># 直接呼び出せない</span></span>
<span id="cb84-2"><a href="#cb84-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in `private$check()`:</span></span>
<span id="cb84-3"><a href="#cb84-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ! This function should not be called directly</span></span>
<span id="cb84-4"><a href="#cb84-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-5"><a href="#cb84-5" aria-hidden="true" tabindex="-1"></a><span class="co"># nodeをactiveにしてからmutateで呼び出す</span></span>
<span id="cb84-6"><a href="#cb84-6" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb84-7"><a href="#cb84-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb84-8"><a href="#cb84-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">degree_cent =</span> <span class="fu">centrality_degree</span>()) </span>
<span id="cb84-9"><a href="#cb84-9" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb84-10"><a href="#cb84-10" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb84-11"><a href="#cb84-11" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb84-12"><a href="#cb84-12" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb84-13"><a href="#cb84-13" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 6 (active)</span></span>
<span id="cb84-14"><a href="#cb84-14" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename       company degree_cent</span></span>
<span id="cb84-15"><a href="#cb84-15" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;         &lt;dbl&gt;</span></span>
<span id="cb84-16"><a href="#cb84-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良   34.7  136. 万葉まほろば線 JR                3</span></span>
<span id="cb84-17"><a href="#cb84-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終   34.7  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-18"><a href="#cb84-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解   34.6  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-19"><a href="#cb84-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本   34.6  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-20"><a href="#cb84-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理   34.6  136. 万葉まほろば線 JR                3</span></span>
<span id="cb84-21"><a href="#cb84-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-22"><a href="#cb84-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-23"><a href="#cb84-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-24"><a href="#cb84-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろば線 JR                2</span></span>
<span id="cb84-25"><a href="#cb84-25" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろば線 JR                4</span></span>
<span id="cb84-26"><a href="#cb84-26" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb84-27"><a href="#cb84-27" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb84-28"><a href="#cb84-28" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4</span></span>
<span id="cb84-29"><a href="#cb84-29" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb84-30"><a href="#cb84-30" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb84-31"><a href="#cb84-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb84-32"><a href="#cb84-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb84-33"><a href="#cb84-33" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb84-34"><a href="#cb84-34" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 117 more rows</span></span>
<span id="cb84-35"><a href="#cb84-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb84-36"><a href="#cb84-36" aria-hidden="true" tabindex="-1"></a><span class="co"># 4種のcentralityを同時に演算する</span></span>
<span id="cb84-37"><a href="#cb84-37" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb84-38"><a href="#cb84-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb84-39"><a href="#cb84-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb84-40"><a href="#cb84-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">cent_degr =</span> <span class="fu">centrality_degree</span>(),</span>
<span id="cb84-41"><a href="#cb84-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">cent_betw =</span> <span class="fu">centrality_betweenness</span>(),</span>
<span id="cb84-42"><a href="#cb84-42" aria-hidden="true" tabindex="-1"></a>    <span class="at">cent_clos =</span> <span class="fu">centrality_closeness</span>(),</span>
<span id="cb84-43"><a href="#cb84-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">cent_eigv =</span> <span class="fu">centrality_eigen</span>()) </span>
<span id="cb84-44"><a href="#cb84-44" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb84-45"><a href="#cb84-45" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb84-46"><a href="#cb84-46" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb84-47"><a href="#cb84-47" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb84-48"><a href="#cb84-48" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 9 (active)</span></span>
<span id="cb84-49"><a href="#cb84-49" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename    company cent_degr cent_betw cent_clos cent_eigv</span></span>
<span id="cb84-50"><a href="#cb84-50" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;       &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb84-51"><a href="#cb84-51" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良   34.7  136. 万葉まほろ… JR              3      882   0.000728    0.0122</span></span>
<span id="cb84-52"><a href="#cb84-52" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終   34.7  136. 万葉まほろ… JR              2      862   0.000741    0.0166</span></span>
<span id="cb84-53"><a href="#cb84-53" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解   34.6  136. 万葉まほろ… JR              2      887   0.000755    0.0272</span></span>
<span id="cb84-54"><a href="#cb84-54" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本   34.6  136. 万葉まほろ… JR              2      914   0.000770    0.0480</span></span>
<span id="cb84-55"><a href="#cb84-55" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理   34.6  136. 万葉まほろ… JR              3     1244.  0.000796    0.0866</span></span>
<span id="cb84-56"><a href="#cb84-56" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろ… JR              2      904.  0.000798    0.102 </span></span>
<span id="cb84-57"><a href="#cb84-57" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろ… JR              2      910.  0.000802    0.156 </span></span>
<span id="cb84-58"><a href="#cb84-58" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろ… JR              2      918.  0.000807    0.268 </span></span>
<span id="cb84-59"><a href="#cb84-59" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろ… JR              2      928.  0.000814    0.480 </span></span>
<span id="cb84-60"><a href="#cb84-60" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろ… JR              4     1340   0.000822    0.870 </span></span>
<span id="cb84-61"><a href="#cb84-61" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb84-62"><a href="#cb84-62" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb84-63"><a href="#cb84-63" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4</span></span>
<span id="cb84-64"><a href="#cb84-64" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb84-65"><a href="#cb84-65" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb84-66"><a href="#cb84-66" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb84-67"><a href="#cb84-67" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb84-68"><a href="#cb84-68" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb84-69"><a href="#cb84-69" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 117 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="nodeedgegraphの評価" class="level3" data-number="33.5.6">
<h3 data-number="33.5.6" class="anchored" data-anchor-id="nodeedgegraphの評価"><span class="header-section-number">33.5.6</span> node・edge・graphの評価</h3>
<p><code>tidygraph</code>には、<code>igraph</code>と同様にnode、edge、graphを評価するための関数群が設定されています。いずれの関数も単独で呼び出すことはできず、<code>mutate</code>関数内で呼び出して用いることが前提とされています。</p>
<p>以下にnodeの評価に関わる関数を示します。上記の中心性もこのnodeの評価に関わる関数の一部となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>nodeの評価</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 単独では呼び出せない</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="fu">node_efficiency</span>(g)</span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in `private$check()`:</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ! This function should not be called directly</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">node_eff =</span> <span class="fu">node_efficiency</span>(), <span class="co"># nodeの効率（igraph::local_efficiency）</span></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">node_core =</span> <span class="fu">node_coreness</span>(), <span class="co"># k-core分解（igraph::coreness）</span></span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">node_clos =</span> <span class="fu">node_closeness_impact</span>()) <span class="co"># nodeを取り除いたときのclosenessへの影響の大きさ</span></span>
<span id="cb85-12"><a href="#cb85-12" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb85-13"><a href="#cb85-13" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 8 (active)</span></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename       company node_eff node_core node_clos</span></span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良   34.7  136. 万葉まほろば線 JR        0.0108         2     -60.3</span></span>
<span id="cb85-20"><a href="#cb85-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終   34.7  136. 万葉まほろば線 JR        0.0323         2     -47.1</span></span>
<span id="cb85-21"><a href="#cb85-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解   34.6  136. 万葉まほろば線 JR        0.0323         2     -49.9</span></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本   34.6  136. 万葉まほろば線 JR        0.0323         2     -54.4</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理   34.6  136. 万葉まほろば線 JR        0.0417         2     -75.4</span></span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろば線 JR        0.0625         2     -34.2</span></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろば線 JR        0.0625         2     -32.2</span></span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろば線 JR        0.0625         2     -32.7</span></span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろば線 JR        0.0625         2     -35.8</span></span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろば線 JR        0.0104         2    -152. </span></span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4</span></span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb85-33"><a href="#cb85-33" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb85-34"><a href="#cb85-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 117 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>edgeの評価では、edgeの性質を論理型で返すような関数が主に設定されています。edgeの評価に関する関数はそもそも引数にedgeのtibbleを取るように設定されていません。nodeの場合と同じく、edgeの評価の関数も<code>mutate</code>関数内で用いることが想定されています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>edgeの評価</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb86"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb86-2"><a href="#cb86-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">|&gt;</span> </span>
<span id="cb86-3"><a href="#cb86-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">edge_is_multiple</span>() <span class="co"># そもそも引数として設定できない</span></span>
<span id="cb86-4"><a href="#cb86-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in edge_is_multiple(activate(g, edges)): unused argument (activate(g, edges))</span></span>
<span id="cb86-5"><a href="#cb86-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb86-6"><a href="#cb86-6" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb86-7"><a href="#cb86-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(edges) <span class="sc">|&gt;</span> </span>
<span id="cb86-8"><a href="#cb86-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb86-9"><a href="#cb86-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">multiple =</span> <span class="fu">edge_is_multiple</span>(), <span class="co"># 平行するedgeがあるか</span></span>
<span id="cb86-10"><a href="#cb86-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">bridge =</span> <span class="fu">edge_is_bridge</span>() <span class="co"># edgeが切断されるとグラフが分離されるか</span></span>
<span id="cb86-11"><a href="#cb86-11" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb86-12"><a href="#cb86-12" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb86-13"><a href="#cb86-13" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb86-14"><a href="#cb86-14" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb86-15"><a href="#cb86-15" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb86-16"><a href="#cb86-16" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 6 (active)</span></span>
<span id="cb86-17"><a href="#cb86-17" aria-hidden="true" tabindex="-1"></a><span class="do">##     from    to linename       company multiple bridge</span></span>
<span id="cb86-18"><a href="#cb86-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;   &lt;lgl&gt;    &lt;lgl&gt; </span></span>
<span id="cb86-19"><a href="#cb86-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  1     1     2 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-20"><a href="#cb86-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  2     2     3 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-21"><a href="#cb86-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  3     3     4 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-22"><a href="#cb86-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  4     4     5 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-23"><a href="#cb86-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  5     5     6 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-24"><a href="#cb86-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  6     6     7 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-25"><a href="#cb86-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  7     7     8 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-26"><a href="#cb86-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  8     8     9 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-27"><a href="#cb86-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  9     9    10 万葉まほろば線 JR      FALSE    FALSE </span></span>
<span id="cb86-28"><a href="#cb86-28" aria-hidden="true" tabindex="-1"></a><span class="do">## 10    10    11 万葉まほろば線 JR      FALSE    TRUE  </span></span>
<span id="cb86-29"><a href="#cb86-29" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 110 more rows</span></span>
<span id="cb86-30"><a href="#cb86-30" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb86-31"><a href="#cb86-31" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 5</span></span>
<span id="cb86-32"><a href="#cb86-32" aria-hidden="true" tabindex="-1"></a><span class="do">##   name    lat   lon linename       company</span></span>
<span id="cb86-33"><a href="#cb86-33" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb86-34"><a href="#cb86-34" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 奈良   34.7  136. 万葉まほろば線 JR     </span></span>
<span id="cb86-35"><a href="#cb86-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 京終   34.7  136. 万葉まほろば線 JR     </span></span>
<span id="cb86-36"><a href="#cb86-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 帯解   34.6  136. 万葉まほろば線 JR     </span></span>
<span id="cb86-37"><a href="#cb86-37" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 116 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>graphの評価に関する関数は<code>igraph</code>に設定されている関数群とほぼ同じですが、やはり直接呼び出して用いることはできません。評価の意味に関しては以下を参照して下さい。</p>
<p><a href="https://www.geeksforgeeks.org/graph-measurements-length-distance-diameter-eccentricity-radius-center/?ref=lbp">GeekforGeeksのネットワークに関するページ</a></p>
<p><a href="chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://ocw.hokudai.ac.jp/wp-content/uploads/2016/01/GraphTheory-2007-Note-08.pdf">グラフ理論講義ノート#8 井上純一先生（北海道大学 情報科学研究科）</a></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>graphの評価</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">graph_diameter</span>() <span class="co"># 直接呼び出せない</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Error in `private$check()`:</span></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ! This function should not be called directly</span></span>
<span id="cb87-4"><a href="#cb87-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-5"><a href="#cb87-5" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb87-6"><a href="#cb87-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb87-7"><a href="#cb87-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb87-8"><a href="#cb87-8" aria-hidden="true" tabindex="-1"></a>    <span class="at">g_diameter =</span> <span class="fu">graph_diameter</span>(), <span class="co"># グラフの直径（最大の経路長）</span></span>
<span id="cb87-9"><a href="#cb87-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">g_girth =</span> <span class="fu">graph_girth</span>(), <span class="co"># グラフの内周（最小の閉路長）</span></span>
<span id="cb87-10"><a href="#cb87-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">g_radius =</span> <span class="fu">graph_radius</span>(), <span class="co"># グラフの離心率（igraph::radius）</span></span>
<span id="cb87-11"><a href="#cb87-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">g_size =</span> <span class="fu">graph_size</span>() <span class="co"># グラフのedgeの数</span></span>
<span id="cb87-12"><a href="#cb87-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb87-13"><a href="#cb87-13" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 120 edges</span></span>
<span id="cb87-14"><a href="#cb87-14" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb87-15"><a href="#cb87-15" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 2 components</span></span>
<span id="cb87-16"><a href="#cb87-16" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb87-17"><a href="#cb87-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 9 (active)</span></span>
<span id="cb87-18"><a href="#cb87-18" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename       company g_diameter g_girth g_radius g_size</span></span>
<span id="cb87-19"><a href="#cb87-19" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;        &lt;dbl&gt;   &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;</span></span>
<span id="cb87-20"><a href="#cb87-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良   34.7  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-21"><a href="#cb87-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終   34.7  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-22"><a href="#cb87-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解   34.6  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-23"><a href="#cb87-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本   34.6  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-24"><a href="#cb87-24" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理   34.6  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-25"><a href="#cb87-25" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-26"><a href="#cb87-26" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-27"><a href="#cb87-27" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-28"><a href="#cb87-28" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-29"><a href="#cb87-29" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろば線 JR              33      18        4    120</span></span>
<span id="cb87-30"><a href="#cb87-30" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb87-31"><a href="#cb87-31" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb87-32"><a href="#cb87-32" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 120 × 4</span></span>
<span id="cb87-33"><a href="#cb87-33" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb87-34"><a href="#cb87-34" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb87-35"><a href="#cb87-35" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb87-36"><a href="#cb87-36" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb87-37"><a href="#cb87-37" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb87-38"><a href="#cb87-38" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 117 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="create_関数とplay_関数" class="level3" data-number="33.5.7">
<h3 data-number="33.5.7" class="anchored" data-anchor-id="create_関数とplay_関数"><span class="header-section-number">33.5.7</span> create_関数とplay_関数</h3>
<p><code>igraph</code>では<code>make_</code>関数（<code>make_ring</code>関数や<code>make_star</code>関数など）で形状を指定したグラフを、<code>sample_</code>関数（<code>sample_tree</code>関数や<code>sample_gnp</code>関数など）でアルゴリズムに従ったランダムなグラフを作成することができます。この<code>igraph</code>の<code>make_</code>関数と<code>sample_</code>関数に当たるものが<code>tidygraph</code>の<code>create_</code>関数と<code>play_</code>関数です。出力がtbl_graphであることと、引数の順序・名前以外に<code>igraph</code>の関数群と大きな差は無いので、<code>igraph</code>の関数に慣れているのであれば<code>igraph</code>の関数を用いてグラフを作成した後で<code>as_tbl_graph</code>関数を用いて<code>tbl_graph</code>に変換してもよいでしょう。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">create_ring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">create_chordal_ring</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">create_complete</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">create_empty</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-5" role="tab" aria-controls="tabset-4-5" aria-selected="false">create_tree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-6" role="tab" aria-controls="tabset-4-6" aria-selected="false">create_star</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-7" role="tab" aria-controls="tabset-4-7" aria-selected="false">play_gnm</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-8" role="tab" aria-controls="tabset-4-8" aria-selected="false">play_gnp</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-9" role="tab" aria-controls="tabset-4-9" aria-selected="false">play_geometry</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb88"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_ring</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-87-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-68"><img src="chapter33_files/figure-html/unnamed-chunk-87-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_chordal_ring</span>(<span class="dv">10</span>, <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-88-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-69"><img src="chapter33_files/figure-html/unnamed-chunk-88-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb90"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_complete</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-89-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-70"><img src="chapter33_files/figure-html/unnamed-chunk-89-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_empty</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-90-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-71"><img src="chapter33_files/figure-html/unnamed-chunk-90-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb92"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="dv">10</span>, <span class="dv">4</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-91-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-72"><img src="chapter33_files/figure-html/unnamed-chunk-91-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_star</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-92-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-73"><img src="chapter33_files/figure-html/unnamed-chunk-92-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb94"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="fu">play_gnm</span>(<span class="dv">10</span>, <span class="dv">20</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-93-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-74"><img src="chapter33_files/figure-html/unnamed-chunk-93-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">play_gnp</span>(<span class="dv">10</span>, <span class="fl">0.25</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-94-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-75"><img src="chapter33_files/figure-html/unnamed-chunk-94-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb96"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="fu">play_geometry</span>(<span class="dv">10</span>, <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-95-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-76"><img src="chapter33_files/figure-html/unnamed-chunk-95-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="map_関数群" class="level3" data-number="33.5.8">
<h3 data-number="33.5.8" class="anchored" data-anchor-id="map_関数群"><span class="header-section-number">33.5.8</span> map_関数群</h3>
<p><code>purrr</code>の<code>map</code>関数と同様に、node、edgeのtibbleに関数を適用して演算を行う関数が<code>map_</code>関数群です。</p>
<p><code>map_</code>関数群には大きく分けるとbfs（breath first search）を演算に用いるもの（<code>map_bfs_</code>関数）と、dfs（depth first search）を用いるもの（<code>map_dfs_</code>関数）があります。</p>
<p><code>map_</code>関数も単独では呼び出すことができず、<code>mutate</code>関数内で呼び出すことが想定された関数で、<code>map_</code>関数内で引数（<code>.f</code>引数）として設定する関数は無名関数のみとなります。この<code>.f</code>関数で指定する無名関数については引数が定められていて（<code>node</code>, <code>rank</code>, <code>path</code>など）、かなり使い方が複雑です。また、bfs、dfsで到達不可能なパスが存在すると演算ができなくなります。</p>
<p>以下の例では、bfsによってJR奈良駅から他の駅までの到達に必要な距離を演算しています。<code>value</code>に駅間の距離や運賃などを正確に設定すれば、<code>map_bfs_dbl</code>関数を用いて到達距離を計算することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>map_関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb97-2"><a href="#cb97-2" aria-hidden="true" tabindex="-1"></a>  <span class="co"># 離れているとbfsで探索できないので、田原本線をつなげる</span></span>
<span id="cb97-3"><a href="#cb97-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from =</span> <span class="st">"田原本"</span>, <span class="at">to =</span> <span class="st">"西田原本"</span>, <span class="at">linename =</span> <span class="st">"田原本線"</span>, <span class="at">company =</span> <span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb97-4"><a href="#cb97-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value =</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">119</span>)) <span class="sc">|&gt;</span>  <span class="co"># 駅間を1としている</span></span>
<span id="cb97-5"><a href="#cb97-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">value_acc =</span> <span class="fu">map_bfs_dbl</span>(<span class="dv">1</span>, <span class="at">.f =</span> <span class="cf">function</span>(node, path, ...){ </span>
<span id="cb97-6"><a href="#cb97-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">.N</span>()<span class="sc">$</span>value[<span class="fu">c</span>(node, path<span class="sc">$</span>node)]) <span class="co"># searchの順に値を足していく（各nodeまでの距離を反映）</span></span>
<span id="cb97-7"><a href="#cb97-7" aria-hidden="true" tabindex="-1"></a>  }))</span>
<span id="cb97-8"><a href="#cb97-8" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tbl_graph: 119 nodes and 121 edges</span></span>
<span id="cb97-9"><a href="#cb97-9" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb97-10"><a href="#cb97-10" aria-hidden="true" tabindex="-1"></a><span class="do">## # An undirected simple graph with 1 component</span></span>
<span id="cb97-11"><a href="#cb97-11" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb97-12"><a href="#cb97-12" aria-hidden="true" tabindex="-1"></a><span class="do">## # Node Data: 119 × 7 (active)</span></span>
<span id="cb97-13"><a href="#cb97-13" aria-hidden="true" tabindex="-1"></a><span class="do">##    name    lat   lon linename       company value value_acc</span></span>
<span id="cb97-14"><a href="#cb97-14" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;          &lt;chr&gt;   &lt;dbl&gt;     &lt;dbl&gt;</span></span>
<span id="cb97-15"><a href="#cb97-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 奈良   34.7  136. 万葉まほろば線 JR          1         1</span></span>
<span id="cb97-16"><a href="#cb97-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 京終   34.7  136. 万葉まほろば線 JR          1         2</span></span>
<span id="cb97-17"><a href="#cb97-17" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 帯解   34.6  136. 万葉まほろば線 JR          1         3</span></span>
<span id="cb97-18"><a href="#cb97-18" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 櫟本   34.6  136. 万葉まほろば線 JR          1         4</span></span>
<span id="cb97-19"><a href="#cb97-19" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 天理   34.6  136. 万葉まほろば線 JR          1         5</span></span>
<span id="cb97-20"><a href="#cb97-20" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 長柄   34.6  136. 万葉まほろば線 JR          1         6</span></span>
<span id="cb97-21"><a href="#cb97-21" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 柳本   34.6  136. 万葉まほろば線 JR          1         7</span></span>
<span id="cb97-22"><a href="#cb97-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 巻向   34.5  136. 万葉まほろば線 JR          1         8</span></span>
<span id="cb97-23"><a href="#cb97-23" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 三輪   34.5  136. 万葉まほろば線 JR          1         9</span></span>
<span id="cb97-24"><a href="#cb97-24" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 桜井   34.5  136. 万葉まほろば線 JR          1        10</span></span>
<span id="cb97-25"><a href="#cb97-25" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb97-26"><a href="#cb97-26" aria-hidden="true" tabindex="-1"></a><span class="do">## #</span></span>
<span id="cb97-27"><a href="#cb97-27" aria-hidden="true" tabindex="-1"></a><span class="do">## # Edge Data: 121 × 4</span></span>
<span id="cb97-28"><a href="#cb97-28" aria-hidden="true" tabindex="-1"></a><span class="do">##    from    to linename       company</span></span>
<span id="cb97-29"><a href="#cb97-29" aria-hidden="true" tabindex="-1"></a><span class="do">##   &lt;int&gt; &lt;int&gt; &lt;chr&gt;          &lt;chr&gt;  </span></span>
<span id="cb97-30"><a href="#cb97-30" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     1     2 万葉まほろば線 JR     </span></span>
<span id="cb97-31"><a href="#cb97-31" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     2     3 万葉まほろば線 JR     </span></span>
<span id="cb97-32"><a href="#cb97-32" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     3     4 万葉まほろば線 JR     </span></span>
<span id="cb97-33"><a href="#cb97-33" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 118 more rows</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="グラフ表示のライブラリ" class="level2" data-number="33.6">
<h2 data-number="33.6" class="anchored" data-anchor-id="グラフ表示のライブラリ"><span class="header-section-number">33.6</span> グラフ表示のライブラリ</h2>
<p>上記のように、グラフの表示はグラフの理解において非常に重要です。<code>igraph</code>を用いることでグラフを様々な形式で表示することができますが、デザイン的には<code>ggplot2</code>などとは異なり、Rのデフォルトのプロットに近い形での表示となります。Rには、<code>igraph</code>だけでなく、グラフを表示するためのライブラリがいくつかありますので、以下に簡単に紹介します。</p>
<section id="ggraph" class="level3" data-number="33.6.1">
<h3 data-number="33.6.1" class="anchored" data-anchor-id="ggraph"><span class="header-section-number">33.6.1</span> ggraph</h3>
<p><code>ggraph</code><span class="citation" data-cites="ggraph_bib">(<a href="references.html#ref-ggraph_bib" role="doc-biblioref">Pedersen 2024a</a>)</span>は上記の<code>tidygraph</code>の開発者が開発した、<code>tbl_graph</code>を<code>ggplot2</code>の文法・デザインで描画するためのライブラリです。仕組みは比較的単純で、以下の例のように<code>tbl_graph</code>を<code>ggplot2</code>のグラフ表示に適したtibbleに変形し（<code>create_layout</code>関数）、<code>ggplot2</code>の文法でこの<code>tibble</code>を表示しています。この変換において、nodeの位置を<code>layout</code>引数で指定した位置に指定させています。</p>
<p><code>layout</code>引数には<code>"auto"</code>、<code>"igraph"</code>、<code>"dendrogram"</code>、<code>"manual"</code>、<code>"linear"</code>、<code>"matrix"</code>、<code>"treemap"</code>などの様々な値を指定することができます。<code>layout</code>による違いは後ほど説明します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ggraph：create_layout関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb98"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(ggraph)</span>
<span id="cb98-2"><a href="#cb98-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb98-3"><a href="#cb98-3" aria-hidden="true" tabindex="-1"></a><span class="fu">create_layout</span>(g, <span class="at">layout =</span> <span class="st">"tree"</span>)</span>
<span id="cb98-4"><a href="#cb98-4" aria-hidden="true" tabindex="-1"></a><span class="do">## # A tibble: 119 × 10</span></span>
<span id="cb98-5"><a href="#cb98-5" aria-hidden="true" tabindex="-1"></a><span class="do">##        x     y name    lat   lon linename    company .ggraph.orig_index circular</span></span>
<span id="cb98-6"><a href="#cb98-6" aria-hidden="true" tabindex="-1"></a><span class="do">##    &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;chr&gt;       &lt;chr&gt;                &lt;int&gt; &lt;lgl&gt;   </span></span>
<span id="cb98-7"><a href="#cb98-7" aria-hidden="true" tabindex="-1"></a><span class="do">##  1 -7.97    12 奈良   34.7  136. 万葉まほろ… JR                       1 FALSE   </span></span>
<span id="cb98-8"><a href="#cb98-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  2 -7.97    13 京終   34.7  136. 万葉まほろ… JR                       2 FALSE   </span></span>
<span id="cb98-9"><a href="#cb98-9" aria-hidden="true" tabindex="-1"></a><span class="do">##  3 -7.97    14 帯解   34.6  136. 万葉まほろ… JR                       3 FALSE   </span></span>
<span id="cb98-10"><a href="#cb98-10" aria-hidden="true" tabindex="-1"></a><span class="do">##  4 -7.97    15 櫟本   34.6  136. 万葉まほろ… JR                       4 FALSE   </span></span>
<span id="cb98-11"><a href="#cb98-11" aria-hidden="true" tabindex="-1"></a><span class="do">##  5 -6.47    16 天理   34.6  136. 万葉まほろ… JR                       5 FALSE   </span></span>
<span id="cb98-12"><a href="#cb98-12" aria-hidden="true" tabindex="-1"></a><span class="do">##  6 -6.47    17 長柄   34.6  136. 万葉まほろ… JR                       6 FALSE   </span></span>
<span id="cb98-13"><a href="#cb98-13" aria-hidden="true" tabindex="-1"></a><span class="do">##  7 -6.47    18 柳本   34.6  136. 万葉まほろ… JR                       7 FALSE   </span></span>
<span id="cb98-14"><a href="#cb98-14" aria-hidden="true" tabindex="-1"></a><span class="do">##  8 -6.47    19 巻向   34.5  136. 万葉まほろ… JR                       8 FALSE   </span></span>
<span id="cb98-15"><a href="#cb98-15" aria-hidden="true" tabindex="-1"></a><span class="do">##  9 -6.47    20 三輪   34.5  136. 万葉まほろ… JR                       9 FALSE   </span></span>
<span id="cb98-16"><a href="#cb98-16" aria-hidden="true" tabindex="-1"></a><span class="do">## 10 -3.03    21 桜井   34.5  136. 万葉まほろ… JR                      10 FALSE   </span></span>
<span id="cb98-17"><a href="#cb98-17" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 109 more rows</span></span>
<span id="cb98-18"><a href="#cb98-18" aria-hidden="true" tabindex="-1"></a><span class="do">## # ℹ 1 more variable: .ggraph.index &lt;int&gt;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p><code>ggraph</code>の文法は<code>ggplot2</code>と非常に類似しています。まず、<code>ggplot2</code>での<code>ggplot</code>関数に当たる<code>ggraph</code>関数の引数として、グラフ、<code>layout</code>引数を設定します。<code>layout</code>によってはこの<code>ggraph</code>関数内で追加の引数を設定する必要があります。<code>ggplot2</code>と同様に、この<code>ggraph</code>関数に足し算（<code>+</code>）で他の<code>geom</code>関数を付け加えていくことでグラフを構成していきます。</p>
<p>以下の例では、nodeを点で表示し（<code>geom_node_point</code>）、node側のtibbleの変数である<code>name</code>（駅名）をテキストとして重ね書きし（<code>geom_node_text</code>）、edgeを運行会社により色分けして直線でつないでいます（<code>geom_edge_link</code>）。<code>ggplot2</code>の<code>aes</code>関数に関しては<code>geom_node_</code>関数、<code>geom_edge_</code>関数内で指定します。<code>geom_node_</code>関数内ではnode側のtibble、<code>geom_edge_</code>関数内ではedge側のtibbleの列名を用いて表示する色や大きさを指定することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ggraph：グラフを描画する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="co"># グラフのテーマの設定（ggplot2のthemeをあらかじめ定めておくもの）</span></span>
<span id="cb99-2"><a href="#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="fu">windowsFonts</span>(<span class="at">Meiryo =</span> <span class="fu">windowsFont</span>(<span class="st">"Meiryo"</span>))</span>
<span id="cb99-3"><a href="#cb99-3" aria-hidden="true" tabindex="-1"></a><span class="fu">set_graph_style</span>(<span class="at">family=</span><span class="st">"Meiryo"</span>, <span class="at">text_size =</span> <span class="dv">5</span>, <span class="at">background =</span> <span class="st">"white"</span>, <span class="at">caption_size =</span> <span class="dv">3</span>)</span>
<span id="cb99-4"><a href="#cb99-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb99-5"><a href="#cb99-5" aria-hidden="true" tabindex="-1"></a><span class="co"># x、yで指定した位置にnodeを表示する</span></span>
<span id="cb99-6"><a href="#cb99-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(g, <span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb99-7"><a href="#cb99-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb99-8"><a href="#cb99-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name)) <span class="sc">+</span></span>
<span id="cb99-9"><a href="#cb99-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(<span class="at">color =</span> company))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-98-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-77"><img src="chapter33_files/figure-html/unnamed-chunk-98-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="ggraphのlayout" class="level4" data-number="33.6.1.1">
<h4 data-number="33.6.1.1" class="anchored" data-anchor-id="ggraphのlayout"><span class="header-section-number">33.6.1.1</span> ggraphのlayout</h4>
<p>このggraphのlayout・node・edgeの表示は非常に多種多様で、情報を捉えにくいものも含まれています。<a href="https://thomaslinpedersen.art/">開発者がアートに興味がある</a>こともあり、ggraphにはどちらかというと現代美術的な、意味よりも見た目重視な表示方法も含まれています。</p>
<p>以下に<code>layout</code>の例を示します。<code>layout</code>は単にnodeのx・y軸上の位置を定めているだけで、<code>layout</code>自体にはそれほど変わったものはありません。とは言え、特定のnode・edgeの表示とセットで用いることを前提としている、使いにくいものもあります。</p>
<p><code>layout</code>には<code>sf</code>をベースにしたもの（<code>layout = "sf"</code>）もあるため、上記のような路線図であれば、<code>sf</code>で表示するのもよいでしょう。<code>sf</code>については<a href="./chapter32.html">32章</a>で説明しています。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">auto</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">stress</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">sparse_stress</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-4" role="tab" aria-controls="tabset-5-4" aria-selected="false">igraph</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-5" role="tab" aria-controls="tabset-5-5" aria-selected="false">backbone</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-6" role="tab" aria-controls="tabset-5-6" aria-selected="false">pmds</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-7" role="tab" aria-controls="tabset-5-7" aria-selected="false">eigen</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-8" role="tab" aria-controls="tabset-5-8" aria-selected="false">centrality</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-9" role="tab" aria-controls="tabset-5-9" aria-selected="false">focus</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-10" role="tab" aria-controls="tabset-5-10" aria-selected="false">dendrogram</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-11" role="tab" aria-controls="tabset-5-11" aria-selected="false">unrooted</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-12" role="tab" aria-controls="tabset-5-12" aria-selected="false">linear</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-13" role="tab" aria-controls="tabset-5-13" aria-selected="false">circlepack</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-14" role="tab" aria-controls="tabset-5-14" aria-selected="false">treemap</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-15" role="tab" aria-controls="tabset-5-15" aria-selected="false">partition</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-16-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-16" role="tab" aria-controls="tabset-5-16" aria-selected="false">cactustree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-17-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-17" role="tab" aria-controls="tabset-5-17" aria-selected="false">htree</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-18-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-18" role="tab" aria-controls="tabset-5-18" aria-selected="false">matrix</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-19-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-19" role="tab" aria-controls="tabset-5-19" aria-selected="false">hive</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-20-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-20" role="tab" aria-controls="tabset-5-20" aria-selected="false">fabric</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-21-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-21" role="tab" aria-controls="tabset-5-21" aria-selected="false">metro</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb100"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb100-2"><a href="#cb100-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb100-3"><a href="#cb100-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="co"># stressが選択されている</span></span>
<span id="cb100-4"><a href="#cb100-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "stress" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-99-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-78"><img src="chapter33_files/figure-html/unnamed-chunk-99-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"stress"</span>) <span class="sc">+</span></span>
<span id="cb101-2"><a href="#cb101-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb101-3"><a href="#cb101-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="co"># autoで選ばれているのと同じ</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-100-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-79"><img src="chapter33_files/figure-html/unnamed-chunk-100-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb102"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb102-2"><a href="#cb102-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb102-3"><a href="#cb102-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"sparse_stress"</span>, <span class="at">pivots =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb102-4"><a href="#cb102-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb102-5"><a href="#cb102-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-101-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-80"><img src="chapter33_files/figure-html/unnamed-chunk-101-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"igraph"</span>, <span class="at">algorithm =</span> <span class="st">"grid"</span>) <span class="sc">+</span> <span class="co"># igraphのon_gridと同じ</span></span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-102-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-81"><img src="chapter33_files/figure-html/unnamed-chunk-102-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb104"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb104-2"><a href="#cb104-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb104-3"><a href="#cb104-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"backbone"</span>) <span class="sc">+</span> <span class="co"># 分離したグラフには適さない</span></span>
<span id="cb104-4"><a href="#cb104-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb104-5"><a href="#cb104-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-103-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-82"><img src="chapter33_files/figure-html/unnamed-chunk-103-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"pmds"</span>, <span class="at">pivots =</span> <span class="dv">10</span>) <span class="sc">+</span>  <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb105-4"><a href="#cb105-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb105-5"><a href="#cb105-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-104-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-83"><img src="chapter33_files/figure-html/unnamed-chunk-104-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb106"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb106-2"><a href="#cb106-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb106-3"><a href="#cb106-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"eigen"</span>) <span class="sc">+</span>  <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb106-4"><a href="#cb106-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb106-5"><a href="#cb106-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-105-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-84"><img src="chapter33_files/figure-html/unnamed-chunk-105-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cent =</span> <span class="fu">centrality_degree</span>()) <span class="sc">|&gt;</span> <span class="co"># 中心性に従い位置を決定する</span></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb107-4"><a href="#cb107-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"centrality"</span>, <span class="at">centrality =</span> cent) <span class="sc">+</span>  <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb107-5"><a href="#cb107-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb107-6"><a href="#cb107-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-106-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-85"><img src="chapter33_files/figure-html/unnamed-chunk-106-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb108"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb108-2"><a href="#cb108-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb108-3"><a href="#cb108-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"focus"</span>, <span class="at">focus =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># JR奈良駅にfocusする</span></span>
<span id="cb108-4"><a href="#cb108-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb108-5"><a href="#cb108-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-107-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-86"><img src="chapter33_files/figure-html/unnamed-chunk-107-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフにしか適用できない</span></span>
<span id="cb109-2"><a href="#cb109-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"dendrogram"</span>) <span class="sc">+</span> </span>
<span id="cb109-3"><a href="#cb109-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb109-4"><a href="#cb109-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-108-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-87"><img src="chapter33_files/figure-html/unnamed-chunk-108-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb110"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>g  <span class="sc">|&gt;</span> </span>
<span id="cb110-2"><a href="#cb110-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"unrooted"</span>) <span class="sc">+</span> </span>
<span id="cb110-3"><a href="#cb110-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb110-4"><a href="#cb110-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-109-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-88"><img src="chapter33_files/figure-html/unnamed-chunk-109-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-12-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb111-2"><a href="#cb111-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"linear"</span>) <span class="sc">+</span> </span>
<span id="cb111-3"><a href="#cb111-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb111-4"><a href="#cb111-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>() <span class="co"># 直線ではedgeが見えないのでarcとしている</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-110-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-89"><img src="chapter33_files/figure-html/unnamed-chunk-110-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-13-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb112"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="fu">play_gnm</span>(<span class="dv">30</span>, <span class="dv">80</span>, <span class="at">directed =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span>  <span class="co"># 有向グラフのみ対応</span></span>
<span id="cb112-2"><a href="#cb112-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"circlepack"</span>) <span class="sc">+</span> </span>
<span id="cb112-3"><a href="#cb112-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb112-4"><a href="#cb112-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb112-5"><a href="#cb112-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple parents. Unfolding graph</span></span>
<span id="cb112-6"><a href="#cb112-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Multiple roots in graph. Choosing the first</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-111-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-90"><img src="chapter33_files/figure-html/unnamed-chunk-111-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-14-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフにしか適用できない</span></span>
<span id="cb113-2"><a href="#cb113-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"treemap"</span>) <span class="sc">+</span> </span>
<span id="cb113-3"><a href="#cb113-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb113-4"><a href="#cb113-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-112-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-91"><img src="chapter33_files/figure-html/unnamed-chunk-112-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-15-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb114"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフにしか適用できない</span></span>
<span id="cb114-2"><a href="#cb114-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"partition"</span>) <span class="sc">+</span> </span>
<span id="cb114-3"><a href="#cb114-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb114-4"><a href="#cb114-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-113-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-92"><img src="chapter33_files/figure-html/unnamed-chunk-113-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-16" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-16-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">2</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフでないとnodeが範囲外に出る</span></span>
<span id="cb115-2"><a href="#cb115-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"cactustree"</span>) <span class="sc">+</span> </span>
<span id="cb115-3"><a href="#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb115-4"><a href="#cb115-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-114-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-93"><img src="chapter33_files/figure-html/unnamed-chunk-114-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-17" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-17-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb116"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">children =</span> <span class="dv">2</span>)  <span class="sc">|&gt;</span> <span class="co"># 二分木でないと描画できない</span></span>
<span id="cb116-2"><a href="#cb116-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"htree"</span>) <span class="sc">+</span> </span>
<span id="cb116-3"><a href="#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb116-4"><a href="#cb116-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-115-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-94"><img src="chapter33_files/figure-html/unnamed-chunk-115-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-18" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-18-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"matrix"</span>) <span class="sc">+</span></span>
<span id="cb117-2"><a href="#cb117-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb117-3"><a href="#cb117-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>() <span class="co"># 直線では見えなくなるのでarcを選択</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-116-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-95"><img src="chapter33_files/figure-html/unnamed-chunk-116-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-19" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-19-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb118"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb118-2"><a href="#cb118-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb118-3"><a href="#cb118-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">linename =</span> <span class="fu">E</span>(g)<span class="sc">$</span>linename[<span class="dv">1</span><span class="sc">:</span><span class="dv">119</span>]) <span class="sc">|&gt;</span> </span>
<span id="cb118-4"><a href="#cb118-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"hive"</span>, <span class="at">axis =</span> linename) <span class="sc">+</span> <span class="co"># linenameを軸として配置</span></span>
<span id="cb118-5"><a href="#cb118-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb118-6"><a href="#cb118-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="fu">aes</span>(<span class="at">color=</span>linename)) <span class="co"># 直線では見えなくなるのでarcを選択</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-117-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-96"><img src="chapter33_files/figure-html/unnamed-chunk-117-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-20" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-20-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fabric"</span>) <span class="sc">+</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-118-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-97"><img src="chapter33_files/figure-html/unnamed-chunk-118-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-5-21" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-21-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb120"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"metro"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-119-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-98"><img src="chapter33_files/figure-html/unnamed-chunk-119-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="nodeの表示" class="level4" data-number="33.6.1.2">
<h4 data-number="33.6.1.2" class="anchored" data-anchor-id="nodeの表示"><span class="header-section-number">33.6.1.2</span> nodeの表示</h4>
<p>nodeの表示には、<code>geom_node_</code>関数を用います。<code>geom_node_</code>の後にnodeの形状を示す単語（<code>point</code>、<code>text</code>、<code>tile</code>、<code>voronoi</code>など）を繋ぐことで、nodeの形状を指定します。<code>geom_node_</code>関数は<code>ggplot2</code>の<code>geom_</code>関数と同様に、<code>ggraph</code>関数に<code>+</code>でつないで用います。</p>
<p><code>geom_node_point</code>や<code>geom_node_text</code>、<code>geom_node_label</code>はどのようなグラフで用いても使いやすいですが、<code>geom_node_voronoi</code>のようにデザイン重視でネットワークの理解にはつながらないものもあります。以下に<code>geom_node_</code>関数の使用例を示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">point</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">text</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">label</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">tile</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">voronoi</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">circle</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-7" role="tab" aria-controls="tabset-6-7" aria-selected="false">arc_bar</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-8" role="tab" aria-controls="tabset-6-8" aria-selected="false">range</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb121"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb121-2"><a href="#cb121-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb121-3"><a href="#cb121-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-120-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-99"><img src="chapter33_files/figure-html/unnamed-chunk-120-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb122"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb122-2"><a href="#cb122-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb122-3"><a href="#cb122-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-121-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-100"><img src="chapter33_files/figure-html/unnamed-chunk-121-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb123"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb123-2"><a href="#cb123-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb123-3"><a href="#cb123-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-122-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-101"><img src="chapter33_files/figure-html/unnamed-chunk-122-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb124"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb124-2"><a href="#cb124-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"igraph"</span>, <span class="at">algorithm =</span> <span class="st">"grid"</span>) <span class="sc">+</span></span>
<span id="cb124-3"><a href="#cb124-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>lon, <span class="at">color =</span> lat, <span class="at">width=</span><span class="fl">0.9</span>, <span class="at">height=</span><span class="fl">0.9</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-123-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-102"><img src="chapter33_files/figure-html/unnamed-chunk-123-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb125"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb125-2"><a href="#cb125-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"stress"</span>) <span class="sc">+</span></span>
<span id="cb125-3"><a href="#cb125-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_voronoi</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">fill=</span><span class="fu">factor</span>(lat), <span class="at">alpha =</span> <span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb125-4"><a href="#cb125-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-124-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-103"><img src="chapter33_files/figure-html/unnamed-chunk-124-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb126"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb126-2"><a href="#cb126-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb126-3"><a href="#cb126-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">r =</span> lon<span class="sc">/</span><span class="dv">10000</span>, <span class="at">color =</span> <span class="fu">factor</span>(lon)))<span class="sc">+</span></span>
<span id="cb126-4"><a href="#cb126-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-125-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-104"><img src="chapter33_files/figure-html/unnamed-chunk-125-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb127"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">2</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb127-2"><a href="#cb127-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colors =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb127-3"><a href="#cb127-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"partition"</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb127-4"><a href="#cb127-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_arc_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(colors))) <span class="co"># 内→外へのtreeになっている</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-126-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-105"><img src="chapter33_files/figure-html/unnamed-chunk-126-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-6-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb128"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb128-2"><a href="#cb128-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fabric"</span>) <span class="sc">+</span></span>
<span id="cb128-3"><a href="#cb128-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_range</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(lon)))<span class="sc">+</span></span>
<span id="cb128-4"><a href="#cb128-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-127-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-106"><img src="chapter33_files/figure-html/unnamed-chunk-127-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="edgeの表示" class="level4" data-number="33.6.1.3">
<h4 data-number="33.6.1.3" class="anchored" data-anchor-id="edgeの表示"><span class="header-section-number">33.6.1.3</span> edgeの表示</h4>
<p>edgeの表示には、<code>geom_edge_</code>関数を用います。<code>geom_edge_</code>関数は<code>geom_node_</code>関数とほぼ同じように用います。つまり、<code>geom_edge_</code>の後に形状を指定する単語（<code>link</code>、<code>arc</code>など）を繋いだ関数として用い、<code>ggraph</code>関数に<code>+</code>でつないで用います。</p>
<p><code>geom_edge_link</code>関数や<code>geom_edge_arc</code>関数のように比較的使いやすいものから、平行するedge（同じnode間をつなぐ複数のedge）を示すときだけに用いるもの（<code>geom_edge_parallel</code>、<code>geom_edge_fan</code>）、ループ（ノードからそのノード自身に接続するedge）を示すときだけに用いるもの（<code>geom_edge_loop</code>）、特定のlayout・nodeと共に用いることが想定されているもの（<code>geom_edge_hive</code>、<code>geom_edge_span</code>）など、特定の場合以外にはほぼ用いないものもあります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">link</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">arc</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">parallel</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">fan</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">loop</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" role="tab" aria-controls="tabset-7-6" aria-selected="false">diagonal</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" role="tab" aria-controls="tabset-7-7" aria-selected="false">elbow</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-8" role="tab" aria-controls="tabset-7-8" aria-selected="false">bend</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-9-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-9" role="tab" aria-controls="tabset-7-9" aria-selected="false">hive</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-10-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-10" role="tab" aria-controls="tabset-7-10" aria-selected="false">span</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-11-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-11" role="tab" aria-controls="tabset-7-11" aria-selected="false">point</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-12-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-12" role="tab" aria-controls="tabset-7-12" aria-selected="false">tile</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-13-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-13" role="tab" aria-controls="tabset-7-13" aria-selected="false">density</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-14-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-14" role="tab" aria-controls="tabset-7-14" aria-selected="false">bundle_force</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-15-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-15" role="tab" aria-controls="tabset-7-15" aria-selected="false">bundle_path</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-16-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-16" role="tab" aria-controls="tabset-7-16" aria-selected="false">bundle_path</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb129"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb129-2"><a href="#cb129-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"dendrogram"</span>) <span class="sc">+</span> </span>
<span id="cb129-3"><a href="#cb129-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb129-4"><a href="#cb129-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-128-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-107"><img src="chapter33_files/figure-html/unnamed-chunk-128-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb130"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>karate  <span class="sc">|&gt;</span></span>
<span id="cb130-2"><a href="#cb130-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb130-3"><a href="#cb130-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb130-4"><a href="#cb130-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>()</span>
<span id="cb130-5"><a href="#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "stress" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-129-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-108"><img src="chapter33_files/figure-html/unnamed-chunk-129-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb131"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a><span class="co"># マニュアルの例の通り</span></span>
<span id="cb131-2"><a href="#cb131-2" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">create_notable</span>(<span class="st">'bull'</span>) <span class="sc">|&gt;</span></span>
<span id="cb131-3"><a href="#cb131-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert</span>(to_directed) <span class="sc">|&gt;</span></span>
<span id="cb131-4"><a href="#cb131-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb131-5"><a href="#cb131-5" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb131-6"><a href="#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(gr, <span class="st">'stress'</span>) <span class="sc">+</span></span>
<span id="cb131-7"><a href="#cb131-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb131-8"><a href="#cb131-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_parallel</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(index)))<span class="sc">+</span></span>
<span id="cb131-9"><a href="#cb131-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-130-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-109"><img src="chapter33_files/figure-html/unnamed-chunk-130-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb132"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">create_notable</span>(<span class="st">'bull'</span>) <span class="sc">|&gt;</span></span>
<span id="cb132-2"><a href="#cb132-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert</span>(to_directed) <span class="sc">|&gt;</span></span>
<span id="cb132-3"><a href="#cb132-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb132-4"><a href="#cb132-4" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb132-5"><a href="#cb132-5" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(gr, <span class="st">'stress'</span>) <span class="sc">+</span></span>
<span id="cb132-6"><a href="#cb132-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb132-7"><a href="#cb132-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_fan</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(index)))<span class="sc">+</span></span>
<span id="cb132-8"><a href="#cb132-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-131-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-110"><img src="chapter33_files/figure-html/unnamed-chunk-131-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb133"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb133-2"><a href="#cb133-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb133-3"><a href="#cb133-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb133-4"><a href="#cb133-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb133-5"><a href="#cb133-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_loop</span>() <span class="sc">+</span> <span class="co"># node自身への接続（ループ）を表示する</span></span>
<span id="cb133-6"><a href="#cb133-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_fan</span>()</span>
<span id="cb133-7"><a href="#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "stress" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-132-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-111"><img src="chapter33_files/figure-html/unnamed-chunk-132-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb134"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb134-2"><a href="#cb134-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"dendrogram"</span>) <span class="sc">+</span> </span>
<span id="cb134-3"><a href="#cb134-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb134-4"><a href="#cb134-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="co"># ベジェ曲線</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-133-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-112"><img src="chapter33_files/figure-html/unnamed-chunk-133-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb135"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb135-2"><a href="#cb135-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb135-3"><a href="#cb135-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb135-4"><a href="#cb135-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_elbow</span>()</span>
<span id="cb135-5"><a href="#cb135-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "tree" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-134-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-113"><img src="chapter33_files/figure-html/unnamed-chunk-134-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb136"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb136-2"><a href="#cb136-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb136-3"><a href="#cb136-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb136-4"><a href="#cb136-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bend</span>()</span>
<span id="cb136-5"><a href="#cb136-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "tree" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-135-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-114"><img src="chapter33_files/figure-html/unnamed-chunk-135-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-9" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-9-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb137"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb137-1"><a href="#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb137-2"><a href="#cb137-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb137-3"><a href="#cb137-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"hive"</span>, <span class="at">axis =</span> group) <span class="sc">+</span> </span>
<span id="cb137-4"><a href="#cb137-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb137-5"><a href="#cb137-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_hive</span>() <span class="co"># axis間しか繋がない</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-136-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-115"><img src="chapter33_files/figure-html/unnamed-chunk-136-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-10" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-10-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb138"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb138-1"><a href="#cb138-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb138-2"><a href="#cb138-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fabric"</span>) <span class="sc">+</span></span>
<span id="cb138-3"><a href="#cb138-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_range</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(lon)))<span class="sc">+</span></span>
<span id="cb138-4"><a href="#cb138-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb138-5"><a href="#cb138-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_span</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-137-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-116"><img src="chapter33_files/figure-html/unnamed-chunk-137-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-11" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-11-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb139"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb139-1"><a href="#cb139-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb139-2"><a href="#cb139-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb139-3"><a href="#cb139-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb139-4"><a href="#cb139-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(linename)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-138-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-117"><img src="chapter33_files/figure-html/unnamed-chunk-138-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-12" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-12-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb140"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb140-1"><a href="#cb140-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb140-2"><a href="#cb140-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"matrix"</span>) <span class="sc">+</span></span>
<span id="cb140-3"><a href="#cb140-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb140-4"><a href="#cb140-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_tile</span>(<span class="fu">aes</span>(<span class="at">color =</span> linename, <span class="at">fill=</span>linename))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-139-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-118"><img src="chapter33_files/figure-html/unnamed-chunk-139-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-13" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-13-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb141"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb141-1"><a href="#cb141-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb141-2"><a href="#cb141-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb141-3"><a href="#cb141-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb141-4"><a href="#cb141-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb141-5"><a href="#cb141-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_density</span>(<span class="fu">aes</span>(<span class="at">fill=</span>linename))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-140-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-119"><img src="chapter33_files/figure-html/unnamed-chunk-140-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-14" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-14-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb142"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb142-1"><a href="#cb142-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">"Zachary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb142-2"><a href="#cb142-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb142-3"><a href="#cb142-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb142-4"><a href="#cb142-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb142-5"><a href="#cb142-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb142-6"><a href="#cb142-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bundle_force</span>()</span>
<span id="cb142-7"><a href="#cb142-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "stress" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-141-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-120"><img src="chapter33_files/figure-html/unnamed-chunk-141-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-15" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-15-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb143"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb143-1"><a href="#cb143-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">"Zachary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb143-2"><a href="#cb143-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb143-3"><a href="#cb143-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb143-4"><a href="#cb143-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb143-5"><a href="#cb143-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb143-6"><a href="#cb143-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bundle_path</span>()</span>
<span id="cb143-7"><a href="#cb143-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "stress" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-142-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-121"><img src="chapter33_files/figure-html/unnamed-chunk-142-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-7-16" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-16-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb144"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb144-1"><a href="#cb144-1" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">"Zachary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb144-2"><a href="#cb144-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb144-3"><a href="#cb144-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb144-4"><a href="#cb144-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb144-5"><a href="#cb144-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb144-6"><a href="#cb144-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bundle_minimal</span>()</span>
<span id="cb144-7"><a href="#cb144-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Using "stress" as default layout</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-143-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-122"><img src="chapter33_files/figure-html/unnamed-chunk-143-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="faceting" class="level4" data-number="33.6.1.4">
<h4 data-number="33.6.1.4" class="anchored" data-anchor-id="faceting"><span class="header-section-number">33.6.1.4</span> faceting</h4>
<p><code>ggplot2</code>と同じように、<code>facet</code>関数を用いることで、tbl_graphに含まれている変数（<code>igraph</code>における<code>attribute</code>）を用いてグラフを分割し、表示することができます。<code>facet</code>関数には<code>facet_graph</code>、<code>facet_node</code>、<code>facet_edge</code>の3つの関数があり、それぞれ使用感が少しずつ異なります。</p>
<p><code>facet</code>関数の引数にはチルダ（<code>~</code>）を用い、チルダの右辺、もしくは両辺に変数を指定することで、グラフを分割表示することができます。</p>
<p><code>ggraph</code>には上に示したものの他に、色や文字等を指定するたくさんの関数が設定されています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>faceting</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb145"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb145-1"><a href="#cb145-1" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb145-2"><a href="#cb145-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb145-3"><a href="#cb145-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">color =</span> company)) <span class="sc">+</span></span>
<span id="cb145-4"><a href="#cb145-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(, <span class="at">color =</span> company)) <span class="sc">+</span></span>
<span id="cb145-5"><a href="#cb145-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_graph</span>(<span class="sc">~</span> company)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-144-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-123"><img src="chapter33_files/figure-html/unnamed-chunk-144-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb146"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb146-1"><a href="#cb146-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb146-2"><a href="#cb146-2" aria-hidden="true" tabindex="-1"></a><span class="co"># 上と同じ</span></span>
<span id="cb146-3"><a href="#cb146-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb146-4"><a href="#cb146-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb146-5"><a href="#cb146-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">color =</span> company)) <span class="sc">+</span></span>
<span id="cb146-6"><a href="#cb146-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(, <span class="at">color =</span> company)) <span class="sc">+</span></span>
<span id="cb146-7"><a href="#cb146-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_nodes</span>(<span class="sc">~</span> company)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-144-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-124"><img src="chapter33_files/figure-html/unnamed-chunk-144-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb147"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb147-1"><a href="#cb147-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb147-2"><a href="#cb147-2" aria-hidden="true" tabindex="-1"></a><span class="co"># edgeだけが2つに分かれる</span></span>
<span id="cb147-3"><a href="#cb147-3" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb147-4"><a href="#cb147-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb147-5"><a href="#cb147-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name, <span class="at">color =</span> company)) <span class="sc">+</span></span>
<span id="cb147-6"><a href="#cb147-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>(<span class="fu">aes</span>(, <span class="at">color =</span> company)) <span class="sc">+</span></span>
<span id="cb147-7"><a href="#cb147-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">facet_edges</span>(<span class="sc">~</span> company)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter33_files/figure-html/unnamed-chunk-144-3.png" class="lightbox" data-gallery="quarto-lightbox-gallery-125"><img src="chapter33_files/figure-html/unnamed-chunk-144-3.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="networkd3" class="level3" data-number="33.6.2">
<h3 data-number="33.6.2" class="anchored" data-anchor-id="networkd3"><span class="header-section-number">33.6.2</span> networkD3</h3>
<p>上記のように<code>igraph</code>の<code>plot</code>関数や<code>ggraph</code>で静的なグラフを準備すれば、論文や出版物、プレゼンテーションで示すグラフとしては十分ですが、Web上ではグラフをインタラクティブに示すことでグラフの構造を読み取りやすくできる場合があります。</p>
<p>このようなインタラクティブなグラフの表示を行うためのライブラリが<code>networkD3</code><span class="citation" data-cites="networkD3_bib">(<a href="references.html#ref-networkD3_bib" role="doc-biblioref">Allaire et al. 2017</a>)</span>です。<code>networkD3</code>はJavascriptのグラフィックライブラリである<a href="https://d3js.org/">D3.js</a>をRに持ち込んで、ネットワークの表記ができるようにしたものです。</p>
<p>D3.jsを用いることができるライブラリには<a href="https://rstudio.github.io/r2d3/"><code>r2d3</code></a><span class="citation" data-cites="r2d3_bib">(<a href="references.html#ref-r2d3_bib" role="doc-biblioref">Strayer, Luraschi, and Allaire 2022</a>)</span>もありますが、<code>r2d3</code>との違いはネットワークの表記にのみ対応していることで、<code>r2d3</code>でもネットワークを表記することはできます。ただし、<code>r2d3</code>はデータの準備がかなり独特（<a href="https://github.com/rstudio/r2d3/blob/main/vignettes/gallery/dendogram/flare.csv"><code>r2d3</code>のgithubページ</a>を参照。idの列にネットワークの情報を入力）ですので、<code>networkD3</code>の方が比較的使いやすいでしょう。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ライブラリの読み込み</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb148"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb148-1"><a href="#cb148-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(networkD3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<section id="データの準備" class="level4" data-number="33.6.2.1">
<h4 data-number="33.6.2.1" class="anchored" data-anchor-id="データの準備"><span class="header-section-number">33.6.2.1</span> データの準備</h4>
<p><code>networkD3</code>でのグラフ表記には、nodeのデータフレームとedgeのデータフレームをそれぞれ独立に準備する必要があります。<code>igraph</code>や<code>tidygraph</code>のグラフオブジェクトを<code>networkD3</code>で利用する場合には、<code>igraph_to_networkD3</code>関数でデータをリストに変換します。この<code>igraph_to_networkD3</code>関数は<code>igraph</code>のオブジェクトをnodeのデータフレーム、edgeのデータフレーム（名前は<code>links</code>）からなるリストに変換してくれるだけの関数です。<code>group</code>引数を指定すると、元の<code>igraph</code>オブジェクトのattributeやベクターをnodeのデータフレームに付け加えることもできます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ファイルの準備</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb149"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb149-1"><a href="#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="co"># dとvtからネットワークを作成</span></span>
<span id="cb149-2"><a href="#cb149-2" aria-hidden="true" tabindex="-1"></a>nara_stations <span class="ot">&lt;-</span> <span class="fu">graph_from_data_frame</span>(d, <span class="at">vertices =</span> vt, <span class="at">directed =</span> <span class="cn">FALSE</span>)</span>
<span id="cb149-3"><a href="#cb149-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-4"><a href="#cb149-4" aria-hidden="true" tabindex="-1"></a>ns_D3 <span class="ot">&lt;-</span> nara_stations <span class="sc">|&gt;</span> </span>
<span id="cb149-5"><a href="#cb149-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">igraph_to_networkD3</span>(<span class="at">group =</span> <span class="fu">V</span>(nara_stations)<span class="sc">$</span>linename)</span>
<span id="cb149-6"><a href="#cb149-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb149-7"><a href="#cb149-7" aria-hidden="true" tabindex="-1"></a>ns_D3<span class="sc">$</span>links <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># edge_listに似たデータフレーム</span></span>
<span id="cb149-8"><a href="#cb149-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   source target</span></span>
<span id="cb149-9"><a href="#cb149-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 1     15     16</span></span>
<span id="cb149-10"><a href="#cb149-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2     55     56</span></span>
<span id="cb149-11"><a href="#cb149-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 3     30     31</span></span>
<span id="cb149-12"><a href="#cb149-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 4     83     84</span></span>
<span id="cb149-13"><a href="#cb149-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 5     74     75</span></span>
<span id="cb149-14"><a href="#cb149-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 6     82     83</span></span>
<span id="cb149-15"><a href="#cb149-15" aria-hidden="true" tabindex="-1"></a>ns_D3<span class="sc">$</span>nodes <span class="sc">|&gt;</span> <span class="fu">head</span>() <span class="co"># nodeをまとめたもの</span></span>
<span id="cb149-16"><a href="#cb149-16" aria-hidden="true" tabindex="-1"></a><span class="do">##   name          group</span></span>
<span id="cb149-17"><a href="#cb149-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 奈良 万葉まほろば線</span></span>
<span id="cb149-18"><a href="#cb149-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2 京終 万葉まほろば線</span></span>
<span id="cb149-19"><a href="#cb149-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 3 帯解 万葉まほろば線</span></span>
<span id="cb149-20"><a href="#cb149-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 4 櫟本 万葉まほろば線</span></span>
<span id="cb149-21"><a href="#cb149-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 5 天理 万葉まほろば線</span></span>
<span id="cb149-22"><a href="#cb149-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 6 長柄 万葉まほろば線</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="simplenetwork関数" class="level4" data-number="33.6.2.2">
<h4 data-number="33.6.2.2" class="anchored" data-anchor-id="simplenetwork関数"><span class="header-section-number">33.6.2.2</span> simpleNetwork関数</h4>
<p>最も簡単にネットワークを表示するための関数が、<code>simpleNetwork</code>関数です。この関数の引数にedgeを示すデータフレームを設定するだけで、D3.jsを用いたネットワークを表示することができます。このグラフ上では、nodeをドラッグすることでnodeを移動させて表記することができます。</p>
<p>ただし、この<code>simpleNetwork</code>をそのまま用いるとグラフが拡大されすぎて見えなかったり、nodeの意味がよくわからなくなったりします。グラフが拡大されて見にくい問題は引数に<code>zoom = TRUE</code>することで拡大・縮小できるようにすることで対処できます。しかし、他の情報を表示するのにはこの<code>simpleNetwork</code>関数は向いていません。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>simpleNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb150"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb150-1"><a href="#cb150-1" aria-hidden="true" tabindex="-1"></a><span class="fu">simpleNetwork</span>(ns_D3<span class="sc">$</span>links, <span class="at">zoom =</span> <span class="cn">TRUE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-6511565612ad4ff5bb52" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-6511565612ad4ff5bb52">{"x":{"links":{"source":[26,70,43,101,91,100,110,74,89,80,90,34,95,75,105,33,104,0,30,115,67,107,85,113,66,0,39,71,47,116,35,29,108,25,27,13,85,59,55,41,97,23,11,86,94,24,78,10,84,3,111,63,23,51,76,63,9,4,78,2,79,50,65,60,72,12,53,1,99,108,6,54,118,38,103,28,62,108,36,77,58,56,117,8,53,42,73,46,41,82,68,44,70,114,81,63,106,45,57,23,78,83,92,109,87,98,48,61,0,69,23,88,34,34,64,49,102,93,32,31],"target":[27,71,44,102,92,101,111,76,90,91,91,96,96,86,19,34,105,1,32,116,68,20,106,21,67,40,40,72,48,117,36,30,2,26,28,28,87,60,56,43,108,37,22,97,95,25,6,11,85,4,112,112,52,52,77,113,10,5,5,15,80,51,66,18,73,14,14,31,100,7,7,55,3,39,104,29,63,8,16,78,59,57,118,9,64,53,74,47,109,83,69,45,12,115,82,65,107,46,58,24,79,84,93,110,88,99,49,62,17,70,38,89,35,98,75,50,103,94,33,42],"value":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["0","1","10","100","101","102","103","104","105","106","107","108","109","11","110","111","112","113","114","115","116","117","118","12","13","14","15","16","17","18","19","2","20","21","22","23","24","25","26","27","28","29","3","30","31","32","33","34","35","36","37","38","39","4","40","41","42","43","44","45","46","47","48","49","5","50","51","52","53","54","55","56","57","58","59","6","60","61","62","63","64","65","66","67","68","69","7","70","71","72","73","74","75","76","77","78","79","8","80","81","82","83","84","85","86","87","88","89","9","90","91","92","93","94","95","96","97","98","99"],"group":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],"nodesize":[8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(['#3182bd'])","fontSize":7,"fontFamily":"serif","clickTextSize":17.5,"linkDistance":50,"linkWidth":"'1.5px'.toString()","charge":-30,"opacity":0.6,"zoom":true,"legend":false,"arrows":false,"nodesize":true,"radiusCalculation":"d.nodesize","bounded":false,"opacityNoHover":1,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="forcenetwork" class="level4" data-number="33.6.2.3">
<h4 data-number="33.6.2.3" class="anchored" data-anchor-id="forcenetwork"><span class="header-section-number">33.6.2.3</span> forceNetwork</h4>
<p>もう少し情報を詰め込んだグラフを作成するための関数が<code>forceNetwork</code>関数です。この関数ではedgeのデータフレーム（<code>Links</code>引数）とnodeのデータフレーム（<code>Nodes</code>引数）を別に指定することができます。</p>
<p>この関数では、ネットワークの接続（edgelistに当たるもの）を<code>Source</code>と<code>Target</code>引数に、edgeの太さを<code>Value</code>引数に、ノードに表示される名前を<code>NodeID</code>引数に、色などのグループ分けを<code>Group</code>引数に指定することで、比較的簡単に情報量の多いインタラクティブなグラフを作成することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>forceNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb151"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb151-1"><a href="#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="fu">forceNetwork</span>(</span>
<span id="cb151-2"><a href="#cb151-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">Links =</span> ns_D3<span class="sc">$</span>links,</span>
<span id="cb151-3"><a href="#cb151-3" aria-hidden="true" tabindex="-1"></a>  <span class="at">Nodes =</span> ns_D3<span class="sc">$</span>nodes,</span>
<span id="cb151-4"><a href="#cb151-4" aria-hidden="true" tabindex="-1"></a>  <span class="at">Source =</span> <span class="st">"source"</span>,</span>
<span id="cb151-5"><a href="#cb151-5" aria-hidden="true" tabindex="-1"></a>  <span class="at">Target =</span> <span class="st">"target"</span>,</span>
<span id="cb151-6"><a href="#cb151-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">NodeID =</span> <span class="st">"name"</span>,</span>
<span id="cb151-7"><a href="#cb151-7" aria-hidden="true" tabindex="-1"></a>  <span class="at">Group =</span> <span class="st">"group"</span>,</span>
<span id="cb151-8"><a href="#cb151-8" aria-hidden="true" tabindex="-1"></a>  <span class="at">fontSize =</span> <span class="dv">30</span>, <span class="at">zoom =</span> <span class="cn">TRUE</span></span>
<span id="cb151-9"><a href="#cb151-9" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="forceNetwork html-widget html-fill-item" id="htmlwidget-b282ab022ea1363ff574" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b282ab022ea1363ff574">{"x":{"links":{"source":[15,55,30,83,74,82,91,59,72,64,73,22,78,6,87,21,86,0,19,96,52,89,69,94,51,0,27,56,34,97,23,18,9,14,16,11,69,45,41,29,8,12,108,7,77,13,62,107,68,100,92,49,12,38,60,49,106,101,62,10,63,37,50,46,57,109,4,1,81,9,103,40,99,26,85,17,48,9,24,61,44,42,98,105,4,3,58,33,29,66,53,31,55,95,65,49,88,32,43,12,62,67,75,90,70,80,35,47,0,54,12,71,22,22,5,36,84,76,20,2],"target":[16,56,31,84,75,83,92,60,73,74,74,79,79,7,115,22,87,1,20,97,53,116,88,117,52,28,28,57,35,98,24,19,10,15,17,17,70,46,42,30,9,25,118,8,78,14,103,108,69,101,93,93,39,39,61,94,107,102,102,111,64,38,51,114,58,110,110,2,82,104,104,41,100,27,86,18,49,105,112,62,45,43,99,106,5,4,59,34,90,67,54,32,109,96,66,50,89,33,44,13,63,68,76,91,71,81,36,48,113,55,26,72,23,80,6,37,85,77,21,3],"colour":["#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666","#666"]},"nodes":{"name":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"],"group":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","和歌山線","和歌山線","大和路線","田原本線","吉野線","御所線","奈良線","大阪線"]},"options":{"NodeID":"name","Group":"group","colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":30,"fontFamily":"serif","clickTextSize":75,"linkDistance":50,"linkWidth":"function(d) { return Math.sqrt(d.value); }","charge":-30,"opacity":0.6,"zoom":true,"legend":false,"arrows":false,"nodesize":false,"radiusCalculation":" Math.sqrt(d.nodesize)+6","bounded":false,"opacityNoHover":0,"clickAction":null}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="dendronetwork" class="level4" data-number="33.6.2.4">
<h4 data-number="33.6.2.4" class="anchored" data-anchor-id="dendronetwork"><span class="header-section-number">33.6.2.4</span> dendroNetwork</h4>
<p><code>dendroNetwork</code>関数はネットワークではなく、階層ありクラスタリングの結果を表示するための関数です。引数に取れるのは<code>hclust</code>関数の返り値（<code>hclust</code>クラスのオブジェクト）だけです。<code>dendroNetwork</code>関数を用いることで簡単にインタラクティブな階層ありクラスタリングの結果を表示することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>dendroNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb152"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb152-1"><a href="#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="co"># hclustクラスのオブジェクトをプロットする</span></span>
<span id="cb152-2"><a href="#cb152-2" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(<span class="fu">dist</span>(USArrests))</span>
<span id="cb152-3"><a href="#cb152-3" aria-hidden="true" tabindex="-1"></a><span class="fu">dendroNetwork</span>(hc)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div id="htmlwidget-4018dcfeb9d1b2595ccd" style="width:100%;height:406px;" class="dendroNetwork html-widget"></div>
<script type="application/json" data-for="htmlwidget-4018dcfeb9d1b2595ccd">{"x":{"root":{"name":"","y":293.6227511620992,"children":[{"name":"","y":102.8615574449464,"children":[{"name":"","y":38.5279119600323,"children":[{"name":"Florida","y":0,"textColour":"#111","textOpacity":0.9},{"name":"North Carolina","y":0,"textColour":"#111","textOpacity":0.9}]},{"name":"","y":64.99361507102063,"children":[{"name":"","y":48.72514751132109,"children":[{"name":"","y":16.9767488053514,"children":[{"name":"Delaware","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":15.4544491975612,"children":[{"name":"Alabama","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Louisiana","y":0,"textColour":"#111","textOpacity":0.9}]}]},{"name":"","y":28.63511829903973,"children":[{"name":"Alaska","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":21.16719159454083,"children":[{"name":"Mississippi","y":0,"textColour":"#111","textOpacity":0.9},{"name":"South Carolina","y":0,"textColour":"#111","textOpacity":0.9}]}]}]},{"name":"","y":53.59337645642417,"children":[{"name":"","y":15.8902485820707,"children":[{"name":"Maryland","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":13.89604260212237,"children":[{"name":"Arizona","y":0,"textColour":"#111","textOpacity":0.9},{"name":"New Mexico","y":0,"textColour":"#111","textOpacity":0.9}]}]},{"name":"","y":32.7188019340562,"children":[{"name":"California","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":22.36604569431083,"children":[{"name":"","y":6.23698645180507,"children":[{"name":"Illinois","y":0,"textColour":"#111","textOpacity":0.9},{"name":"New York","y":0,"textColour":"#111","textOpacity":0.9}]},{"name":"","y":13.29736816065495,"children":[{"name":"Michigan","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Nevada","y":0,"textColour":"#111","textOpacity":0.9}]}]}]}]}]}]},{"name":"","y":168.6114171697753,"children":[{"name":"","y":68.76227163205125,"children":[{"name":"","y":36.73486082728503,"children":[{"name":"","y":24.89437687510977,"children":[{"name":"Missouri","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":12.61427762497718,"children":[{"name":"Arkansas","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Tennessee","y":0,"textColour":"#111","textOpacity":0.9}]}]},{"name":"","y":25.09302691984369,"children":[{"name":"Georgia","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":14.50103444585937,"children":[{"name":"Colorado","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Texas","y":0,"textColour":"#111","textOpacity":0.9}]}]}]},{"name":"","y":36.84793074244468,"children":[{"name":"Rhode Island","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":29.25064101861701,"children":[{"name":"","y":15.63009916795156,"children":[{"name":"Wyoming","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":12.42497484906911,"children":[{"name":"Oregon","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":7.355270219373317,"children":[{"name":"Oklahoma","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Virginia","y":0,"textColour":"#111","textOpacity":0.9}]}]}]},{"name":"","y":22.7666422645062,"children":[{"name":"Washington","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":11.4564392373896,"children":[{"name":"Massachusetts","y":0,"textColour":"#111","textOpacity":0.9},{"name":"New Jersey","y":0,"textColour":"#111","textOpacity":0.9}]}]}]}]}]},{"name":"","y":87.32634195934237,"children":[{"name":"","y":31.47713455827897,"children":[{"name":"","y":18.26499384067786,"children":[{"name":"","y":6.637770710110436,"children":[{"name":"Ohio","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Utah","y":0,"textColour":"#111","textOpacity":0.9}]},{"name":"","y":8.027452896155792,"children":[{"name":"Connecticut","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Pennsylvania","y":0,"textColour":"#111","textOpacity":0.9}]}]},{"name":"","y":19.90427089847805,"children":[{"name":"","y":13.34915727677219,"children":[{"name":"Nebraska","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":3.834057902536162,"children":[{"name":"Kentucky","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Montana","y":0,"textColour":"#111","textOpacity":0.9}]}]},{"name":"","y":15.40779023740913,"children":[{"name":"Idaho","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":3.9293765408777,"children":[{"name":"Indiana","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Kansas","y":0,"textColour":"#111","textOpacity":0.9}]}]}]}]},{"name":"","y":57.27102234114561,"children":[{"name":"","y":31.62040480449294,"children":[{"name":"Hawaii","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":19.43759244351008,"children":[{"name":"Minnesota","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":10.86001841619065,"children":[{"name":"Wisconsin","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":2.29128784747792,"children":[{"name":"Iowa","y":0,"textColour":"#111","textOpacity":0.9},{"name":"New Hampshire","y":0,"textColour":"#111","textOpacity":0.9}]}]}]}]},{"name":"","y":41.48795005781799,"children":[{"name":"","y":12.7753669223236,"children":[{"name":"West Virginia","y":0,"textColour":"#111","textOpacity":0.9},{"name":"","y":8.537564055396599,"children":[{"name":"Maine","y":0,"textColour":"#111","textOpacity":0.9},{"name":"South Dakota","y":0,"textColour":"#111","textOpacity":0.9}]}]},{"name":"","y":13.04492238382429,"children":[{"name":"North Dakota","y":0,"textColour":"#111","textOpacity":0.9},{"name":"Vermont","y":0,"textColour":"#111","textOpacity":0.9}]}]}]}]}]}]},"options":{"height":500,"width":800,"fontSize":10,"linkColour":"#ccc","nodeColour":"#fff","nodeStroke":"steelblue","textRotate":0,"margins":{"top":40,"right":150,"bottom":40,"left":40},"opacity":0.9,"linkType":"elbow","treeOrientation":"horizontal","zoom":false}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
<section id="その他の関数" class="level4" data-number="33.6.2.5">
<h4 data-number="33.6.2.5" class="anchored" data-anchor-id="その他の関数"><span class="header-section-number">33.6.2.5</span> その他の関数</h4>
<p><code>networkD3</code>には上記の<code>forceNetwork</code>、<code>dendroNetwork</code>の他にも円形・階層型のグラフを表示することができる<code>radialNetwork</code>関数や<code>diagonalNetwork</code>関数、サンキー図を表示する<code>sankeyNetwork</code>関数も備わっています。以下の例ではjsonを<code>jsonline::fromJSON</code>関数でリストにして引数としていますが、<code>sankeyNetwork</code>関数は上記の<code>forceNetwork</code>と同様にedgeとnodeのデータフレームを引数に取ることもできます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>radialNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb153"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb153-1"><a href="#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="co"># JSONのアドレスを読み込み</span></span>
<span id="cb153-2"><a href="#cb153-2" aria-hidden="true" tabindex="-1"></a>URL <span class="ot">&lt;-</span> </span>
<span id="cb153-3"><a href="#cb153-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://cdn.rawgit.com/christophergandrud/networkD3/master/JSONdata//flare.json"</span></span>
<span id="cb153-4"><a href="#cb153-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-5"><a href="#cb153-5" aria-hidden="true" tabindex="-1"></a><span class="co"># JSONをリストにする</span></span>
<span id="cb153-6"><a href="#cb153-6" aria-hidden="true" tabindex="-1"></a>Flare <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(URL, <span class="at">simplifyDataFrame =</span> <span class="cn">FALSE</span>)</span>
<span id="cb153-7"><a href="#cb153-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb153-8"><a href="#cb153-8" aria-hidden="true" tabindex="-1"></a><span class="co"># ネットワークを表示</span></span>
<span id="cb153-9"><a href="#cb153-9" aria-hidden="true" tabindex="-1"></a><span class="fu">radialNetwork</span>(<span class="at">List =</span> Flare, <span class="at">opacity =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="radialNetwork html-widget html-fill-item" id="htmlwidget-9d0cc41806339808040a" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-9d0cc41806339808040a">{"x":{"root":{"name":"flare","children":[{"name":"analytics","children":[{"name":"cluster","children":[{"name":"AgglomerativeCluster","size":3938},{"name":"CommunityStructure","size":3812},{"name":"HierarchicalCluster","size":6714},{"name":"MergeEdge","size":743}]},{"name":"graph","children":[{"name":"BetweennessCentrality","size":3534},{"name":"LinkDistance","size":5731},{"name":"MaxFlowMinCut","size":7840},{"name":"ShortestPaths","size":5914},{"name":"SpanningTree","size":3416}]},{"name":"optimization","children":[{"name":"AspectRatioBanker","size":7074}]}]},{"name":"animate","children":[{"name":"Easing","size":17010},{"name":"FunctionSequence","size":5842},{"name":"interpolate","children":[{"name":"ArrayInterpolator","size":1983},{"name":"ColorInterpolator","size":2047},{"name":"DateInterpolator","size":1375},{"name":"Interpolator","size":8746},{"name":"MatrixInterpolator","size":2202},{"name":"NumberInterpolator","size":1382},{"name":"ObjectInterpolator","size":1629},{"name":"PointInterpolator","size":1675},{"name":"RectangleInterpolator","size":2042}]},{"name":"ISchedulable","size":1041},{"name":"Parallel","size":5176},{"name":"Pause","size":449},{"name":"Scheduler","size":5593},{"name":"Sequence","size":5534},{"name":"Transition","size":9201},{"name":"Transitioner","size":19975},{"name":"TransitionEvent","size":1116},{"name":"Tween","size":6006}]},{"name":"data","children":[{"name":"converters","children":[{"name":"Converters","size":721},{"name":"DelimitedTextConverter","size":4294},{"name":"GraphMLConverter","size":9800},{"name":"IDataConverter","size":1314},{"name":"JSONConverter","size":2220}]},{"name":"DataField","size":1759},{"name":"DataSchema","size":2165},{"name":"DataSet","size":586},{"name":"DataSource","size":3331},{"name":"DataTable","size":772},{"name":"DataUtil","size":3322}]},{"name":"display","children":[{"name":"DirtySprite","size":8833},{"name":"LineSprite","size":1732},{"name":"RectSprite","size":3623},{"name":"TextSprite","size":10066}]},{"name":"flex","children":[{"name":"FlareVis","size":4116}]},{"name":"physics","children":[{"name":"DragForce","size":1082},{"name":"GravityForce","size":1336},{"name":"IForce","size":319},{"name":"NBodyForce","size":10498},{"name":"Particle","size":2822},{"name":"Simulation","size":9983},{"name":"Spring","size":2213},{"name":"SpringForce","size":1681}]},{"name":"query","children":[{"name":"AggregateExpression","size":1616},{"name":"And","size":1027},{"name":"Arithmetic","size":3891},{"name":"Average","size":891},{"name":"BinaryExpression","size":2893},{"name":"Comparison","size":5103},{"name":"CompositeExpression","size":3677},{"name":"Count","size":781},{"name":"DateUtil","size":4141},{"name":"Distinct","size":933},{"name":"Expression","size":5130},{"name":"ExpressionIterator","size":3617},{"name":"Fn","size":3240},{"name":"If","size":2732},{"name":"IsA","size":2039},{"name":"Literal","size":1214},{"name":"Match","size":3748},{"name":"Maximum","size":843},{"name":"methods","children":[{"name":"add","size":593},{"name":"and","size":330},{"name":"average","size":287},{"name":"count","size":277},{"name":"distinct","size":292},{"name":"div","size":595},{"name":"eq","size":594},{"name":"fn","size":460},{"name":"gt","size":603},{"name":"gte","size":625},{"name":"iff","size":748},{"name":"isa","size":461},{"name":"lt","size":597},{"name":"lte","size":619},{"name":"max","size":283},{"name":"min","size":283},{"name":"mod","size":591},{"name":"mul","size":603},{"name":"neq","size":599},{"name":"not","size":386},{"name":"or","size":323},{"name":"orderby","size":307},{"name":"range","size":772},{"name":"select","size":296},{"name":"stddev","size":363},{"name":"sub","size":600},{"name":"sum","size":280},{"name":"update","size":307},{"name":"variance","size":335},{"name":"where","size":299},{"name":"xor","size":354},{"name":"_","size":264}]},{"name":"Minimum","size":843},{"name":"Not","size":1554},{"name":"Or","size":970},{"name":"Query","size":13896},{"name":"Range","size":1594},{"name":"StringUtil","size":4130},{"name":"Sum","size":791},{"name":"Variable","size":1124},{"name":"Variance","size":1876},{"name":"Xor","size":1101}]},{"name":"scale","children":[{"name":"IScaleMap","size":2105},{"name":"LinearScale","size":1316},{"name":"LogScale","size":3151},{"name":"OrdinalScale","size":3770},{"name":"QuantileScale","size":2435},{"name":"QuantitativeScale","size":4839},{"name":"RootScale","size":1756},{"name":"Scale","size":4268},{"name":"ScaleType","size":1821},{"name":"TimeScale","size":5833}]},{"name":"util","children":[{"name":"Arrays","size":8258},{"name":"Colors","size":10001},{"name":"Dates","size":8217},{"name":"Displays","size":12555},{"name":"Filter","size":2324},{"name":"Geometry","size":10993},{"name":"heap","children":[{"name":"FibonacciHeap","size":9354},{"name":"HeapNode","size":1233}]},{"name":"IEvaluable","size":335},{"name":"IPredicate","size":383},{"name":"IValueProxy","size":874},{"name":"math","children":[{"name":"DenseMatrix","size":3165},{"name":"IMatrix","size":2815},{"name":"SparseMatrix","size":3366}]},{"name":"Maths","size":17705},{"name":"Orientation","size":1486},{"name":"palette","children":[{"name":"ColorPalette","size":6367},{"name":"Palette","size":1229},{"name":"ShapePalette","size":2059},{"name":"SizePalette","size":2291}]},{"name":"Property","size":5559},{"name":"Shapes","size":19118},{"name":"Sort","size":6887},{"name":"Stats","size":6557},{"name":"Strings","size":22026}]},{"name":"vis","children":[{"name":"axis","children":[{"name":"Axes","size":1302},{"name":"Axis","size":24593},{"name":"AxisGridLine","size":652},{"name":"AxisLabel","size":636},{"name":"CartesianAxes","size":6703}]},{"name":"controls","children":[{"name":"AnchorControl","size":2138},{"name":"ClickControl","size":3824},{"name":"Control","size":1353},{"name":"ControlList","size":4665},{"name":"DragControl","size":2649},{"name":"ExpandControl","size":2832},{"name":"HoverControl","size":4896},{"name":"IControl","size":763},{"name":"PanZoomControl","size":5222},{"name":"SelectionControl","size":7862},{"name":"TooltipControl","size":8435}]},{"name":"data","children":[{"name":"Data","size":20544},{"name":"DataList","size":19788},{"name":"DataSprite","size":10349},{"name":"EdgeSprite","size":3301},{"name":"NodeSprite","size":19382},{"name":"render","children":[{"name":"ArrowType","size":698},{"name":"EdgeRenderer","size":5569},{"name":"IRenderer","size":353},{"name":"ShapeRenderer","size":2247}]},{"name":"ScaleBinding","size":11275},{"name":"Tree","size":7147},{"name":"TreeBuilder","size":9930}]},{"name":"events","children":[{"name":"DataEvent","size":2313},{"name":"SelectionEvent","size":1880},{"name":"TooltipEvent","size":1701},{"name":"VisualizationEvent","size":1117}]},{"name":"legend","children":[{"name":"Legend","size":20859},{"name":"LegendItem","size":4614},{"name":"LegendRange","size":10530}]},{"name":"operator","children":[{"name":"distortion","children":[{"name":"BifocalDistortion","size":4461},{"name":"Distortion","size":6314},{"name":"FisheyeDistortion","size":3444}]},{"name":"encoder","children":[{"name":"ColorEncoder","size":3179},{"name":"Encoder","size":4060},{"name":"PropertyEncoder","size":4138},{"name":"ShapeEncoder","size":1690},{"name":"SizeEncoder","size":1830}]},{"name":"filter","children":[{"name":"FisheyeTreeFilter","size":5219},{"name":"GraphDistanceFilter","size":3165},{"name":"VisibilityFilter","size":3509}]},{"name":"IOperator","size":1286},{"name":"label","children":[{"name":"Labeler","size":9956},{"name":"RadialLabeler","size":3899},{"name":"StackedAreaLabeler","size":3202}]},{"name":"layout","children":[{"name":"AxisLayout","size":6725},{"name":"BundledEdgeRouter","size":3727},{"name":"CircleLayout","size":9317},{"name":"CirclePackingLayout","size":12003},{"name":"DendrogramLayout","size":4853},{"name":"ForceDirectedLayout","size":8411},{"name":"IcicleTreeLayout","size":4864},{"name":"IndentedTreeLayout","size":3174},{"name":"Layout","size":7881},{"name":"NodeLinkTreeLayout","size":12870},{"name":"PieLayout","size":2728},{"name":"RadialTreeLayout","size":12348},{"name":"RandomLayout","size":870},{"name":"StackedAreaLayout","size":9121},{"name":"TreeMapLayout","size":9191}]},{"name":"Operator","size":2490},{"name":"OperatorList","size":5248},{"name":"OperatorSequence","size":4190},{"name":"OperatorSwitch","size":2581},{"name":"SortOperator","size":2023}]},{"name":"Visualization","size":16540}]}]},"options":{"height":null,"width":null,"fontSize":10,"fontFamily":"serif","linkColour":"#ccc","nodeColour":"#fff","nodeStroke":"steelblue","textColour":"#111","margin":{"top":null,"right":null,"bottom":null,"left":null},"opacity":0.9}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>diagonalNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb154"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb154-1"><a href="#cb154-1" aria-hidden="true" tabindex="-1"></a><span class="fu">diagonalNetwork</span>(<span class="at">List =</span> Flare, <span class="at">opacity =</span> <span class="fl">0.9</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="diagonalNetwork html-widget html-fill-item" id="htmlwidget-f4f0449c646489ea0c5c" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f4f0449c646489ea0c5c">{"x":{"root":{"name":"flare","children":[{"name":"analytics","children":[{"name":"cluster","children":[{"name":"AgglomerativeCluster","size":3938},{"name":"CommunityStructure","size":3812},{"name":"HierarchicalCluster","size":6714},{"name":"MergeEdge","size":743}]},{"name":"graph","children":[{"name":"BetweennessCentrality","size":3534},{"name":"LinkDistance","size":5731},{"name":"MaxFlowMinCut","size":7840},{"name":"ShortestPaths","size":5914},{"name":"SpanningTree","size":3416}]},{"name":"optimization","children":[{"name":"AspectRatioBanker","size":7074}]}]},{"name":"animate","children":[{"name":"Easing","size":17010},{"name":"FunctionSequence","size":5842},{"name":"interpolate","children":[{"name":"ArrayInterpolator","size":1983},{"name":"ColorInterpolator","size":2047},{"name":"DateInterpolator","size":1375},{"name":"Interpolator","size":8746},{"name":"MatrixInterpolator","size":2202},{"name":"NumberInterpolator","size":1382},{"name":"ObjectInterpolator","size":1629},{"name":"PointInterpolator","size":1675},{"name":"RectangleInterpolator","size":2042}]},{"name":"ISchedulable","size":1041},{"name":"Parallel","size":5176},{"name":"Pause","size":449},{"name":"Scheduler","size":5593},{"name":"Sequence","size":5534},{"name":"Transition","size":9201},{"name":"Transitioner","size":19975},{"name":"TransitionEvent","size":1116},{"name":"Tween","size":6006}]},{"name":"data","children":[{"name":"converters","children":[{"name":"Converters","size":721},{"name":"DelimitedTextConverter","size":4294},{"name":"GraphMLConverter","size":9800},{"name":"IDataConverter","size":1314},{"name":"JSONConverter","size":2220}]},{"name":"DataField","size":1759},{"name":"DataSchema","size":2165},{"name":"DataSet","size":586},{"name":"DataSource","size":3331},{"name":"DataTable","size":772},{"name":"DataUtil","size":3322}]},{"name":"display","children":[{"name":"DirtySprite","size":8833},{"name":"LineSprite","size":1732},{"name":"RectSprite","size":3623},{"name":"TextSprite","size":10066}]},{"name":"flex","children":[{"name":"FlareVis","size":4116}]},{"name":"physics","children":[{"name":"DragForce","size":1082},{"name":"GravityForce","size":1336},{"name":"IForce","size":319},{"name":"NBodyForce","size":10498},{"name":"Particle","size":2822},{"name":"Simulation","size":9983},{"name":"Spring","size":2213},{"name":"SpringForce","size":1681}]},{"name":"query","children":[{"name":"AggregateExpression","size":1616},{"name":"And","size":1027},{"name":"Arithmetic","size":3891},{"name":"Average","size":891},{"name":"BinaryExpression","size":2893},{"name":"Comparison","size":5103},{"name":"CompositeExpression","size":3677},{"name":"Count","size":781},{"name":"DateUtil","size":4141},{"name":"Distinct","size":933},{"name":"Expression","size":5130},{"name":"ExpressionIterator","size":3617},{"name":"Fn","size":3240},{"name":"If","size":2732},{"name":"IsA","size":2039},{"name":"Literal","size":1214},{"name":"Match","size":3748},{"name":"Maximum","size":843},{"name":"methods","children":[{"name":"add","size":593},{"name":"and","size":330},{"name":"average","size":287},{"name":"count","size":277},{"name":"distinct","size":292},{"name":"div","size":595},{"name":"eq","size":594},{"name":"fn","size":460},{"name":"gt","size":603},{"name":"gte","size":625},{"name":"iff","size":748},{"name":"isa","size":461},{"name":"lt","size":597},{"name":"lte","size":619},{"name":"max","size":283},{"name":"min","size":283},{"name":"mod","size":591},{"name":"mul","size":603},{"name":"neq","size":599},{"name":"not","size":386},{"name":"or","size":323},{"name":"orderby","size":307},{"name":"range","size":772},{"name":"select","size":296},{"name":"stddev","size":363},{"name":"sub","size":600},{"name":"sum","size":280},{"name":"update","size":307},{"name":"variance","size":335},{"name":"where","size":299},{"name":"xor","size":354},{"name":"_","size":264}]},{"name":"Minimum","size":843},{"name":"Not","size":1554},{"name":"Or","size":970},{"name":"Query","size":13896},{"name":"Range","size":1594},{"name":"StringUtil","size":4130},{"name":"Sum","size":791},{"name":"Variable","size":1124},{"name":"Variance","size":1876},{"name":"Xor","size":1101}]},{"name":"scale","children":[{"name":"IScaleMap","size":2105},{"name":"LinearScale","size":1316},{"name":"LogScale","size":3151},{"name":"OrdinalScale","size":3770},{"name":"QuantileScale","size":2435},{"name":"QuantitativeScale","size":4839},{"name":"RootScale","size":1756},{"name":"Scale","size":4268},{"name":"ScaleType","size":1821},{"name":"TimeScale","size":5833}]},{"name":"util","children":[{"name":"Arrays","size":8258},{"name":"Colors","size":10001},{"name":"Dates","size":8217},{"name":"Displays","size":12555},{"name":"Filter","size":2324},{"name":"Geometry","size":10993},{"name":"heap","children":[{"name":"FibonacciHeap","size":9354},{"name":"HeapNode","size":1233}]},{"name":"IEvaluable","size":335},{"name":"IPredicate","size":383},{"name":"IValueProxy","size":874},{"name":"math","children":[{"name":"DenseMatrix","size":3165},{"name":"IMatrix","size":2815},{"name":"SparseMatrix","size":3366}]},{"name":"Maths","size":17705},{"name":"Orientation","size":1486},{"name":"palette","children":[{"name":"ColorPalette","size":6367},{"name":"Palette","size":1229},{"name":"ShapePalette","size":2059},{"name":"SizePalette","size":2291}]},{"name":"Property","size":5559},{"name":"Shapes","size":19118},{"name":"Sort","size":6887},{"name":"Stats","size":6557},{"name":"Strings","size":22026}]},{"name":"vis","children":[{"name":"axis","children":[{"name":"Axes","size":1302},{"name":"Axis","size":24593},{"name":"AxisGridLine","size":652},{"name":"AxisLabel","size":636},{"name":"CartesianAxes","size":6703}]},{"name":"controls","children":[{"name":"AnchorControl","size":2138},{"name":"ClickControl","size":3824},{"name":"Control","size":1353},{"name":"ControlList","size":4665},{"name":"DragControl","size":2649},{"name":"ExpandControl","size":2832},{"name":"HoverControl","size":4896},{"name":"IControl","size":763},{"name":"PanZoomControl","size":5222},{"name":"SelectionControl","size":7862},{"name":"TooltipControl","size":8435}]},{"name":"data","children":[{"name":"Data","size":20544},{"name":"DataList","size":19788},{"name":"DataSprite","size":10349},{"name":"EdgeSprite","size":3301},{"name":"NodeSprite","size":19382},{"name":"render","children":[{"name":"ArrowType","size":698},{"name":"EdgeRenderer","size":5569},{"name":"IRenderer","size":353},{"name":"ShapeRenderer","size":2247}]},{"name":"ScaleBinding","size":11275},{"name":"Tree","size":7147},{"name":"TreeBuilder","size":9930}]},{"name":"events","children":[{"name":"DataEvent","size":2313},{"name":"SelectionEvent","size":1880},{"name":"TooltipEvent","size":1701},{"name":"VisualizationEvent","size":1117}]},{"name":"legend","children":[{"name":"Legend","size":20859},{"name":"LegendItem","size":4614},{"name":"LegendRange","size":10530}]},{"name":"operator","children":[{"name":"distortion","children":[{"name":"BifocalDistortion","size":4461},{"name":"Distortion","size":6314},{"name":"FisheyeDistortion","size":3444}]},{"name":"encoder","children":[{"name":"ColorEncoder","size":3179},{"name":"Encoder","size":4060},{"name":"PropertyEncoder","size":4138},{"name":"ShapeEncoder","size":1690},{"name":"SizeEncoder","size":1830}]},{"name":"filter","children":[{"name":"FisheyeTreeFilter","size":5219},{"name":"GraphDistanceFilter","size":3165},{"name":"VisibilityFilter","size":3509}]},{"name":"IOperator","size":1286},{"name":"label","children":[{"name":"Labeler","size":9956},{"name":"RadialLabeler","size":3899},{"name":"StackedAreaLabeler","size":3202}]},{"name":"layout","children":[{"name":"AxisLayout","size":6725},{"name":"BundledEdgeRouter","size":3727},{"name":"CircleLayout","size":9317},{"name":"CirclePackingLayout","size":12003},{"name":"DendrogramLayout","size":4853},{"name":"ForceDirectedLayout","size":8411},{"name":"IcicleTreeLayout","size":4864},{"name":"IndentedTreeLayout","size":3174},{"name":"Layout","size":7881},{"name":"NodeLinkTreeLayout","size":12870},{"name":"PieLayout","size":2728},{"name":"RadialTreeLayout","size":12348},{"name":"RandomLayout","size":870},{"name":"StackedAreaLayout","size":9121},{"name":"TreeMapLayout","size":9191}]},{"name":"Operator","size":2490},{"name":"OperatorList","size":5248},{"name":"OperatorSequence","size":4190},{"name":"OperatorSwitch","size":2581},{"name":"SortOperator","size":2023}]},{"name":"Visualization","size":16540}]}]},"options":{"height":null,"width":null,"fontSize":10,"fontFamily":"serif","linkColour":"#ccc","nodeColour":"#fff","nodeStroke":"steelblue","textColour":"#111","margin":{"top":null,"right":null,"bottom":null,"left":null},"opacity":0.9}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>sankeyNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb155"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb155-1"><a href="#cb155-1" aria-hidden="true" tabindex="-1"></a><span class="co"># sankeyNetwork（サンキー図）</span></span>
<span id="cb155-2"><a href="#cb155-2" aria-hidden="true" tabindex="-1"></a>URL <span class="ot">&lt;-</span> </span>
<span id="cb155-3"><a href="#cb155-3" aria-hidden="true" tabindex="-1"></a>  <span class="st">"https://cdn.rawgit.com/christophergandrud/networkD3/master/JSONdata/energy.json"</span></span>
<span id="cb155-4"><a href="#cb155-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb155-5"><a href="#cb155-5" aria-hidden="true" tabindex="-1"></a><span class="co"># データはforceNetworkと同じように準備する（valueがlink側に必要）</span></span>
<span id="cb155-6"><a href="#cb155-6" aria-hidden="true" tabindex="-1"></a>Energy <span class="ot">&lt;-</span> jsonlite<span class="sc">::</span><span class="fu">fromJSON</span>(URL)</span>
<span id="cb155-7"><a href="#cb155-7" aria-hidden="true" tabindex="-1"></a>Energy<span class="sc">$</span>links <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb155-8"><a href="#cb155-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   source target   value</span></span>
<span id="cb155-9"><a href="#cb155-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 1      0      1 124.729</span></span>
<span id="cb155-10"><a href="#cb155-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 2      1      2   0.597</span></span>
<span id="cb155-11"><a href="#cb155-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 3      1      3  26.862</span></span>
<span id="cb155-12"><a href="#cb155-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 4      1      4 280.322</span></span>
<span id="cb155-13"><a href="#cb155-13" aria-hidden="true" tabindex="-1"></a><span class="do">## 5      1      5  81.144</span></span>
<span id="cb155-14"><a href="#cb155-14" aria-hidden="true" tabindex="-1"></a><span class="do">## 6      6      2  35.000</span></span>
<span id="cb155-15"><a href="#cb155-15" aria-hidden="true" tabindex="-1"></a>Energy<span class="sc">$</span>nodes <span class="sc">|&gt;</span> <span class="fu">head</span>()</span>
<span id="cb155-16"><a href="#cb155-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                   name</span></span>
<span id="cb155-17"><a href="#cb155-17" aria-hidden="true" tabindex="-1"></a><span class="do">## 1 Agricultural 'waste'</span></span>
<span id="cb155-18"><a href="#cb155-18" aria-hidden="true" tabindex="-1"></a><span class="do">## 2       Bio-conversion</span></span>
<span id="cb155-19"><a href="#cb155-19" aria-hidden="true" tabindex="-1"></a><span class="do">## 3               Liquid</span></span>
<span id="cb155-20"><a href="#cb155-20" aria-hidden="true" tabindex="-1"></a><span class="do">## 4               Losses</span></span>
<span id="cb155-21"><a href="#cb155-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 5                Solid</span></span>
<span id="cb155-22"><a href="#cb155-22" aria-hidden="true" tabindex="-1"></a><span class="do">## 6                  Gas</span></span>
<span id="cb155-23"><a href="#cb155-23" aria-hidden="true" tabindex="-1"></a><span class="fu">sankeyNetwork</span>(<span class="at">Links =</span> Energy<span class="sc">$</span>links, <span class="at">Nodes =</span> Energy<span class="sc">$</span>nodes, <span class="at">Source =</span> <span class="st">"source"</span>,</span>
<span id="cb155-24"><a href="#cb155-24" aria-hidden="true" tabindex="-1"></a>              <span class="at">Target =</span> <span class="st">"target"</span>, <span class="at">Value =</span> <span class="st">"value"</span>, <span class="at">NodeID =</span> <span class="st">"name"</span>,</span>
<span id="cb155-25"><a href="#cb155-25" aria-hidden="true" tabindex="-1"></a>              <span class="at">units =</span> <span class="st">"TWh"</span>, <span class="at">fontSize =</span> <span class="dv">12</span>, <span class="at">nodeWidth =</span> <span class="dv">30</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="sankeyNetwork html-widget html-fill-item" id="htmlwidget-57f84674966ef733316d" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-57f84674966ef733316d">{"x":{"links":{"source":[0,1,1,1,1,6,7,8,10,9,11,11,11,15,15,15,15,15,15,15,15,15,15,15,23,25,5,5,5,5,5,27,17,17,28,29,2,2,2,2,2,2,2,2,34,24,35,36,38,37,39,39,40,40,41,42,43,43,4,4,4,26,26,26,44,45,46,47],"target":[1,2,3,4,5,2,4,9,9,4,12,13,14,16,14,17,12,18,19,13,3,20,21,22,24,24,13,3,26,19,12,15,28,3,18,15,12,30,18,31,32,19,33,20,1,5,26,37,37,2,4,1,14,13,15,14,42,41,19,26,12,15,3,11,15,1,15,15],"value":[124.729,0.597,26.862,280.322,81.14400000000001,35,35,11.606,63.965,75.571,10.639,22.505,46.184,104.453,113.726,27.14,342.165,37.797,4.412,40.858,56.691,7.863,90.008,93.494,40.719,82.233,0.129,1.401,151.891,2.096,48.58,7.013,20.897,6.242,20.897,6.995,121.066,128.69,135.835,14.458,206.267,3.64,33.218,4.413,4.375,122.952,839.978,504.287,107.703,611.99,56.587,77.81,193.026,70.672,59.901,19.263,19.263,59.901,0.882,400.12,46.477,525.5309999999999,787.129,79.32899999999999,9.452,182.01,19.013,289.366]},"nodes":{"name":["Agricultural 'waste'","Bio-conversion","Liquid","Losses","Solid","Gas","Biofuel imports","Biomass imports","Coal imports","Coal","Coal reserves","District heating","Industry","Heating and cooling - commercial","Heating and cooling - homes","Electricity grid","Over generation / exports","H2 conversion","Road transport","Agriculture","Rail transport","Lighting & appliances - commercial","Lighting & appliances - homes","Gas imports","Ngas","Gas reserves","Thermal generation","Geothermal","H2","Hydro","International shipping","Domestic aviation","International aviation","National navigation","Marine algae","Nuclear","Oil imports","Oil","Oil reserves","Other waste","Pumped heat","Solar PV","Solar Thermal","Solar","Tidal","UK land based bioenergy","Wave","Wind"],"group":["Agricultural 'waste'","Bio-conversion","Liquid","Losses","Solid","Gas","Biofuel imports","Biomass imports","Coal imports","Coal","Coal reserves","District heating","Industry","Heating and cooling - commercial","Heating and cooling - homes","Electricity grid","Over generation / exports","H2 conversion","Road transport","Agriculture","Rail transport","Lighting & appliances - commercial","Lighting & appliances - homes","Gas imports","Ngas","Gas reserves","Thermal generation","Geothermal","H2","Hydro","International shipping","Domestic aviation","International aviation","National navigation","Marine algae","Nuclear","Oil imports","Oil","Oil reserves","Other waste","Pumped heat","Solar PV","Solar Thermal","Solar","Tidal","UK land based bioenergy","Wave","Wind"]},"options":{"NodeID":"name","NodeGroup":"name","LinkGroup":null,"colourScale":"d3.scaleOrdinal(d3.schemeCategory20);","fontSize":12,"fontFamily":null,"nodeWidth":30,"nodePadding":10,"units":"TWh","margin":{"top":null,"right":null,"bottom":null,"left":null},"iterations":32,"sinksRight":true}},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="visnetwork" class="level3" data-number="33.6.3">
<h3 data-number="33.6.3" class="anchored" data-anchor-id="visnetwork"><span class="header-section-number">33.6.3</span> visNetwork</h3>
<p><a href="https://datastorm-open.github.io/visNetwork/">visNetwork</a><span class="citation" data-cites="visNetwork_bib">(<a href="references.html#ref-visNetwork_bib" role="doc-biblioref">Almende B.V. and Contributors and Thieurmel 2022</a>)</span>はD3.jsとは異なるJavascriptのビジュアライゼーションライブラリである<a href="https://visjs.org/">vis.js</a>を用いたインタラクティブなネットワーク描画に関するパッケージです。上記の<code>NetworkD3</code>とは少し違う感じでネットワークが描画されるので、好みの方を用いるとよいでしょう。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ライブラリの読み込み</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb156"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb156-1"><a href="#cb156-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(visNetwork)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<section id="visnetwork関数" class="level4" data-number="33.6.3.1">
<h4 data-number="33.6.3.1" class="anchored" data-anchor-id="visnetwork関数"><span class="header-section-number">33.6.3.1</span> visNetwork関数</h4>
<p><code>visNetwork</code>関数は、<code>NetworkD3</code>の<code>forceNetwork</code>関数に近い使い勝手の関数で、<code>forceNetwork</code>関数と同様にnodeとedgeのデータフレームを引数に取る関数です。ただし、<code>forceNetwork</code>関数が引数で色やnode名の指定を行うのに対し、<code>visNetwork</code>関数は引数に取ったデータフレームの列名に従ってネットワークを描画するという特徴があります。Rの他のグラフィックライブラリとは少し使い勝手が異なります。</p>
<p>nodeに指定するデータフレームには<code>id</code>という名前の列が、edgeに指定するデータフレームには<code>from</code>と<code>to</code>という名前の列が必要です。この列名を読み取って、<code>visNetwork</code>はグラフを描画します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>visNetwork関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb157"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb157-1"><a href="#cb157-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/chapter33_nara_stations.csv"</span>)</span>
<span id="cb157-2"><a href="#cb157-2" aria-hidden="true" tabindex="-1"></a>vt <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">"./data/chapter33_nara_stations_vertex_list.csv"</span>)</span>
<span id="cb157-3"><a href="#cb157-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-4"><a href="#cb157-4" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(d) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"from"</span>, <span class="st">"to"</span>, <span class="st">"linename"</span>, <span class="st">"company"</span>)</span>
<span id="cb157-5"><a href="#cb157-5" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(vt) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"id"</span>, <span class="st">"lat"</span>, <span class="st">"lon"</span>, <span class="st">"linename"</span>, <span class="st">"company"</span>)</span>
<span id="cb157-6"><a href="#cb157-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb157-7"><a href="#cb157-7" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(<span class="at">nodes =</span> vt, <span class="at">edges =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-debb4217e31bde21e4ee" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-debb4217e31bde21e4ee">{"x":{"nodes":{"id":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"],"lat":[34.68077889641153,34.66997984143489,34.64339720801266,34.62100982302106,34.60119543773195,34.57420182671255,34.55911174,34.54543328511998,34.52719176412109,34.51347234556961,34.51078477436202,34.50961825856488,34.59772266332324,34.57763044648121,34.56155155047492,34.543348161339,34.52765142695763,34.51626676022408,34.48866682559694,34.46466321460042,34.45834448,34.45236285,34.42084877882249,34.38266146215452,34.35571728699052,34.58929613435219,34.60149615425941,34.62227622638444,34.6479699755299,34.69332480909848,34.68555025554144,34.67592565829064,34.66550098294679,34.65654675124937,34.64813820858031,34.64006531607362,34.62917355506478,34.61748125646026,34.60599598,34.60099036479767,34.59774906858284,34.58912679518835,34.58517280952235,34.57856652901711,34.57031626307485,34.56934940021956,34.56829566393314,34.72373748110263,34.70172243945424,34.69390609633185,34.68151102159077,34.67053984676916,34.65923128120475,34.64619841955895,34.62041947906572,34.60662381945989,34.59826964651775,34.58457775907492,34.57193856475993,34.55330431156303,34.54178864138176,34.52550929516489,34.51320494803076,34.50924984919699,34.49337312770563,34.53911210202045,34.53161599920064,34.51647123100369,34.51115497242616,34.50854699594273,34.50694131816211,34.49796323,34.49332301951053,34.48612385135785,34.48343873729746,34.47410704338412,34.46487372380226,34.44984226372562,34.44186180817045,34.43159576,34.40729376561155,34.39511489946702,34.38841,34.38366308561198,34.38612467014393,34.39026841927821,34.39549209847647,34.39021851318266,34.48939932064624,34.47597814789609,34.69171006331597,34.69411114338323,34.69693743894673,34.69815792104841,34.68542759,34.55386784122172,34.54635147047126,34.54144051387431,34.53485057281426,34.526179940049,34.51961356895004,34.52069475792074,34.51977847492522,34.51253225676717,34.5129180932103,34.51613962224484,34.52661527,34.52974822358372,34.56602680191052,34.60224893297654,34.60099706553275,34.50834417256181,34.34589064484895,34.71069525271852,34.55365900137742,34.37660548171625,34.46473786196023,34.68435949056003,34.57827531570576],"lon":[135.8189537638132,135.8287374343293,135.8262065675336,135.8262913094558,135.8305393407344,135.8350898486471,135.8384381500308,135.8406692552043,135.8485650985864,135.8467190392171,135.8252192687146,135.7651380089752,135.7022739972764,135.7035114437513,135.7018376200836,135.7059144478943,135.7185746398643,135.7447531,135.7346486007671,135.7348526011892,135.7485952199712,135.7632562070261,135.750536634116,135.7127334,135.6977657634497,135.6866161705931,135.7372663,135.7622579282512,135.7892424485712,135.6972458735988,135.7055773447603,135.7072639713512,135.7077754265108,135.7077245211917,135.7078270539694,135.6998019739194,135.7035329555713,135.7034819970984,135.6988849,135.6944875232455,135.7030223118592,135.719070971162,135.7299571680989,135.736703492343,135.7505023288532,135.7669091734583,135.7763138471451,135.7907662439876,135.7842243361619,135.7861176190244,135.7823339741376,135.7819750539546,135.7815159599058,135.779266361666,135.7817696822717,135.7814129129274,135.7837833614022,135.7846406639496,135.7857483816421,135.791147264396,135.7936850172993,135.7948294158887,135.7922984148161,135.7908413491503,135.7926673191986,135.6858456149057,135.6933931123597,135.7051403509105,135.7104053525259,135.7209353872449,135.7422100615471,135.7542600889347,135.7643640163411,135.7802198298992,135.7924536984949,135.7950715892783,135.7976585903959,135.7942803868968,135.7756852980908,135.7597989818987,135.7423910695577,135.7500906964062,135.7653683,135.7865502672284,135.8020103229443,135.8227355703949,135.8445561912245,135.8469605369775,135.7263025742545,135.7315982181241,135.7098099167597,135.7343579607317,135.7496888726569,135.7602933427443,135.8110317314001,135.6673005419264,135.6876505101159,135.703285550317,135.7170657271586,135.7323966842405,135.7416437040496,135.7617419371281,135.7726004747371,135.8151689974774,135.8298019665447,135.8679592908777,135.9051922391519,135.9541360823177,136.0144265783477,135.7945828528153,135.8159978538317,135.7933757903544,135.6831555207892,135.8098843257658,135.7888029062249,135.8528336507365,135.7316286366128,135.8261283890624,136.0345026748359],"linename":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","和歌山線","和歌山線","大和路線","田原本線","吉野線","御所線","奈良線","大阪線"],"company":["JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄"]},"edges":{"from":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","王寺","法隆寺","大和小泉","郡山","奈良","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","吉野口","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","尺土","近鉄新庄","忍海","生駒","東生駒","富雄","学園前","菖蒲池","大和西大寺","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","大和八木","耳成","大福","桜井","大和朝倉","長谷寺","榛原","室生口大野","平端","二階堂","前栽"],"to":["京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","畝傍","高田","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","大和二見","王寺","法隆寺","大和小泉","郡山","奈良","平城山","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","西田原本","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","橿原神宮前","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","吉野口","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","吉野","近鉄新庄","忍海","近鉄御所","東生駒","富雄","学園前","菖蒲池","大和西大寺","新大宮","近鉄奈良","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","大和八木","耳成","大福","桜井","大和朝倉","長谷寺","榛原","室生口大野","三本松","二階堂","前栽","天理"],"linename":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","天理線"],"company":["JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p><code>visNetwork</code>関数にnodeとedgeを指定しただけでは、nodeをドラッグして位置を変えることができる程度で、nodeの情報などは表示されません。nodeをクリックしたときに表示される文字列は<code>title</code>という列名に指定します。また、nodeの色を変える場合には、nodeに指定するデータフレームに<code>color</code>という列が必要です。この<code>title</code>や<code>color</code>に指定された値・色を読み取って、<code>visNetwork</code>関数はnodeの情報を変更します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>nodeの情報を指定する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb158"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb158-1"><a href="#cb158-1" aria-hidden="true" tabindex="-1"></a>vt<span class="sc">$</span>title <span class="ot">&lt;-</span> vt<span class="sc">$</span>id <span class="co"># nodeをクリックしたときに表示する文字</span></span>
<span id="cb158-2"><a href="#cb158-2" aria-hidden="true" tabindex="-1"></a>vt<span class="sc">$</span>color <span class="ot">&lt;-</span> <span class="fu">if_else</span>(vt<span class="sc">$</span>company <span class="sc">==</span> <span class="st">"JR"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>) <span class="co"># nodeの色</span></span>
<span id="cb158-3"><a href="#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(<span class="at">nodes =</span> vt, <span class="at">edges =</span> d)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-a95c8b4fe9e5fd881ffa" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a95c8b4fe9e5fd881ffa">{"x":{"nodes":{"id":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"],"lat":[34.68077889641153,34.66997984143489,34.64339720801266,34.62100982302106,34.60119543773195,34.57420182671255,34.55911174,34.54543328511998,34.52719176412109,34.51347234556961,34.51078477436202,34.50961825856488,34.59772266332324,34.57763044648121,34.56155155047492,34.543348161339,34.52765142695763,34.51626676022408,34.48866682559694,34.46466321460042,34.45834448,34.45236285,34.42084877882249,34.38266146215452,34.35571728699052,34.58929613435219,34.60149615425941,34.62227622638444,34.6479699755299,34.69332480909848,34.68555025554144,34.67592565829064,34.66550098294679,34.65654675124937,34.64813820858031,34.64006531607362,34.62917355506478,34.61748125646026,34.60599598,34.60099036479767,34.59774906858284,34.58912679518835,34.58517280952235,34.57856652901711,34.57031626307485,34.56934940021956,34.56829566393314,34.72373748110263,34.70172243945424,34.69390609633185,34.68151102159077,34.67053984676916,34.65923128120475,34.64619841955895,34.62041947906572,34.60662381945989,34.59826964651775,34.58457775907492,34.57193856475993,34.55330431156303,34.54178864138176,34.52550929516489,34.51320494803076,34.50924984919699,34.49337312770563,34.53911210202045,34.53161599920064,34.51647123100369,34.51115497242616,34.50854699594273,34.50694131816211,34.49796323,34.49332301951053,34.48612385135785,34.48343873729746,34.47410704338412,34.46487372380226,34.44984226372562,34.44186180817045,34.43159576,34.40729376561155,34.39511489946702,34.38841,34.38366308561198,34.38612467014393,34.39026841927821,34.39549209847647,34.39021851318266,34.48939932064624,34.47597814789609,34.69171006331597,34.69411114338323,34.69693743894673,34.69815792104841,34.68542759,34.55386784122172,34.54635147047126,34.54144051387431,34.53485057281426,34.526179940049,34.51961356895004,34.52069475792074,34.51977847492522,34.51253225676717,34.5129180932103,34.51613962224484,34.52661527,34.52974822358372,34.56602680191052,34.60224893297654,34.60099706553275,34.50834417256181,34.34589064484895,34.71069525271852,34.55365900137742,34.37660548171625,34.46473786196023,34.68435949056003,34.57827531570576],"lon":[135.8189537638132,135.8287374343293,135.8262065675336,135.8262913094558,135.8305393407344,135.8350898486471,135.8384381500308,135.8406692552043,135.8485650985864,135.8467190392171,135.8252192687146,135.7651380089752,135.7022739972764,135.7035114437513,135.7018376200836,135.7059144478943,135.7185746398643,135.7447531,135.7346486007671,135.7348526011892,135.7485952199712,135.7632562070261,135.750536634116,135.7127334,135.6977657634497,135.6866161705931,135.7372663,135.7622579282512,135.7892424485712,135.6972458735988,135.7055773447603,135.7072639713512,135.7077754265108,135.7077245211917,135.7078270539694,135.6998019739194,135.7035329555713,135.7034819970984,135.6988849,135.6944875232455,135.7030223118592,135.719070971162,135.7299571680989,135.736703492343,135.7505023288532,135.7669091734583,135.7763138471451,135.7907662439876,135.7842243361619,135.7861176190244,135.7823339741376,135.7819750539546,135.7815159599058,135.779266361666,135.7817696822717,135.7814129129274,135.7837833614022,135.7846406639496,135.7857483816421,135.791147264396,135.7936850172993,135.7948294158887,135.7922984148161,135.7908413491503,135.7926673191986,135.6858456149057,135.6933931123597,135.7051403509105,135.7104053525259,135.7209353872449,135.7422100615471,135.7542600889347,135.7643640163411,135.7802198298992,135.7924536984949,135.7950715892783,135.7976585903959,135.7942803868968,135.7756852980908,135.7597989818987,135.7423910695577,135.7500906964062,135.7653683,135.7865502672284,135.8020103229443,135.8227355703949,135.8445561912245,135.8469605369775,135.7263025742545,135.7315982181241,135.7098099167597,135.7343579607317,135.7496888726569,135.7602933427443,135.8110317314001,135.6673005419264,135.6876505101159,135.703285550317,135.7170657271586,135.7323966842405,135.7416437040496,135.7617419371281,135.7726004747371,135.8151689974774,135.8298019665447,135.8679592908777,135.9051922391519,135.9541360823177,136.0144265783477,135.7945828528153,135.8159978538317,135.7933757903544,135.6831555207892,135.8098843257658,135.7888029062249,135.8528336507365,135.7316286366128,135.8261283890624,136.0345026748359],"linename":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","和歌山線","和歌山線","大和路線","田原本線","吉野線","御所線","奈良線","大阪線"],"company":["JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄"],"title":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"],"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","red","red","red","blue","blue","blue","blue","blue"]},"edges":{"from":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","王寺","法隆寺","大和小泉","郡山","奈良","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","吉野口","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","尺土","近鉄新庄","忍海","生駒","東生駒","富雄","学園前","菖蒲池","大和西大寺","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","大和八木","耳成","大福","桜井","大和朝倉","長谷寺","榛原","室生口大野","平端","二階堂","前栽"],"to":["京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","畝傍","高田","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","大和二見","王寺","法隆寺","大和小泉","郡山","奈良","平城山","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","西田原本","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","橿原神宮前","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","吉野口","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","吉野","近鉄新庄","忍海","近鉄御所","東生駒","富雄","学園前","菖蒲池","大和西大寺","新大宮","近鉄奈良","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","大和八木","耳成","大福","桜井","大和朝倉","長谷寺","榛原","室生口大野","三本松","二階堂","前栽","天理"],"linename":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","天理線"],"company":["JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"dot"},"manipulation":{"enabled":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false},"byselection":{"enabled":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>また、<code>visNetwork</code>ではパイプ演算子（<code>%&gt;%</code>や<code>|&gt;</code>）を用いてグラフの要素を追加することもできます。<code>visNodes</code>関数をパイプで繋ぐことでnodeの編集、<code>visOptions</code>をパイプで繋ぐことでオプション設定の変更を行うこともできます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>パイプ演算子でグラフを編集する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb159"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb159-1"><a href="#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="fu">visNetwork</span>(<span class="at">nodes =</span> vt, <span class="at">edges =</span> d) <span class="sc">|&gt;</span> </span>
<span id="cb159-2"><a href="#cb159-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visNodes</span>(<span class="at">shape =</span> <span class="st">"square"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb159-3"><a href="#cb159-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># クリックすると連結したノードがハイライトされる</span></span>
<span id="cb159-4"><a href="#cb159-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">visOptions</span>(<span class="at">highlightNearest =</span> <span class="cn">TRUE</span>) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="visNetwork html-widget html-fill-item" id="htmlwidget-f348dab1f0ab9472c8c6" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-f348dab1f0ab9472c8c6">{"x":{"nodes":{"id":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"],"lat":[34.68077889641153,34.66997984143489,34.64339720801266,34.62100982302106,34.60119543773195,34.57420182671255,34.55911174,34.54543328511998,34.52719176412109,34.51347234556961,34.51078477436202,34.50961825856488,34.59772266332324,34.57763044648121,34.56155155047492,34.543348161339,34.52765142695763,34.51626676022408,34.48866682559694,34.46466321460042,34.45834448,34.45236285,34.42084877882249,34.38266146215452,34.35571728699052,34.58929613435219,34.60149615425941,34.62227622638444,34.6479699755299,34.69332480909848,34.68555025554144,34.67592565829064,34.66550098294679,34.65654675124937,34.64813820858031,34.64006531607362,34.62917355506478,34.61748125646026,34.60599598,34.60099036479767,34.59774906858284,34.58912679518835,34.58517280952235,34.57856652901711,34.57031626307485,34.56934940021956,34.56829566393314,34.72373748110263,34.70172243945424,34.69390609633185,34.68151102159077,34.67053984676916,34.65923128120475,34.64619841955895,34.62041947906572,34.60662381945989,34.59826964651775,34.58457775907492,34.57193856475993,34.55330431156303,34.54178864138176,34.52550929516489,34.51320494803076,34.50924984919699,34.49337312770563,34.53911210202045,34.53161599920064,34.51647123100369,34.51115497242616,34.50854699594273,34.50694131816211,34.49796323,34.49332301951053,34.48612385135785,34.48343873729746,34.47410704338412,34.46487372380226,34.44984226372562,34.44186180817045,34.43159576,34.40729376561155,34.39511489946702,34.38841,34.38366308561198,34.38612467014393,34.39026841927821,34.39549209847647,34.39021851318266,34.48939932064624,34.47597814789609,34.69171006331597,34.69411114338323,34.69693743894673,34.69815792104841,34.68542759,34.55386784122172,34.54635147047126,34.54144051387431,34.53485057281426,34.526179940049,34.51961356895004,34.52069475792074,34.51977847492522,34.51253225676717,34.5129180932103,34.51613962224484,34.52661527,34.52974822358372,34.56602680191052,34.60224893297654,34.60099706553275,34.50834417256181,34.34589064484895,34.71069525271852,34.55365900137742,34.37660548171625,34.46473786196023,34.68435949056003,34.57827531570576],"lon":[135.8189537638132,135.8287374343293,135.8262065675336,135.8262913094558,135.8305393407344,135.8350898486471,135.8384381500308,135.8406692552043,135.8485650985864,135.8467190392171,135.8252192687146,135.7651380089752,135.7022739972764,135.7035114437513,135.7018376200836,135.7059144478943,135.7185746398643,135.7447531,135.7346486007671,135.7348526011892,135.7485952199712,135.7632562070261,135.750536634116,135.7127334,135.6977657634497,135.6866161705931,135.7372663,135.7622579282512,135.7892424485712,135.6972458735988,135.7055773447603,135.7072639713512,135.7077754265108,135.7077245211917,135.7078270539694,135.6998019739194,135.7035329555713,135.7034819970984,135.6988849,135.6944875232455,135.7030223118592,135.719070971162,135.7299571680989,135.736703492343,135.7505023288532,135.7669091734583,135.7763138471451,135.7907662439876,135.7842243361619,135.7861176190244,135.7823339741376,135.7819750539546,135.7815159599058,135.779266361666,135.7817696822717,135.7814129129274,135.7837833614022,135.7846406639496,135.7857483816421,135.791147264396,135.7936850172993,135.7948294158887,135.7922984148161,135.7908413491503,135.7926673191986,135.6858456149057,135.6933931123597,135.7051403509105,135.7104053525259,135.7209353872449,135.7422100615471,135.7542600889347,135.7643640163411,135.7802198298992,135.7924536984949,135.7950715892783,135.7976585903959,135.7942803868968,135.7756852980908,135.7597989818987,135.7423910695577,135.7500906964062,135.7653683,135.7865502672284,135.8020103229443,135.8227355703949,135.8445561912245,135.8469605369775,135.7263025742545,135.7315982181241,135.7098099167597,135.7343579607317,135.7496888726569,135.7602933427443,135.8110317314001,135.6673005419264,135.6876505101159,135.703285550317,135.7170657271586,135.7323966842405,135.7416437040496,135.7617419371281,135.7726004747371,135.8151689974774,135.8298019665447,135.8679592908777,135.9051922391519,135.9541360823177,136.0144265783477,135.7945828528153,135.8159978538317,135.7933757903544,135.6831555207892,135.8098843257658,135.7888029062249,135.8528336507365,135.7316286366128,135.8261283890624,136.0345026748359],"linename":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","和歌山線","和歌山線","大和路線","田原本線","吉野線","御所線","奈良線","大阪線"],"company":["JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄"],"title":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"],"color":["red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","red","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","blue","red","red","red","blue","blue","blue","blue","blue"],"label":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","法隆寺","大和小泉","郡山","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","近鉄新庄","忍海","東生駒","富雄","学園前","菖蒲池","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","耳成","大福","大和朝倉","長谷寺","榛原","室生口大野","二階堂","前栽","畝傍","大和二見","平城山","西田原本","吉野","近鉄御所","近鉄奈良","三本松"]},"edges":{"from":["奈良","京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","金橋","王寺","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","三郷","王寺","法隆寺","大和小泉","郡山","奈良","生駒","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","新王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","高の原","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","二上山","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","吉野口","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","尺土","近鉄新庄","忍海","生駒","東生駒","富雄","学園前","菖蒲池","大和西大寺","新大宮","関屋","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","大和八木","耳成","大福","桜井","大和朝倉","長谷寺","榛原","室生口大野","平端","二階堂","前栽"],"to":["京終","帯解","櫟本","天理","長柄","柳本","巻向","三輪","桜井","香久山","畝傍","高田","畠田","志都美","香芝","JR五位堂","高田","大和新庄","御所","玉手","掖上","吉野口","北宇智","五条","大和二見","王寺","法隆寺","大和小泉","郡山","奈良","平城山","菜畑","一分","南生駒","萩の台","東山","元山上口","平群","竜田川","勢野北口","信貴山下","王寺","大輪田","佐味田川","池部","箸尾","但馬","黒田","西田原本","平城","大和西大寺","尼ヶ辻","西ノ京","九条","近鉄郡山","筒井","平端","ファミリー公園前","結崎","石見","田原本","笠縫","新ノ口","大和八木","八木西口","畝傍御陵前","橿原神宮前","二上神社口","当麻寺","磐城","尺土","高田市","浮孔","坊城","橿原神宮西口","橿原神宮前","岡寺","飛鳥","壺阪山","市尾","葛","吉野口","薬水","福神","大阿太","下市口","越部","六田","大和上市","吉野神宮","吉野","近鉄新庄","忍海","近鉄御所","東生駒","富雄","学園前","菖蒲池","大和西大寺","新大宮","近鉄奈良","二上","近鉄下田","五位堂","築山","大和高田","松塚","真菅","大和八木","耳成","大福","桜井","大和朝倉","長谷寺","榛原","室生口大野","三本松","二階堂","前栽","天理"],"linename":["万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","万葉まほろば線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","和歌山線","大和路線","大和路線","大和路線","大和路線","大和路線","大和路線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","生駒線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","田原本線","京都線","京都線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","橿原線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","南大阪線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","吉野線","御所線","御所線","御所線","奈良線","奈良線","奈良線","奈良線","奈良線","奈良線","奈良線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","大阪線","天理線","天理線","天理線"],"company":["JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","JR","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄","近鉄"]},"nodesToDataframe":true,"edgesToDataframe":true,"options":{"width":"100%","height":"100%","nodes":{"shape":"square"},"manipulation":{"enabled":false}},"groups":null,"width":null,"height":null,"idselection":{"enabled":false,"style":"width: 150px; height: 26px","useLabels":true,"main":"Select by id"},"byselection":{"enabled":false,"style":"width: 150px; height: 26px","multiple":false,"hideColor":"rgba(200,200,200,0.5)","highlight":false},"main":null,"submain":null,"footer":null,"background":"rgba(0, 0, 0, 0)","highlight":{"enabled":true,"hoverNearest":false,"degree":1,"algorithm":"all","hideColor":"rgba(200,200,200,0.5)","labelOnly":true},"collapse":{"enabled":false,"fit":false,"resetHighlight":true,"clusterOptions":null,"keepCoord":true,"labelSuffix":"(cluster)"}},"evals":[],"jsHooks":[]}</script>
</div>
</div>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-1">図1：ネットワークの用語</span>
<span class="glightbox-desc lightbox-desc-2">図2：igraphでの呼び方</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-networkD3_bib" class="csl-entry" role="listitem">
Allaire, J. J., Christopher Gandrud, Kenton Russell, and CJ Yetman. 2017. <em>networkD3: D3 JavaScript Network Graphs from r</em>. <a href="https://CRAN.R-project.org/package=networkD3">https://CRAN.R-project.org/package=networkD3</a>.
</div>
<div id="ref-visNetwork_bib" class="csl-entry" role="listitem">
Almende B.V. and Contributors, and Benoit Thieurmel. 2022. <em>visNetwork: Network Visualization Using ’Vis.js’ Library</em>. <a href="https://CRAN.R-project.org/package=visNetwork">https://CRAN.R-project.org/package=visNetwork</a>.
</div>
<div id="ref-network_bib2" class="csl-entry" role="listitem">
Butts, Carter T. 2008. <span>“Network: A Package for Managing Relational Data in r.”</span> <em>Journal of Statistical Software</em> 24 (2). <a href="https://doi.org/10.18637/jss.v024.i02">https://doi.org/10.18637/jss.v024.i02</a>.
</div>
<div id="ref-network_bib1" class="csl-entry" role="listitem">
———. 2015. <em>Network: Classes for Relational Data</em>. The Statnet Project (<a href="http://www.statnet.org" class="uri">http://www.statnet.org</a>). <a href="https://CRAN.R-project.org/package=network">https://CRAN.R-project.org/package=network</a>.
</div>
<div id="ref-sna_bib" class="csl-entry" role="listitem">
———. 2023. <em>Sna: Tools for Social Network Analysis</em>. <a href="https://CRAN.R-project.org/package=sna">https://CRAN.R-project.org/package=sna</a>.
</div>
<div id="ref-igraph_bib1" class="csl-entry" role="listitem">
Csardi, Gabor, and Tamas Nepusz. 2006. <span>“The Igraph Software Package for Complex Network Research.”</span> <em>InterJournal</em> Complex Systems: 1695. <a href="https://igraph.org">https://igraph.org</a>.
</div>
<div id="ref-igraph_bib2" class="csl-entry" role="listitem">
Csárdi, Gábor, Tamás Nepusz, Vincent Traag, Szabolcs Horvát, Fabio Zanini, Daniel Noom, and Kirill Müller. 2024. <em><span class="nocase">igraph</span>: Network Analysis and Visualization in r</em>. <a href="https://doi.org/10.5281/zenodo.7682609">https://doi.org/10.5281/zenodo.7682609</a>.
</div>
<div id="ref-statnet_bib1" class="csl-entry" role="listitem">
Handcock, Mark S., David R. Hunter, Carter T. Butts, Steven M. Goodreau, Pavel N. Krivitsky, and Martina Morris. 2018. <em>Ergm: Fit, Simulate and Diagnose Exponential-Family Models for Networks</em>. The Statnet Project (<a href="http://www.statnet.org" class="uri">http://www.statnet.org</a>). <a href="https://CRAN.R-project.org/package=ergm">https://CRAN.R-project.org/package=ergm</a>.
</div>
<div id="ref-statnet_bib2" class="csl-entry" role="listitem">
Hunter, David R., Mark S. Handcock, Carter T. Butts, Steven M. Goodreau, and Martina Morris. 2008. <span>“Ergm: A Package to Fit, Simulate and Diagnose Exponential-Family Models for Networks.”</span> <em>Journal of Statistical Software</em> 24 (3): 1–29.
</div>
<div id="ref-Jones_2018_f_in_psycho_bib" class="csl-entry" role="listitem">
Jones, Payton J., Patrick Mair, and Richard J. McNally. 2018. <span>“Visualizing Psychological Networks: A Tutorial in r.”</span> <em>Frontiers in Psychology</em> 9. <a href="https://doi.org/10.3389/fpsyg.2018.01742">https://doi.org/10.3389/fpsyg.2018.01742</a>.
</div>
<div id="ref-ggraph_bib" class="csl-entry" role="listitem">
Pedersen, Thomas Lin. 2024a. <em>Ggraph: An Implementation of Grammar of Graphics for Graphs and Networks</em>. <a href="https://CRAN.R-project.org/package=ggraph">https://CRAN.R-project.org/package=ggraph</a>.
</div>
<div id="ref-tidygraph_bib" class="csl-entry" role="listitem">
———. 2024b. <em>Tidygraph: A Tidy API for Graph Manipulation</em>. <a href="https://CRAN.R-project.org/package=tidygraph">https://CRAN.R-project.org/package=tidygraph</a>.
</div>
<div id="ref-netrankr_bib" class="csl-entry" role="listitem">
Schoch, David. 2022. <span>“Netrankr: An r Package for Total, Partial, and Probabilistic Rankings in Networks.”</span> <em>Journal of Open Source Software</em>, no. 77: 4563.
</div>
<div id="ref-r2d3_bib" class="csl-entry" role="listitem">
Strayer, Nick, Javier Luraschi, and JJ Allaire. 2022. <em>R2d3: Interface to ’D3’ Visualizations</em>. <a href="https://CRAN.R-project.org/package=r2d3">https://CRAN.R-project.org/package=r2d3</a>.
</div>
<div id="ref-Zachary1976" class="csl-entry" role="listitem">
Zachary, Wayne. 1976. <span>“An Information Flow Model for Conflict and Fission in Small Groups1.”</span> <em>Journal of Anthropological Research</em> 33 (November). <a href="https://doi.org/10.1086/jar.33.4.3629752">https://doi.org/10.1086/jar.33.4.3629752</a>.
</div>
</div>
</section>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter32.html" class="pagination-link" aria-label="地理空間情報">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">地理空間情報</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter34.html" class="pagination-link" aria-label="R markdown・Quarto">
        <span class="nav-page-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">R markdown・Quarto</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb160" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb160-1"><a href="#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># ネットワーク解析</span></span>
<span id="cb160-2"><a href="#cb160-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-3"><a href="#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, include=FALSE, echo=FALSE}</span></span>
<span id="cb160-4"><a href="#cb160-4" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb160-5"><a href="#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="in">  collapse = TRUE</span></span>
<span id="cb160-6"><a href="#cb160-6" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb160-7"><a href="#cb160-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-8"><a href="#cb160-8" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse)</span></span>
<span id="cb160-9"><a href="#cb160-9" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-10"><a href="#cb160-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-11"><a href="#cb160-11" aria-hidden="true" tabindex="-1"></a><span class="fu">## ネットワーク解析とは？</span></span>
<span id="cb160-12"><a href="#cb160-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-13"><a href="#cb160-13" aria-hidden="true" tabindex="-1"></a>**ネットワーク解析**とは、たくさんの人や都市、ウェブページなどの関係性（ネットワーク）を解析する一連の解析手法のことを指します。ここでのネットワークとは、例えば友人関係やメールの送付、電車の路線での駅同士のつながりや物資のやり取りなど、多岐に渡ります。生物学であれば代謝経路や遺伝子の誘導・抑制の関係性、会社であれば命令系統などもネットワークの例となります。これらのネットワークを表示し、特徴を抽出することでネットワークを評価する手法がネットワーク解析です。</span>
<span id="cb160-14"><a href="#cb160-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-15"><a href="#cb160-15" aria-hidden="true" tabindex="-1"></a>ネットワークの基本は、人や都市などの要素と、そのつながりの2つです。ネットワーク解析では、人や都市などの要素のことを**node**や**vertex**、つながりのことを**link**や**edge**と呼びます。また、このネットワーク全体のことを**graph**と呼びます。</span>
<span id="cb160-16"><a href="#cb160-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-17"><a href="#cb160-17" aria-hidden="true" tabindex="-1"></a>linkやedge、つまりネットワークのつながりには、大きく分けて2つのタイプがあります。一つは友人関係や線路での結合など、方向性が無いもので、もう一つはメールの送付や物資の輸送などの方向性があるものです。方向性のないつながりのことを**無向（undirected）**、方向性のあるつながりのことを**有向（directed）**と呼びます。</span>
<span id="cb160-18"><a href="#cb160-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-19"><a href="#cb160-19" aria-hidden="true" tabindex="-1"></a><span class="al">![図1：ネットワークの用語](./image/network_graph.png)</span></span>
<span id="cb160-20"><a href="#cb160-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-21"><a href="#cb160-21" aria-hidden="true" tabindex="-1"></a>主要なネットワーク解析の目的は以下の通りです。</span>
<span id="cb160-22"><a href="#cb160-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-23"><a href="#cb160-23" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ネットワークを作成し、取り扱う </span>
<span id="cb160-24"><a href="#cb160-24" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ネットワークを表示する </span>
<span id="cb160-25"><a href="#cb160-25" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>重要なnodeを抽出する（中心性） </span>
<span id="cb160-26"><a href="#cb160-26" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>nodeをグループ分けする（クラスター化） </span>
<span id="cb160-27"><a href="#cb160-27" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>グラフの特徴を評価する </span>
<span id="cb160-28"><a href="#cb160-28" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>nodeからnodeへの経路を探索する </span>
<span id="cb160-29"><a href="#cb160-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-30"><a href="#cb160-30" aria-hidden="true" tabindex="-1"></a>この他にランダムなグラフの作成、グラフの類似性の評価や検定を用いたネットワーク解析もあります。</span>
<span id="cb160-31"><a href="#cb160-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-32"><a href="#cb160-32" aria-hidden="true" tabindex="-1"></a><span class="fu">## Rでのネットワーク解析のライブラリ</span></span>
<span id="cb160-33"><a href="#cb160-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-34"><a href="#cb160-34" aria-hidden="true" tabindex="-1"></a>Rでのネットワーク解析には、<span class="co">[</span><span class="ot">`statnet`</span><span class="co">](https://statnet.org/)[</span><span class="ot">@statnet_bib1; @statnet_bib2</span><span class="co">]</span>系ライブラリと<span class="co">[</span><span class="ot">`igraph`</span><span class="co">](https://r.igraph.org/index.html)[</span><span class="ot">@igraph_bib1; @igraph_bib2</span><span class="co">]</span>系ライブラリの2系統があります。どちらもネットワーク解析を行うために必要十分な機能を備えていますが、オブジェクトの取り扱いや関数名の特徴が異なります。どちらを使うかは好みで決めてしまってよいですが、<span class="in">`igraph`</span>系の方が情報が多いため比較的使いやすいと思います。</span>
<span id="cb160-35"><a href="#cb160-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-36"><a href="#cb160-36" aria-hidden="true" tabindex="-1"></a><span class="in">`statnet`</span>は<span class="in">`sna`</span><span class="co">[</span><span class="ot">@sna_bib</span><span class="co">]</span>や<span class="in">`network`</span><span class="co">[</span><span class="ot">@network_bib1; @network_bib2</span><span class="co">]</span>などの一連のネットワーク解析用ライブラリの総称で、<span class="in">`tidyverse`</span>のように<span class="in">`install.packages("statnet")`</span>で一度にインストールし、<span class="in">`library(statnet)`</span>で一度にロードすることができます。<span class="in">`statnet`</span>はよくできたライブラリ群だと思うのですが、解説文（Documentation）があまり充実しておらず、なかなか手を付けにくい印象があります。</span>
<span id="cb160-37"><a href="#cb160-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-38"><a href="#cb160-38" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>はネットワーク解析に必要な関数を一通り備えたライブラリで、RだけでなくpythonやMathematica、Cにも機能を提供しています。ネット上にも<span class="in">`igraph`</span>の情報はたくさん落ちており、<span class="in">`statnet`</span>よりは間口が広く学びやすいかと思います。ただし、<span class="in">`statnet`</span>も<span class="in">`igraph`</span>もたくさんの機能を備えたライブラリであり、学習コストは高めです。</span>
<span id="cb160-39"><a href="#cb160-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-40"><a href="#cb160-40" aria-hidden="true" tabindex="-1"></a>この<span class="in">`igraph`</span>、非常にたくさんの関数を備えたライブラリではあるのですが、関数の命名規則や引数の形が一定ではなく、そのまま使うとやや使いにくいです。また、<span class="in">`tidyverse`</span>などのRの標準的なパッケージとの相性もあまりよくありません。この命名や<span class="in">`tidyverse`</span>との整合性を取るためのライブラリが<span class="in">`tidygraph`</span><span class="co">[</span><span class="ot">@tidygraph_bib</span><span class="co">]</span>です。<span class="in">`tidygraph`</span>はほぼ<span class="in">`igraph`</span>のwrapper（関数名と引数の形を整えたもの）ですが、<span class="in">`igraph`</span>をそのまま使うよりは使いやすく、パイプ演算子との相性も悪くありません。</span>
<span id="cb160-41"><a href="#cb160-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-42"><a href="#cb160-42" aria-hidden="true" tabindex="-1"></a>この章ではまず<span class="in">`igraph`</span>について説明し、その後に<span class="in">`tidygraph`</span>と<span class="in">`igraph`</span>の関数との対応を説明することにします。</span>
<span id="cb160-43"><a href="#cb160-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-44"><a href="#cb160-44" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ライブラリのロード"}</span></span>
<span id="cb160-45"><a href="#cb160-45" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(igraph, tidygraph, tidyverse)</span></span>
<span id="cb160-46"><a href="#cb160-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-47"><a href="#cb160-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-48"><a href="#cb160-48" aria-hidden="true" tabindex="-1"></a><span class="fu">## igraph</span></span>
<span id="cb160-49"><a href="#cb160-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-50"><a href="#cb160-50" aria-hidden="true" tabindex="-1"></a><span class="fu">### igraphでの用語</span></span>
<span id="cb160-51"><a href="#cb160-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-52"><a href="#cb160-52" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>では、ネットワーク全体を**graph**、ノードを**vertex**、リンクを**edge**と呼びます。それぞれをnetwork、node、linkと呼ぶことは基本的にありません（ただし、一部の関数の引数としてnodeを使っていたりします）。</span>
<span id="cb160-53"><a href="#cb160-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-54"><a href="#cb160-54" aria-hidden="true" tabindex="-1"></a><span class="al">![図2：igraphでの呼び方](./image/graph_at_igraph.png)</span></span>
<span id="cb160-55"><a href="#cb160-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-56"><a href="#cb160-56" aria-hidden="true" tabindex="-1"></a><span class="fu">### グラフを作成する</span></span>
<span id="cb160-57"><a href="#cb160-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-58"><a href="#cb160-58" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>でグラフ、つまりネットワークの全体図を作成する方法はいくつかあります。</span>
<span id="cb160-59"><a href="#cb160-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-60"><a href="#cb160-60" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**edge vector**から作成する</span>
<span id="cb160-61"><a href="#cb160-61" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**edge list**から作成する</span>
<span id="cb160-62"><a href="#cb160-62" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**adjacent matrix**から作成する</span>
<span id="cb160-63"><a href="#cb160-63" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**literal**から作成する</span>
<span id="cb160-64"><a href="#cb160-64" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>formulaから作成する</span>
<span id="cb160-65"><a href="#cb160-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>**data.frame**から作成する</span>
<span id="cb160-66"><a href="#cb160-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-67"><a href="#cb160-67" aria-hidden="true" tabindex="-1"></a>単純なグラフを作成するのであればedge vectorやedge listから、vertexやnodeに特性（<span class="in">`attribute`</span>）を付けた複雑なグラフを作成するのであれば<span class="in">`data.frame`</span>を用いるのが比較的簡単だと思います。</span>
<span id="cb160-68"><a href="#cb160-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-69"><a href="#cb160-69" aria-hidden="true" tabindex="-1"></a><span class="fu">#### edge vectorから作成する</span></span>
<span id="cb160-70"><a href="#cb160-70" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-71"><a href="#cb160-71" aria-hidden="true" tabindex="-1"></a>まずはベクターから作成する方法を説明します。</span>
<span id="cb160-72"><a href="#cb160-72" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-73"><a href="#cb160-73" aria-hidden="true" tabindex="-1"></a>ベクターでネットワークを表現する場合には、ベクターに、edgeで繋ぎたいvertex2つをセットで記載します。例えば、<span class="in">`c("A", "B")`</span>であれば、AとBというvertexをedgeで繋いだグラフとなります。edgeでつなぐvertexは必ず2つセットになりますので、もう一つedgeを設定したい場合には、1つ目のedgeを示す2つのvertexの後に、さらに2つのvertexを記載します。つまり、<span class="in">`c("A","B", "A","C")`</span>といった形で表現することで、A-B、A-Cのedgeを持つ、A、B、Cのvertexを表現することができます。このようなベクターを<span class="in">`igraph`</span>では**edge vector**と呼びます。</span>
<span id="cb160-74"><a href="#cb160-74" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-75"><a href="#cb160-75" aria-hidden="true" tabindex="-1"></a>とは言っても、edge vectorはただのベクターですので、このedge vectorからグラフを作成する必要があります。グラフの作成には、<span class="in">`make_graph`</span>関数を用います。edge vectorを<span class="in">`make_graph`</span>関数の引数とすることで、グラフを作成することができます。</span>
<span id="cb160-76"><a href="#cb160-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-77"><a href="#cb160-77" aria-hidden="true" tabindex="-1"></a>edge vectorでは、基本的に1つ目のvertexから2つ目のvertexの方向にedgeを繋ぐ、有向グラフが作成されます。無向グラフを作成する場合には、引数に<span class="in">`directed=FALSE`</span>と指定します。</span>
<span id="cb160-78"><a href="#cb160-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-79"><a href="#cb160-79" aria-hidden="true" tabindex="-1"></a>グラフを作成し表示すると、グラフの情報が示されます。このグラフの情報については後ほど説明します。</span>
<span id="cb160-80"><a href="#cb160-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-81"><a href="#cb160-81" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filenamae="edge vectorからグラフを作成する"}</span></span>
<span id="cb160-82"><a href="#cb160-82" aria-hidden="true" tabindex="-1"></a><span class="in"># 有向グラフ</span></span>
<span id="cb160-83"><a href="#cb160-83" aria-hidden="true" tabindex="-1"></a><span class="in">make_graph(</span></span>
<span id="cb160-84"><a href="#cb160-84" aria-hidden="true" tabindex="-1"></a><span class="in">  c(1, 2,</span></span>
<span id="cb160-85"><a href="#cb160-85" aria-hidden="true" tabindex="-1"></a><span class="in">    2, 3,</span></span>
<span id="cb160-86"><a href="#cb160-86" aria-hidden="true" tabindex="-1"></a><span class="in">    3, 1)</span></span>
<span id="cb160-87"><a href="#cb160-87" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb160-88"><a href="#cb160-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-89"><a href="#cb160-89" aria-hidden="true" tabindex="-1"></a><span class="in"># 無向グラフ</span></span>
<span id="cb160-90"><a href="#cb160-90" aria-hidden="true" tabindex="-1"></a><span class="in">make_graph(</span></span>
<span id="cb160-91"><a href="#cb160-91" aria-hidden="true" tabindex="-1"></a><span class="in">  c(1, 2,</span></span>
<span id="cb160-92"><a href="#cb160-92" aria-hidden="true" tabindex="-1"></a><span class="in">    2, 3,</span></span>
<span id="cb160-93"><a href="#cb160-93" aria-hidden="true" tabindex="-1"></a><span class="in">    3, 1),</span></span>
<span id="cb160-94"><a href="#cb160-94" aria-hidden="true" tabindex="-1"></a><span class="in">  directed = FALSE</span></span>
<span id="cb160-95"><a href="#cb160-95" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb160-96"><a href="#cb160-96" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-97"><a href="#cb160-97" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-98"><a href="#cb160-98" aria-hidden="true" tabindex="-1"></a><span class="fu">##### グラフを描画する</span></span>
<span id="cb160-99"><a href="#cb160-99" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-100"><a href="#cb160-100" aria-hidden="true" tabindex="-1"></a>グラフを描画するには、先ほど作成したグラフを<span class="in">`plot`</span>関数の引数に取ります。より複雑なグラフの描画方法については後ほど説明します。</span>
<span id="cb160-101"><a href="#cb160-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-102"><a href="#cb160-102" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="グラフを表示する"}</span></span>
<span id="cb160-103"><a href="#cb160-103" aria-hidden="true" tabindex="-1"></a><span class="in">make_graph(</span></span>
<span id="cb160-104"><a href="#cb160-104" aria-hidden="true" tabindex="-1"></a><span class="in">  c(1, 2,</span></span>
<span id="cb160-105"><a href="#cb160-105" aria-hidden="true" tabindex="-1"></a><span class="in">    2, 3,</span></span>
<span id="cb160-106"><a href="#cb160-106" aria-hidden="true" tabindex="-1"></a><span class="in">    3, 1)</span></span>
<span id="cb160-107"><a href="#cb160-107" aria-hidden="true" tabindex="-1"></a><span class="in">) |&gt; plot()</span></span>
<span id="cb160-108"><a href="#cb160-108" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-109"><a href="#cb160-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-110"><a href="#cb160-110" aria-hidden="true" tabindex="-1"></a><span class="fu">#### edge listからグラフを作成する</span></span>
<span id="cb160-111"><a href="#cb160-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-112"><a href="#cb160-112" aria-hidden="true" tabindex="-1"></a>**edge list**はedge vectorと似ており、edgeでつなぐvertexを1、2列目にそれぞれ記載した行列（edge list）を用いてグラフを作成する方法です。下の例では、A→B、B→C、C→Aのそれぞれのedgeを2列の行列で表現しています。edge listからグラフを作成する場合には、<span class="in">`graph_from_edgelist`</span>関数を用います。<span class="in">`make_graph`</span>関数と同様に、無向グラフを作成する場合には引数に<span class="in">`directed=FALSE`</span>を指定します。</span>
<span id="cb160-113"><a href="#cb160-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-114"><a href="#cb160-114" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="edge listからグラフを作成する"}</span></span>
<span id="cb160-115"><a href="#cb160-115" aria-hidden="true" tabindex="-1"></a><span class="in"># byrow=TRUEを指定すると表記と一致してわかりやすい</span></span>
<span id="cb160-116"><a href="#cb160-116" aria-hidden="true" tabindex="-1"></a><span class="in">edgelist_matrix &lt;- </span></span>
<span id="cb160-117"><a href="#cb160-117" aria-hidden="true" tabindex="-1"></a><span class="in">  matrix(</span></span>
<span id="cb160-118"><a href="#cb160-118" aria-hidden="true" tabindex="-1"></a><span class="in">    c("A","B", </span></span>
<span id="cb160-119"><a href="#cb160-119" aria-hidden="true" tabindex="-1"></a><span class="in">      "B","C", </span></span>
<span id="cb160-120"><a href="#cb160-120" aria-hidden="true" tabindex="-1"></a><span class="in">      "C","A"),</span></span>
<span id="cb160-121"><a href="#cb160-121" aria-hidden="true" tabindex="-1"></a><span class="in">    ncol = 2,</span></span>
<span id="cb160-122"><a href="#cb160-122" aria-hidden="true" tabindex="-1"></a><span class="in">    byrow=TRUE</span></span>
<span id="cb160-123"><a href="#cb160-123" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb160-124"><a href="#cb160-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-125"><a href="#cb160-125" aria-hidden="true" tabindex="-1"></a><span class="in"># edgelistを表示する</span></span>
<span id="cb160-126"><a href="#cb160-126" aria-hidden="true" tabindex="-1"></a><span class="in">edgelist_matrix</span></span>
<span id="cb160-127"><a href="#cb160-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-128"><a href="#cb160-128" aria-hidden="true" tabindex="-1"></a><span class="in">graph_from_edgelist(edgelist_matrix) |&gt; plot()</span></span>
<span id="cb160-129"><a href="#cb160-129" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-130"><a href="#cb160-130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-131"><a href="#cb160-131" aria-hidden="true" tabindex="-1"></a><span class="fu">#### adjacency matrixからグラフを作成する</span></span>
<span id="cb160-132"><a href="#cb160-132" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-133"><a href="#cb160-133" aria-hidden="true" tabindex="-1"></a>edge vector、edge listを用いないグラフの作成方法として、**adjacency matrix（隣接行列）**を用いる方法があります。隣接行列は行数と列数が同じ行列（正方行列）で、行名・列名をvertexの名前とした行列です。隣接行列では、行方向に見て0であればedgeなし、1以上であればedgeありとなります。例えば下の例では、Aの行を見ると、A列は0、B列に1、C列に1となっています。これは、AからAはedgeがなく、AからB、AからCへのedgeがあることを示しています。</span>
<span id="cb160-134"><a href="#cb160-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-135"><a href="#cb160-135" aria-hidden="true" tabindex="-1"></a>隣接行列からグラフを作成するための関数が<span class="in">`graph_from_adjacency_matrix`</span>です。<span class="in">`graph_from_adjacency_matrix`</span>関数では、有向グラフ・無向グラフを指定する引数として<span class="in">`directed`</span>ではなく、<span class="in">`mode`</span>が用いられます。デフォルトは<span class="in">`mode="directed"`</span>で、有向グラフが作成されます。無向グラフを作成する場合には<span class="in">`mode="undirected"`</span>を指定します。</span>
<span id="cb160-136"><a href="#cb160-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-137"><a href="#cb160-137" aria-hidden="true" tabindex="-1"></a>隣接行列には1以上の値を設定することができます。1以上の値を設定した場合には、そのedgeが複数、平行なedgeとして設定されます。ただし、<span class="in">`weighted=TRUE`</span>とした場合には、edgeの数ではなく、edgeの<span class="in">`weight`</span>という特性（attribute）の値が指定されることになります。</span>
<span id="cb160-138"><a href="#cb160-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-139"><a href="#cb160-139" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="adjacency matrixからグラフを作成する"}</span></span>
<span id="cb160-140"><a href="#cb160-140" aria-hidden="true" tabindex="-1"></a><span class="in">mat &lt;- </span></span>
<span id="cb160-141"><a href="#cb160-141" aria-hidden="true" tabindex="-1"></a><span class="in">  matrix(</span></span>
<span id="cb160-142"><a href="#cb160-142" aria-hidden="true" tabindex="-1"></a><span class="in">    c(0, 1, 1,</span></span>
<span id="cb160-143"><a href="#cb160-143" aria-hidden="true" tabindex="-1"></a><span class="in">      1, 0, 1,</span></span>
<span id="cb160-144"><a href="#cb160-144" aria-hidden="true" tabindex="-1"></a><span class="in">      1, 1, 0),</span></span>
<span id="cb160-145"><a href="#cb160-145" aria-hidden="true" tabindex="-1"></a><span class="in">    nrow = 3,</span></span>
<span id="cb160-146"><a href="#cb160-146" aria-hidden="true" tabindex="-1"></a><span class="in">    byrow = TRUE</span></span>
<span id="cb160-147"><a href="#cb160-147" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb160-148"><a href="#cb160-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-149"><a href="#cb160-149" aria-hidden="true" tabindex="-1"></a><span class="in"># vertex名は行・列名で設定する</span></span>
<span id="cb160-150"><a href="#cb160-150" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(mat) &lt;- c("A", "B", "C")</span></span>
<span id="cb160-151"><a href="#cb160-151" aria-hidden="true" tabindex="-1"></a><span class="in">rownames(mat) &lt;- c("A", "B", "C")</span></span>
<span id="cb160-152"><a href="#cb160-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-153"><a href="#cb160-153" aria-hidden="true" tabindex="-1"></a><span class="in"># 隣接行列を表示する</span></span>
<span id="cb160-154"><a href="#cb160-154" aria-hidden="true" tabindex="-1"></a><span class="in">mat</span></span>
<span id="cb160-155"><a href="#cb160-155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-156"><a href="#cb160-156" aria-hidden="true" tabindex="-1"></a><span class="in"># 有向グラフ</span></span>
<span id="cb160-157"><a href="#cb160-157" aria-hidden="true" tabindex="-1"></a><span class="in">graph_from_adjacency_matrix(mat) |&gt; plot()</span></span>
<span id="cb160-158"><a href="#cb160-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-159"><a href="#cb160-159" aria-hidden="true" tabindex="-1"></a><span class="in"># 無向グラフ</span></span>
<span id="cb160-160"><a href="#cb160-160" aria-hidden="true" tabindex="-1"></a><span class="in">graph_from_adjacency_matrix(mat, mode = "undirected") |&gt; plot()</span></span>
<span id="cb160-161"><a href="#cb160-161" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-162"><a href="#cb160-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-163"><a href="#cb160-163" aria-hidden="true" tabindex="-1"></a>上の例ではA、B、Cを繋ぐすべてのedgeが両方向になっていますが、片方向にする場合には、例えばA行B列を1、B行A列を0とします。このように設定することで、A→Bのみの有向グラフを作成することができます。また、対角成分（A行A列など）が1以上に設定されている場合には、AからAへの**ループ**となるedgeが設定されます。</span>
<span id="cb160-164"><a href="#cb160-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-165"><a href="#cb160-165" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="adjacency matrixで方向を設定する"}</span></span>
<span id="cb160-166"><a href="#cb160-166" aria-hidden="true" tabindex="-1"></a><span class="in">mat2 &lt;-</span></span>
<span id="cb160-167"><a href="#cb160-167" aria-hidden="true" tabindex="-1"></a><span class="in">  matrix(</span></span>
<span id="cb160-168"><a href="#cb160-168" aria-hidden="true" tabindex="-1"></a><span class="in">    c(0, 1, 0,</span></span>
<span id="cb160-169"><a href="#cb160-169" aria-hidden="true" tabindex="-1"></a><span class="in">      0, 0, 1,</span></span>
<span id="cb160-170"><a href="#cb160-170" aria-hidden="true" tabindex="-1"></a><span class="in">      1, 0, 0),</span></span>
<span id="cb160-171"><a href="#cb160-171" aria-hidden="true" tabindex="-1"></a><span class="in">    nrow = 3,</span></span>
<span id="cb160-172"><a href="#cb160-172" aria-hidden="true" tabindex="-1"></a><span class="in">    byrow = TRUE</span></span>
<span id="cb160-173"><a href="#cb160-173" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb160-174"><a href="#cb160-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-175"><a href="#cb160-175" aria-hidden="true" tabindex="-1"></a><span class="in">mat2</span></span>
<span id="cb160-176"><a href="#cb160-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-177"><a href="#cb160-177" aria-hidden="true" tabindex="-1"></a><span class="in"># 有向グラフ</span></span>
<span id="cb160-178"><a href="#cb160-178" aria-hidden="true" tabindex="-1"></a><span class="in">graph_from_adjacency_matrix(mat2) |&gt; plot()</span></span>
<span id="cb160-179"><a href="#cb160-179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-180"><a href="#cb160-180" aria-hidden="true" tabindex="-1"></a><span class="in"># vertex自身へのedge（ループ）</span></span>
<span id="cb160-181"><a href="#cb160-181" aria-hidden="true" tabindex="-1"></a><span class="in">matrix(</span></span>
<span id="cb160-182"><a href="#cb160-182" aria-hidden="true" tabindex="-1"></a><span class="in">  c(1, 1, 1,</span></span>
<span id="cb160-183"><a href="#cb160-183" aria-hidden="true" tabindex="-1"></a><span class="in">    1, 1, 1,</span></span>
<span id="cb160-184"><a href="#cb160-184" aria-hidden="true" tabindex="-1"></a><span class="in">    1, 1, 0),</span></span>
<span id="cb160-185"><a href="#cb160-185" aria-hidden="true" tabindex="-1"></a><span class="in">  nrow = 3,</span></span>
<span id="cb160-186"><a href="#cb160-186" aria-hidden="true" tabindex="-1"></a><span class="in">  byrow = TRUE</span></span>
<span id="cb160-187"><a href="#cb160-187" aria-hidden="true" tabindex="-1"></a><span class="in">) |&gt; </span></span>
<span id="cb160-188"><a href="#cb160-188" aria-hidden="true" tabindex="-1"></a><span class="in">  graph_from_adjacency_matrix() |&gt; </span></span>
<span id="cb160-189"><a href="#cb160-189" aria-hidden="true" tabindex="-1"></a><span class="in">  plot()</span></span>
<span id="cb160-190"><a href="#cb160-190" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-191"><a href="#cb160-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-192"><a href="#cb160-192" aria-hidden="true" tabindex="-1"></a><span class="fu">#### literalからグラフを作成する</span></span>
<span id="cb160-193"><a href="#cb160-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-194"><a href="#cb160-194" aria-hidden="true" tabindex="-1"></a>グラフの表現として、<span class="in">`--`</span>や<span class="in">`-+`</span>などの記号を用いる、literalでもグラフを作成することができます。グラフの表現はそれぞれ以下の通りです。</span>
<span id="cb160-195"><a href="#cb160-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-196"><a href="#cb160-196" aria-hidden="true" tabindex="-1"></a>| literal   | graph              | </span>
<span id="cb160-197"><a href="#cb160-197" aria-hidden="true" tabindex="-1"></a>| --------- | ------------------ | </span>
<span id="cb160-198"><a href="#cb160-198" aria-hidden="true" tabindex="-1"></a>| A -- B    | A－B（無向グラフ） | </span>
<span id="cb160-199"><a href="#cb160-199" aria-hidden="true" tabindex="-1"></a>| A -+ B    | A→B               | </span>
<span id="cb160-200"><a href="#cb160-200" aria-hidden="true" tabindex="-1"></a>| A +- B    | A←B               | </span>
<span id="cb160-201"><a href="#cb160-201" aria-hidden="true" tabindex="-1"></a>| A ++ B    | A↔B               | </span>
<span id="cb160-202"><a href="#cb160-202" aria-hidden="true" tabindex="-1"></a>| A ----+ B | A→B               | </span>
<span id="cb160-203"><a href="#cb160-203" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-204"><a href="#cb160-204" aria-hidden="true" tabindex="-1"></a>要は、+側が矢印の先になるような記法がliteralです。矢印の反対側は-になります。左端と右端の-、+の間には-を複数挟むこともできます。無向グラフと有向グラフを同じグラフに含めることはできませんので、<span class="in">`--`</span>を用いた場合にはすべてのedgeを<span class="in">`--`</span>で表現する必要があります。</span>
<span id="cb160-205"><a href="#cb160-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-206"><a href="#cb160-206" aria-hidden="true" tabindex="-1"></a>このliteralからグラフを作成する関数が<span class="in">`graph_from_literal`</span>です。literalは文字列ではなく、そのまま引数として取り、edgeの表現として必要な分だけコンマで繋ぎます。</span>
<span id="cb160-207"><a href="#cb160-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-208"><a href="#cb160-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="literalからグラフを作成する"}</span></span>
<span id="cb160-209"><a href="#cb160-209" aria-hidden="true" tabindex="-1"></a><span class="in">graph_from_literal(</span></span>
<span id="cb160-210"><a href="#cb160-210" aria-hidden="true" tabindex="-1"></a><span class="in">  A-+B, B-+C, C-+D, D++A </span></span>
<span id="cb160-211"><a href="#cb160-211" aria-hidden="true" tabindex="-1"></a><span class="in">) |&gt; plot()</span></span>
<span id="cb160-212"><a href="#cb160-212" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-213"><a href="#cb160-213" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-214"><a href="#cb160-214" aria-hidden="true" tabindex="-1"></a><span class="fu">##### formulaでグラフを作成する</span></span>
<span id="cb160-215"><a href="#cb160-215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-216"><a href="#cb160-216" aria-hidden="true" tabindex="-1"></a>また、このliteralに似た表現を用いてグラフを作成する方法もあります。引数としてベクターではなく、チルダ（<span class="in">`~`</span>）で始まり、edgeとvertexを表現した<span class="in">`―`</span>と<span class="in">`:`</span>から成る式（formula）を用いる方法です。グラフの作成にはedge vectorの際に用いた<span class="in">`make_graph`</span>を用います。<span class="in">`-`</span>がedge、<span class="in">`:`</span>は複数のvertexへの接続を表します。Rでは<span class="in">`:`</span>の表現が数列（<span class="in">`1:3`</span>など）と異なり混乱しやすいので、あまりお勧めできる表記方法ではないように思います。</span>
<span id="cb160-217"><a href="#cb160-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-218"><a href="#cb160-218" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="formulaを用いてグラフを作成する"} </span></span>
<span id="cb160-219"><a href="#cb160-219" aria-hidden="true" tabindex="-1"></a><span class="in">make_graph(~ A-B, B-C, C-A:D) |&gt; plot() # C-A、C-Dを設定</span></span>
<span id="cb160-220"><a href="#cb160-220" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-221"><a href="#cb160-221" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-222"><a href="#cb160-222" aria-hidden="true" tabindex="-1"></a><span class="fu">#### data.frameからグラフを作成する</span></span>
<span id="cb160-223"><a href="#cb160-223" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-224"><a href="#cb160-224" aria-hidden="true" tabindex="-1"></a>Rで最も頻繁に用いられるデータ型の一つである、データフレームを用いてもグラフを作成することができます。グラフの作成方法はedge listとよく似ていて、1列目と2列目にedgeで接続するvertexを表記したデータフレームを用います。列名はわかりやすいようにそれぞれ<span class="in">`from`</span>と<span class="in">`to`</span>にしておきます。このデータフレームがグラフ作成の基本となります。</span>
<span id="cb160-225"><a href="#cb160-225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-226"><a href="#cb160-226" aria-hidden="true" tabindex="-1"></a>また、データフレームを用いると、edgeやvertexに特性（<span class="in">`attributes`</span>）を持たせたいときに便利です。例えば人間関係であれば、edgeにはメールのやり取りの回数であったり、交友関係の深さを設定することがあります。また、人間関係におけるvertex、つまり人には性別や年齢、所属する組織などを設定したい場合もあるでしょう。データフレームからグラフを作成すると、このような特性を比較的簡単にグラフに持たせることができます。</span>
<span id="cb160-227"><a href="#cb160-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-228"><a href="#cb160-228" aria-hidden="true" tabindex="-1"></a>edgeに特性を持たせたい場合には、上記の<span class="in">`from`</span>と<span class="in">`to`</span>からなるデータフレームに列を追加します。edgeに設定される主な特性は<span class="in">`weight`</span>です。上記のメールの数や交友関係の深さなどを<span class="in">`weight`</span>として数値で設定します。</span>
<span id="cb160-229"><a href="#cb160-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-230"><a href="#cb160-230" aria-hidden="true" tabindex="-1"></a>同じように、vertexにも特性を持たせることができます。edgeを示したデータフレームとは別に、vertexを表現するためのデータフレームを準備します。このデータフレームの1列目には、edgeのデータフレームに示したvertexをすべて含める必要があります。また、edgeのデータフレームに含まれないvertexを含めることもできます（edgeによる接続のない、独立したvertexが追加されます）。2列目以降には、vertexの特性、例えば人であれば年齢や性別の列を作成しておきます。</span>
<span id="cb160-231"><a href="#cb160-231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-232"><a href="#cb160-232" aria-hidden="true" tabindex="-1"></a>この2つのデータフレームを用いて、グラフを作成します。データフレームからグラフを作成するための関数が<span class="in">`graph_from_data_frame`</span>です。<span class="in">`graph_from_data_frame`</span>では、edgeを表現したデータフレームだけあればグラフを作成することができます。また、<span class="in">`vertices`</span>引数にvertexを表現したデータフレームを設定することで、edgeとは別にvertexやその特性を設定することができます。</span>
<span id="cb160-233"><a href="#cb160-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-234"><a href="#cb160-234" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="データフレームからグラフを作成する"}</span></span>
<span id="cb160-235"><a href="#cb160-235" aria-hidden="true" tabindex="-1"></a><span class="in"># edgeのデータフレーム（weightは特性）</span></span>
<span id="cb160-236"><a href="#cb160-236" aria-hidden="true" tabindex="-1"></a><span class="in">d_edge &lt;- data.frame(</span></span>
<span id="cb160-237"><a href="#cb160-237" aria-hidden="true" tabindex="-1"></a><span class="in">  from = c("A", "B", "C"),</span></span>
<span id="cb160-238"><a href="#cb160-238" aria-hidden="true" tabindex="-1"></a><span class="in">  to = c("B", "C", "A"),</span></span>
<span id="cb160-239"><a href="#cb160-239" aria-hidden="true" tabindex="-1"></a><span class="in">  weight = c(1, 2, 3)</span></span>
<span id="cb160-240"><a href="#cb160-240" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb160-241"><a href="#cb160-241" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-242"><a href="#cb160-242" aria-hidden="true" tabindex="-1"></a><span class="in"># vertexのデータフレーム（age、sexは特性）</span></span>
<span id="cb160-243"><a href="#cb160-243" aria-hidden="true" tabindex="-1"></a><span class="in">d_vertex &lt;- data.frame(</span></span>
<span id="cb160-244"><a href="#cb160-244" aria-hidden="true" tabindex="-1"></a><span class="in">  name = c("A", "B", "C"),</span></span>
<span id="cb160-245"><a href="#cb160-245" aria-hidden="true" tabindex="-1"></a><span class="in">  age = c(20, 25, 30),</span></span>
<span id="cb160-246"><a href="#cb160-246" aria-hidden="true" tabindex="-1"></a><span class="in">  sex = c("F", "M", "F")</span></span>
<span id="cb160-247"><a href="#cb160-247" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb160-248"><a href="#cb160-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-249"><a href="#cb160-249" aria-hidden="true" tabindex="-1"></a><span class="in">g &lt;- graph_from_data_frame(d_edge, vertices = d_vertex)</span></span>
<span id="cb160-250"><a href="#cb160-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-251"><a href="#cb160-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-252"><a href="#cb160-252" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb160-253"><a href="#cb160-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-254"><a href="#cb160-254" aria-hidden="true" tabindex="-1"></a><span class="fu">## attribute</span></span>
<span id="cb160-255"><a href="#cb160-255" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-256"><a href="#cb160-256" aria-hidden="true" tabindex="-1"></a><span class="in">`attribute`</span>については<span class="co">[</span><span class="ot">3章</span><span class="co">](./chapter3.html)</span>や<span class="co">[</span><span class="ot">18章</span><span class="co">](./chapter18.html)</span>で簡単に説明しています。ベクターの名前（<span class="in">`names`</span>）や行列の次元（<span class="in">`dim`</span>）は<span class="in">`attribute`</span>として設定されており、関数から呼び出したり、演算に用いたりすることができます。<span class="in">`igraph`</span>ではこの<span class="in">`attribute`</span>を設定することで、vertexやedgeの性質をリストのように呼び出すことができます。</span>
<span id="cb160-257"><a href="#cb160-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-258"><a href="#cb160-258" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-259"><a href="#cb160-259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-260"><a href="#cb160-260" aria-hidden="true" tabindex="-1"></a><span class="fu">#### グラフの表示とattributes</span></span>
<span id="cb160-261"><a href="#cb160-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-262"><a href="#cb160-262" aria-hidden="true" tabindex="-1"></a>ここまでで、グラフを作成する方法について述べてきました。作成したグラフは<span class="in">`igraph`</span>クラスのオブジェクトで、表示させるとedgeの一覧と色々な情報が表示されます。</span>
<span id="cb160-263"><a href="#cb160-263" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-264"><a href="#cb160-264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="igraphクラス"}</span></span>
<span id="cb160-265"><a href="#cb160-265" aria-hidden="true" tabindex="-1"></a><span class="in">class(g)</span></span>
<span id="cb160-266"><a href="#cb160-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-267"><a href="#cb160-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-268"><a href="#cb160-268" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="igraphクラスのオブジェクトを表示する"}</span></span>
<span id="cb160-269"><a href="#cb160-269" aria-hidden="true" tabindex="-1"></a><span class="in">g</span></span>
<span id="cb160-270"><a href="#cb160-270" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-271"><a href="#cb160-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-272"><a href="#cb160-272" aria-hidden="true" tabindex="-1"></a>この表示のうち、1行目の<span class="in">`DNW-`</span>という部分はこのグラフの性質を示しています。始めの<span class="in">`D`</span>はDirected（有向グラフ）の略です。無向グラフの場合には<span class="in">`U`</span>（Undirected）と表示されます。</span>
<span id="cb160-273"><a href="#cb160-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-274"><a href="#cb160-274" aria-hidden="true" tabindex="-1"></a>次の<span class="in">`N`</span>はNamedの略で、vertexに名前（<span class="in">`name`</span>）の特性（<span class="in">`attribute`</span>）がついていることを示しています。その次の<span class="in">`W`</span>はWeightedの略で、edgeに<span class="in">`weight`</span>が設定されていることを示しています。vertexに名前がついていない場合には<span class="in">`N`</span>の位置が<span class="in">`-`</span>に、edgeに<span class="in">`weight`</span>が設定されていない場合には<span class="in">`W`</span>の位置が<span class="in">`―`</span>になります。</span>
<span id="cb160-275"><a href="#cb160-275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-276"><a href="#cb160-276" aria-hidden="true" tabindex="-1"></a>最後の<span class="in">`―`</span>は**2部グラフ（Bipartite graph）**であるかどうかを示しており、2部グラフの場合は<span class="in">`B`</span>、2部グラフでない場合には<span class="in">`―`</span>が表示されます。2部グラフについては後ほど説明します。</span>
<span id="cb160-277"><a href="#cb160-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-278"><a href="#cb160-278" aria-hidden="true" tabindex="-1"></a>次の<span class="in">`3 3`</span>の部分はvertexとedgeの数を示しており、前がvertexの数、後ろがedgeの数になります。</span>
<span id="cb160-279"><a href="#cb160-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-280"><a href="#cb160-280" aria-hidden="true" tabindex="-1"></a>次の行の<span class="in">`+ attr`</span>は設定されている<span class="in">`attribute`</span>を示しています。<span class="in">`name`</span>、<span class="in">`sex`</span>には<span class="in">`(v/c)`</span>と表示されています。この<span class="in">`(v/c)`</span>はvertexの<span class="in">`attribute`</span>であり、characterであることを示しています。<span class="in">`age`</span>は<span class="in">`(v/n)`</span>、つまりvertexの<span class="in">`attribute`</span>でnumericであること、<span class="in">`weight`</span>は<span class="in">`(e/n)`</span>、edgeの<span class="in">`attribute`</span>でnumericであることが表示されています。この他にグラフ自体にも<span class="in">`attribute`</span>を設定することができます。グラフの<span class="in">`attribute`</span>は<span class="in">`(g/c)`</span>や<span class="in">`(g/n)`</span>で示されます。</span>
<span id="cb160-281"><a href="#cb160-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-282"><a href="#cb160-282" aria-hidden="true" tabindex="-1"></a>最後の行はedgeのリストです。この場合は有向グラフであり、A→B、B→C、C→Aの3つのedgeがあることが示されています。</span>
<span id="cb160-283"><a href="#cb160-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-284"><a href="#cb160-284" aria-hidden="true" tabindex="-1"></a><span class="fu">#### edge/vertexをgraphから取り出す</span></span>
<span id="cb160-285"><a href="#cb160-285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-286"><a href="#cb160-286" aria-hidden="true" tabindex="-1"></a>グラフからedgeを取り出す場合には<span class="in">`E`</span>関数、vertexを取り出す場合には<span class="in">`V`</span>関数をそれぞれ用います。取り出したedgeやvertexには<span class="in">`attribute`</span>が付いたままになっています。</span>
<span id="cb160-287"><a href="#cb160-287" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-288"><a href="#cb160-288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="vertex・edgeを取り出す"}</span></span>
<span id="cb160-289"><a href="#cb160-289" aria-hidden="true" tabindex="-1"></a><span class="in">E(g)</span></span>
<span id="cb160-290"><a href="#cb160-290" aria-hidden="true" tabindex="-1"></a><span class="in">V(g)</span></span>
<span id="cb160-291"><a href="#cb160-291" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-292"><a href="#cb160-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-293"><a href="#cb160-293" aria-hidden="true" tabindex="-1"></a>上記のように、グラフには<span class="in">`attribute`</span>を設定することができます。<span class="in">`attribute`</span>を設定することができるのは、graph全体と、edge、vertexの3種類です。それぞれの<span class="in">`attribute`</span>は<span class="in">`graph_attr`</span>、<span class="in">`edge_attr`</span>、<span class="in">`vertex_attr`</span>関数でそれぞれリストとして取り出すことができます。</span>
<span id="cb160-294"><a href="#cb160-294" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-295"><a href="#cb160-295" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="attributesを取り出す"}</span></span>
<span id="cb160-296"><a href="#cb160-296" aria-hidden="true" tabindex="-1"></a><span class="in">graph_attr(g)</span></span>
<span id="cb160-297"><a href="#cb160-297" aria-hidden="true" tabindex="-1"></a><span class="in">edge_attr(g)</span></span>
<span id="cb160-298"><a href="#cb160-298" aria-hidden="true" tabindex="-1"></a><span class="in">vertex_attr(g)</span></span>
<span id="cb160-299"><a href="#cb160-299" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-300"><a href="#cb160-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-301"><a href="#cb160-301" aria-hidden="true" tabindex="-1"></a>他のRの関数と同様に、<span class="in">`graph_attr`</span>、<span class="in">`edge_attr`</span>、<span class="in">`vertex_attr`</span>関数にベクターやリストを代入することで、グラフに後から<span class="in">`attribute`</span>を設定することもできます。代入により<span class="in">`attribute`</span>を設定する場合には、関数の第一引数にグラフ、第二引数に<span class="in">`attribute`</span>の名前を文字列で設定します。</span>
<span id="cb160-302"><a href="#cb160-302" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-303"><a href="#cb160-303" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="attributeを設定する"}</span></span>
<span id="cb160-304"><a href="#cb160-304" aria-hidden="true" tabindex="-1"></a><span class="in">graph_attr(g, "name") &lt;- "ABC"</span></span>
<span id="cb160-305"><a href="#cb160-305" aria-hidden="true" tabindex="-1"></a><span class="in">edge_attr(g, "degree") &lt;- c(3, 4, 5)</span></span>
<span id="cb160-306"><a href="#cb160-306" aria-hidden="true" tabindex="-1"></a><span class="in">vertex_attr(g, "height") &lt;- c(167, 182, 153)</span></span>
<span id="cb160-307"><a href="#cb160-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-308"><a href="#cb160-308" aria-hidden="true" tabindex="-1"></a><span class="in"># attributeが増えている</span></span>
<span id="cb160-309"><a href="#cb160-309" aria-hidden="true" tabindex="-1"></a><span class="in">g</span></span>
<span id="cb160-310"><a href="#cb160-310" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-311"><a href="#cb160-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-312"><a href="#cb160-312" aria-hidden="true" tabindex="-1"></a><span class="in">`attribute`</span>の取り出しには、<span class="in">`graph_attr`</span>、<span class="in">`edge_attr`</span>、<span class="in">`vertex_attr`</span>関数だけでなく、上記の<span class="in">`E`</span>関数、<span class="in">`V`</span>関数を用いることもできます。<span class="in">`E`</span>関数、<span class="in">`V`</span>関数の返り値には<span class="in">`attribute`</span>がくっついているので、<span class="in">`E`</span>関数、<span class="in">`V`</span>関数の後に<span class="in">`$ + attribute名`</span>をつけることで<span class="in">`attribute`</span>をリストのように取り出すことができます。<span class="in">`attribute`</span>を用いて演算を行う場合（たとえばネットワークを<span class="in">`plot`</span>関数で表示するときのオプション設定に<span class="in">`attribute`</span>を用いる場合など）には<span class="in">`E`</span>、<span class="in">`V`</span>関数からの<span class="in">`attribute`</span>の呼び出しを用いることになります。</span>
<span id="cb160-313"><a href="#cb160-313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-314"><a href="#cb160-314" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="edgeのattributeをE関数から呼び出す"}</span></span>
<span id="cb160-315"><a href="#cb160-315" aria-hidden="true" tabindex="-1"></a><span class="in"># edgeに指定したweightを呼び出し</span></span>
<span id="cb160-316"><a href="#cb160-316" aria-hidden="true" tabindex="-1"></a><span class="in">E(g)$weight</span></span>
<span id="cb160-317"><a href="#cb160-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-318"><a href="#cb160-318" aria-hidden="true" tabindex="-1"></a><span class="in"># edgeの太さをweightに従い決める</span></span>
<span id="cb160-319"><a href="#cb160-319" aria-hidden="true" tabindex="-1"></a><span class="in">plot(g, edge.width = E(g)$weight)</span></span>
<span id="cb160-320"><a href="#cb160-320" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-321"><a href="#cb160-321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-322"><a href="#cb160-322" aria-hidden="true" tabindex="-1"></a>同じように、vertexの<span class="in">`attribute`</span>もノードの色調整などに用いることができます。</span>
<span id="cb160-323"><a href="#cb160-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-324"><a href="#cb160-324" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="vertexのattributeをV関数から呼び出す"}</span></span>
<span id="cb160-325"><a href="#cb160-325" aria-hidden="true" tabindex="-1"></a><span class="in">V(g)$sex</span></span>
<span id="cb160-326"><a href="#cb160-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-327"><a href="#cb160-327" aria-hidden="true" tabindex="-1"></a><span class="in">plot(</span></span>
<span id="cb160-328"><a href="#cb160-328" aria-hidden="true" tabindex="-1"></a><span class="in">  g, </span></span>
<span id="cb160-329"><a href="#cb160-329" aria-hidden="true" tabindex="-1"></a><span class="in">  edge.width = E(g)$weight, </span></span>
<span id="cb160-330"><a href="#cb160-330" aria-hidden="true" tabindex="-1"></a><span class="in">  # 男性のvertexはlightblue、女性のvertexはlightpinkで表示する</span></span>
<span id="cb160-331"><a href="#cb160-331" aria-hidden="true" tabindex="-1"></a><span class="in">  vertex.color = if_else(V(g)$sex == "M", "lightblue", "lightpink"))</span></span>
<span id="cb160-332"><a href="#cb160-332" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-333"><a href="#cb160-333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-334"><a href="#cb160-334" aria-hidden="true" tabindex="-1"></a><span class="fu">### ネットワークを描画する</span></span>
<span id="cb160-335"><a href="#cb160-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-336"><a href="#cb160-336" aria-hidden="true" tabindex="-1"></a>上記の通り、ネットワークを描画する場合には、<span class="in">`plot`</span>関数の引数にグラフのオブジェクトを取ります。</span>
<span id="cb160-337"><a href="#cb160-337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-338"><a href="#cb160-338" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="plot関数でネットワークを表示する"}</span></span>
<span id="cb160-339"><a href="#cb160-339" aria-hidden="true" tabindex="-1"></a><span class="in">plot(g)</span></span>
<span id="cb160-340"><a href="#cb160-340" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-341"><a href="#cb160-341" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-342"><a href="#cb160-342" aria-hidden="true" tabindex="-1"></a>ただし、これだけではedgeやvertexの特性をグラフに反映することはできませんし、場合によっては表示が見にくく、ネットワークの構造をきちんととらえることができないこともあります。</span>
<span id="cb160-343"><a href="#cb160-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-344"><a href="#cb160-344" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>では、<span class="in">`plot`</span>関数の引数や<span class="in">`layout`</span>（vertexの位置を決める要素）を設定する一連の関数により、ネットワークを自由に描画できるようになっています。以下に<span class="in">`plot`</span>関数の引数の一覧を示します。</span>
<span id="cb160-345"><a href="#cb160-345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-346"><a href="#cb160-346" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE}</span></span>
<span id="cb160-347"><a href="#cb160-347" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(DT, readxl)</span></span>
<span id="cb160-348"><a href="#cb160-348" aria-hidden="true" tabindex="-1"></a><span class="in">dargs &lt;- read_excel("./data/chapter33_plot.igraph_args.xlsx")</span></span>
<span id="cb160-349"><a href="#cb160-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-350"><a href="#cb160-350" aria-hidden="true" tabindex="-1"></a><span class="in">DT::datatable(dargs, caption="表1：plot.igraph関数の引数一覧")</span></span>
<span id="cb160-351"><a href="#cb160-351" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-352"><a href="#cb160-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-353"><a href="#cb160-353" aria-hidden="true" tabindex="-1"></a>いくつかの引数を指定した例を以下に示します。いろいろ試してみることで自由にネットワークを表示できるようになるでしょう。</span>
<span id="cb160-354"><a href="#cb160-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-355"><a href="#cb160-355" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="vertexのグループ化"}</span></span>
<span id="cb160-356"><a href="#cb160-356" aria-hidden="true" tabindex="-1"></a><span class="in">plot(g, mark.groups=list(c(1, 2), c(3)), mark.col = c("red", "blue"))</span></span>
<span id="cb160-357"><a href="#cb160-357" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-358"><a href="#cb160-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-359"><a href="#cb160-359" aria-hidden="true" tabindex="-1"></a><span class="fu">#### layout</span></span>
<span id="cb160-360"><a href="#cb160-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-361"><a href="#cb160-361" aria-hidden="true" tabindex="-1"></a>ネットワークを表示する際には、上記のような引数による細かな表示の変更の他に、ネットワーク自体の形を大きく変える**layout**というものを指定することができます。<span class="in">`plot`</span>関数内の<span class="in">`layout`</span>引数にlayoutを指定するための関数を指定することで、ネットワークの見た目を大きく変えることができます。また、layoutを指定するための関数を前もって宣言しておくことでもlayoutを変更することができます。各<span class="in">`layout`</span>関数にはそれぞれ引数も設定されているので、同じlayout内で見た目を微調整することもできます。</span>
<span id="cb160-362"><a href="#cb160-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-363"><a href="#cb160-363" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-364"><a href="#cb160-364" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-365"><a href="#cb160-365" aria-hidden="true" tabindex="-1"></a><span class="fu">## star</span></span>
<span id="cb160-366"><a href="#cb160-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-369"><a href="#cb160-369" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-370"><a href="#cb160-370" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-371"><a href="#cb160-371" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_as_star</span>(karate))</span>
<span id="cb160-372"><a href="#cb160-372" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-373"><a href="#cb160-373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-374"><a href="#cb160-374" aria-hidden="true" tabindex="-1"></a><span class="fu">## tree</span></span>
<span id="cb160-375"><a href="#cb160-375" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-378"><a href="#cb160-378" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-379"><a href="#cb160-379" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-380"><a href="#cb160-380" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_as_tree</span>(karate))</span>
<span id="cb160-381"><a href="#cb160-381" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-382"><a href="#cb160-382" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-383"><a href="#cb160-383" aria-hidden="true" tabindex="-1"></a><span class="fu">## circle</span></span>
<span id="cb160-384"><a href="#cb160-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-387"><a href="#cb160-387" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-388"><a href="#cb160-388" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-389"><a href="#cb160-389" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_in_circle</span>(karate))</span>
<span id="cb160-390"><a href="#cb160-390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-391"><a href="#cb160-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-392"><a href="#cb160-392" aria-hidden="true" tabindex="-1"></a><span class="fu">## nicely</span></span>
<span id="cb160-393"><a href="#cb160-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-396"><a href="#cb160-396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-397"><a href="#cb160-397" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-398"><a href="#cb160-398" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_nicely</span>(karate)) <span class="co"># plotのデフォルト</span></span>
<span id="cb160-399"><a href="#cb160-399" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-400"><a href="#cb160-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-401"><a href="#cb160-401" aria-hidden="true" tabindex="-1"></a><span class="fu">## grid</span></span>
<span id="cb160-402"><a href="#cb160-402" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-405"><a href="#cb160-405" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-406"><a href="#cb160-406" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-407"><a href="#cb160-407" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_on_grid</span>(karate))</span>
<span id="cb160-408"><a href="#cb160-408" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-409"><a href="#cb160-409" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-410"><a href="#cb160-410" aria-hidden="true" tabindex="-1"></a><span class="fu">## sphere</span></span>
<span id="cb160-411"><a href="#cb160-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-414"><a href="#cb160-414" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-415"><a href="#cb160-415" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-416"><a href="#cb160-416" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_on_sphere</span>(karate))</span>
<span id="cb160-417"><a href="#cb160-417" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-418"><a href="#cb160-418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-419"><a href="#cb160-419" aria-hidden="true" tabindex="-1"></a><span class="fu">## randomly</span></span>
<span id="cb160-420"><a href="#cb160-420" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-423"><a href="#cb160-423" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-424"><a href="#cb160-424" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-425"><a href="#cb160-425" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_randomly</span>(karate))</span>
<span id="cb160-426"><a href="#cb160-426" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-427"><a href="#cb160-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-428"><a href="#cb160-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_dh</span></span>
<span id="cb160-429"><a href="#cb160-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-432"><a href="#cb160-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-433"><a href="#cb160-433" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-434"><a href="#cb160-434" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_dh</span>(karate)) <span class="co"># Davidson-Harel layout algorithm</span></span>
<span id="cb160-435"><a href="#cb160-435" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-436"><a href="#cb160-436" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-437"><a href="#cb160-437" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_fr</span></span>
<span id="cb160-438"><a href="#cb160-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-441"><a href="#cb160-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-442"><a href="#cb160-442" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-443"><a href="#cb160-443" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_fr</span>(karate)) <span class="co"># Fruchterman-Reingold layout algorithm</span></span>
<span id="cb160-444"><a href="#cb160-444" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-445"><a href="#cb160-445" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-446"><a href="#cb160-446" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_gem</span></span>
<span id="cb160-447"><a href="#cb160-447" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-450"><a href="#cb160-450" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-451"><a href="#cb160-451" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-452"><a href="#cb160-452" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_gem</span>(karate)) <span class="co"># GEM layout algorithm</span></span>
<span id="cb160-453"><a href="#cb160-453" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-454"><a href="#cb160-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-455"><a href="#cb160-455" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_graphopt</span></span>
<span id="cb160-456"><a href="#cb160-456" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-459"><a href="#cb160-459" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-460"><a href="#cb160-460" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-461"><a href="#cb160-461" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_graphopt</span>(karate)) <span class="co"># graphopt layout algorithm</span></span>
<span id="cb160-462"><a href="#cb160-462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-463"><a href="#cb160-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-464"><a href="#cb160-464" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_kk</span></span>
<span id="cb160-465"><a href="#cb160-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-468"><a href="#cb160-468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-469"><a href="#cb160-469" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-470"><a href="#cb160-470" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_kk</span>(karate)) <span class="co"># Kamada-Kawai layout algorithm</span></span>
<span id="cb160-471"><a href="#cb160-471" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-472"><a href="#cb160-472" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-473"><a href="#cb160-473" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_lgl</span></span>
<span id="cb160-474"><a href="#cb160-474" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-477"><a href="#cb160-477" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-478"><a href="#cb160-478" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-479"><a href="#cb160-479" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_lgl</span>(karate)) <span class="co"># Large Graph layout</span></span>
<span id="cb160-480"><a href="#cb160-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-481"><a href="#cb160-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-482"><a href="#cb160-482" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_mds</span></span>
<span id="cb160-483"><a href="#cb160-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-486"><a href="#cb160-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-487"><a href="#cb160-487" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-488"><a href="#cb160-488" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_mds</span>(karate)) <span class="co"># multidimensional scaling</span></span>
<span id="cb160-489"><a href="#cb160-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-490"><a href="#cb160-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-491"><a href="#cb160-491" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_sugiyama</span></span>
<span id="cb160-492"><a href="#cb160-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-495"><a href="#cb160-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-496"><a href="#cb160-496" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-497"><a href="#cb160-497" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_sugiyama</span>(karate)) <span class="co"># Sugiyama graph layout</span></span>
<span id="cb160-498"><a href="#cb160-498" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-499"><a href="#cb160-499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-500"><a href="#cb160-500" aria-hidden="true" tabindex="-1"></a><span class="fu">## with_drl</span></span>
<span id="cb160-501"><a href="#cb160-501" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-504"><a href="#cb160-504" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-505"><a href="#cb160-505" aria-hidden="true" tabindex="-1"></a>karate <span class="ot">&lt;-</span> <span class="fu">make_graph</span>(<span class="st">"Zachary"</span>)</span>
<span id="cb160-506"><a href="#cb160-506" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(karate, <span class="at">layout=</span><span class="fu">layout_with_drl</span>(karate)) <span class="co"># force-directed graph layout</span></span>
<span id="cb160-507"><a href="#cb160-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-508"><a href="#cb160-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-509"><a href="#cb160-509" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-510"><a href="#cb160-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-511"><a href="#cb160-511" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse=true}</span>
<span id="cb160-512"><a href="#cb160-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-513"><a href="#cb160-513" aria-hidden="true" tabindex="-1"></a><span class="fu">## ネットワークの表記と情報としての正しさ</span></span>
<span id="cb160-514"><a href="#cb160-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-515"><a href="#cb160-515" aria-hidden="true" tabindex="-1"></a>ネットワークをグラフとしてプロットすると、何となくそのネットワークが分かったような気がします。ですので、ネットワーク解析においてプロットすること、ネットワークの表記は非常に重要です。一方で、上記のようにネットワークの表記の方法は様々であり、どのようなネットワークの表記がネットワークの正確な理解につながるのかは難しい問題です。</span>
<span id="cb160-516"><a href="#cb160-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-517"><a href="#cb160-517" aria-hidden="true" tabindex="-1"></a>ネットワークに関する<span class="co">[</span><span class="ot">論文</span><span class="co">](https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2018.01742/full)</span> <span class="co">[</span><span class="ot">@Jones_2018_f_in_psycho_bib</span><span class="co">]</span>では、ネットワークの表記において勘違いしやすい点が4点挙げられています。</span>
<span id="cb160-518"><a href="#cb160-518" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-519"><a href="#cb160-519" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>vertexの位置が近いとvertexの関係が密接で、遠いと密接ではないように思う</span>
<span id="cb160-520"><a href="#cb160-520" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>vertexの縦横の位置に意味があるように思う</span>
<span id="cb160-521"><a href="#cb160-521" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>ネットワークの中心に表記されているvertexが重要だと思う</span>
<span id="cb160-522"><a href="#cb160-522" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>2つのネットワークの図が全然違うと、ネットワークは全く異なっていると思う</span>
<span id="cb160-523"><a href="#cb160-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-524"><a href="#cb160-524" aria-hidden="true" tabindex="-1"></a>上記の4点は表記法により正しかったり間違っていたりするため、必ずしも表示されたネットワークがネットワークの正確な情報を伝えているというわけではありません。ネットワークの描画は乱数依存であるため、例えば下図のように同じグラフを2回表示するだけでも、グラフは同じ形には表記されません。</span>
<span id="cb160-525"><a href="#cb160-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-526"><a href="#cb160-526" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="同じネットワークを2度表示する"}</span></span>
<span id="cb160-527"><a href="#cb160-527" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(1, 2))</span></span>
<span id="cb160-528"><a href="#cb160-528" aria-hidden="true" tabindex="-1"></a><span class="in">karate |&gt; plot()</span></span>
<span id="cb160-529"><a href="#cb160-529" aria-hidden="true" tabindex="-1"></a><span class="in">karate |&gt; plot() # seedを指定しないと見た目が変わる</span></span>
<span id="cb160-530"><a href="#cb160-530" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-531"><a href="#cb160-531" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-532"><a href="#cb160-532" aria-hidden="true" tabindex="-1"></a>上記で紹介した<span class="co">[</span><span class="ot">論文</span><span class="co">](https://www.frontiersin.org/journals/psychology/articles/10.3389/fpsyg.2018.01742/full)</span>には、ネットワークの情報を正確に伝えるためのプロットの手法について記載されています。ご一読されるとよいでしょう。</span>
<span id="cb160-533"><a href="#cb160-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-534"><a href="#cb160-534" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-535"><a href="#cb160-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-536"><a href="#cb160-536" aria-hidden="true" tabindex="-1"></a><span class="fu">## Zachary's karate club</span></span>
<span id="cb160-537"><a href="#cb160-537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-538"><a href="#cb160-538" aria-hidden="true" tabindex="-1"></a>上記のlayoutでは、<span class="in">`karate &lt;- make_graph("Zachary")`</span>という形で<span class="in">`igraph`</span>に登録されているネットワークである、<span class="in">`"Zachary"`</span>を読み込んで利用しています。<span class="in">`make_graph`</span>関数では、<span class="in">`igraph`</span>に登録されているネットワーク（<span class="co">[</span><span class="ot">Notable graphs</span><span class="co">](https://r.igraph.org/reference/make_graph.html)</span>）を文字列で指定することで、<span class="in">`igraph`</span>に保存されているネットワークを呼び出すことができます。</span>
<span id="cb160-539"><a href="#cb160-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-540"><a href="#cb160-540" aria-hidden="true" tabindex="-1"></a>これらのネットワークの中でも有名なものの一つが上記の<span class="co">[</span><span class="ot">**Zachary's karate club**</span><span class="co">](https://en.wikipedia.org/wiki/Zachary%27s_karate_club)</span>です。この空手クラブのデータは<span class="co">[</span><span class="ot">Zachary et al. (1976)</span><span class="co">](https://www.researchgate.net/publication/248519014_An_Information_Flow_Model_for_Conflict_and_Fission_in_Small_Groups1)[</span><span class="ot">@Zachary1976</span><span class="co">]</span>で人類学的な解析に用いられたもので、アメリカの大学の空手クラブにおけるメンバー間の交友関係をネットワークとしたものです。この空手クラブ、1番と34番のメンバーを中心とした2つのグループに別れたことで有名で、ネットワークについての教科書などで頻出するデータとなっています。</span>
<span id="cb160-541"><a href="#cb160-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-542"><a href="#cb160-542" aria-hidden="true" tabindex="-1"></a>以下のネットワーク図はメンバーが分離した後の2グループを色で示したものになっています。次に説明する中心性の評価、クラスターの評価にはこのデータを用います。</span>
<span id="cb160-543"><a href="#cb160-543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-544"><a href="#cb160-544" aria-hidden="true" tabindex="-1"></a>``<span class="in">`{r, filename="Zachary`</span>s karate club"}</span>
<span id="cb160-545"><a href="#cb160-545" aria-hidden="true" tabindex="-1"></a>karate &lt;- make_graph("Zachary")</span>
<span id="cb160-546"><a href="#cb160-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-547"><a href="#cb160-547" aria-hidden="true" tabindex="-1"></a><span class="fu"># 2つに分離した後のグループ</span></span>
<span id="cb160-548"><a href="#cb160-548" aria-hidden="true" tabindex="-1"></a>karate_col &lt;- </span>
<span id="cb160-549"><a href="#cb160-549" aria-hidden="true" tabindex="-1"></a>  c("A", "A", "A", "A", "A", </span>
<span id="cb160-550"><a href="#cb160-550" aria-hidden="true" tabindex="-1"></a>    "A", "A", "A", "A", "B", </span>
<span id="cb160-551"><a href="#cb160-551" aria-hidden="true" tabindex="-1"></a>    "A", "A", "A", "A", "B", </span>
<span id="cb160-552"><a href="#cb160-552" aria-hidden="true" tabindex="-1"></a>    "B", "A", "A", "B", "A", </span>
<span id="cb160-553"><a href="#cb160-553" aria-hidden="true" tabindex="-1"></a>    "B", "A", "B", "B", "B",</span>
<span id="cb160-554"><a href="#cb160-554" aria-hidden="true" tabindex="-1"></a>    "B", "B", "B", "B", "B", </span>
<span id="cb160-555"><a href="#cb160-555" aria-hidden="true" tabindex="-1"></a>    "B", "B", "B", "B")</span>
<span id="cb160-556"><a href="#cb160-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-557"><a href="#cb160-557" aria-hidden="true" tabindex="-1"></a>set.seed(1)</span>
<span id="cb160-558"><a href="#cb160-558" aria-hidden="true" tabindex="-1"></a>plot(</span>
<span id="cb160-559"><a href="#cb160-559" aria-hidden="true" tabindex="-1"></a>  karate, </span>
<span id="cb160-560"><a href="#cb160-560" aria-hidden="true" tabindex="-1"></a>  vertex.color=</span>
<span id="cb160-561"><a href="#cb160-561" aria-hidden="true" tabindex="-1"></a>    if_else(</span>
<span id="cb160-562"><a href="#cb160-562" aria-hidden="true" tabindex="-1"></a>      karate_col == "A", </span>
<span id="cb160-563"><a href="#cb160-563" aria-hidden="true" tabindex="-1"></a>      "lightblue", </span>
<span id="cb160-564"><a href="#cb160-564" aria-hidden="true" tabindex="-1"></a>      "orange"), </span>
<span id="cb160-565"><a href="#cb160-565" aria-hidden="true" tabindex="-1"></a>  vertex.size = 25)</span>
<span id="cb160-566"><a href="#cb160-566" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-567"><a href="#cb160-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-568"><a href="#cb160-568" aria-hidden="true" tabindex="-1"></a><span class="in">### 中心性</span></span>
<span id="cb160-569"><a href="#cb160-569" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-570"><a href="#cb160-570" aria-hidden="true" tabindex="-1"></a><span class="in">上記の通り、Zachary's karate clubのネットワークは1と34のメンバーを中心に2つのグループに分離しました。上のネットワーク図を見ると、確かに1と34にはたくさんのedgeが接続しているように見えます。しかし、実際に1と34がネットワークで中心的な役割があるのかと言われると、グラフだけを見ていてもいまいちよくわかりません。</span></span>
<span id="cb160-571"><a href="#cb160-571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-572"><a href="#cb160-572" aria-hidden="true" tabindex="-1"></a><span class="in">ネットワークで中心的でかつ重要なvertexを抽出するための手法の一つが、**中心性（centrality）**の評価です。ネットワーク解析でよく用いられる中心性は以下の4種類です。</span></span>
<span id="cb160-573"><a href="#cb160-573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-574"><a href="#cb160-574" aria-hidden="true" tabindex="-1"></a><span class="in">- **次数中心性**（degree centrality）</span></span>
<span id="cb160-575"><a href="#cb160-575" aria-hidden="true" tabindex="-1"></a><span class="in">- **媒介中心性**（betweenness centrality）</span></span>
<span id="cb160-576"><a href="#cb160-576" aria-hidden="true" tabindex="-1"></a><span class="in">- **近接中心性**（closeness centrality）</span></span>
<span id="cb160-577"><a href="#cb160-577" aria-hidden="true" tabindex="-1"></a><span class="in">- **固有ベクトル中心性**（eigenvector centrality）</span></span>
<span id="cb160-578"><a href="#cb160-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-579"><a href="#cb160-579" aria-hidden="true" tabindex="-1"></a><span class="in">**次数中心性**は最も単純な中心性で、そのvertexに接続しているedgeの数を表します。`igraph`では`degree`関数で次数中心性を計算することができます。</span></span>
<span id="cb160-580"><a href="#cb160-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-581"><a href="#cb160-581" aria-hidden="true" tabindex="-1"></a><span class="in">**媒介中心性**はそのvertexが他のvertexの間に存在する頻度を表したものです。`igraph`では`betweenness`関数で媒介中心性を計算することができます。</span></span>
<span id="cb160-582"><a href="#cb160-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-583"><a href="#cb160-583" aria-hidden="true" tabindex="-1"></a><span class="in">**近接中心性**はそのvertexから他のvertexまでの距離の和を反映したもので、`igraph`では`closeness`関数で近接中心性を計算することができます。</span></span>
<span id="cb160-584"><a href="#cb160-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-585"><a href="#cb160-585" aria-hidden="true" tabindex="-1"></a><span class="in">**固有ベクトル中心性**は隣接行列から演算できる中心性の指標です。`igraph`では`eigen_centrality`関数で固有ベクトル中心性を計算することができます。</span></span>
<span id="cb160-586"><a href="#cb160-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-587"><a href="#cb160-587" aria-hidden="true" tabindex="-1"></a><span class="in">この他にも様々な中心性の指標はありますが、とりあえずこの4つを比較するとある程度は中心的なvertexを特定することができるでしょう。以下はkarate clubのネットワークでのvertexの中心性を評価したものです。いずれの中心性でも、1と34が高い値を示しており、この2人が重要なvertexであったことがわかります。</span></span>
<span id="cb160-588"><a href="#cb160-588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-589"><a href="#cb160-589" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="中心性の演算", fig.width=10, fig.height=7}</span></span>
<span id="cb160-590"><a href="#cb160-590" aria-hidden="true" tabindex="-1"></a><span class="in"># 次数中心性</span></span>
<span id="cb160-591"><a href="#cb160-591" aria-hidden="true" tabindex="-1"></a><span class="in">degree(karate)</span></span>
<span id="cb160-592"><a href="#cb160-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-593"><a href="#cb160-593" aria-hidden="true" tabindex="-1"></a><span class="in"># 媒介中心性</span></span>
<span id="cb160-594"><a href="#cb160-594" aria-hidden="true" tabindex="-1"></a><span class="in">betweenness(karate)</span></span>
<span id="cb160-595"><a href="#cb160-595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-596"><a href="#cb160-596" aria-hidden="true" tabindex="-1"></a><span class="in"># 近接中心性</span></span>
<span id="cb160-597"><a href="#cb160-597" aria-hidden="true" tabindex="-1"></a><span class="in">closeness(karate)</span></span>
<span id="cb160-598"><a href="#cb160-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-599"><a href="#cb160-599" aria-hidden="true" tabindex="-1"></a><span class="in"># 固有ベクトル中心性</span></span>
<span id="cb160-600"><a href="#cb160-600" aria-hidden="true" tabindex="-1"></a><span class="in">eigen_centrality(karate)$vector</span></span>
<span id="cb160-601"><a href="#cb160-601" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-602"><a href="#cb160-602" aria-hidden="true" tabindex="-1"></a><span class="in"># それぞれをプロットする</span></span>
<span id="cb160-603"><a href="#cb160-603" aria-hidden="true" tabindex="-1"></a><span class="in">par(mfrow = c(2, 2))</span></span>
<span id="cb160-604"><a href="#cb160-604" aria-hidden="true" tabindex="-1"></a><span class="in">degree(karate) |&gt; plot()</span></span>
<span id="cb160-605"><a href="#cb160-605" aria-hidden="true" tabindex="-1"></a><span class="in">title("次数中心性")</span></span>
<span id="cb160-606"><a href="#cb160-606" aria-hidden="true" tabindex="-1"></a><span class="in">betweenness(karate) |&gt; plot()</span></span>
<span id="cb160-607"><a href="#cb160-607" aria-hidden="true" tabindex="-1"></a><span class="in">title("媒介中心性")</span></span>
<span id="cb160-608"><a href="#cb160-608" aria-hidden="true" tabindex="-1"></a><span class="in">closeness(karate) |&gt; plot()</span></span>
<span id="cb160-609"><a href="#cb160-609" aria-hidden="true" tabindex="-1"></a><span class="in">title("近接中心性")</span></span>
<span id="cb160-610"><a href="#cb160-610" aria-hidden="true" tabindex="-1"></a><span class="in">eigen_centrality(karate)$vector |&gt; plot()</span></span>
<span id="cb160-611"><a href="#cb160-611" aria-hidden="true" tabindex="-1"></a><span class="in">title("固有ベクトル中心性")</span></span>
<span id="cb160-612"><a href="#cb160-612" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-613"><a href="#cb160-613" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-614"><a href="#cb160-614" aria-hidden="true" tabindex="-1"></a><span class="fu">#### PageRank</span></span>
<span id="cb160-615"><a href="#cb160-615" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-616"><a href="#cb160-616" aria-hidden="true" tabindex="-1"></a>上記の中心性と似た中心性の評価基準として、**PageRank**があります。PageRankは<span class="co">[</span><span class="ot">Googleが検索エンジンにおいてホームページの順位付けをする</span><span class="co">](https://ja.wikipedia.org/wiki/%E3%83%9A%E3%83%BC%E3%82%B8%E3%83%A9%E3%83%B3%E3%82%AF)</span>のに用いた評価方法です。<span class="in">`igraph`</span>では<span class="in">`page_rank`</span>関数でPageRankの演算を行うことができます。</span>
<span id="cb160-617"><a href="#cb160-617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-618"><a href="#cb160-618" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="PageRankによるvertexの評価"}</span></span>
<span id="cb160-619"><a href="#cb160-619" aria-hidden="true" tabindex="-1"></a><span class="in">page_rank(karate)[[1]] |&gt; plot()</span></span>
<span id="cb160-620"><a href="#cb160-620" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-621"><a href="#cb160-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-622"><a href="#cb160-622" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Edge betweenness</span></span>
<span id="cb160-623"><a href="#cb160-623" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-624"><a href="#cb160-624" aria-hidden="true" tabindex="-1"></a>vertexの媒介性ではなく、edgeの媒介性、つまりvertexとvertexの経路の間にあるedgeを評価する方法がedge betweenness（辺の媒介性）です。edge betweennessが高い辺が切れてしまった場合には、ネットワークが大きく分断されることになります。以下の通り、karate clubでは1と32の間のedge betweennessが高く、ココが切れるとネットワークが2つに分離しやすくなります。</span>
<span id="cb160-625"><a href="#cb160-625" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-626"><a href="#cb160-626" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, fig.width=10, filename="edge betweenness"}</span></span>
<span id="cb160-627"><a href="#cb160-627" aria-hidden="true" tabindex="-1"></a><span class="in"># edge betweennessを演算</span></span>
<span id="cb160-628"><a href="#cb160-628" aria-hidden="true" tabindex="-1"></a><span class="in">edge_betweenness(karate)</span></span>
<span id="cb160-629"><a href="#cb160-629" aria-hidden="true" tabindex="-1"></a><span class="in">edge &lt;- karate |&gt; as_edgelist() |&gt; as.data.frame()</span></span>
<span id="cb160-630"><a href="#cb160-630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-631"><a href="#cb160-631" aria-hidden="true" tabindex="-1"></a><span class="in"># Edge betweennessをグラフで表示</span></span>
<span id="cb160-632"><a href="#cb160-632" aria-hidden="true" tabindex="-1"></a><span class="in">data.frame(edge , betweenness = edge_betweenness(karate)) |&gt; </span></span>
<span id="cb160-633"><a href="#cb160-633" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(edge = paste0(V1, "-", V2)) |&gt; </span></span>
<span id="cb160-634"><a href="#cb160-634" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = edge, y = betweenness))+</span></span>
<span id="cb160-635"><a href="#cb160-635" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 3)+</span></span>
<span id="cb160-636"><a href="#cb160-636" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))</span></span>
<span id="cb160-637"><a href="#cb160-637" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-638"><a href="#cb160-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-639"><a href="#cb160-639" aria-hidden="true" tabindex="-1"></a><span class="fu">### ネットワークのクラスター（コミュニティ）</span></span>
<span id="cb160-640"><a href="#cb160-640" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-641"><a href="#cb160-641" aria-hidden="true" tabindex="-1"></a>ネットワーク解析の目的の一つは、ネットワーク上のクラスター（コミュニティ）を明らかにすることです。karate clubの例であれば、2つのクラスターが存在することがあらかじめ分かっていれば、グループが割れないように対策することができたかもしれません。</span>
<span id="cb160-642"><a href="#cb160-642" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-643"><a href="#cb160-643" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">28章</span><span class="co">](./chapter28.html)</span>で説明したようにクラスター解析には様々な方法があります。同じように、ネットワーク解析におけるクラスター解析にも様々なものがあります。<span class="in">`igraph`</span>に登録されているクラスター解析だけで10種以上あります。どれがいいのかは時と場合によりますが、いずれも<span class="in">`igraph`</span>では名前が<span class="in">`cluster_`</span>から始まる一連の関数で演算することができます。</span>
<span id="cb160-644"><a href="#cb160-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-645"><a href="#cb160-645" aria-hidden="true" tabindex="-1"></a>以下に<span class="in">`igraph`</span>が備えているクラスター解析とkarate clubの分離後の2グループを比較したものを示します（一番左の<span class="in">`karate`</span>が分離後のグループ）。グラフで左側に示したものほど<span class="in">`karate`</span>との一致度が高くなっています。それぞれの関数には解析方法を調整するための引数が多数準備されているので、うまく調整することでより精度の高いクラスター解析を行うこともできます。したがって、必ずしも以下の例のように<span class="in">`cluster_fluid_communities`</span>が優れているというわけではありません。時と場合により手法を使い分けるのが良いでしょう。</span>
<span id="cb160-646"><a href="#cb160-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-647"><a href="#cb160-647" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ネットワークのクラスターの演算"}</span></span>
<span id="cb160-648"><a href="#cb160-648" aria-hidden="true" tabindex="-1"></a><span class="in"># クラスターを計算</span></span>
<span id="cb160-649"><a href="#cb160-649" aria-hidden="true" tabindex="-1"></a><span class="in">karate_clus &lt;- data.frame(</span></span>
<span id="cb160-650"><a href="#cb160-650" aria-hidden="true" tabindex="-1"></a><span class="in">  vertex = as.character(1:34) |&gt; factor(levels=1:34),</span></span>
<span id="cb160-651"><a href="#cb160-651" aria-hidden="true" tabindex="-1"></a><span class="in">  karate = if_else(karate_col == "A", 1, 2),</span></span>
<span id="cb160-652"><a href="#cb160-652" aria-hidden="true" tabindex="-1"></a><span class="in">  edge_betweenness = cluster_edge_betweenness(karate)$membership,</span></span>
<span id="cb160-653"><a href="#cb160-653" aria-hidden="true" tabindex="-1"></a><span class="in">  fast_greedy = cluster_fast_greedy(karate)$membership,</span></span>
<span id="cb160-654"><a href="#cb160-654" aria-hidden="true" tabindex="-1"></a><span class="in">  fluid_communities = cluster_fluid_communities(karate, no.of.communities = 2)$membership,</span></span>
<span id="cb160-655"><a href="#cb160-655" aria-hidden="true" tabindex="-1"></a><span class="in">  infomap = cluster_infomap(karate)$membership,</span></span>
<span id="cb160-656"><a href="#cb160-656" aria-hidden="true" tabindex="-1"></a><span class="in">  label_prop = cluster_label_prop(karate)$membership,</span></span>
<span id="cb160-657"><a href="#cb160-657" aria-hidden="true" tabindex="-1"></a><span class="in">  leading_eigen = cluster_leading_eigen(karate)$membership,</span></span>
<span id="cb160-658"><a href="#cb160-658" aria-hidden="true" tabindex="-1"></a><span class="in">  optimal = cluster_optimal(karate)$membership,</span></span>
<span id="cb160-659"><a href="#cb160-659" aria-hidden="true" tabindex="-1"></a><span class="in">  spinglass = cluster_spinglass(karate)$membership,</span></span>
<span id="cb160-660"><a href="#cb160-660" aria-hidden="true" tabindex="-1"></a><span class="in">  walktrap = cluster_walktrap(karate)$membership</span></span>
<span id="cb160-661"><a href="#cb160-661" aria-hidden="true" tabindex="-1"></a><span class="in">) </span></span>
<span id="cb160-662"><a href="#cb160-662" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-663"><a href="#cb160-663" aria-hidden="true" tabindex="-1"></a><span class="in"># 同一クラスターのvertexを同じ色で表示する</span></span>
<span id="cb160-664"><a href="#cb160-664" aria-hidden="true" tabindex="-1"></a><span class="in">karate_clus|&gt; </span></span>
<span id="cb160-665"><a href="#cb160-665" aria-hidden="true" tabindex="-1"></a><span class="in">  pivot_longer(2:11, names_to = "type", values_to = "cluster") |&gt; </span></span>
<span id="cb160-666"><a href="#cb160-666" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate( # 見やすいように順番を入れ替え</span></span>
<span id="cb160-667"><a href="#cb160-667" aria-hidden="true" tabindex="-1"></a><span class="in">    type = </span></span>
<span id="cb160-668"><a href="#cb160-668" aria-hidden="true" tabindex="-1"></a><span class="in">      fct_relevel(</span></span>
<span id="cb160-669"><a href="#cb160-669" aria-hidden="true" tabindex="-1"></a><span class="in">        type, </span></span>
<span id="cb160-670"><a href="#cb160-670" aria-hidden="true" tabindex="-1"></a><span class="in">        c(</span></span>
<span id="cb160-671"><a href="#cb160-671" aria-hidden="true" tabindex="-1"></a><span class="in">          "karate", </span></span>
<span id="cb160-672"><a href="#cb160-672" aria-hidden="true" tabindex="-1"></a><span class="in">          "fluid_communities", </span></span>
<span id="cb160-673"><a href="#cb160-673" aria-hidden="true" tabindex="-1"></a><span class="in">          "fast_greedy", </span></span>
<span id="cb160-674"><a href="#cb160-674" aria-hidden="true" tabindex="-1"></a><span class="in">          "leading_eigen", </span></span>
<span id="cb160-675"><a href="#cb160-675" aria-hidden="true" tabindex="-1"></a><span class="in">          "edge_betweenness", </span></span>
<span id="cb160-676"><a href="#cb160-676" aria-hidden="true" tabindex="-1"></a><span class="in">          "walktrap", "infomap", </span></span>
<span id="cb160-677"><a href="#cb160-677" aria-hidden="true" tabindex="-1"></a><span class="in">          "label_prop", </span></span>
<span id="cb160-678"><a href="#cb160-678" aria-hidden="true" tabindex="-1"></a><span class="in">          "optimal", </span></span>
<span id="cb160-679"><a href="#cb160-679" aria-hidden="true" tabindex="-1"></a><span class="in">          "spinglass"))) |&gt; </span></span>
<span id="cb160-680"><a href="#cb160-680" aria-hidden="true" tabindex="-1"></a><span class="in">  ggplot(aes(x = type, y = vertex, color = factor(cluster), fill = factor(cluster))) +</span></span>
<span id="cb160-681"><a href="#cb160-681" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_tile()+</span></span>
<span id="cb160-682"><a href="#cb160-682" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))</span></span>
<span id="cb160-683"><a href="#cb160-683" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-684"><a href="#cb160-684" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-685"><a href="#cb160-685" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-686"><a href="#cb160-686" aria-hidden="true" tabindex="-1"></a><span class="fu">#### クリーク（cliques）</span></span>
<span id="cb160-687"><a href="#cb160-687" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-688"><a href="#cb160-688" aria-hidden="true" tabindex="-1"></a>類似の解析方法として、クリーク（cliques、小集団）という、サブグループを見つけるための解析方法もあります。こちらはすべてのvertexをクラスターに所属させるようなものではなく、内部に存在する小集団（例えば、会社の一部署のメンバーなど）を求める手法となっています。<span class="in">`clique_num`</span>関数はクリークに含まれる最大のvertex数を返す関数です。この<span class="in">`clique_num`</span>の返り値を<span class="in">`cliques`</span>関数の<span class="in">`min`</span>引数に取ることで、クリークを比較的簡単に見つけることができます。下の例では、5人のクリークを2つ検出しています。</span>
<span id="cb160-689"><a href="#cb160-689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-690"><a href="#cb160-690" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="クリーク（clique）の演算"}</span></span>
<span id="cb160-691"><a href="#cb160-691" aria-hidden="true" tabindex="-1"></a><span class="in">clique_num(karate)</span></span>
<span id="cb160-692"><a href="#cb160-692" aria-hidden="true" tabindex="-1"></a><span class="in">cliques(karate, min = 5)</span></span>
<span id="cb160-693"><a href="#cb160-693" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-694"><a href="#cb160-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-695"><a href="#cb160-695" aria-hidden="true" tabindex="-1"></a><span class="fu">### ネットワークの特徴を評価する</span></span>
<span id="cb160-696"><a href="#cb160-696" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-697"><a href="#cb160-697" aria-hidden="true" tabindex="-1"></a><span class="fu">#### edgeの密度（edge density）</span></span>
<span id="cb160-698"><a href="#cb160-698" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-699"><a href="#cb160-699" aria-hidden="true" tabindex="-1"></a>ネットワーク解析では、ネットワーク全体を評価することもあります。代表的な特徴として、ネットワークの密度（edge density）があります。密度とは、現在のedgeの数の、そのvertex数で実現可能な最大のedgeの数に対する割合を指します。karateの例では、edgeの数は78ですが、34人のネットワークですべての人がedgeでつながっている場合、つまりedgeの最大数は<span class="in">`sum(33:1)`</span>、つまり561となります。この78と561の比、<span class="in">`78/561`</span>がedge densityとなります。</span>
<span id="cb160-700"><a href="#cb160-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-701"><a href="#cb160-701" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>ではedge densityを<span class="in">`edge_density`</span>関数で演算することができます。</span>
<span id="cb160-702"><a href="#cb160-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-703"><a href="#cb160-703" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="edgeの密度（edge density）"}</span></span>
<span id="cb160-704"><a href="#cb160-704" aria-hidden="true" tabindex="-1"></a><span class="in">edge_density(karate) # edgeの密度</span></span>
<span id="cb160-705"><a href="#cb160-705" aria-hidden="true" tabindex="-1"></a><span class="in">E(karate) # 78 edge</span></span>
<span id="cb160-706"><a href="#cb160-706" aria-hidden="true" tabindex="-1"></a><span class="in">E(make_full_graph(n=34)) # full graph(すべてのvertexがedgeでつながっている場合)：561 edge</span></span>
<span id="cb160-707"><a href="#cb160-707" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-708"><a href="#cb160-708" aria-hidden="true" tabindex="-1"></a><span class="in">78 / 561 # edge_densityの結果と同じ</span></span>
<span id="cb160-709"><a href="#cb160-709" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-710"><a href="#cb160-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-711"><a href="#cb160-711" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 次数の分布</span></span>
<span id="cb160-712"><a href="#cb160-712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-713"><a href="#cb160-713" aria-hidden="true" tabindex="-1"></a>次数（degree）、つまりそれぞれのvertexから出ているedgeの数もネットワークの構造を反映するパラメータとなります。次数をヒストグラムとして表示すれば、edgeの分布やその偏りを図示することができます。<span class="in">`igraph`</span>では、<span class="in">`degree_distribution`</span>関数で次数の頻度を計算することができます。また、この関数の返り値を<span class="in">`hist`</span>関数の引数とすることで、次数のヒストグラムを表示することができます。</span>
<span id="cb160-714"><a href="#cb160-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-715"><a href="#cb160-715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="次数の分布"}</span></span>
<span id="cb160-716"><a href="#cb160-716" aria-hidden="true" tabindex="-1"></a><span class="in">degree_distribution(karate) |&gt; hist() # 次数の分布</span></span>
<span id="cb160-717"><a href="#cb160-717" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-718"><a href="#cb160-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-719"><a href="#cb160-719" aria-hidden="true" tabindex="-1"></a><span class="fu">#### その他の評価尺度：vertexの距離・ネットワークの直径</span></span>
<span id="cb160-720"><a href="#cb160-720" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-721"><a href="#cb160-721" aria-hidden="true" tabindex="-1"></a>上記のedgeの密度や次数の分布に加えて、vertex間の平均距離や距離の分布、ネットワークの直径もネットワークの性質を表すパラメータとして用いられています。vertex間の距離の分布は<span class="in">`distance_table`</span>関数で、ネットワークの直径は<span class="in">`girth`</span>関数で計算することができます。</span>
<span id="cb160-722"><a href="#cb160-722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-725"><a href="#cb160-725" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-726"><a href="#cb160-726" aria-hidden="true" tabindex="-1"></a><span class="fu">mean_distance</span>(karate) <span class="co"># vertex間の平均距離</span></span>
<span id="cb160-727"><a href="#cb160-727" aria-hidden="true" tabindex="-1"></a><span class="fu">distance_table</span>(karate) <span class="co"># vertex間の距離の要約</span></span>
<span id="cb160-728"><a href="#cb160-728" aria-hidden="true" tabindex="-1"></a><span class="fu">girth</span>(karate) <span class="co"># ネットワークの直径</span></span>
<span id="cb160-729"><a href="#cb160-729" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-730"><a href="#cb160-730" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-731"><a href="#cb160-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-732"><a href="#cb160-732" aria-hidden="true" tabindex="-1"></a><span class="fu">### 経路を探索する</span></span>
<span id="cb160-733"><a href="#cb160-733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-734"><a href="#cb160-734" aria-hidden="true" tabindex="-1"></a>ネットワーク解析では、上記のような中心性やクラスター以外に、vertexからvertexまでの経路を探索することも目的となります。karate clubでは経路を調べる意味はあまりありませんが、例えば鉄道の路線図や飛行機の航路であれば、最短経路や複数の経路を求める必要があるでしょう。</span>
<span id="cb160-735"><a href="#cb160-735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-736"><a href="#cb160-736" aria-hidden="true" tabindex="-1"></a>経路の探索の例として、路線図のデータを利用します。以下は奈良の鉄道（近鉄・JR）の路線のネットワーク（路線図）です。この路線図を利用して経路の探索を説明します。</span>
<span id="cb160-737"><a href="#cb160-737" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-738"><a href="#cb160-738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="奈良の路線図"}</span></span>
<span id="cb160-739"><a href="#cb160-739" aria-hidden="true" tabindex="-1"></a><span class="in"># 駅同士の接続（d）と駅（vt）のデータを読み込む</span></span>
<span id="cb160-740"><a href="#cb160-740" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- read.csv("./data/chapter33_nara_stations.csv")</span></span>
<span id="cb160-741"><a href="#cb160-741" aria-hidden="true" tabindex="-1"></a><span class="in">vt &lt;- read.csv("./data/chapter33_nara_stations_vertex_list.csv")</span></span>
<span id="cb160-742"><a href="#cb160-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-743"><a href="#cb160-743" aria-hidden="true" tabindex="-1"></a><span class="in"># dとvtからネットワークを作成</span></span>
<span id="cb160-744"><a href="#cb160-744" aria-hidden="true" tabindex="-1"></a><span class="in">nara_stations &lt;- graph_from_data_frame(d, vertices = vt, directed = FALSE)</span></span>
<span id="cb160-745"><a href="#cb160-745" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-746"><a href="#cb160-746" aria-hidden="true" tabindex="-1"></a><span class="in"># ネットワークの表示</span></span>
<span id="cb160-747"><a href="#cb160-747" aria-hidden="true" tabindex="-1"></a><span class="in">nara_stations</span></span>
<span id="cb160-748"><a href="#cb160-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-749"><a href="#cb160-749" aria-hidden="true" tabindex="-1"></a><span class="in"># ネットワークを図にする</span></span>
<span id="cb160-750"><a href="#cb160-750" aria-hidden="true" tabindex="-1"></a><span class="in">plot(</span></span>
<span id="cb160-751"><a href="#cb160-751" aria-hidden="true" tabindex="-1"></a><span class="in">  nara_stations, </span></span>
<span id="cb160-752"><a href="#cb160-752" aria-hidden="true" tabindex="-1"></a><span class="in">  curved = TRUE, </span></span>
<span id="cb160-753"><a href="#cb160-753" aria-hidden="true" tabindex="-1"></a><span class="in">  layout = cbind(V(nara_stations)$lon, V(nara_stations)$lat), </span></span>
<span id="cb160-754"><a href="#cb160-754" aria-hidden="true" tabindex="-1"></a><span class="in">  vertex.label = NA, </span></span>
<span id="cb160-755"><a href="#cb160-755" aria-hidden="true" tabindex="-1"></a><span class="in">  vertex.size = 4)</span></span>
<span id="cb160-756"><a href="#cb160-756" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-757"><a href="#cb160-757" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-758"><a href="#cb160-758" aria-hidden="true" tabindex="-1"></a><span class="fu">#### vertex間の距離行列</span></span>
<span id="cb160-759"><a href="#cb160-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-760"><a href="#cb160-760" aria-hidden="true" tabindex="-1"></a>vertex間の距離は行列の形で、<span class="in">`distances`</span>関数を用いることで求めることができます。到達可能性が無いvertexとの間の距離は無限大（<span class="in">`Inf`</span>）となります。<span class="in">`distances`</span>関数には到着点（<span class="in">`to`</span>引数）を設定することができます。</span>
<span id="cb160-761"><a href="#cb160-761" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-762"><a href="#cb160-762" aria-hidden="true" tabindex="-1"></a>奈良の鉄道路線の例であれば、田原本線は独立線になっている（王寺-新王寺、西田原本-田原本間は路線としては接続しておらず、別の駅）ので、奈良へは到達不可能（<span class="in">`Inf`</span>）になっています。</span>
<span id="cb160-763"><a href="#cb160-763" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-764"><a href="#cb160-764" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="vertex間の距離を調べる"}</span></span>
<span id="cb160-765"><a href="#cb160-765" aria-hidden="true" tabindex="-1"></a><span class="in">distances(nara_stations)[1:5, 1:5]</span></span>
<span id="cb160-766"><a href="#cb160-766" aria-hidden="true" tabindex="-1"></a><span class="in">distances(nara_stations, to="奈良")[40:50,]</span></span>
<span id="cb160-767"><a href="#cb160-767" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-768"><a href="#cb160-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-769"><a href="#cb160-769" aria-hidden="true" tabindex="-1"></a><span class="fu">#### 最短距離の探索</span></span>
<span id="cb160-770"><a href="#cb160-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-771"><a href="#cb160-771" aria-hidden="true" tabindex="-1"></a>最短距離の探索には、<span class="in">`shortest_paths`</span>関数、<span class="in">`all_shortest_paths`</span>関数を用います。<span class="in">`shortest_paths`</span>関数は最短距離を1つだけ、<span class="in">`all_shortest_paths`</span>関数はすべての最短距離を返します。路線ではなかなか最短距離が複数存在する場合はありませんので、下の例では<span class="in">`all_shortest_paths`</span>は一つの経路を返しています。</span>
<span id="cb160-772"><a href="#cb160-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-773"><a href="#cb160-773" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="最短距離の探索"}</span></span>
<span id="cb160-774"><a href="#cb160-774" aria-hidden="true" tabindex="-1"></a><span class="in">shortest_paths(nara_stations, from = "奈良", to = "吉野口")</span></span>
<span id="cb160-775"><a href="#cb160-775" aria-hidden="true" tabindex="-1"></a><span class="in">all_shortest_paths(nara_stations, from = "桜井", to = "吉野口")</span></span>
<span id="cb160-776"><a href="#cb160-776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-777"><a href="#cb160-777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-778"><a href="#cb160-778" aria-hidden="true" tabindex="-1"></a>距離行列・最短距離の探索には、幅優先探索（breadth-first search）や深さ優先探索（depth-first search）などのアルゴリズムが用いられています。また、edgeの特性に<span class="in">`weight`</span>を設定していた場合には、<span class="in">`weight`</span>を考慮した評価を行うこともできます。</span>
<span id="cb160-779"><a href="#cb160-779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-780"><a href="#cb160-780" aria-hidden="true" tabindex="-1"></a><span class="fu">### その他の分析について</span></span>
<span id="cb160-781"><a href="#cb160-781" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-782"><a href="#cb160-782" aria-hidden="true" tabindex="-1"></a>ネットワーク解析には、上記に示した解析方法に加えて、ランダムなグラフの作成、グラフの類似性や検定を用いたネットワーク解析などがあります。</span>
<span id="cb160-783"><a href="#cb160-783" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-784"><a href="#cb160-784" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>ではランダムなグラフの作成には関数名が<span class="in">`sample_`</span>から始まる一連の関数が、一定の構造を持つグラフの作成には<span class="in">`make_ring`</span>や<span class="in">`make_star`</span>関数などの関数が備わっています。ランダムなグラフの作成では、それぞれの関数に設定されたアルゴリズムに従いネットワークが作成されます。また、<span class="in">`make_`</span>関数でのグラフ作成では、一定の構造を持つグラフが作成されるため、グラフ作成時の基礎構造を準備するのに便利です。</span>
<span id="cb160-785"><a href="#cb160-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-786"><a href="#cb160-786" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ランダム・一定の構造を持つグラフの作成"}</span></span>
<span id="cb160-787"><a href="#cb160-787" aria-hidden="true" tabindex="-1"></a><span class="in">g &lt;- sample_tree(n = 30) # ランダムな木構造型ネットワークを作成</span></span>
<span id="cb160-788"><a href="#cb160-788" aria-hidden="true" tabindex="-1"></a><span class="in">plot(g, layout=layout_as_tree(g))</span></span>
<span id="cb160-789"><a href="#cb160-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-790"><a href="#cb160-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-791"><a href="#cb160-791" aria-hidden="true" tabindex="-1"></a>とは言っても<span class="in">`igraph`</span>に登録されている<span class="in">`sample_`</span>関数だけでも10種以上あり、それぞれのアルゴリズムも複雑です。また、グラフの類似性や検定を用いたネットワーク解析に関しては<span class="in">`igraph`</span>のみでは対応できず、別のライブラリ（<span class="in">`statnet`</span>、<span class="in">`sna`</span>）が必要となります。上記のネットワーク解析に関しても詳細な説明は加えていませんので、詳細を理解したい方は教科書（<span class="co">[</span><span class="ot">Rで学ぶデータサイエンス ネットワーク分析</span><span class="co">](https://www.amazon.co.jp/%E3%83%8D%E3%83%83%E3%83%88%E3%83%AF%E3%83%BC%E3%82%AF%E5%88%86%E6%9E%90-%E7%AC%AC2%E7%89%88-R%E3%81%A7%E5%AD%A6%E3%81%B6%E3%83%87%E3%83%BC%E3%82%BF%E3%82%B5%E3%82%A4%E3%82%A8%E3%83%B3%E3%82%B9-%E9%88%B4%E6%9C%A8-%E5%8A%AA/dp/4320113152)</span>）を一読されることをおすすめいたします。</span>
<span id="cb160-792"><a href="#cb160-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-793"><a href="#cb160-793" aria-hidden="true" tabindex="-1"></a>以下に<span class="in">`sample_`</span>と<span class="in">`make_`</span>関数の一覧を示します。</span>
<span id="cb160-794"><a href="#cb160-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-795"><a href="#cb160-795" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-796"><a href="#cb160-796" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-797"><a href="#cb160-797" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_bipartite</span></span>
<span id="cb160-798"><a href="#cb160-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-801"><a href="#cb160-801" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-802"><a href="#cb160-802" aria-hidden="true" tabindex="-1"></a><span class="co"># ランダムな2部グラフを作成する</span></span>
<span id="cb160-803"><a href="#cb160-803" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_bipartite</span>(<span class="dv">10</span>, <span class="dv">10</span>, <span class="at">p =</span> <span class="fl">0.3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="at">layout =</span> layout_as_bipartite) <span class="co"># pはedgeの頻度</span></span>
<span id="cb160-804"><a href="#cb160-804" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-805"><a href="#cb160-805" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-806"><a href="#cb160-806" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_gnp</span></span>
<span id="cb160-807"><a href="#cb160-807" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-810"><a href="#cb160-810" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-811"><a href="#cb160-811" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">sample_gnp</span>(<span class="dv">20</span>, <span class="at">p =</span> <span class="fl">0.3</span>) <span class="co"># Erdos-Renyi modelに従い作成（20はvertex数、pはedgeの頻度）</span></span>
<span id="cb160-812"><a href="#cb160-812" aria-hidden="true" tabindex="-1"></a>gr <span class="sc">|&gt;</span> <span class="fu">plot</span>() </span>
<span id="cb160-813"><a href="#cb160-813" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-814"><a href="#cb160-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-815"><a href="#cb160-815" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_correlated_gnp</span></span>
<span id="cb160-816"><a href="#cb160-816" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-819"><a href="#cb160-819" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-820"><a href="#cb160-820" aria-hidden="true" tabindex="-1"></a>gr <span class="sc">|&gt;</span>  <span class="fu">sample_correlated_gnp</span>(<span class="at">corr =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># edgeをランダムに付け加え・取り除く</span></span>
<span id="cb160-821"><a href="#cb160-821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-822"><a href="#cb160-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-823"><a href="#cb160-823" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_degseq</span></span>
<span id="cb160-824"><a href="#cb160-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-827"><a href="#cb160-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-828"><a href="#cb160-828" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_degseq</span>(<span class="fu">rep</span>(<span class="dv">4</span>, <span class="dv">10</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># nodeのdegree（次数、この例では4）を指定したグラフ</span></span>
<span id="cb160-829"><a href="#cb160-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-830"><a href="#cb160-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-831"><a href="#cb160-831" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_dot_product</span></span>
<span id="cb160-832"><a href="#cb160-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-835"><a href="#cb160-835" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-836"><a href="#cb160-836" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">90</span>, <span class="dv">0</span>, <span class="fl">0.5</span>), <span class="at">nrow =</span> <span class="dv">9</span>) <span class="co"># matrixを引数に取る</span></span>
<span id="cb160-837"><a href="#cb160-837" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_dot_product</span>(ma) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># 各列がvertexになる</span></span>
<span id="cb160-838"><a href="#cb160-838" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-839"><a href="#cb160-839" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-840"><a href="#cb160-840" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_fitness</span></span>
<span id="cb160-841"><a href="#cb160-841" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-844"><a href="#cb160-844" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-845"><a href="#cb160-845" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_fitness</span>(<span class="dv">10</span>, <span class="fu">runif</span>(<span class="dv">10</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-846"><a href="#cb160-846" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-847"><a href="#cb160-847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-848"><a href="#cb160-848" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_fitness_pl</span></span>
<span id="cb160-849"><a href="#cb160-849" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-852"><a href="#cb160-852" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-853"><a href="#cb160-853" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_fitness_pl</span>(<span class="dv">10</span>, <span class="dv">15</span>, <span class="at">exponent.out =</span> <span class="fl">2.5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、edgeの数、degreeの分布を指定する引数</span></span>
<span id="cb160-854"><a href="#cb160-854" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-855"><a href="#cb160-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-856"><a href="#cb160-856" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_gnm</span></span>
<span id="cb160-857"><a href="#cb160-857" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-860"><a href="#cb160-860" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-861"><a href="#cb160-861" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_gnm</span>(<span class="dv">10</span>, <span class="dv">15</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、nodeの数を指定</span></span>
<span id="cb160-862"><a href="#cb160-862" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-863"><a href="#cb160-863" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-864"><a href="#cb160-864" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_grg</span></span>
<span id="cb160-865"><a href="#cb160-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-868"><a href="#cb160-868" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-869"><a href="#cb160-869" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_grg</span>(<span class="dv">10</span>, <span class="fl">0.85</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、radiusを指定</span></span>
<span id="cb160-870"><a href="#cb160-870" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-871"><a href="#cb160-871" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-872"><a href="#cb160-872" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_growing</span></span>
<span id="cb160-873"><a href="#cb160-873" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-876"><a href="#cb160-876" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-877"><a href="#cb160-877" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_growing</span>(<span class="dv">10</span>, <span class="at">m =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># vertexの数、ランダムに追加するedgeの数</span></span>
<span id="cb160-878"><a href="#cb160-878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-879"><a href="#cb160-879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-880"><a href="#cb160-880" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_islands</span></span>
<span id="cb160-881"><a href="#cb160-881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-884"><a href="#cb160-884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-885"><a href="#cb160-885" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_islands</span>(<span class="dv">5</span>, <span class="dv">3</span>, <span class="fl">0.3</span>, <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>() <span class="co"># gnpでのvertex3つのグラフを5つつないだもの</span></span>
<span id="cb160-886"><a href="#cb160-886" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-887"><a href="#cb160-887" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-888"><a href="#cb160-888" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_k_regular</span></span>
<span id="cb160-889"><a href="#cb160-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-892"><a href="#cb160-892" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-893"><a href="#cb160-893" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_k_regular</span>(<span class="dv">10</span>, <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-894"><a href="#cb160-894" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-895"><a href="#cb160-895" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-896"><a href="#cb160-896" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_last_cit</span></span>
<span id="cb160-897"><a href="#cb160-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-900"><a href="#cb160-900" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-901"><a href="#cb160-901" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_last_cit</span>(<span class="dv">10</span>, <span class="at">agebins =</span> <span class="dv">5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-902"><a href="#cb160-902" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-903"><a href="#cb160-903" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-904"><a href="#cb160-904" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_pa</span></span>
<span id="cb160-905"><a href="#cb160-905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-908"><a href="#cb160-908" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-909"><a href="#cb160-909" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_pa</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-910"><a href="#cb160-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-911"><a href="#cb160-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-912"><a href="#cb160-912" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_pa_age</span></span>
<span id="cb160-913"><a href="#cb160-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-916"><a href="#cb160-916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-917"><a href="#cb160-917" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_pa_age</span>(<span class="dv">10</span>, <span class="dv">3</span>, <span class="sc">-</span><span class="fl">0.5</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-918"><a href="#cb160-918" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-919"><a href="#cb160-919" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-920"><a href="#cb160-920" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_pref</span></span>
<span id="cb160-921"><a href="#cb160-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-924"><a href="#cb160-924" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-925"><a href="#cb160-925" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_pref</span>(<span class="dv">30</span>, <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-926"><a href="#cb160-926" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-927"><a href="#cb160-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-928"><a href="#cb160-928" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_sbm</span></span>
<span id="cb160-929"><a href="#cb160-929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-932"><a href="#cb160-932" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-933"><a href="#cb160-933" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_sbm</span>(<span class="dv">10</span>, <span class="at">pref.matrix =</span> <span class="fu">matrix</span>(<span class="fu">runif</span>(<span class="dv">9</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>), <span class="at">nrow=</span><span class="dv">3</span>), <span class="at">block.sizes =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">4</span>), <span class="at">directed =</span> <span class="cn">TRUE</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-934"><a href="#cb160-934" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-935"><a href="#cb160-935" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-936"><a href="#cb160-936" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_smallworld</span></span>
<span id="cb160-937"><a href="#cb160-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-940"><a href="#cb160-940" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-941"><a href="#cb160-941" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_smallworld</span>(<span class="at">dim =</span> <span class="dv">2</span>, <span class="at">size =</span> <span class="dv">5</span>, <span class="at">nei =</span> <span class="dv">1</span>, <span class="at">p =</span> <span class="fl">0.2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-942"><a href="#cb160-942" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-943"><a href="#cb160-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-944"><a href="#cb160-944" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_traits_callaway</span></span>
<span id="cb160-945"><a href="#cb160-945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-948"><a href="#cb160-948" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-949"><a href="#cb160-949" aria-hidden="true" tabindex="-1"></a><span class="fu">sample_traits_callaway</span>(<span class="dv">10</span>, <span class="at">types =</span> <span class="dv">3</span>, <span class="at">edge.per.step =</span> <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-950"><a href="#cb160-950" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-951"><a href="#cb160-951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-952"><a href="#cb160-952" aria-hidden="true" tabindex="-1"></a><span class="fu">## sample_tree</span></span>
<span id="cb160-953"><a href="#cb160-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-956"><a href="#cb160-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-957"><a href="#cb160-957" aria-hidden="true" tabindex="-1"></a>g_tree <span class="ot">&lt;-</span> <span class="fu">sample_tree</span>(<span class="dv">20</span>)</span>
<span id="cb160-958"><a href="#cb160-958" aria-hidden="true" tabindex="-1"></a>g_tree <span class="sc">|&gt;</span> <span class="fu">plot</span>(<span class="at">layout =</span> <span class="fu">layout_as_tree</span>(g_tree))</span>
<span id="cb160-959"><a href="#cb160-959" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-960"><a href="#cb160-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-961"><a href="#cb160-961" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-962"><a href="#cb160-962" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-963"><a href="#cb160-963" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-964"><a href="#cb160-964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-965"><a href="#cb160-965" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_star</span></span>
<span id="cb160-966"><a href="#cb160-966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-969"><a href="#cb160-969" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-970"><a href="#cb160-970" aria-hidden="true" tabindex="-1"></a><span class="fu">make_star</span>(<span class="at">n =</span> <span class="dv">10</span>, <span class="at">mode =</span> <span class="st">"undirected"</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-971"><a href="#cb160-971" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-972"><a href="#cb160-972" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-973"><a href="#cb160-973" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_ring</span></span>
<span id="cb160-974"><a href="#cb160-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-977"><a href="#cb160-977" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-978"><a href="#cb160-978" aria-hidden="true" tabindex="-1"></a><span class="fu">make_ring</span>(<span class="at">n =</span> <span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-979"><a href="#cb160-979" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-980"><a href="#cb160-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-981"><a href="#cb160-981" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_chordal_ring</span></span>
<span id="cb160-982"><a href="#cb160-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-985"><a href="#cb160-985" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-986"><a href="#cb160-986" aria-hidden="true" tabindex="-1"></a><span class="fu">make_chordal_ring</span>(<span class="dv">12</span>, <span class="at">w =</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">8</span>, <span class="dv">10</span>, <span class="dv">12</span>), <span class="at">nrow =</span> <span class="dv">2</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-987"><a href="#cb160-987" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-988"><a href="#cb160-988" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-989"><a href="#cb160-989" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_empty_graph</span></span>
<span id="cb160-990"><a href="#cb160-990" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-993"><a href="#cb160-993" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-994"><a href="#cb160-994" aria-hidden="true" tabindex="-1"></a><span class="fu">make_empty_graph</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-995"><a href="#cb160-995" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-996"><a href="#cb160-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-997"><a href="#cb160-997" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_full_graph</span></span>
<span id="cb160-998"><a href="#cb160-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1001"><a href="#cb160-1001" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1002"><a href="#cb160-1002" aria-hidden="true" tabindex="-1"></a><span class="fu">make_full_graph</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1003"><a href="#cb160-1003" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1004"><a href="#cb160-1004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1005"><a href="#cb160-1005" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_lattice</span></span>
<span id="cb160-1006"><a href="#cb160-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1009"><a href="#cb160-1009" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1010"><a href="#cb160-1010" aria-hidden="true" tabindex="-1"></a><span class="fu">make_lattice</span>(<span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>)) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1011"><a href="#cb160-1011" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1012"><a href="#cb160-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1013"><a href="#cb160-1013" aria-hidden="true" tabindex="-1"></a><span class="fu">## make_tree</span></span>
<span id="cb160-1014"><a href="#cb160-1014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1017"><a href="#cb160-1017" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1018"><a href="#cb160-1018" aria-hidden="true" tabindex="-1"></a><span class="fu">make_tree</span>(<span class="dv">16</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1019"><a href="#cb160-1019" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1020"><a href="#cb160-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1021"><a href="#cb160-1021" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-1022"><a href="#cb160-1022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1023"><a href="#cb160-1023" aria-hidden="true" tabindex="-1"></a><span class="fu">### 2部グラフ</span></span>
<span id="cb160-1024"><a href="#cb160-1024" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1025"><a href="#cb160-1025" aria-hidden="true" tabindex="-1"></a>**2部グラフ（Bipartite graph）**とは、vertexが2つのタイプからなるグラフのことです。この2つのタイプとは、例えば人物と所属するクラブのような、互いに関係性はあるけれども同じタイプ同士のvertex間のつながりは無視できるようなものになります。</span>
<span id="cb160-1026"><a href="#cb160-1026" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1027"><a href="#cb160-1027" aria-hidden="true" tabindex="-1"></a>以下に2部グラフの例を示します。2部グラフを作成する場合、専用の関数（<span class="in">`make_bipartite_graph`</span>）がありますが、この関数を用いるよりはedge listや<span class="in">`data.frame`</span>からグラフを作成した後、vertexの<span class="in">`type`</span>という<span class="in">`attribute`</span>に論理型で2部のどちらであるか（上の例では人物を<span class="in">`TRUE`</span>、所属するクラブを<span class="in">`FALSE`</span>で指定）を指定する方が作成しやすいと思います。</span>
<span id="cb160-1028"><a href="#cb160-1028" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1029"><a href="#cb160-1029" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="2部グラフ"}</span></span>
<span id="cb160-1030"><a href="#cb160-1030" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(0)</span></span>
<span id="cb160-1031"><a href="#cb160-1031" aria-hidden="true" tabindex="-1"></a><span class="in"># edgeを示したデータフレームを作成する</span></span>
<span id="cb160-1032"><a href="#cb160-1032" aria-hidden="true" tabindex="-1"></a><span class="in">d_edge &lt;- data.frame(</span></span>
<span id="cb160-1033"><a href="#cb160-1033" aria-hidden="true" tabindex="-1"></a><span class="in">  club = sample(c("野球", "サッカー", "バスケットボール", "バレーボール"), 52, replace = TRUE),</span></span>
<span id="cb160-1034"><a href="#cb160-1034" aria-hidden="true" tabindex="-1"></a><span class="in">  person = c(LETTERS, LETTERS)</span></span>
<span id="cb160-1035"><a href="#cb160-1035" aria-hidden="true" tabindex="-1"></a><span class="in">) |&gt; distinct()</span></span>
<span id="cb160-1036"><a href="#cb160-1036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1037"><a href="#cb160-1037" aria-hidden="true" tabindex="-1"></a><span class="in"># データフレームから2部グラフを作成する</span></span>
<span id="cb160-1038"><a href="#cb160-1038" aria-hidden="true" tabindex="-1"></a><span class="in">g &lt;- graph_from_data_frame(d_edge, directed = F)</span></span>
<span id="cb160-1039"><a href="#cb160-1039" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1040"><a href="#cb160-1040" aria-hidden="true" tabindex="-1"></a><span class="in"># typeのattributeを追加する（TRUE、FALSEで2部のどちらであるかを指定する）</span></span>
<span id="cb160-1041"><a href="#cb160-1041" aria-hidden="true" tabindex="-1"></a><span class="in">V(g)$type &lt;- V(g)$name %in% d_edge[,2]</span></span>
<span id="cb160-1042"><a href="#cb160-1042" aria-hidden="true" tabindex="-1"></a><span class="in">V(g)$type</span></span>
<span id="cb160-1043"><a href="#cb160-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1044"><a href="#cb160-1044" aria-hidden="true" tabindex="-1"></a><span class="in"># 2部グラフ（UN-B、BがBipartiteの意味）になっている</span></span>
<span id="cb160-1045"><a href="#cb160-1045" aria-hidden="true" tabindex="-1"></a><span class="in">g</span></span>
<span id="cb160-1046"><a href="#cb160-1046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1047"><a href="#cb160-1047" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; plot(layout = layout_as_bipartite, vertex.color = c("orange", "lightblue")[V(g)$type + 1], vertex.shape = c("square", "circle")[V(g)$type + 1])</span></span>
<span id="cb160-1048"><a href="#cb160-1048" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1049"><a href="#cb160-1049" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1050"><a href="#cb160-1050" aria-hidden="true" tabindex="-1"></a><span class="fu">## tidygraph</span></span>
<span id="cb160-1051"><a href="#cb160-1051" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1052"><a href="#cb160-1052" aria-hidden="true" tabindex="-1"></a>ここまで説明してきた<span class="in">`igraph`</span>は非常に多機能でよくできたパッケージではありますが、関数名や引数名があまり一定ではなく、使用する際に関数名や引数名をチェックしないとうまく使うことができません。引数の指定方法も多岐に渡っており、統一した手法でグラフを取り扱うことができず、使いにくさがあります。</span>
<span id="cb160-1053"><a href="#cb160-1053" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1054"><a href="#cb160-1054" aria-hidden="true" tabindex="-1"></a>このような問題を解決するためのライブラリが<span class="in">`tidygraph`</span>パッケージです。<span class="in">`tidygraph`</span>パッケージは基本的に<span class="in">`tibble`</span>を用いてグラフを作成し、<span class="in">`tidyverse`</span>（特に<span class="in">`dplyr`</span>）とパイプ演算子を用いてグラフを編集することを目的として構成されています。</span>
<span id="cb160-1055"><a href="#cb160-1055" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1056"><a href="#cb160-1056" aria-hidden="true" tabindex="-1"></a>とは言え、<span class="in">`igraph`</span>が非常に機能豊富なパッケージであったのと同様に、<span class="in">`tidygraph`</span>も機能豊富で、利用の難易度は高めです。また、解説文等が少ないため、使い方を理解するのが難しい関数もあります。<span class="in">`dplyr::mutate`</span>関数内以外では使えない関数がたくさんあるなど、使い方もやや複雑です。</span>
<span id="cb160-1057"><a href="#cb160-1057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1058"><a href="#cb160-1058" aria-hidden="true" tabindex="-1"></a><span class="fu">### tidygraphの基礎とグラフの作成</span></span>
<span id="cb160-1059"><a href="#cb160-1059" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1060"><a href="#cb160-1060" aria-hidden="true" tabindex="-1"></a><span class="in">`tidygraph`</span>ではグラフはnodeとedgeで表されます。<span class="in">`igraph`</span>とは異なり、nodeがvertexと呼ばれることはありません。</span>
<span id="cb160-1061"><a href="#cb160-1061" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1062"><a href="#cb160-1062" aria-hidden="true" tabindex="-1"></a><span class="in">`tidygraph`</span>では、<span class="in">`igraph`</span>と同じく、データフレームからグラフを作成します。また、<span class="in">`igraph`</span>で作成したグラフオブジェクトやedge vector、adjacency matrixからもグラフを作成することができます。データフレームからグラフを作成する場合には<span class="in">`tbl_graph`</span>関数、その他のオブジェクトや<span class="in">`igraph`</span>のグラフから<span class="in">`tidygraph`</span>のグラフを作成する場合には<span class="in">`as_tbl_graph`</span>関数を用います。</span>
<span id="cb160-1063"><a href="#cb160-1063" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1064"><a href="#cb160-1064" aria-hidden="true" tabindex="-1"></a>作成したグラフのクラスは<span class="in">`igraph`</span>と<span class="in">`tbl_graph`</span>となっており、表示するとnodeとedgeのデータフレームが示されます。<span class="in">`igraph`</span>ではvertexに指定するデータフレームの2列目以降、edgeに指定するデータフレームの3列目以降はattributeとして登録されますが、<span class="in">`tbl_graph`</span>ではnodeとedgeのtibbleとして表示されます。<span class="in">`tbl_graph`</span>は<span class="in">`igraph`</span>のオブジェクトでもあるので、<span class="in">`igraph`</span>と同じように<span class="in">`attributes`</span>としてtibbleの列を呼び出すこともできます。</span>
<span id="cb160-1065"><a href="#cb160-1065" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1066"><a href="#cb160-1066" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="tbl_graphを作成する"}</span></span>
<span id="cb160-1067"><a href="#cb160-1067" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidygraph)</span></span>
<span id="cb160-1068"><a href="#cb160-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1069"><a href="#cb160-1069" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- read.csv("./data/chapter33_nara_stations.csv") # edgeのデータフレーム</span></span>
<span id="cb160-1070"><a href="#cb160-1070" aria-hidden="true" tabindex="-1"></a><span class="in">vt &lt;- read.csv("./data/chapter33_nara_stations_vertex_list.csv") # nodeのデータフレーム</span></span>
<span id="cb160-1071"><a href="#cb160-1071" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1072"><a href="#cb160-1072" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(vt) &lt;- c("name", "lat", "lon", "linename", "company") # vertex名はname列から取り込まれる</span></span>
<span id="cb160-1073"><a href="#cb160-1073" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(d) &lt;- c("from", "to", "linename", "company") # edgeはfrom→toになる</span></span>
<span id="cb160-1074"><a href="#cb160-1074" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1075"><a href="#cb160-1075" aria-hidden="true" tabindex="-1"></a><span class="in"># tbl_graphをデータフレームから作成する</span></span>
<span id="cb160-1076"><a href="#cb160-1076" aria-hidden="true" tabindex="-1"></a><span class="in">g &lt;- tbl_graph(nodes = vt, edges = d, directed = FALSE) </span></span>
<span id="cb160-1077"><a href="#cb160-1077" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1078"><a href="#cb160-1078" aria-hidden="true" tabindex="-1"></a><span class="in"># igraphオブジェクトをtbl_graphに変換する</span></span>
<span id="cb160-1079"><a href="#cb160-1079" aria-hidden="true" tabindex="-1"></a><span class="in">as_tbl_graph(karate)</span></span>
<span id="cb160-1080"><a href="#cb160-1080" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1081"><a href="#cb160-1081" aria-hidden="true" tabindex="-1"></a><span class="in">class(g) # クラスはtbl_graph</span></span>
<span id="cb160-1082"><a href="#cb160-1082" aria-hidden="true" tabindex="-1"></a><span class="in">V(g)$lat # igraphとして取り扱い、attributeとして2列目以降を呼び出すこともできる</span></span>
<span id="cb160-1083"><a href="#cb160-1083" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1084"><a href="#cb160-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1085"><a href="#cb160-1085" aria-hidden="true" tabindex="-1"></a><span class="fu">### node/edgeをactivateする</span></span>
<span id="cb160-1086"><a href="#cb160-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1087"><a href="#cb160-1087" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>ではnode（vertex）やedgeを呼び出す場合、<span class="in">`V`</span>関数と<span class="in">`E`</span>関数を用いますが、<span class="in">`tidygraph`</span>ではnode・edgeの呼び出しに<span class="in">`activate`</span>関数を用います。<span class="in">`activate`</span>関数はパイプ演算子を用いて呼び出すことが想定されている関数で、パイプ演算子でつないでグラフに適用します。第2引数として<span class="in">`nodes`</span>と<span class="in">`edges`</span>を用います。<span class="in">`activate`</span>関数をグラフに適用すると、<span class="in">`node`</span>・<span class="in">`edge`</span>のtibbleに「activate」と表示されます。この状態でさらにパイプ演算子をつなぐと、activateされている側のtibbleを編集することができます。</span>
<span id="cb160-1088"><a href="#cb160-1088" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1089"><a href="#cb160-1089" aria-hidden="true" tabindex="-1"></a>node・edgeのどちらがactiveであるかを調べる場合には、<span class="in">`active`</span>関数を用います。</span>
<span id="cb160-1090"><a href="#cb160-1090" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1091"><a href="#cb160-1091" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="activate関数"}</span></span>
<span id="cb160-1092"><a href="#cb160-1092" aria-hidden="true" tabindex="-1"></a><span class="in"># node・edgeをactivateする</span></span>
<span id="cb160-1093"><a href="#cb160-1093" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; active() # nodeがactiveになっている</span></span>
<span id="cb160-1094"><a href="#cb160-1094" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; activate(edges) # edgeをactiveにする（nodeはactiveではなくなる）</span></span>
<span id="cb160-1095"><a href="#cb160-1095" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; activate(edges) |&gt; active() # edgeがactiveになっている</span></span>
<span id="cb160-1096"><a href="#cb160-1096" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1097"><a href="#cb160-1097" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1098"><a href="#cb160-1098" aria-hidden="true" tabindex="-1"></a><span class="fu">### focus</span></span>
<span id="cb160-1099"><a href="#cb160-1099" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1100"><a href="#cb160-1100" aria-hidden="true" tabindex="-1"></a><span class="in">`tidygraph`</span>では、基本的に<span class="in">`activate`</span>でnode・edgeのいずれかを選択した後、<span class="in">`mutate`</span>など<span class="in">`dplyr`</span>の関数を用いてグラフの要素であるtibbleを編集していきます。</span>
<span id="cb160-1101"><a href="#cb160-1101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1102"><a href="#cb160-1102" aria-hidden="true" tabindex="-1"></a><span class="in">`mutate`</span>などで編集を行うために、行を選択するための関数が<span class="in">`focus`</span>です。<span class="in">`focus`</span>関数の引数には論理型を用い、<span class="in">`TRUE`</span>の行のみを<span class="in">`dplyr`</span>の関数での編集の対象とすることができます。以下の例では、nodeのはじめの5行を選択し、その行だけを<span class="in">`mutate`</span>での演算の対象としています。</span>
<span id="cb160-1103"><a href="#cb160-1103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1104"><a href="#cb160-1104" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="focusで行を選択して編集する"}</span></span>
<span id="cb160-1105"><a href="#cb160-1105" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1106"><a href="#cb160-1106" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(nodes) |&gt; </span></span>
<span id="cb160-1107"><a href="#cb160-1107" aria-hidden="true" tabindex="-1"></a><span class="in">  focus(c(T, T, T, T, T, rep(F, 114))) |&gt; # 始めの5つのnodeにfocusする</span></span>
<span id="cb160-1108"><a href="#cb160-1108" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(lat = lat - 50) # 初めの5つのnodeのlatから50を引く</span></span>
<span id="cb160-1109"><a href="#cb160-1109" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1110"><a href="#cb160-1110" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1111"><a href="#cb160-1111" aria-hidden="true" tabindex="-1"></a><span class="fu">### morph・unmorphとcrystalise</span></span>
<span id="cb160-1112"><a href="#cb160-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1113"><a href="#cb160-1113" aria-hidden="true" tabindex="-1"></a>上記の<span class="in">`igraph`</span>で説明したクラスター計算では、nodeを各クラスターに分離することができます。ただし、分離したクラスターごとに何らかの演算をしたい場合や、nodeのグループごとに演算を行いたい場合、<span class="in">`igraph`</span>には簡単に計算する方法はありません。<span class="in">`tidygraph`</span>では、このようなグループごとの演算を<span class="in">`morph`</span>関数を用いて簡単に行うことができます。</span>
<span id="cb160-1114"><a href="#cb160-1114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1115"><a href="#cb160-1115" aria-hidden="true" tabindex="-1"></a><span class="in">`morph`</span>関数はnode・edgeのtibbleを一時的に変換するための関数です。<span class="in">`tidygraph`</span>の開発者（Dr. </span>
<span id="cb160-1116"><a href="#cb160-1116" aria-hidden="true" tabindex="-1"></a>Thomas Lin Pedersen、<span class="in">`patchwork`</span>や<span class="in">`gganimate`</span>の開発者）は、この<span class="in">`morph`</span>/<span class="in">`unmorph`</span>/<span class="in">`crystalise`</span>を<span class="co">[</span><span class="ot">`tidygraph`の最も代表的な関数の一つ</span><span class="co">](https://www.data-imaginist.com/posts/2018-02-12-tidygraph-1-1-a-tidy-hope/index.html)</span>だと考えているようで、使い方を理解すれば非常に便利な関数群です。</span>
<span id="cb160-1117"><a href="#cb160-1117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1118"><a href="#cb160-1118" aria-hidden="true" tabindex="-1"></a>以下の例では<span class="in">`group_infomap`</span>関数（<span class="in">`igraph`</span>の<span class="in">`cluster_infomap`</span>関数のwrapper）でnodeをクラスター分けし、<span class="in">`morph`</span>関数内ではそのクラスター（<span class="in">`group`</span>）に従い<span class="in">`to_split`</span>関数でtibbleを一時的に<span class="in">`nest`</span>しています（<span class="in">`tidyr::nest`</span>に関しては<span class="co">[</span><span class="ot">16章</span><span class="co">](./chapter16.html)</span>を参照。複数の要素をtibbleの「セル」として設定する方法のこと）。</span>
<span id="cb160-1119"><a href="#cb160-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1120"><a href="#cb160-1120" aria-hidden="true" tabindex="-1"></a><span class="in">`nest`</span>したtibbleに対して<span class="in">`graph_diameter`</span>関数（<span class="in">`igraph`</span>の<span class="in">`diameter`</span>関数のwrapper）と<span class="in">`centrality_degree`</span>関数（<span class="in">`igraph`</span>の<span class="in">`degree`</span>関数のwrapper）を適用することで、クラスターごとのネットワークの直径、nodeの中心性を演算して行に追加しています。ただし、このままではtibbleが<span class="in">`nest`</span>されたままです。</span>
<span id="cb160-1121"><a href="#cb160-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1122"><a href="#cb160-1122" aria-hidden="true" tabindex="-1"></a>この<span class="in">`nest`</span>されたtibbleをもとに戻すのが<span class="in">`unmorph`</span>関数です。<span class="in">`unmorph`</span>関数を適用することで、nodeのtibbleの<span class="in">`nest`</span>が解除される、つまり<span class="in">`unnest`</span>されて元のグラフに戻ります。</span>
<span id="cb160-1123"><a href="#cb160-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1124"><a href="#cb160-1124" aria-hidden="true" tabindex="-1"></a>このように、<span class="in">`morph`</span>/<span class="in">`unmorph`</span>を用いることで、node・edgeのグループごとの演算を簡単に行うことができます。<span class="in">`morph`</span>でのグループ分けのための関数には<span class="in">`to_subgraph`</span>関数（<span class="in">`dplyr::filter`</span>に近い演算を行うもの）や<span class="in">`to_components`</span>関数などが準備されています。</span>
<span id="cb160-1125"><a href="#cb160-1125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1126"><a href="#cb160-1126" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="morph・unmorph関数"}</span></span>
<span id="cb160-1127"><a href="#cb160-1127" aria-hidden="true" tabindex="-1"></a><span class="in"># サブグループ内での演算を行うときにはmorph/unmorphを用いる</span></span>
<span id="cb160-1128"><a href="#cb160-1128" aria-hidden="true" tabindex="-1"></a><span class="in"># morph内の関数はto_から始まる関数群を用いる</span></span>
<span id="cb160-1129"><a href="#cb160-1129" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1130"><a href="#cb160-1130" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(nodes) |&gt; # nodeをactiveにして</span></span>
<span id="cb160-1131"><a href="#cb160-1131" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(group = group_infomap()) |&gt; # クラスターに分けて</span></span>
<span id="cb160-1132"><a href="#cb160-1132" aria-hidden="true" tabindex="-1"></a><span class="in">  morph(to_split, group) |&gt; # グループで一時的に分割・ネストして</span></span>
<span id="cb160-1133"><a href="#cb160-1133" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb160-1134"><a href="#cb160-1134" aria-hidden="true" tabindex="-1"></a><span class="in">    group_diameter = graph_diameter(), </span></span>
<span id="cb160-1135"><a href="#cb160-1135" aria-hidden="true" tabindex="-1"></a><span class="in">    centrality = centrality_degree()) |&gt; # グループごとに直径を計算して</span></span>
<span id="cb160-1136"><a href="#cb160-1136" aria-hidden="true" tabindex="-1"></a><span class="in">  unmorph() # morphをもとに戻す</span></span>
<span id="cb160-1137"><a href="#cb160-1137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1138"><a href="#cb160-1138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1139"><a href="#cb160-1139" aria-hidden="true" tabindex="-1"></a><span class="in">`morph`</span>で変形したグラフをそのまま固定するための関数が<span class="in">`crystallise`</span>関数です。<span class="in">`crystallise`</span>関数を用いると、<span class="in">`morph`</span>で指定した変形の状態などが固定され、tibbleとしてデータが返ってきます。</span>
<span id="cb160-1140"><a href="#cb160-1140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1141"><a href="#cb160-1141" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="crystallise関数"}</span></span>
<span id="cb160-1142"><a href="#cb160-1142" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1143"><a href="#cb160-1143" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(group = group_infomap()) |&gt; # クラスターに分けて</span></span>
<span id="cb160-1144"><a href="#cb160-1144" aria-hidden="true" tabindex="-1"></a><span class="in">  morph(to_split, group) |&gt; # グループで一時的に分割して</span></span>
<span id="cb160-1145"><a href="#cb160-1145" aria-hidden="true" tabindex="-1"></a><span class="in">  crystallise() # crystalliseして固定してしまう</span></span>
<span id="cb160-1146"><a href="#cb160-1146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1147"><a href="#cb160-1147" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1148"><a href="#cb160-1148" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(group = group_infomap()) |&gt; </span></span>
<span id="cb160-1149"><a href="#cb160-1149" aria-hidden="true" tabindex="-1"></a><span class="in">  morph(to_split, group) |&gt; </span></span>
<span id="cb160-1150"><a href="#cb160-1150" aria-hidden="true" tabindex="-1"></a><span class="in">  crystallise() |&gt; </span></span>
<span id="cb160-1151"><a href="#cb160-1151" aria-hidden="true" tabindex="-1"></a><span class="in">  class() # classからgraph関係のものがなくなり、tibbleになっている</span></span>
<span id="cb160-1152"><a href="#cb160-1152" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1153"><a href="#cb160-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1154"><a href="#cb160-1154" aria-hidden="true" tabindex="-1"></a><span class="fu">### 中心性</span></span>
<span id="cb160-1155"><a href="#cb160-1155" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1156"><a href="#cb160-1156" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>と同様に、<span class="in">`tidygraph`</span>にも中心性を評価する関数群（<span class="in">`centrality_`</span>から始まる関数）が設定されています。<span class="in">`igraph`</span>との違いは、これらの<span class="in">`centrality_`</span>関数群は単独で呼び出すことができず、nodeをactiveにした上で<span class="in">`mutate`</span>関数の中で呼び出すような使い方をする点です。単独で使用するとエラーが返ってきます。</span>
<span id="cb160-1157"><a href="#cb160-1157" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1158"><a href="#cb160-1158" aria-hidden="true" tabindex="-1"></a><span class="in">`tidygraph`</span>にはこの<span class="in">`centrality_`</span>関数が30個以上も設定されています（<span class="in">`igraph`</span>の中心性演算の関数に加えて、<span class="in">`netrankr`</span><span class="co">[</span><span class="ot">@netrankr_bib</span><span class="co">]</span>パッケージから方法を引用しています）。</span>
<span id="cb160-1159"><a href="#cb160-1159" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1160"><a href="#cb160-1160" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="中心性：centrality_関数", error=TRUE}</span></span>
<span id="cb160-1161"><a href="#cb160-1161" aria-hidden="true" tabindex="-1"></a><span class="in">centrality_degree(g) # 直接呼び出せない</span></span>
<span id="cb160-1162"><a href="#cb160-1162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1163"><a href="#cb160-1163" aria-hidden="true" tabindex="-1"></a><span class="in"># nodeをactiveにしてからmutateで呼び出す</span></span>
<span id="cb160-1164"><a href="#cb160-1164" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1165"><a href="#cb160-1165" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(nodes) |&gt; </span></span>
<span id="cb160-1166"><a href="#cb160-1166" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(degree_cent = centrality_degree()) </span></span>
<span id="cb160-1167"><a href="#cb160-1167" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1168"><a href="#cb160-1168" aria-hidden="true" tabindex="-1"></a><span class="in"># 4種のcentralityを同時に演算する</span></span>
<span id="cb160-1169"><a href="#cb160-1169" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1170"><a href="#cb160-1170" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(nodes) |&gt; </span></span>
<span id="cb160-1171"><a href="#cb160-1171" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb160-1172"><a href="#cb160-1172" aria-hidden="true" tabindex="-1"></a><span class="in">    cent_degr = centrality_degree(),</span></span>
<span id="cb160-1173"><a href="#cb160-1173" aria-hidden="true" tabindex="-1"></a><span class="in">    cent_betw = centrality_betweenness(),</span></span>
<span id="cb160-1174"><a href="#cb160-1174" aria-hidden="true" tabindex="-1"></a><span class="in">    cent_clos = centrality_closeness(),</span></span>
<span id="cb160-1175"><a href="#cb160-1175" aria-hidden="true" tabindex="-1"></a><span class="in">    cent_eigv = centrality_eigen()) </span></span>
<span id="cb160-1176"><a href="#cb160-1176" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1177"><a href="#cb160-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1178"><a href="#cb160-1178" aria-hidden="true" tabindex="-1"></a><span class="fu">### node・edge・graphの評価</span></span>
<span id="cb160-1179"><a href="#cb160-1179" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1180"><a href="#cb160-1180" aria-hidden="true" tabindex="-1"></a><span class="in">`tidygraph`</span>には、<span class="in">`igraph`</span>と同様にnode、edge、graphを評価するための関数群が設定されています。いずれの関数も単独で呼び出すことはできず、<span class="in">`mutate`</span>関数内で呼び出して用いることが前提とされています。</span>
<span id="cb160-1181"><a href="#cb160-1181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1182"><a href="#cb160-1182" aria-hidden="true" tabindex="-1"></a>以下にnodeの評価に関わる関数を示します。上記の中心性もこのnodeの評価に関わる関数の一部となります。</span>
<span id="cb160-1183"><a href="#cb160-1183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1184"><a href="#cb160-1184" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE, filename="nodeの評価"}</span></span>
<span id="cb160-1185"><a href="#cb160-1185" aria-hidden="true" tabindex="-1"></a><span class="in"># 単独では呼び出せない</span></span>
<span id="cb160-1186"><a href="#cb160-1186" aria-hidden="true" tabindex="-1"></a><span class="in">node_efficiency(g)</span></span>
<span id="cb160-1187"><a href="#cb160-1187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1188"><a href="#cb160-1188" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1189"><a href="#cb160-1189" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(nodes) |&gt; </span></span>
<span id="cb160-1190"><a href="#cb160-1190" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb160-1191"><a href="#cb160-1191" aria-hidden="true" tabindex="-1"></a><span class="in">    node_eff = node_efficiency(), # nodeの効率（igraph::local_efficiency）</span></span>
<span id="cb160-1192"><a href="#cb160-1192" aria-hidden="true" tabindex="-1"></a><span class="in">    node_core = node_coreness(), # k-core分解（igraph::coreness）</span></span>
<span id="cb160-1193"><a href="#cb160-1193" aria-hidden="true" tabindex="-1"></a><span class="in">    node_clos = node_closeness_impact()) # nodeを取り除いたときのclosenessへの影響の大きさ</span></span>
<span id="cb160-1194"><a href="#cb160-1194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1195"><a href="#cb160-1195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1196"><a href="#cb160-1196" aria-hidden="true" tabindex="-1"></a>edgeの評価では、edgeの性質を論理型で返すような関数が主に設定されています。edgeの評価に関する関数はそもそも引数にedgeのtibbleを取るように設定されていません。nodeの場合と同じく、edgeの評価の関数も<span class="in">`mutate`</span>関数内で用いることが想定されています。</span>
<span id="cb160-1197"><a href="#cb160-1197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1198"><a href="#cb160-1198" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE, filename="edgeの評価"}</span></span>
<span id="cb160-1199"><a href="#cb160-1199" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1200"><a href="#cb160-1200" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(edges) |&gt; </span></span>
<span id="cb160-1201"><a href="#cb160-1201" aria-hidden="true" tabindex="-1"></a><span class="in">  edge_is_multiple() # そもそも引数として設定できない</span></span>
<span id="cb160-1202"><a href="#cb160-1202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1203"><a href="#cb160-1203" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1204"><a href="#cb160-1204" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(edges) |&gt; </span></span>
<span id="cb160-1205"><a href="#cb160-1205" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb160-1206"><a href="#cb160-1206" aria-hidden="true" tabindex="-1"></a><span class="in">    multiple = edge_is_multiple(), # 平行するedgeがあるか</span></span>
<span id="cb160-1207"><a href="#cb160-1207" aria-hidden="true" tabindex="-1"></a><span class="in">    bridge = edge_is_bridge() # edgeが切断されるとグラフが分離されるか</span></span>
<span id="cb160-1208"><a href="#cb160-1208" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb160-1209"><a href="#cb160-1209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1210"><a href="#cb160-1210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1211"><a href="#cb160-1211" aria-hidden="true" tabindex="-1"></a>graphの評価に関する関数は<span class="in">`igraph`</span>に設定されている関数群とほぼ同じですが、やはり直接呼び出して用いることはできません。評価の意味に関しては以下を参照して下さい。</span>
<span id="cb160-1212"><a href="#cb160-1212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1213"><a href="#cb160-1213" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">GeekforGeeksのネットワークに関するページ</span><span class="co">](https://www.geeksforgeeks.org/graph-measurements-length-distance-diameter-eccentricity-radius-center/?ref=lbp)</span></span>
<span id="cb160-1214"><a href="#cb160-1214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1215"><a href="#cb160-1215" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">グラフ理論講義ノート#8 井上純一先生（北海道大学 情報科学研究科）</span><span class="co">](chrome-extension://efaidnbmnnnibpcajpcglclefindmkaj/https://ocw.hokudai.ac.jp/wp-content/uploads/2016/01/GraphTheory-2007-Note-08.pdf)</span></span>
<span id="cb160-1216"><a href="#cb160-1216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1217"><a href="#cb160-1217" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, error=TRUE, filename="graphの評価"}</span></span>
<span id="cb160-1218"><a href="#cb160-1218" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; graph_diameter() # 直接呼び出せない</span></span>
<span id="cb160-1219"><a href="#cb160-1219" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1220"><a href="#cb160-1220" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1221"><a href="#cb160-1221" aria-hidden="true" tabindex="-1"></a><span class="in">  activate(nodes) |&gt; </span></span>
<span id="cb160-1222"><a href="#cb160-1222" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(</span></span>
<span id="cb160-1223"><a href="#cb160-1223" aria-hidden="true" tabindex="-1"></a><span class="in">    g_diameter = graph_diameter(), # グラフの直径（最大の経路長）</span></span>
<span id="cb160-1224"><a href="#cb160-1224" aria-hidden="true" tabindex="-1"></a><span class="in">    g_girth = graph_girth(), # グラフの内周（最小の閉路長）</span></span>
<span id="cb160-1225"><a href="#cb160-1225" aria-hidden="true" tabindex="-1"></a><span class="in">    g_radius = graph_radius(), # グラフの離心率（igraph::radius）</span></span>
<span id="cb160-1226"><a href="#cb160-1226" aria-hidden="true" tabindex="-1"></a><span class="in">    g_size = graph_size() # グラフのedgeの数</span></span>
<span id="cb160-1227"><a href="#cb160-1227" aria-hidden="true" tabindex="-1"></a><span class="in">  )</span></span>
<span id="cb160-1228"><a href="#cb160-1228" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1229"><a href="#cb160-1229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1230"><a href="#cb160-1230" aria-hidden="true" tabindex="-1"></a><span class="fu">### create_関数とplay_関数</span></span>
<span id="cb160-1231"><a href="#cb160-1231" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1232"><a href="#cb160-1232" aria-hidden="true" tabindex="-1"></a><span class="in">`igraph`</span>では<span class="in">`make_`</span>関数（<span class="in">`make_ring`</span>関数や<span class="in">`make_star`</span>関数など）で形状を指定したグラフを、<span class="in">`sample_`</span>関数（<span class="in">`sample_tree`</span>関数や<span class="in">`sample_gnp`</span>関数など）でアルゴリズムに従ったランダムなグラフを作成することができます。この<span class="in">`igraph`</span>の<span class="in">`make_`</span>関数と<span class="in">`sample_`</span>関数に当たるものが<span class="in">`tidygraph`</span>の<span class="in">`create_`</span>関数と<span class="in">`play_`</span>関数です。出力がtbl_graphであることと、引数の順序・名前以外に<span class="in">`igraph`</span>の関数群と大きな差は無いので、<span class="in">`igraph`</span>の関数に慣れているのであれば<span class="in">`igraph`</span>の関数を用いてグラフを作成した後で<span class="in">`as_tbl_graph`</span>関数を用いて<span class="in">`tbl_graph`</span>に変換してもよいでしょう。</span>
<span id="cb160-1233"><a href="#cb160-1233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1234"><a href="#cb160-1234" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-1235"><a href="#cb160-1235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1236"><a href="#cb160-1236" aria-hidden="true" tabindex="-1"></a><span class="fu">## create_ring</span></span>
<span id="cb160-1237"><a href="#cb160-1237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1240"><a href="#cb160-1240" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1241"><a href="#cb160-1241" aria-hidden="true" tabindex="-1"></a><span class="fu">create_ring</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1242"><a href="#cb160-1242" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1243"><a href="#cb160-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1244"><a href="#cb160-1244" aria-hidden="true" tabindex="-1"></a><span class="fu">## create_chordal_ring</span></span>
<span id="cb160-1245"><a href="#cb160-1245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1248"><a href="#cb160-1248" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1249"><a href="#cb160-1249" aria-hidden="true" tabindex="-1"></a><span class="fu">create_chordal_ring</span>(<span class="dv">10</span>, <span class="dv">2</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1250"><a href="#cb160-1250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1251"><a href="#cb160-1251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1252"><a href="#cb160-1252" aria-hidden="true" tabindex="-1"></a><span class="fu">## create_complete</span></span>
<span id="cb160-1253"><a href="#cb160-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1256"><a href="#cb160-1256" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1257"><a href="#cb160-1257" aria-hidden="true" tabindex="-1"></a><span class="fu">create_complete</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1258"><a href="#cb160-1258" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1259"><a href="#cb160-1259" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1260"><a href="#cb160-1260" aria-hidden="true" tabindex="-1"></a><span class="fu">## create_empty</span></span>
<span id="cb160-1261"><a href="#cb160-1261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1264"><a href="#cb160-1264" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1265"><a href="#cb160-1265" aria-hidden="true" tabindex="-1"></a><span class="fu">create_empty</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1266"><a href="#cb160-1266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1267"><a href="#cb160-1267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1268"><a href="#cb160-1268" aria-hidden="true" tabindex="-1"></a><span class="fu">## create_tree</span></span>
<span id="cb160-1269"><a href="#cb160-1269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1272"><a href="#cb160-1272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1273"><a href="#cb160-1273" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="dv">10</span>, <span class="dv">4</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1274"><a href="#cb160-1274" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1275"><a href="#cb160-1275" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1276"><a href="#cb160-1276" aria-hidden="true" tabindex="-1"></a><span class="fu">## create_star</span></span>
<span id="cb160-1277"><a href="#cb160-1277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1280"><a href="#cb160-1280" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1281"><a href="#cb160-1281" aria-hidden="true" tabindex="-1"></a><span class="fu">create_star</span>(<span class="dv">10</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1282"><a href="#cb160-1282" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1283"><a href="#cb160-1283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1284"><a href="#cb160-1284" aria-hidden="true" tabindex="-1"></a><span class="fu">## play_gnm</span></span>
<span id="cb160-1285"><a href="#cb160-1285" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1288"><a href="#cb160-1288" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1289"><a href="#cb160-1289" aria-hidden="true" tabindex="-1"></a><span class="fu">play_gnm</span>(<span class="dv">10</span>, <span class="dv">20</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1290"><a href="#cb160-1290" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1291"><a href="#cb160-1291" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1292"><a href="#cb160-1292" aria-hidden="true" tabindex="-1"></a><span class="fu">## play_gnp</span></span>
<span id="cb160-1293"><a href="#cb160-1293" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1296"><a href="#cb160-1296" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1297"><a href="#cb160-1297" aria-hidden="true" tabindex="-1"></a><span class="fu">play_gnp</span>(<span class="dv">10</span>, <span class="fl">0.25</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1298"><a href="#cb160-1298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1299"><a href="#cb160-1299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1300"><a href="#cb160-1300" aria-hidden="true" tabindex="-1"></a><span class="fu">## play_geometry</span></span>
<span id="cb160-1301"><a href="#cb160-1301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1304"><a href="#cb160-1304" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1305"><a href="#cb160-1305" aria-hidden="true" tabindex="-1"></a><span class="fu">play_geometry</span>(<span class="dv">10</span>, <span class="dv">3</span>) <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span>
<span id="cb160-1306"><a href="#cb160-1306" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1307"><a href="#cb160-1307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1308"><a href="#cb160-1308" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-1309"><a href="#cb160-1309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1310"><a href="#cb160-1310" aria-hidden="true" tabindex="-1"></a><span class="fu">### map_関数群</span></span>
<span id="cb160-1311"><a href="#cb160-1311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1312"><a href="#cb160-1312" aria-hidden="true" tabindex="-1"></a><span class="in">`purrr`</span>の<span class="in">`map`</span>関数と同様に、node、edgeのtibbleに関数を適用して演算を行う関数が<span class="in">`map_`</span>関数群です。</span>
<span id="cb160-1313"><a href="#cb160-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1314"><a href="#cb160-1314" aria-hidden="true" tabindex="-1"></a><span class="in">`map_`</span>関数群には大きく分けるとbfs（breath first search）を演算に用いるもの（<span class="in">`map_bfs_`</span>関数）と、dfs（depth first search）を用いるもの（<span class="in">`map_dfs_`</span>関数）があります。</span>
<span id="cb160-1315"><a href="#cb160-1315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1316"><a href="#cb160-1316" aria-hidden="true" tabindex="-1"></a><span class="in">`map_`</span>関数も単独では呼び出すことができず、<span class="in">`mutate`</span>関数内で呼び出すことが想定された関数で、<span class="in">`map_`</span>関数内で引数（<span class="in">`.f`</span>引数）として設定する関数は無名関数のみとなります。この<span class="in">`.f`</span>関数で指定する無名関数については引数が定められていて（<span class="in">`node`</span>, <span class="in">`rank`</span>, <span class="in">`path`</span>など）、かなり使い方が複雑です。また、bfs、dfsで到達不可能なパスが存在すると演算ができなくなります。</span>
<span id="cb160-1317"><a href="#cb160-1317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1318"><a href="#cb160-1318" aria-hidden="true" tabindex="-1"></a>以下の例では、bfsによってJR奈良駅から他の駅までの到達に必要な距離を演算しています。<span class="in">`value`</span>に駅間の距離や運賃などを正確に設定すれば、<span class="in">`map_bfs_dbl`</span>関数を用いて到達距離を計算することができます。</span>
<span id="cb160-1319"><a href="#cb160-1319" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1320"><a href="#cb160-1320" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="map_関数"}</span></span>
<span id="cb160-1321"><a href="#cb160-1321" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1322"><a href="#cb160-1322" aria-hidden="true" tabindex="-1"></a><span class="in">  # 離れているとbfsで探索できないので、田原本線をつなげる</span></span>
<span id="cb160-1323"><a href="#cb160-1323" aria-hidden="true" tabindex="-1"></a><span class="in">  bind_edges(data.frame(from = "田原本", to = "西田原本", linename = "田原本線", company = "近鉄")) |&gt; </span></span>
<span id="cb160-1324"><a href="#cb160-1324" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(value = rep(1, 119)) |&gt;  # 駅間を1としている</span></span>
<span id="cb160-1325"><a href="#cb160-1325" aria-hidden="true" tabindex="-1"></a><span class="in">  mutate(value_acc = map_bfs_dbl(1, .f = function(node, path, ...){ </span></span>
<span id="cb160-1326"><a href="#cb160-1326" aria-hidden="true" tabindex="-1"></a><span class="in">    sum(.N()$value[c(node, path$node)]) # searchの順に値を足していく（各nodeまでの距離を反映）</span></span>
<span id="cb160-1327"><a href="#cb160-1327" aria-hidden="true" tabindex="-1"></a><span class="in">  }))</span></span>
<span id="cb160-1328"><a href="#cb160-1328" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1329"><a href="#cb160-1329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1330"><a href="#cb160-1330" aria-hidden="true" tabindex="-1"></a><span class="fu">## グラフ表示のライブラリ</span></span>
<span id="cb160-1331"><a href="#cb160-1331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1332"><a href="#cb160-1332" aria-hidden="true" tabindex="-1"></a>上記のように、グラフの表示はグラフの理解において非常に重要です。<span class="in">`igraph`</span>を用いることでグラフを様々な形式で表示することができますが、デザイン的には<span class="in">`ggplot2`</span>などとは異なり、Rのデフォルトのプロットに近い形での表示となります。Rには、<span class="in">`igraph`</span>だけでなく、グラフを表示するためのライブラリがいくつかありますので、以下に簡単に紹介します。</span>
<span id="cb160-1333"><a href="#cb160-1333" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1334"><a href="#cb160-1334" aria-hidden="true" tabindex="-1"></a><span class="fu">### ggraph</span></span>
<span id="cb160-1335"><a href="#cb160-1335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1336"><a href="#cb160-1336" aria-hidden="true" tabindex="-1"></a><span class="in">`ggraph`</span><span class="co">[</span><span class="ot">@ggraph_bib</span><span class="co">]</span>は上記の<span class="in">`tidygraph`</span>の開発者が開発した、<span class="in">`tbl_graph`</span>を<span class="in">`ggplot2`</span>の文法・デザインで描画するためのライブラリです。仕組みは比較的単純で、以下の例のように<span class="in">`tbl_graph`</span>を<span class="in">`ggplot2`</span>のグラフ表示に適したtibbleに変形し（<span class="in">`create_layout`</span>関数）、<span class="in">`ggplot2`</span>の文法でこの<span class="in">`tibble`</span>を表示しています。この変換において、nodeの位置を<span class="in">`layout`</span>引数で指定した位置に指定させています。</span>
<span id="cb160-1337"><a href="#cb160-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1338"><a href="#cb160-1338" aria-hidden="true" tabindex="-1"></a><span class="in">`layout`</span>引数には<span class="in">`"auto"`</span>、<span class="in">`"igraph"`</span>、<span class="in">`"dendrogram"`</span>、<span class="in">`"manual"`</span>、<span class="in">`"linear"`</span>、<span class="in">`"matrix"`</span>、<span class="in">`"treemap"`</span>などの様々な値を指定することができます。<span class="in">`layout`</span>による違いは後ほど説明します。</span>
<span id="cb160-1339"><a href="#cb160-1339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1340"><a href="#cb160-1340" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ggraph：create_layout関数"}</span></span>
<span id="cb160-1341"><a href="#cb160-1341" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(ggraph)</span></span>
<span id="cb160-1342"><a href="#cb160-1342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1343"><a href="#cb160-1343" aria-hidden="true" tabindex="-1"></a><span class="in">create_layout(g, layout = "tree")</span></span>
<span id="cb160-1344"><a href="#cb160-1344" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1345"><a href="#cb160-1345" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1346"><a href="#cb160-1346" aria-hidden="true" tabindex="-1"></a><span class="in">`ggraph`</span>の文法は<span class="in">`ggplot2`</span>と非常に類似しています。まず、<span class="in">`ggplot2`</span>での<span class="in">`ggplot`</span>関数に当たる<span class="in">`ggraph`</span>関数の引数として、グラフ、<span class="in">`layout`</span>引数を設定します。<span class="in">`layout`</span>によってはこの<span class="in">`ggraph`</span>関数内で追加の引数を設定する必要があります。<span class="in">`ggplot2`</span>と同様に、この<span class="in">`ggraph`</span>関数に足し算（<span class="in">`+`</span>）で他の<span class="in">`geom`</span>関数を付け加えていくことでグラフを構成していきます。</span>
<span id="cb160-1347"><a href="#cb160-1347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1348"><a href="#cb160-1348" aria-hidden="true" tabindex="-1"></a>以下の例では、nodeを点で表示し（<span class="in">`geom_node_point`</span>）、node側のtibbleの変数である<span class="in">`name`</span>（駅名）をテキストとして重ね書きし（<span class="in">`geom_node_text`</span>）、edgeを運行会社により色分けして直線でつないでいます（<span class="in">`geom_edge_link`</span>）。<span class="in">`ggplot2`</span>の<span class="in">`aes`</span>関数に関しては<span class="in">`geom_node_`</span>関数、<span class="in">`geom_edge_`</span>関数内で指定します。<span class="in">`geom_node_`</span>関数内ではnode側のtibble、<span class="in">`geom_edge_`</span>関数内ではedge側のtibbleの列名を用いて表示する色や大きさを指定することができます。</span>
<span id="cb160-1349"><a href="#cb160-1349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1350"><a href="#cb160-1350" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ggraph：グラフを描画する"}</span></span>
<span id="cb160-1351"><a href="#cb160-1351" aria-hidden="true" tabindex="-1"></a><span class="in"># グラフのテーマの設定（ggplot2のthemeをあらかじめ定めておくもの）</span></span>
<span id="cb160-1352"><a href="#cb160-1352" aria-hidden="true" tabindex="-1"></a><span class="in">windowsFonts(Meiryo = windowsFont("Meiryo"))</span></span>
<span id="cb160-1353"><a href="#cb160-1353" aria-hidden="true" tabindex="-1"></a><span class="in">set_graph_style(family="Meiryo", text_size = 5, background = "white", caption_size = 3)</span></span>
<span id="cb160-1354"><a href="#cb160-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1355"><a href="#cb160-1355" aria-hidden="true" tabindex="-1"></a><span class="in"># x、yで指定した位置にnodeを表示する</span></span>
<span id="cb160-1356"><a href="#cb160-1356" aria-hidden="true" tabindex="-1"></a><span class="in">ggraph(g, layout = "manual", x = lon, y = lat) +</span></span>
<span id="cb160-1357"><a href="#cb160-1357" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_node_point() +</span></span>
<span id="cb160-1358"><a href="#cb160-1358" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_node_text(aes(label = name)) +</span></span>
<span id="cb160-1359"><a href="#cb160-1359" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_edge_link(aes(color = company))</span></span>
<span id="cb160-1360"><a href="#cb160-1360" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1361"><a href="#cb160-1361" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1362"><a href="#cb160-1362" aria-hidden="true" tabindex="-1"></a><span class="fu">#### ggraphのlayout</span></span>
<span id="cb160-1363"><a href="#cb160-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1364"><a href="#cb160-1364" aria-hidden="true" tabindex="-1"></a>このggraphのlayout・node・edgeの表示は非常に多種多様で、情報を捉えにくいものも含まれています。<span class="co">[</span><span class="ot">開発者がアートに興味がある</span><span class="co">](https://thomaslinpedersen.art/)</span>こともあり、ggraphにはどちらかというと現代美術的な、意味よりも見た目重視な表示方法も含まれています。</span>
<span id="cb160-1365"><a href="#cb160-1365" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1366"><a href="#cb160-1366" aria-hidden="true" tabindex="-1"></a>以下に<span class="in">`layout`</span>の例を示します。<span class="in">`layout`</span>は単にnodeのx・y軸上の位置を定めているだけで、<span class="in">`layout`</span>自体にはそれほど変わったものはありません。とは言え、特定のnode・edgeの表示とセットで用いることを前提としている、使いにくいものもあります。</span>
<span id="cb160-1367"><a href="#cb160-1367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1368"><a href="#cb160-1368" aria-hidden="true" tabindex="-1"></a><span class="in">`layout`</span>には<span class="in">`sf`</span>をベースにしたもの（<span class="in">`layout = "sf"`</span>）もあるため、上記のような路線図であれば、<span class="in">`sf`</span>で表示するのもよいでしょう。<span class="in">`sf`</span>については<span class="co">[</span><span class="ot">32章</span><span class="co">](./chapter32.html)</span>で説明しています。</span>
<span id="cb160-1369"><a href="#cb160-1369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1370"><a href="#cb160-1370" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-1371"><a href="#cb160-1371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1372"><a href="#cb160-1372" aria-hidden="true" tabindex="-1"></a><span class="fu">## auto</span></span>
<span id="cb160-1373"><a href="#cb160-1373" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1376"><a href="#cb160-1376" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1377"><a href="#cb160-1377" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb160-1378"><a href="#cb160-1378" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1379"><a href="#cb160-1379" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="co"># stressが選択されている</span></span>
<span id="cb160-1380"><a href="#cb160-1380" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1381"><a href="#cb160-1381" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1382"><a href="#cb160-1382" aria-hidden="true" tabindex="-1"></a><span class="fu">## stress</span></span>
<span id="cb160-1383"><a href="#cb160-1383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1386"><a href="#cb160-1386" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1387"><a href="#cb160-1387" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"stress"</span>) <span class="sc">+</span></span>
<span id="cb160-1388"><a href="#cb160-1388" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1389"><a href="#cb160-1389" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>() <span class="co"># autoで選ばれているのと同じ</span></span>
<span id="cb160-1390"><a href="#cb160-1390" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1391"><a href="#cb160-1391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1392"><a href="#cb160-1392" aria-hidden="true" tabindex="-1"></a><span class="fu">## sparse_stress</span></span>
<span id="cb160-1393"><a href="#cb160-1393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1396"><a href="#cb160-1396" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1397"><a href="#cb160-1397" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1398"><a href="#cb160-1398" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1399"><a href="#cb160-1399" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"sparse_stress"</span>, <span class="at">pivots =</span> <span class="dv">10</span>) <span class="sc">+</span> <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb160-1400"><a href="#cb160-1400" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1401"><a href="#cb160-1401" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1402"><a href="#cb160-1402" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1403"><a href="#cb160-1403" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1404"><a href="#cb160-1404" aria-hidden="true" tabindex="-1"></a><span class="fu">## igraph</span></span>
<span id="cb160-1405"><a href="#cb160-1405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1408"><a href="#cb160-1408" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1409"><a href="#cb160-1409" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1410"><a href="#cb160-1410" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"igraph"</span>, <span class="at">algorithm =</span> <span class="st">"grid"</span>) <span class="sc">+</span> <span class="co"># igraphのon_gridと同じ</span></span>
<span id="cb160-1411"><a href="#cb160-1411" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1412"><a href="#cb160-1412" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1413"><a href="#cb160-1413" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1414"><a href="#cb160-1414" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1415"><a href="#cb160-1415" aria-hidden="true" tabindex="-1"></a><span class="fu">## backbone</span></span>
<span id="cb160-1416"><a href="#cb160-1416" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1419"><a href="#cb160-1419" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1420"><a href="#cb160-1420" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1421"><a href="#cb160-1421" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1422"><a href="#cb160-1422" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"backbone"</span>) <span class="sc">+</span> <span class="co"># 分離したグラフには適さない</span></span>
<span id="cb160-1423"><a href="#cb160-1423" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1424"><a href="#cb160-1424" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1425"><a href="#cb160-1425" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1426"><a href="#cb160-1426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1427"><a href="#cb160-1427" aria-hidden="true" tabindex="-1"></a><span class="fu">## pmds</span></span>
<span id="cb160-1428"><a href="#cb160-1428" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1431"><a href="#cb160-1431" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1432"><a href="#cb160-1432" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1433"><a href="#cb160-1433" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1434"><a href="#cb160-1434" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"pmds"</span>, <span class="at">pivots =</span> <span class="dv">10</span>) <span class="sc">+</span>  <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb160-1435"><a href="#cb160-1435" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1436"><a href="#cb160-1436" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1437"><a href="#cb160-1437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1438"><a href="#cb160-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1439"><a href="#cb160-1439" aria-hidden="true" tabindex="-1"></a><span class="fu">## eigen</span></span>
<span id="cb160-1440"><a href="#cb160-1440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1443"><a href="#cb160-1443" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1444"><a href="#cb160-1444" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1445"><a href="#cb160-1445" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1446"><a href="#cb160-1446" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"eigen"</span>) <span class="sc">+</span>  <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb160-1447"><a href="#cb160-1447" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1448"><a href="#cb160-1448" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1449"><a href="#cb160-1449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1450"><a href="#cb160-1450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1451"><a href="#cb160-1451" aria-hidden="true" tabindex="-1"></a><span class="fu">## centrality</span></span>
<span id="cb160-1452"><a href="#cb160-1452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1455"><a href="#cb160-1455" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1456"><a href="#cb160-1456" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1457"><a href="#cb160-1457" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">cent =</span> <span class="fu">centrality_degree</span>()) <span class="sc">|&gt;</span> <span class="co"># 中心性に従い位置を決定する</span></span>
<span id="cb160-1458"><a href="#cb160-1458" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1459"><a href="#cb160-1459" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"centrality"</span>, <span class="at">centrality =</span> cent) <span class="sc">+</span>  <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb160-1460"><a href="#cb160-1460" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1461"><a href="#cb160-1461" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1462"><a href="#cb160-1462" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1463"><a href="#cb160-1463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1464"><a href="#cb160-1464" aria-hidden="true" tabindex="-1"></a><span class="fu">## focus</span></span>
<span id="cb160-1465"><a href="#cb160-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1468"><a href="#cb160-1468" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1469"><a href="#cb160-1469" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="co"># 分離したグラフでは表示できない</span></span>
<span id="cb160-1470"><a href="#cb160-1470" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from=</span><span class="st">"田原本"</span>, <span class="at">to=</span><span class="st">"西田原本"</span>, <span class="at">linename=</span><span class="st">"田原本線"</span>, <span class="at">company=</span><span class="st">"近鉄"</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1471"><a href="#cb160-1471" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"focus"</span>, <span class="at">focus =</span> <span class="dv">1</span>) <span class="sc">+</span> <span class="co"># JR奈良駅にfocusする</span></span>
<span id="cb160-1472"><a href="#cb160-1472" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1473"><a href="#cb160-1473" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1474"><a href="#cb160-1474" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1475"><a href="#cb160-1475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1476"><a href="#cb160-1476" aria-hidden="true" tabindex="-1"></a><span class="fu">## dendrogram</span></span>
<span id="cb160-1477"><a href="#cb160-1477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1480"><a href="#cb160-1480" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1481"><a href="#cb160-1481" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフにしか適用できない</span></span>
<span id="cb160-1482"><a href="#cb160-1482" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"dendrogram"</span>) <span class="sc">+</span> </span>
<span id="cb160-1483"><a href="#cb160-1483" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1484"><a href="#cb160-1484" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1485"><a href="#cb160-1485" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1486"><a href="#cb160-1486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1487"><a href="#cb160-1487" aria-hidden="true" tabindex="-1"></a><span class="fu">## unrooted</span></span>
<span id="cb160-1488"><a href="#cb160-1488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1491"><a href="#cb160-1491" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1492"><a href="#cb160-1492" aria-hidden="true" tabindex="-1"></a>g  <span class="sc">|&gt;</span> </span>
<span id="cb160-1493"><a href="#cb160-1493" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"unrooted"</span>) <span class="sc">+</span> </span>
<span id="cb160-1494"><a href="#cb160-1494" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1495"><a href="#cb160-1495" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1496"><a href="#cb160-1496" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1497"><a href="#cb160-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1498"><a href="#cb160-1498" aria-hidden="true" tabindex="-1"></a><span class="fu">## linear</span></span>
<span id="cb160-1499"><a href="#cb160-1499" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1502"><a href="#cb160-1502" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1503"><a href="#cb160-1503" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1504"><a href="#cb160-1504" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"linear"</span>) <span class="sc">+</span> </span>
<span id="cb160-1505"><a href="#cb160-1505" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1506"><a href="#cb160-1506" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>() <span class="co"># 直線ではedgeが見えないのでarcとしている</span></span>
<span id="cb160-1507"><a href="#cb160-1507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1508"><a href="#cb160-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1509"><a href="#cb160-1509" aria-hidden="true" tabindex="-1"></a><span class="fu">## circlepack</span></span>
<span id="cb160-1510"><a href="#cb160-1510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1513"><a href="#cb160-1513" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1514"><a href="#cb160-1514" aria-hidden="true" tabindex="-1"></a><span class="fu">play_gnm</span>(<span class="dv">30</span>, <span class="dv">80</span>, <span class="at">directed =</span> <span class="cn">TRUE</span>)  <span class="sc">|&gt;</span>  <span class="co"># 有向グラフのみ対応</span></span>
<span id="cb160-1515"><a href="#cb160-1515" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"circlepack"</span>) <span class="sc">+</span> </span>
<span id="cb160-1516"><a href="#cb160-1516" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1517"><a href="#cb160-1517" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1518"><a href="#cb160-1518" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1519"><a href="#cb160-1519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1520"><a href="#cb160-1520" aria-hidden="true" tabindex="-1"></a><span class="fu">## treemap</span></span>
<span id="cb160-1521"><a href="#cb160-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1524"><a href="#cb160-1524" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1525"><a href="#cb160-1525" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフにしか適用できない</span></span>
<span id="cb160-1526"><a href="#cb160-1526" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"treemap"</span>) <span class="sc">+</span> </span>
<span id="cb160-1527"><a href="#cb160-1527" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1528"><a href="#cb160-1528" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1529"><a href="#cb160-1529" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1530"><a href="#cb160-1530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1531"><a href="#cb160-1531" aria-hidden="true" tabindex="-1"></a><span class="fu">## partition</span></span>
<span id="cb160-1532"><a href="#cb160-1532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1535"><a href="#cb160-1535" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1536"><a href="#cb160-1536" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフにしか適用できない</span></span>
<span id="cb160-1537"><a href="#cb160-1537" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"partition"</span>) <span class="sc">+</span> </span>
<span id="cb160-1538"><a href="#cb160-1538" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1539"><a href="#cb160-1539" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1540"><a href="#cb160-1540" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1541"><a href="#cb160-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1542"><a href="#cb160-1542" aria-hidden="true" tabindex="-1"></a><span class="fu">## cactustree</span></span>
<span id="cb160-1543"><a href="#cb160-1543" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1546"><a href="#cb160-1546" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1547"><a href="#cb160-1547" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">2</span>)  <span class="sc">|&gt;</span> <span class="co"># 有向グラフでないとnodeが範囲外に出る</span></span>
<span id="cb160-1548"><a href="#cb160-1548" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"cactustree"</span>) <span class="sc">+</span> </span>
<span id="cb160-1549"><a href="#cb160-1549" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1550"><a href="#cb160-1550" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1551"><a href="#cb160-1551" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1552"><a href="#cb160-1552" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1553"><a href="#cb160-1553" aria-hidden="true" tabindex="-1"></a><span class="fu">## htree</span></span>
<span id="cb160-1554"><a href="#cb160-1554" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1557"><a href="#cb160-1557" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1558"><a href="#cb160-1558" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">15</span>, <span class="at">children =</span> <span class="dv">2</span>)  <span class="sc">|&gt;</span> <span class="co"># 二分木でないと描画できない</span></span>
<span id="cb160-1559"><a href="#cb160-1559" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"htree"</span>) <span class="sc">+</span> </span>
<span id="cb160-1560"><a href="#cb160-1560" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1561"><a href="#cb160-1561" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1562"><a href="#cb160-1562" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1563"><a href="#cb160-1563" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1564"><a href="#cb160-1564" aria-hidden="true" tabindex="-1"></a><span class="fu">## matrix</span></span>
<span id="cb160-1565"><a href="#cb160-1565" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1568"><a href="#cb160-1568" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1569"><a href="#cb160-1569" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"matrix"</span>) <span class="sc">+</span></span>
<span id="cb160-1570"><a href="#cb160-1570" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1571"><a href="#cb160-1571" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>() <span class="co"># 直線では見えなくなるのでarcを選択</span></span>
<span id="cb160-1572"><a href="#cb160-1572" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1573"><a href="#cb160-1573" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1574"><a href="#cb160-1574" aria-hidden="true" tabindex="-1"></a><span class="fu">## hive</span></span>
<span id="cb160-1575"><a href="#cb160-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1578"><a href="#cb160-1578" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1579"><a href="#cb160-1579" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1580"><a href="#cb160-1580" aria-hidden="true" tabindex="-1"></a>  <span class="fu">activate</span>(nodes) <span class="sc">|&gt;</span> </span>
<span id="cb160-1581"><a href="#cb160-1581" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">linename =</span> <span class="fu">E</span>(g)<span class="sc">$</span>linename[<span class="dv">1</span><span class="sc">:</span><span class="dv">119</span>]) <span class="sc">|&gt;</span> </span>
<span id="cb160-1582"><a href="#cb160-1582" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"hive"</span>, <span class="at">axis =</span> linename) <span class="sc">+</span> <span class="co"># linenameを軸として配置</span></span>
<span id="cb160-1583"><a href="#cb160-1583" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1584"><a href="#cb160-1584" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>(<span class="fu">aes</span>(<span class="at">color=</span>linename)) <span class="co"># 直線では見えなくなるのでarcを選択</span></span>
<span id="cb160-1585"><a href="#cb160-1585" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1586"><a href="#cb160-1586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1587"><a href="#cb160-1587" aria-hidden="true" tabindex="-1"></a><span class="fu">## fabric</span></span>
<span id="cb160-1588"><a href="#cb160-1588" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1591"><a href="#cb160-1591" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1592"><a href="#cb160-1592" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fabric"</span>) <span class="sc">+</span></span>
<span id="cb160-1593"><a href="#cb160-1593" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1594"><a href="#cb160-1594" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1595"><a href="#cb160-1595" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1596"><a href="#cb160-1596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1597"><a href="#cb160-1597" aria-hidden="true" tabindex="-1"></a><span class="fu">## metro</span></span>
<span id="cb160-1598"><a href="#cb160-1598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1601"><a href="#cb160-1601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1602"><a href="#cb160-1602" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"metro"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb160-1603"><a href="#cb160-1603" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1604"><a href="#cb160-1604" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1605"><a href="#cb160-1605" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1606"><a href="#cb160-1606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1607"><a href="#cb160-1607" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-1608"><a href="#cb160-1608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1609"><a href="#cb160-1609" aria-hidden="true" tabindex="-1"></a><span class="fu">#### nodeの表示</span></span>
<span id="cb160-1610"><a href="#cb160-1610" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1611"><a href="#cb160-1611" aria-hidden="true" tabindex="-1"></a>nodeの表示には、<span class="in">`geom_node_`</span>関数を用います。<span class="in">`geom_node_`</span>の後にnodeの形状を示す単語（<span class="in">`point`</span>、<span class="in">`text`</span>、<span class="in">`tile`</span>、<span class="in">`voronoi`</span>など）を繋ぐことで、nodeの形状を指定します。<span class="in">`geom_node_`</span>関数は<span class="in">`ggplot2`</span>の<span class="in">`geom_`</span>関数と同様に、<span class="in">`ggraph`</span>関数に<span class="in">`+`</span>でつないで用います。</span>
<span id="cb160-1612"><a href="#cb160-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1613"><a href="#cb160-1613" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_node_point`</span>や<span class="in">`geom_node_text`</span>、<span class="in">`geom_node_label`</span>はどのようなグラフで用いても使いやすいですが、<span class="in">`geom_node_voronoi`</span>のようにデザイン重視でネットワークの理解にはつながらないものもあります。以下に<span class="in">`geom_node_`</span>関数の使用例を示します。</span>
<span id="cb160-1614"><a href="#cb160-1614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1615"><a href="#cb160-1615" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-1616"><a href="#cb160-1616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1617"><a href="#cb160-1617" aria-hidden="true" tabindex="-1"></a><span class="fu">## point</span></span>
<span id="cb160-1618"><a href="#cb160-1618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1621"><a href="#cb160-1621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1622"><a href="#cb160-1622" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1623"><a href="#cb160-1623" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb160-1624"><a href="#cb160-1624" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>()</span>
<span id="cb160-1625"><a href="#cb160-1625" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1626"><a href="#cb160-1626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1627"><a href="#cb160-1627" aria-hidden="true" tabindex="-1"></a><span class="fu">## text</span></span>
<span id="cb160-1628"><a href="#cb160-1628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1631"><a href="#cb160-1631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1632"><a href="#cb160-1632" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1633"><a href="#cb160-1633" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb160-1634"><a href="#cb160-1634" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_text</span>(<span class="fu">aes</span>(<span class="at">label =</span> name))</span>
<span id="cb160-1635"><a href="#cb160-1635" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1636"><a href="#cb160-1636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1637"><a href="#cb160-1637" aria-hidden="true" tabindex="-1"></a><span class="fu">## label</span></span>
<span id="cb160-1638"><a href="#cb160-1638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1641"><a href="#cb160-1641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1642"><a href="#cb160-1642" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1643"><a href="#cb160-1643" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb160-1644"><a href="#cb160-1644" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_label</span>(<span class="fu">aes</span>(<span class="at">label =</span> name))</span>
<span id="cb160-1645"><a href="#cb160-1645" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1646"><a href="#cb160-1646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1647"><a href="#cb160-1647" aria-hidden="true" tabindex="-1"></a><span class="fu">## tile</span></span>
<span id="cb160-1648"><a href="#cb160-1648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1651"><a href="#cb160-1651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1652"><a href="#cb160-1652" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1653"><a href="#cb160-1653" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"igraph"</span>, <span class="at">algorithm =</span> <span class="st">"grid"</span>) <span class="sc">+</span></span>
<span id="cb160-1654"><a href="#cb160-1654" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_tile</span>(<span class="fu">aes</span>(<span class="at">fill=</span>lon, <span class="at">color =</span> lat, <span class="at">width=</span><span class="fl">0.9</span>, <span class="at">height=</span><span class="fl">0.9</span>))</span>
<span id="cb160-1655"><a href="#cb160-1655" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1656"><a href="#cb160-1656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1657"><a href="#cb160-1657" aria-hidden="true" tabindex="-1"></a><span class="fu">## voronoi</span></span>
<span id="cb160-1658"><a href="#cb160-1658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1661"><a href="#cb160-1661" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1662"><a href="#cb160-1662" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1663"><a href="#cb160-1663" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"stress"</span>) <span class="sc">+</span></span>
<span id="cb160-1664"><a href="#cb160-1664" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_voronoi</span>(<span class="fu">aes</span>(<span class="at">color=</span><span class="fu">factor</span>(<span class="dv">1</span>), <span class="at">fill=</span><span class="fu">factor</span>(lat), <span class="at">alpha =</span> <span class="fl">0.3</span>))<span class="sc">+</span></span>
<span id="cb160-1665"><a href="#cb160-1665" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb160-1666"><a href="#cb160-1666" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1667"><a href="#cb160-1667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1668"><a href="#cb160-1668" aria-hidden="true" tabindex="-1"></a><span class="fu">## circle</span></span>
<span id="cb160-1669"><a href="#cb160-1669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1672"><a href="#cb160-1672" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1673"><a href="#cb160-1673" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1674"><a href="#cb160-1674" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb160-1675"><a href="#cb160-1675" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_circle</span>(<span class="fu">aes</span>(<span class="at">r =</span> lon<span class="sc">/</span><span class="dv">10000</span>, <span class="at">color =</span> <span class="fu">factor</span>(lon)))<span class="sc">+</span></span>
<span id="cb160-1676"><a href="#cb160-1676" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb160-1677"><a href="#cb160-1677" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1678"><a href="#cb160-1678" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1679"><a href="#cb160-1679" aria-hidden="true" tabindex="-1"></a><span class="fu">## arc_bar</span></span>
<span id="cb160-1680"><a href="#cb160-1680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1683"><a href="#cb160-1683" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1684"><a href="#cb160-1684" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">2</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb160-1685"><a href="#cb160-1685" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">colors =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">6</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1686"><a href="#cb160-1686" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"partition"</span>, <span class="at">circular =</span> <span class="cn">TRUE</span>) <span class="sc">+</span></span>
<span id="cb160-1687"><a href="#cb160-1687" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_arc_bar</span>(<span class="fu">aes</span>(<span class="at">fill =</span> <span class="fu">factor</span>(colors))) <span class="co"># 内→外へのtreeになっている</span></span>
<span id="cb160-1688"><a href="#cb160-1688" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1689"><a href="#cb160-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1690"><a href="#cb160-1690" aria-hidden="true" tabindex="-1"></a><span class="fu">## range</span></span>
<span id="cb160-1691"><a href="#cb160-1691" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1694"><a href="#cb160-1694" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1695"><a href="#cb160-1695" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1696"><a href="#cb160-1696" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fabric"</span>) <span class="sc">+</span></span>
<span id="cb160-1697"><a href="#cb160-1697" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_range</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(lon)))<span class="sc">+</span></span>
<span id="cb160-1698"><a href="#cb160-1698" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb160-1699"><a href="#cb160-1699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1700"><a href="#cb160-1700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1701"><a href="#cb160-1701" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-1702"><a href="#cb160-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1703"><a href="#cb160-1703" aria-hidden="true" tabindex="-1"></a><span class="fu">#### edgeの表示</span></span>
<span id="cb160-1704"><a href="#cb160-1704" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1705"><a href="#cb160-1705" aria-hidden="true" tabindex="-1"></a>edgeの表示には、<span class="in">`geom_edge_`</span>関数を用います。<span class="in">`geom_edge_`</span>関数は<span class="in">`geom_node_`</span>関数とほぼ同じように用います。つまり、<span class="in">`geom_edge_`</span>の後に形状を指定する単語（<span class="in">`link`</span>、<span class="in">`arc`</span>など）を繋いだ関数として用い、<span class="in">`ggraph`</span>関数に<span class="in">`+`</span>でつないで用います。</span>
<span id="cb160-1706"><a href="#cb160-1706" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1707"><a href="#cb160-1707" aria-hidden="true" tabindex="-1"></a><span class="in">`geom_edge_link`</span>関数や<span class="in">`geom_edge_arc`</span>関数のように比較的使いやすいものから、平行するedge（同じnode間をつなぐ複数のedge）を示すときだけに用いるもの（<span class="in">`geom_edge_parallel`</span>、<span class="in">`geom_edge_fan`</span>）、ループ（ノードからそのノード自身に接続するedge）を示すときだけに用いるもの（<span class="in">`geom_edge_loop`</span>）、特定のlayout・nodeと共に用いることが想定されているもの（<span class="in">`geom_edge_hive`</span>、<span class="in">`geom_edge_span`</span>）など、特定の場合以外にはほぼ用いないものもあります。</span>
<span id="cb160-1708"><a href="#cb160-1708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1709"><a href="#cb160-1709" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb160-1710"><a href="#cb160-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1711"><a href="#cb160-1711" aria-hidden="true" tabindex="-1"></a><span class="fu">## link</span></span>
<span id="cb160-1712"><a href="#cb160-1712" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1715"><a href="#cb160-1715" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1716"><a href="#cb160-1716" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb160-1717"><a href="#cb160-1717" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"dendrogram"</span>) <span class="sc">+</span> </span>
<span id="cb160-1718"><a href="#cb160-1718" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1719"><a href="#cb160-1719" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_link</span>()</span>
<span id="cb160-1720"><a href="#cb160-1720" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1721"><a href="#cb160-1721" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1722"><a href="#cb160-1722" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1723"><a href="#cb160-1723" aria-hidden="true" tabindex="-1"></a><span class="fu">## arc</span></span>
<span id="cb160-1724"><a href="#cb160-1724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1727"><a href="#cb160-1727" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1728"><a href="#cb160-1728" aria-hidden="true" tabindex="-1"></a>karate  <span class="sc">|&gt;</span></span>
<span id="cb160-1729"><a href="#cb160-1729" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb160-1730"><a href="#cb160-1730" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1731"><a href="#cb160-1731" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_arc</span>()</span>
<span id="cb160-1732"><a href="#cb160-1732" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1733"><a href="#cb160-1733" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1734"><a href="#cb160-1734" aria-hidden="true" tabindex="-1"></a><span class="fu">## parallel</span></span>
<span id="cb160-1735"><a href="#cb160-1735" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1738"><a href="#cb160-1738" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1739"><a href="#cb160-1739" aria-hidden="true" tabindex="-1"></a><span class="co"># マニュアルの例の通り</span></span>
<span id="cb160-1740"><a href="#cb160-1740" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">create_notable</span>(<span class="st">'bull'</span>) <span class="sc">|&gt;</span></span>
<span id="cb160-1741"><a href="#cb160-1741" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert</span>(to_directed) <span class="sc">|&gt;</span></span>
<span id="cb160-1742"><a href="#cb160-1742" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb160-1743"><a href="#cb160-1743" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb160-1744"><a href="#cb160-1744" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(gr, <span class="st">'stress'</span>) <span class="sc">+</span></span>
<span id="cb160-1745"><a href="#cb160-1745" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb160-1746"><a href="#cb160-1746" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_parallel</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(index)))<span class="sc">+</span></span>
<span id="cb160-1747"><a href="#cb160-1747" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb160-1748"><a href="#cb160-1748" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1749"><a href="#cb160-1749" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1750"><a href="#cb160-1750" aria-hidden="true" tabindex="-1"></a><span class="fu">## fan</span></span>
<span id="cb160-1751"><a href="#cb160-1751" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1754"><a href="#cb160-1754" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1755"><a href="#cb160-1755" aria-hidden="true" tabindex="-1"></a>gr <span class="ot">&lt;-</span> <span class="fu">create_notable</span>(<span class="st">'bull'</span>) <span class="sc">|&gt;</span></span>
<span id="cb160-1756"><a href="#cb160-1756" aria-hidden="true" tabindex="-1"></a>  <span class="fu">convert</span>(to_directed) <span class="sc">|&gt;</span></span>
<span id="cb160-1757"><a href="#cb160-1757" aria-hidden="true" tabindex="-1"></a>  <span class="fu">bind_edges</span>(<span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">1</span>, <span class="dv">3</span>, <span class="dv">2</span>)))</span>
<span id="cb160-1758"><a href="#cb160-1758" aria-hidden="true" tabindex="-1"></a> </span>
<span id="cb160-1759"><a href="#cb160-1759" aria-hidden="true" tabindex="-1"></a><span class="fu">ggraph</span>(gr, <span class="st">'stress'</span>) <span class="sc">+</span></span>
<span id="cb160-1760"><a href="#cb160-1760" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="fu">aes</span>(<span class="at">size=</span><span class="dv">1</span>))<span class="sc">+</span></span>
<span id="cb160-1761"><a href="#cb160-1761" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_fan</span>(<span class="fu">aes</span>(<span class="at">alpha =</span> <span class="fu">after_stat</span>(index)))<span class="sc">+</span></span>
<span id="cb160-1762"><a href="#cb160-1762" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)</span>
<span id="cb160-1763"><a href="#cb160-1763" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1764"><a href="#cb160-1764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1765"><a href="#cb160-1765" aria-hidden="true" tabindex="-1"></a><span class="fu">## loop</span></span>
<span id="cb160-1766"><a href="#cb160-1766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1769"><a href="#cb160-1769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1770"><a href="#cb160-1770" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">from =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">3</span>), <span class="at">to =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>, <span class="dv">3</span>, <span class="dv">3</span>, <span class="dv">1</span>, <span class="dv">1</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1771"><a href="#cb160-1771" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb160-1772"><a href="#cb160-1772" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb160-1773"><a href="#cb160-1773" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1774"><a href="#cb160-1774" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_loop</span>() <span class="sc">+</span> <span class="co"># node自身への接続（ループ）を表示する</span></span>
<span id="cb160-1775"><a href="#cb160-1775" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_fan</span>()</span>
<span id="cb160-1776"><a href="#cb160-1776" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1777"><a href="#cb160-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1778"><a href="#cb160-1778" aria-hidden="true" tabindex="-1"></a><span class="fu">## diagonal</span></span>
<span id="cb160-1779"><a href="#cb160-1779" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1782"><a href="#cb160-1782" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1783"><a href="#cb160-1783" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb160-1784"><a href="#cb160-1784" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"dendrogram"</span>) <span class="sc">+</span> </span>
<span id="cb160-1785"><a href="#cb160-1785" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1786"><a href="#cb160-1786" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_diagonal</span>() <span class="co"># ベジェ曲線</span></span>
<span id="cb160-1787"><a href="#cb160-1787" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1788"><a href="#cb160-1788" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1789"><a href="#cb160-1789" aria-hidden="true" tabindex="-1"></a><span class="fu">## elbow</span></span>
<span id="cb160-1790"><a href="#cb160-1790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1793"><a href="#cb160-1793" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1794"><a href="#cb160-1794" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb160-1795"><a href="#cb160-1795" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb160-1796"><a href="#cb160-1796" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1797"><a href="#cb160-1797" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_elbow</span>()</span>
<span id="cb160-1798"><a href="#cb160-1798" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1799"><a href="#cb160-1799" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1800"><a href="#cb160-1800" aria-hidden="true" tabindex="-1"></a><span class="fu">## bend</span></span>
<span id="cb160-1801"><a href="#cb160-1801" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1804"><a href="#cb160-1804" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1805"><a href="#cb160-1805" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span></span>
<span id="cb160-1806"><a href="#cb160-1806" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span> </span>
<span id="cb160-1807"><a href="#cb160-1807" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1808"><a href="#cb160-1808" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bend</span>()</span>
<span id="cb160-1809"><a href="#cb160-1809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1810"><a href="#cb160-1810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1811"><a href="#cb160-1811" aria-hidden="true" tabindex="-1"></a><span class="fu">## hive</span></span>
<span id="cb160-1812"><a href="#cb160-1812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1815"><a href="#cb160-1815" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1816"><a href="#cb160-1816" aria-hidden="true" tabindex="-1"></a><span class="fu">create_tree</span>(<span class="at">n=</span><span class="dv">30</span>, <span class="at">children =</span> <span class="dv">4</span>)  <span class="sc">|&gt;</span> </span>
<span id="cb160-1817"><a href="#cb160-1817" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>, <span class="dv">10</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb160-1818"><a href="#cb160-1818" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"hive"</span>, <span class="at">axis =</span> group) <span class="sc">+</span> </span>
<span id="cb160-1819"><a href="#cb160-1819" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>() <span class="sc">+</span></span>
<span id="cb160-1820"><a href="#cb160-1820" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_hive</span>() <span class="co"># axis間しか繋がない</span></span>
<span id="cb160-1821"><a href="#cb160-1821" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1822"><a href="#cb160-1822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1823"><a href="#cb160-1823" aria-hidden="true" tabindex="-1"></a><span class="fu">## span</span></span>
<span id="cb160-1824"><a href="#cb160-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1827"><a href="#cb160-1827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1828"><a href="#cb160-1828" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1829"><a href="#cb160-1829" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"fabric"</span>) <span class="sc">+</span></span>
<span id="cb160-1830"><a href="#cb160-1830" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_range</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(lon)))<span class="sc">+</span></span>
<span id="cb160-1831"><a href="#cb160-1831" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb160-1832"><a href="#cb160-1832" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_span</span>()</span>
<span id="cb160-1833"><a href="#cb160-1833" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1834"><a href="#cb160-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1835"><a href="#cb160-1835" aria-hidden="true" tabindex="-1"></a><span class="fu">## point</span></span>
<span id="cb160-1836"><a href="#cb160-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1839"><a href="#cb160-1839" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1840"><a href="#cb160-1840" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1841"><a href="#cb160-1841" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"manual"</span>, <span class="at">x =</span> lon, <span class="at">y =</span> lat) <span class="sc">+</span></span>
<span id="cb160-1842"><a href="#cb160-1842" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb160-1843"><a href="#cb160-1843" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_point</span>(<span class="fu">aes</span>(<span class="at">color =</span> <span class="fu">factor</span>(linename)))</span>
<span id="cb160-1844"><a href="#cb160-1844" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1845"><a href="#cb160-1845" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1846"><a href="#cb160-1846" aria-hidden="true" tabindex="-1"></a><span class="fu">## tile</span></span>
<span id="cb160-1847"><a href="#cb160-1847" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1850"><a href="#cb160-1850" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1851"><a href="#cb160-1851" aria-hidden="true" tabindex="-1"></a>g <span class="sc">|&gt;</span> </span>
<span id="cb160-1852"><a href="#cb160-1852" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"matrix"</span>) <span class="sc">+</span></span>
<span id="cb160-1853"><a href="#cb160-1853" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb160-1854"><a href="#cb160-1854" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_tile</span>(<span class="fu">aes</span>(<span class="at">color =</span> linename, <span class="at">fill=</span>linename))</span>
<span id="cb160-1855"><a href="#cb160-1855" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1856"><a href="#cb160-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1857"><a href="#cb160-1857" aria-hidden="true" tabindex="-1"></a><span class="fu">## density</span></span>
<span id="cb160-1858"><a href="#cb160-1858" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1859"><a href="#cb160-1859" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb160-1860"><a href="#cb160-1860" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1861"><a href="#cb160-1861" aria-hidden="true" tabindex="-1"></a><span class="in">  ggraph(layout = "manual", x = lon, y = lat) +</span></span>
<span id="cb160-1862"><a href="#cb160-1862" aria-hidden="true" tabindex="-1"></a><span class="in">  theme(legend.position = "none")+</span></span>
<span id="cb160-1863"><a href="#cb160-1863" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_node_point(size = 0.1)+</span></span>
<span id="cb160-1864"><a href="#cb160-1864" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_edge_density(aes(fill=linename))</span></span>
<span id="cb160-1865"><a href="#cb160-1865" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1866"><a href="#cb160-1866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1867"><a href="#cb160-1867" aria-hidden="true" tabindex="-1"></a><span class="fu">## bundle_force</span></span>
<span id="cb160-1868"><a href="#cb160-1868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1871"><a href="#cb160-1871" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1872"><a href="#cb160-1872" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">"Zachary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb160-1873"><a href="#cb160-1873" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb160-1874"><a href="#cb160-1874" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb160-1875"><a href="#cb160-1875" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb160-1876"><a href="#cb160-1876" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb160-1877"><a href="#cb160-1877" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bundle_force</span>()</span>
<span id="cb160-1878"><a href="#cb160-1878" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1879"><a href="#cb160-1879" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1880"><a href="#cb160-1880" aria-hidden="true" tabindex="-1"></a><span class="fu">## bundle_path</span></span>
<span id="cb160-1881"><a href="#cb160-1881" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1884"><a href="#cb160-1884" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1885"><a href="#cb160-1885" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">"Zachary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb160-1886"><a href="#cb160-1886" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb160-1887"><a href="#cb160-1887" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb160-1888"><a href="#cb160-1888" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb160-1889"><a href="#cb160-1889" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb160-1890"><a href="#cb160-1890" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bundle_path</span>()</span>
<span id="cb160-1891"><a href="#cb160-1891" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1892"><a href="#cb160-1892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1893"><a href="#cb160-1893" aria-hidden="true" tabindex="-1"></a><span class="fu">## bundle_path</span></span>
<span id="cb160-1894"><a href="#cb160-1894" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1897"><a href="#cb160-1897" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb160-1898"><a href="#cb160-1898" aria-hidden="true" tabindex="-1"></a><span class="fu">make_graph</span>(<span class="st">"Zachary"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb160-1899"><a href="#cb160-1899" aria-hidden="true" tabindex="-1"></a>  <span class="fu">as_tbl_graph</span>() <span class="sc">|&gt;</span> </span>
<span id="cb160-1900"><a href="#cb160-1900" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggraph</span>(<span class="at">layout =</span> <span class="st">"auto"</span>) <span class="sc">+</span></span>
<span id="cb160-1901"><a href="#cb160-1901" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">"none"</span>)<span class="sc">+</span></span>
<span id="cb160-1902"><a href="#cb160-1902" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_node_point</span>(<span class="at">size =</span> <span class="fl">0.1</span>)<span class="sc">+</span></span>
<span id="cb160-1903"><a href="#cb160-1903" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_edge_bundle_minimal</span>()</span>
<span id="cb160-1904"><a href="#cb160-1904" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1905"><a href="#cb160-1905" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1906"><a href="#cb160-1906" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb160-1907"><a href="#cb160-1907" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1908"><a href="#cb160-1908" aria-hidden="true" tabindex="-1"></a><span class="fu">#### faceting</span></span>
<span id="cb160-1909"><a href="#cb160-1909" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1910"><a href="#cb160-1910" aria-hidden="true" tabindex="-1"></a><span class="in">`ggplot2`</span>と同じように、<span class="in">`facet`</span>関数を用いることで、tbl_graphに含まれている変数（<span class="in">`igraph`</span>における<span class="in">`attribute`</span>）を用いてグラフを分割し、表示することができます。<span class="in">`facet`</span>関数には<span class="in">`facet_graph`</span>、<span class="in">`facet_node`</span>、<span class="in">`facet_edge`</span>の3つの関数があり、それぞれ使用感が少しずつ異なります。</span>
<span id="cb160-1911"><a href="#cb160-1911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1912"><a href="#cb160-1912" aria-hidden="true" tabindex="-1"></a><span class="in">`facet`</span>関数の引数にはチルダ（<span class="in">`~`</span>）を用い、チルダの右辺、もしくは両辺に変数を指定することで、グラフを分割表示することができます。</span>
<span id="cb160-1913"><a href="#cb160-1913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1914"><a href="#cb160-1914" aria-hidden="true" tabindex="-1"></a><span class="in">`ggraph`</span>には上に示したものの他に、色や文字等を指定するたくさんの関数が設定されています。</span>
<span id="cb160-1915"><a href="#cb160-1915" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1916"><a href="#cb160-1916" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename = "faceting"}</span></span>
<span id="cb160-1917"><a href="#cb160-1917" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1918"><a href="#cb160-1918" aria-hidden="true" tabindex="-1"></a><span class="in">  ggraph(layout = "manual", x = lon, y = lat) +</span></span>
<span id="cb160-1919"><a href="#cb160-1919" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_node_label(aes(label = name, color = company)) +</span></span>
<span id="cb160-1920"><a href="#cb160-1920" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_edge_link(aes(, color = company)) +</span></span>
<span id="cb160-1921"><a href="#cb160-1921" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_graph(~ company)</span></span>
<span id="cb160-1922"><a href="#cb160-1922" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1923"><a href="#cb160-1923" aria-hidden="true" tabindex="-1"></a><span class="in"># 上と同じ</span></span>
<span id="cb160-1924"><a href="#cb160-1924" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1925"><a href="#cb160-1925" aria-hidden="true" tabindex="-1"></a><span class="in">  ggraph(layout = "manual", x = lon, y = lat) +</span></span>
<span id="cb160-1926"><a href="#cb160-1926" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_node_label(aes(label = name, color = company)) +</span></span>
<span id="cb160-1927"><a href="#cb160-1927" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_edge_link(aes(, color = company)) +</span></span>
<span id="cb160-1928"><a href="#cb160-1928" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_nodes(~ company)</span></span>
<span id="cb160-1929"><a href="#cb160-1929" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1930"><a href="#cb160-1930" aria-hidden="true" tabindex="-1"></a><span class="in"># edgeだけが2つに分かれる</span></span>
<span id="cb160-1931"><a href="#cb160-1931" aria-hidden="true" tabindex="-1"></a><span class="in">g |&gt; </span></span>
<span id="cb160-1932"><a href="#cb160-1932" aria-hidden="true" tabindex="-1"></a><span class="in">  ggraph(layout = "manual", x = lon, y = lat) +</span></span>
<span id="cb160-1933"><a href="#cb160-1933" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_node_label(aes(label = name, color = company)) +</span></span>
<span id="cb160-1934"><a href="#cb160-1934" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_edge_link(aes(, color = company)) +</span></span>
<span id="cb160-1935"><a href="#cb160-1935" aria-hidden="true" tabindex="-1"></a><span class="in">  facet_edges(~ company)</span></span>
<span id="cb160-1936"><a href="#cb160-1936" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1937"><a href="#cb160-1937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1938"><a href="#cb160-1938" aria-hidden="true" tabindex="-1"></a><span class="fu">### networkD3</span></span>
<span id="cb160-1939"><a href="#cb160-1939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1940"><a href="#cb160-1940" aria-hidden="true" tabindex="-1"></a>上記のように<span class="in">`igraph`</span>の<span class="in">`plot`</span>関数や<span class="in">`ggraph`</span>で静的なグラフを準備すれば、論文や出版物、プレゼンテーションで示すグラフとしては十分ですが、Web上ではグラフをインタラクティブに示すことでグラフの構造を読み取りやすくできる場合があります。</span>
<span id="cb160-1941"><a href="#cb160-1941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1942"><a href="#cb160-1942" aria-hidden="true" tabindex="-1"></a>このようなインタラクティブなグラフの表示を行うためのライブラリが<span class="in">`networkD3`</span><span class="co">[</span><span class="ot">@networkD3_bib</span><span class="co">]</span>です。<span class="in">`networkD3`</span>はJavascriptのグラフィックライブラリである<span class="co">[</span><span class="ot">D3.js</span><span class="co">](https://d3js.org/)</span>をRに持ち込んで、ネットワークの表記ができるようにしたものです。</span>
<span id="cb160-1943"><a href="#cb160-1943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1944"><a href="#cb160-1944" aria-hidden="true" tabindex="-1"></a>D3.jsを用いることができるライブラリには<span class="co">[</span><span class="ot">`r2d3`</span><span class="co">](https://rstudio.github.io/r2d3/)[</span><span class="ot">@r2d3_bib</span><span class="co">]</span>もありますが、<span class="in">`r2d3`</span>との違いはネットワークの表記にのみ対応していることで、<span class="in">`r2d3`</span>でもネットワークを表記することはできます。ただし、<span class="in">`r2d3`</span>はデータの準備がかなり独特（<span class="co">[</span><span class="ot">`r2d3`のgithubページ</span><span class="co">](https://github.com/rstudio/r2d3/blob/main/vignettes/gallery/dendogram/flare.csv)</span>を参照。idの列にネットワークの情報を入力）ですので、<span class="in">`networkD3`</span>の方が比較的使いやすいでしょう。</span>
<span id="cb160-1945"><a href="#cb160-1945" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1946"><a href="#cb160-1946" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ライブラリの読み込み"}</span></span>
<span id="cb160-1947"><a href="#cb160-1947" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(networkD3)</span></span>
<span id="cb160-1948"><a href="#cb160-1948" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1949"><a href="#cb160-1949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1950"><a href="#cb160-1950" aria-hidden="true" tabindex="-1"></a><span class="fu">#### データの準備</span></span>
<span id="cb160-1951"><a href="#cb160-1951" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1952"><a href="#cb160-1952" aria-hidden="true" tabindex="-1"></a><span class="in">`networkD3`</span>でのグラフ表記には、nodeのデータフレームとedgeのデータフレームをそれぞれ独立に準備する必要があります。<span class="in">`igraph`</span>や<span class="in">`tidygraph`</span>のグラフオブジェクトを<span class="in">`networkD3`</span>で利用する場合には、<span class="in">`igraph_to_networkD3`</span>関数でデータをリストに変換します。この<span class="in">`igraph_to_networkD3`</span>関数は<span class="in">`igraph`</span>のオブジェクトをnodeのデータフレーム、edgeのデータフレーム（名前は<span class="in">`links`</span>）からなるリストに変換してくれるだけの関数です。<span class="in">`group`</span>引数を指定すると、元の<span class="in">`igraph`</span>オブジェクトのattributeやベクターをnodeのデータフレームに付け加えることもできます。</span>
<span id="cb160-1953"><a href="#cb160-1953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1954"><a href="#cb160-1954" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ファイルの準備"}</span></span>
<span id="cb160-1955"><a href="#cb160-1955" aria-hidden="true" tabindex="-1"></a><span class="in"># dとvtからネットワークを作成</span></span>
<span id="cb160-1956"><a href="#cb160-1956" aria-hidden="true" tabindex="-1"></a><span class="in">nara_stations &lt;- graph_from_data_frame(d, vertices = vt, directed = FALSE)</span></span>
<span id="cb160-1957"><a href="#cb160-1957" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1958"><a href="#cb160-1958" aria-hidden="true" tabindex="-1"></a><span class="in">ns_D3 &lt;- nara_stations |&gt; </span></span>
<span id="cb160-1959"><a href="#cb160-1959" aria-hidden="true" tabindex="-1"></a><span class="in">  igraph_to_networkD3(group = V(nara_stations)$linename)</span></span>
<span id="cb160-1960"><a href="#cb160-1960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1961"><a href="#cb160-1961" aria-hidden="true" tabindex="-1"></a><span class="in">ns_D3$links |&gt; head() # edge_listに似たデータフレーム</span></span>
<span id="cb160-1962"><a href="#cb160-1962" aria-hidden="true" tabindex="-1"></a><span class="in">ns_D3$nodes |&gt; head() # nodeをまとめたもの</span></span>
<span id="cb160-1963"><a href="#cb160-1963" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1964"><a href="#cb160-1964" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1965"><a href="#cb160-1965" aria-hidden="true" tabindex="-1"></a><span class="fu">#### simpleNetwork関数</span></span>
<span id="cb160-1966"><a href="#cb160-1966" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1967"><a href="#cb160-1967" aria-hidden="true" tabindex="-1"></a>最も簡単にネットワークを表示するための関数が、<span class="in">`simpleNetwork`</span>関数です。この関数の引数にedgeを示すデータフレームを設定するだけで、D3.jsを用いたネットワークを表示することができます。このグラフ上では、nodeをドラッグすることでnodeを移動させて表記することができます。</span>
<span id="cb160-1968"><a href="#cb160-1968" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1969"><a href="#cb160-1969" aria-hidden="true" tabindex="-1"></a>ただし、この<span class="in">`simpleNetwork`</span>をそのまま用いるとグラフが拡大されすぎて見えなかったり、nodeの意味がよくわからなくなったりします。グラフが拡大されて見にくい問題は引数に<span class="in">`zoom = TRUE`</span>することで拡大・縮小できるようにすることで対処できます。しかし、他の情報を表示するのにはこの<span class="in">`simpleNetwork`</span>関数は向いていません。</span>
<span id="cb160-1970"><a href="#cb160-1970" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1971"><a href="#cb160-1971" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="simpleNetwork関数"}</span></span>
<span id="cb160-1972"><a href="#cb160-1972" aria-hidden="true" tabindex="-1"></a><span class="in">simpleNetwork(ns_D3$links, zoom = TRUE)</span></span>
<span id="cb160-1973"><a href="#cb160-1973" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1974"><a href="#cb160-1974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1975"><a href="#cb160-1975" aria-hidden="true" tabindex="-1"></a><span class="fu">#### forceNetwork</span></span>
<span id="cb160-1976"><a href="#cb160-1976" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1977"><a href="#cb160-1977" aria-hidden="true" tabindex="-1"></a>もう少し情報を詰め込んだグラフを作成するための関数が<span class="in">`forceNetwork`</span>関数です。この関数ではedgeのデータフレーム（<span class="in">`Links`</span>引数）とnodeのデータフレーム（<span class="in">`Nodes`</span>引数）を別に指定することができます。</span>
<span id="cb160-1978"><a href="#cb160-1978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1979"><a href="#cb160-1979" aria-hidden="true" tabindex="-1"></a>この関数では、ネットワークの接続（edgelistに当たるもの）を<span class="in">`Source`</span>と<span class="in">`Target`</span>引数に、edgeの太さを<span class="in">`Value`</span>引数に、ノードに表示される名前を<span class="in">`NodeID`</span>引数に、色などのグループ分けを<span class="in">`Group`</span>引数に指定することで、比較的簡単に情報量の多いインタラクティブなグラフを作成することができます。</span>
<span id="cb160-1980"><a href="#cb160-1980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1981"><a href="#cb160-1981" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="forceNetwork関数"}</span></span>
<span id="cb160-1982"><a href="#cb160-1982" aria-hidden="true" tabindex="-1"></a><span class="in">forceNetwork(</span></span>
<span id="cb160-1983"><a href="#cb160-1983" aria-hidden="true" tabindex="-1"></a><span class="in">  Links = ns_D3$links,</span></span>
<span id="cb160-1984"><a href="#cb160-1984" aria-hidden="true" tabindex="-1"></a><span class="in">  Nodes = ns_D3$nodes,</span></span>
<span id="cb160-1985"><a href="#cb160-1985" aria-hidden="true" tabindex="-1"></a><span class="in">  Source = "source",</span></span>
<span id="cb160-1986"><a href="#cb160-1986" aria-hidden="true" tabindex="-1"></a><span class="in">  Target = "target",</span></span>
<span id="cb160-1987"><a href="#cb160-1987" aria-hidden="true" tabindex="-1"></a><span class="in">  NodeID = "name",</span></span>
<span id="cb160-1988"><a href="#cb160-1988" aria-hidden="true" tabindex="-1"></a><span class="in">  Group = "group",</span></span>
<span id="cb160-1989"><a href="#cb160-1989" aria-hidden="true" tabindex="-1"></a><span class="in">  fontSize = 30, zoom = TRUE</span></span>
<span id="cb160-1990"><a href="#cb160-1990" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb160-1991"><a href="#cb160-1991" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-1992"><a href="#cb160-1992" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1993"><a href="#cb160-1993" aria-hidden="true" tabindex="-1"></a><span class="fu">#### dendroNetwork</span></span>
<span id="cb160-1994"><a href="#cb160-1994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1995"><a href="#cb160-1995" aria-hidden="true" tabindex="-1"></a><span class="in">`dendroNetwork`</span>関数はネットワークではなく、階層ありクラスタリングの結果を表示するための関数です。引数に取れるのは<span class="in">`hclust`</span>関数の返り値（<span class="in">`hclust`</span>クラスのオブジェクト）だけです。<span class="in">`dendroNetwork`</span>関数を用いることで簡単にインタラクティブな階層ありクラスタリングの結果を表示することができます。</span>
<span id="cb160-1996"><a href="#cb160-1996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-1997"><a href="#cb160-1997" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="dendroNetwork関数"}</span></span>
<span id="cb160-1998"><a href="#cb160-1998" aria-hidden="true" tabindex="-1"></a><span class="in"># hclustクラスのオブジェクトをプロットする</span></span>
<span id="cb160-1999"><a href="#cb160-1999" aria-hidden="true" tabindex="-1"></a><span class="in">hc &lt;- hclust(dist(USArrests))</span></span>
<span id="cb160-2000"><a href="#cb160-2000" aria-hidden="true" tabindex="-1"></a><span class="in">dendroNetwork(hc)</span></span>
<span id="cb160-2001"><a href="#cb160-2001" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2002"><a href="#cb160-2002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2003"><a href="#cb160-2003" aria-hidden="true" tabindex="-1"></a><span class="fu">#### その他の関数</span></span>
<span id="cb160-2004"><a href="#cb160-2004" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2005"><a href="#cb160-2005" aria-hidden="true" tabindex="-1"></a><span class="in">`networkD3`</span>には上記の<span class="in">`forceNetwork`</span>、<span class="in">`dendroNetwork`</span>の他にも円形・階層型のグラフを表示することができる<span class="in">`radialNetwork`</span>関数や<span class="in">`diagonalNetwork`</span>関数、サンキー図を表示する<span class="in">`sankeyNetwork`</span>関数も備わっています。以下の例ではjsonを<span class="in">`jsonline::fromJSON`</span>関数でリストにして引数としていますが、<span class="in">`sankeyNetwork`</span>関数は上記の<span class="in">`forceNetwork`</span>と同様にedgeとnodeのデータフレームを引数に取ることもできます。</span>
<span id="cb160-2006"><a href="#cb160-2006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2007"><a href="#cb160-2007" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="radialNetwork関数"}</span></span>
<span id="cb160-2008"><a href="#cb160-2008" aria-hidden="true" tabindex="-1"></a><span class="in"># JSONのアドレスを読み込み</span></span>
<span id="cb160-2009"><a href="#cb160-2009" aria-hidden="true" tabindex="-1"></a><span class="in">URL &lt;- </span></span>
<span id="cb160-2010"><a href="#cb160-2010" aria-hidden="true" tabindex="-1"></a><span class="in">  "https://cdn.rawgit.com/christophergandrud/networkD3/master/JSONdata//flare.json"</span></span>
<span id="cb160-2011"><a href="#cb160-2011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2012"><a href="#cb160-2012" aria-hidden="true" tabindex="-1"></a><span class="in"># JSONをリストにする</span></span>
<span id="cb160-2013"><a href="#cb160-2013" aria-hidden="true" tabindex="-1"></a><span class="in">Flare &lt;- jsonlite::fromJSON(URL, simplifyDataFrame = FALSE)</span></span>
<span id="cb160-2014"><a href="#cb160-2014" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2015"><a href="#cb160-2015" aria-hidden="true" tabindex="-1"></a><span class="in"># ネットワークを表示</span></span>
<span id="cb160-2016"><a href="#cb160-2016" aria-hidden="true" tabindex="-1"></a><span class="in">radialNetwork(List = Flare, opacity = 0.9)</span></span>
<span id="cb160-2017"><a href="#cb160-2017" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2018"><a href="#cb160-2018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2019"><a href="#cb160-2019" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="diagonalNetwork関数"}</span></span>
<span id="cb160-2020"><a href="#cb160-2020" aria-hidden="true" tabindex="-1"></a><span class="in">diagonalNetwork(List = Flare, opacity = 0.9)</span></span>
<span id="cb160-2021"><a href="#cb160-2021" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2022"><a href="#cb160-2022" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2023"><a href="#cb160-2023" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="sankeyNetwork関数"}</span></span>
<span id="cb160-2024"><a href="#cb160-2024" aria-hidden="true" tabindex="-1"></a><span class="in"># sankeyNetwork（サンキー図）</span></span>
<span id="cb160-2025"><a href="#cb160-2025" aria-hidden="true" tabindex="-1"></a><span class="in">URL &lt;- </span></span>
<span id="cb160-2026"><a href="#cb160-2026" aria-hidden="true" tabindex="-1"></a><span class="in">  "https://cdn.rawgit.com/christophergandrud/networkD3/master/JSONdata/energy.json"</span></span>
<span id="cb160-2027"><a href="#cb160-2027" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2028"><a href="#cb160-2028" aria-hidden="true" tabindex="-1"></a><span class="in"># データはforceNetworkと同じように準備する（valueがlink側に必要）</span></span>
<span id="cb160-2029"><a href="#cb160-2029" aria-hidden="true" tabindex="-1"></a><span class="in">Energy &lt;- jsonlite::fromJSON(URL)</span></span>
<span id="cb160-2030"><a href="#cb160-2030" aria-hidden="true" tabindex="-1"></a><span class="in">Energy$links |&gt; head()</span></span>
<span id="cb160-2031"><a href="#cb160-2031" aria-hidden="true" tabindex="-1"></a><span class="in">Energy$nodes |&gt; head()</span></span>
<span id="cb160-2032"><a href="#cb160-2032" aria-hidden="true" tabindex="-1"></a><span class="in">sankeyNetwork(Links = Energy$links, Nodes = Energy$nodes, Source = "source",</span></span>
<span id="cb160-2033"><a href="#cb160-2033" aria-hidden="true" tabindex="-1"></a><span class="in">              Target = "target", Value = "value", NodeID = "name",</span></span>
<span id="cb160-2034"><a href="#cb160-2034" aria-hidden="true" tabindex="-1"></a><span class="in">              units = "TWh", fontSize = 12, nodeWidth = 30)</span></span>
<span id="cb160-2035"><a href="#cb160-2035" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2036"><a href="#cb160-2036" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2037"><a href="#cb160-2037" aria-hidden="true" tabindex="-1"></a><span class="fu">### visNetwork</span></span>
<span id="cb160-2038"><a href="#cb160-2038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2039"><a href="#cb160-2039" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">visNetwork</span><span class="co">](https://datastorm-open.github.io/visNetwork/)[</span><span class="ot">@visNetwork_bib</span><span class="co">]</span>はD3.jsとは異なるJavascriptのビジュアライゼーションライブラリである<span class="co">[</span><span class="ot">vis.js</span><span class="co">](https://visjs.org/)</span>を用いたインタラクティブなネットワーク描画に関するパッケージです。上記の<span class="in">`NetworkD3`</span>とは少し違う感じでネットワークが描画されるので、好みの方を用いるとよいでしょう。</span>
<span id="cb160-2040"><a href="#cb160-2040" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2041"><a href="#cb160-2041" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ライブラリの読み込み"}</span></span>
<span id="cb160-2042"><a href="#cb160-2042" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(visNetwork)</span></span>
<span id="cb160-2043"><a href="#cb160-2043" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2044"><a href="#cb160-2044" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2045"><a href="#cb160-2045" aria-hidden="true" tabindex="-1"></a><span class="fu">#### visNetwork関数</span></span>
<span id="cb160-2046"><a href="#cb160-2046" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2047"><a href="#cb160-2047" aria-hidden="true" tabindex="-1"></a><span class="in">`visNetwork`</span>関数は、<span class="in">`NetworkD3`</span>の<span class="in">`forceNetwork`</span>関数に近い使い勝手の関数で、<span class="in">`forceNetwork`</span>関数と同様にnodeとedgeのデータフレームを引数に取る関数です。ただし、<span class="in">`forceNetwork`</span>関数が引数で色やnode名の指定を行うのに対し、<span class="in">`visNetwork`</span>関数は引数に取ったデータフレームの列名に従ってネットワークを描画するという特徴があります。Rの他のグラフィックライブラリとは少し使い勝手が異なります。</span>
<span id="cb160-2048"><a href="#cb160-2048" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2049"><a href="#cb160-2049" aria-hidden="true" tabindex="-1"></a>nodeに指定するデータフレームには<span class="in">`id`</span>という名前の列が、edgeに指定するデータフレームには<span class="in">`from`</span>と<span class="in">`to`</span>という名前の列が必要です。この列名を読み取って、<span class="in">`visNetwork`</span>はグラフを描画します。</span>
<span id="cb160-2050"><a href="#cb160-2050" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2051"><a href="#cb160-2051" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="visNetwork関数"}</span></span>
<span id="cb160-2052"><a href="#cb160-2052" aria-hidden="true" tabindex="-1"></a><span class="in">d &lt;- read.csv("./data/chapter33_nara_stations.csv")</span></span>
<span id="cb160-2053"><a href="#cb160-2053" aria-hidden="true" tabindex="-1"></a><span class="in">vt &lt;- read.csv("./data/chapter33_nara_stations_vertex_list.csv")</span></span>
<span id="cb160-2054"><a href="#cb160-2054" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2055"><a href="#cb160-2055" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(d) &lt;- c("from", "to", "linename", "company")</span></span>
<span id="cb160-2056"><a href="#cb160-2056" aria-hidden="true" tabindex="-1"></a><span class="in">colnames(vt) &lt;- c("id", "lat", "lon", "linename", "company")</span></span>
<span id="cb160-2057"><a href="#cb160-2057" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2058"><a href="#cb160-2058" aria-hidden="true" tabindex="-1"></a><span class="in">visNetwork(nodes = vt, edges = d)</span></span>
<span id="cb160-2059"><a href="#cb160-2059" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2060"><a href="#cb160-2060" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2061"><a href="#cb160-2061" aria-hidden="true" tabindex="-1"></a><span class="in">`visNetwork`</span>関数にnodeとedgeを指定しただけでは、nodeをドラッグして位置を変えることができる程度で、nodeの情報などは表示されません。nodeをクリックしたときに表示される文字列は<span class="in">`title`</span>という列名に指定します。また、nodeの色を変える場合には、nodeに指定するデータフレームに<span class="in">`color`</span>という列が必要です。この<span class="in">`title`</span>や<span class="in">`color`</span>に指定された値・色を読み取って、<span class="in">`visNetwork`</span>関数はnodeの情報を変更します。</span>
<span id="cb160-2062"><a href="#cb160-2062" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2063"><a href="#cb160-2063" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="nodeの情報を指定する"}</span></span>
<span id="cb160-2064"><a href="#cb160-2064" aria-hidden="true" tabindex="-1"></a><span class="in">vt$title &lt;- vt$id # nodeをクリックしたときに表示する文字</span></span>
<span id="cb160-2065"><a href="#cb160-2065" aria-hidden="true" tabindex="-1"></a><span class="in">vt$color &lt;- if_else(vt$company == "JR", "red", "blue") # nodeの色</span></span>
<span id="cb160-2066"><a href="#cb160-2066" aria-hidden="true" tabindex="-1"></a><span class="in">visNetwork(nodes = vt, edges = d)</span></span>
<span id="cb160-2067"><a href="#cb160-2067" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb160-2068"><a href="#cb160-2068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2069"><a href="#cb160-2069" aria-hidden="true" tabindex="-1"></a>また、<span class="in">`visNetwork`</span>ではパイプ演算子（<span class="in">`%&gt;%`</span>や<span class="in">`|&gt;`</span>）を用いてグラフの要素を追加することもできます。<span class="in">`visNodes`</span>関数をパイプで繋ぐことでnodeの編集、<span class="in">`visOptions`</span>をパイプで繋ぐことでオプション設定の変更を行うこともできます。</span>
<span id="cb160-2070"><a href="#cb160-2070" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb160-2071"><a href="#cb160-2071" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="パイプ演算子でグラフを編集する"}</span></span>
<span id="cb160-2072"><a href="#cb160-2072" aria-hidden="true" tabindex="-1"></a><span class="in">visNetwork(nodes = vt, edges = d) |&gt; </span></span>
<span id="cb160-2073"><a href="#cb160-2073" aria-hidden="true" tabindex="-1"></a><span class="in">  visNodes(shape = "square") |&gt; </span></span>
<span id="cb160-2074"><a href="#cb160-2074" aria-hidden="true" tabindex="-1"></a><span class="in">  # クリックすると連結したノードがハイライトされる</span></span>
<span id="cb160-2075"><a href="#cb160-2075" aria-hidden="true" tabindex="-1"></a><span class="in">  visOptions(highlightNearest = TRUE) </span></span>
<span id="cb160-2076"><a href="#cb160-2076" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://quarto.org/">Quarto</a>を用いてこの本を作成しました</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"loop":false,"selector":".lightbox","descPosition":"bottom","openEffect":"zoom","closeEffect":"zoom"});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>