<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.553">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>R入門 - 29&nbsp; 時系列分析</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./chapter30.html" rel="next">
<link href="./chapter28.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script src="site_libs/quarto-contrib/glightbox/glightbox.min.js"></script>
<link href="site_libs/quarto-contrib/glightbox/glightbox.min.css" rel="stylesheet">
<link href="site_libs/quarto-contrib/glightbox/lightbox.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<link href="site_libs/htmltools-fill-0.5.8.1/fill.css" rel="stylesheet">

<script src="site_libs/htmlwidgets-1.6.4/htmlwidgets.js"></script>

<script src="site_libs/plotly-binding-4.10.4/plotly.js"></script>

<script src="site_libs/typedarray-0.1/typedarray.min.js"></script>

<script src="site_libs/jquery-3.5.1/jquery.min.js"></script>

<link href="site_libs/crosstalk-1.2.1/css/crosstalk.min.css" rel="stylesheet">

<script src="site_libs/crosstalk-1.2.1/js/crosstalk.min.js"></script>

<link href="site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css" rel="stylesheet">

<script src="site_libs/plotly-main-2.11.1/plotly-latest.min.js"></script>


  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar docked">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter24.html">統計解析の基礎</a></li><li class="breadcrumb-item"><a href="./chapter29.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">時系列分析</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">R入門</a> 
        <div class="sidebar-tools-main">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">はじめに</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Rプログラミングの基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Rのインストール</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Rを使ってみよう</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter3.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">オブジェクトと変数・定数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter4.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">条件判断（Control structures）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter5.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">繰り返し文（Looping）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter6.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">ライブラリ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter7.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">エラー処理（error handler）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter8.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">数値</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter9.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">文字列</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter10.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">因子（factor）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter11.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">ベクター</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter12.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">リスト・データフレーム・行列</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter13.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">データの読み込みと書き出し（I/O）</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter14.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">データセット</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Rでのデータの取り扱い</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter15.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">15</span>&nbsp; <span class="chapter-title">apply関数群</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter16.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">16</span>&nbsp; <span class="chapter-title">tidyr・dplyr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter17.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">17</span>&nbsp; <span class="chapter-title">日時データの取り扱い</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter18.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">18</span>&nbsp; <span class="chapter-title">オブジェクト指向とクラス</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter19.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">19</span>&nbsp; <span class="chapter-title">コーディング規約</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true">
 <span class="menu-text">Rでのグラフ作成</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter20.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">20</span>&nbsp; <span class="chapter-title">グラフ作成：高レベルグラフィック関数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter21.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">21</span>&nbsp; <span class="chapter-title">グラフ作成：低レベルグラフィック関数とグラフィックパラメータ</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter22.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">22</span>&nbsp; <span class="chapter-title">ggplot2</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter23.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">23</span>&nbsp; <span class="chapter-title">plotly</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true">
 <span class="menu-text">統計解析の基礎</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter24.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">24</span>&nbsp; <span class="chapter-title">確率分布と乱数</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter25.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">25</span>&nbsp; <span class="chapter-title">検定</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter26.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">26</span>&nbsp; <span class="chapter-title">相関と回帰</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter27.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">27</span>&nbsp; <span class="chapter-title">分類</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter28.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">教師なし学習</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter29.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">時系列分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter30.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">生存時間解析</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true">
 <span class="menu-text">アドバンスな手法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter31.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">31</span>&nbsp; <span class="chapter-title">purrr</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter32.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">32</span>&nbsp; <span class="chapter-title">地理空間情報</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter33.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">33</span>&nbsp; <span class="chapter-title">ネットワーク解析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter34.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">34</span>&nbsp; <span class="chapter-title">R markdown・Quarto</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./chapter35.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">35</span>&nbsp; <span class="chapter-title">Shiny</span></span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./summary.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">おわりに</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active" data-toc-expanded="2">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#ホワイトノイズ" id="toc-ホワイトノイズ" class="nav-link active" data-scroll-target="#ホワイトノイズ"><span class="header-section-number">29.1</span> ホワイトノイズ</a></li>
  <li><a href="#ランダムウォーク" id="toc-ランダムウォーク" class="nav-link" data-scroll-target="#ランダムウォーク"><span class="header-section-number">29.2</span> ランダムウォーク</a></li>
  <li><a href="#季節性" id="toc-季節性" class="nav-link" data-scroll-target="#季節性"><span class="header-section-number">29.3</span> 季節性</a></li>
  <li><a href="#トレンド" id="toc-トレンド" class="nav-link" data-scroll-target="#トレンド"><span class="header-section-number">29.4</span> トレンド</a>
  <ul>
  <li><a href="#tsstudioパッケージで季節性トレンドを図示" id="toc-tsstudioパッケージで季節性トレンドを図示" class="nav-link" data-scroll-target="#tsstudioパッケージで季節性トレンドを図示"><span class="header-section-number">29.4.1</span> TSstudioパッケージで季節性・トレンドを図示</a></li>
  </ul></li>
  <li><a href="#定常性" id="toc-定常性" class="nav-link" data-scroll-target="#定常性"><span class="header-section-number">29.5</span> 定常性</a></li>
  <li><a href="#自己回帰arモデル" id="toc-自己回帰arモデル" class="nav-link" data-scroll-target="#自己回帰arモデル"><span class="header-section-number">29.6</span> 自己回帰（AR）モデル</a></li>
  <li><a href="#自己相関と偏自己相関" id="toc-自己相関と偏自己相関" class="nav-link" data-scroll-target="#自己相関と偏自己相関"><span class="header-section-number">29.7</span> 自己相関と偏自己相関</a>
  <ul>
  <li><a href="#acfpacf関数" id="toc-acfpacf関数" class="nav-link" data-scroll-target="#acfpacf関数"><span class="header-section-number">29.7.1</span> acf、pacf関数</a></li>
  <li><a href="#ar関数でモデルを推定" id="toc-ar関数でモデルを推定" class="nav-link" data-scroll-target="#ar関数でモデルを推定"><span class="header-section-number">29.7.2</span> ar関数でモデルを推定</a></li>
  </ul></li>
  <li><a href="#移動平均" id="toc-移動平均" class="nav-link" data-scroll-target="#移動平均"><span class="header-section-number">29.8</span> 移動平均</a></li>
  <li><a href="#maモデル" id="toc-maモデル" class="nav-link" data-scroll-target="#maモデル"><span class="header-section-number">29.9</span> MAモデル</a></li>
  <li><a href="#単位根過程と反転可能性" id="toc-単位根過程と反転可能性" class="nav-link" data-scroll-target="#単位根過程と反転可能性"><span class="header-section-number">29.10</span> 単位根過程と反転可能性</a>
  <ul>
  <li><a href="#単位根過程" id="toc-単位根過程" class="nav-link" data-scroll-target="#単位根過程"><span class="header-section-number">29.10.1</span> 単位根過程</a></li>
  <li><a href="#独立な単位根過程同士で相関を取る" id="toc-独立な単位根過程同士で相関を取る" class="nav-link" data-scroll-target="#独立な単位根過程同士で相関を取る"><span class="header-section-number">29.10.2</span> 独立な単位根過程同士で相関を取る</a></li>
  <li><a href="#単位根検定" id="toc-単位根検定" class="nav-link" data-scroll-target="#単位根検定"><span class="header-section-number">29.10.3</span> 単位根検定</a></li>
  <li><a href="#反転可能性" id="toc-反転可能性" class="nav-link" data-scroll-target="#反転可能性"><span class="header-section-number">29.10.4</span> 反転可能性</a></li>
  </ul></li>
  <li><a href="#armaモデル" id="toc-armaモデル" class="nav-link" data-scroll-target="#armaモデル"><span class="header-section-number">29.11</span> ARMAモデル</a></li>
  <li><a href="#arimaモデル" id="toc-arimaモデル" class="nav-link" data-scroll-target="#arimaモデル"><span class="header-section-number">29.12</span> ARIMAモデル</a>
  <ul>
  <li><a href="#arimaモデルを用いた予測" id="toc-arimaモデルを用いた予測" class="nav-link" data-scroll-target="#arimaモデルを用いた予測"><span class="header-section-number">29.12.1</span> ARIMAモデルを用いた予測</a></li>
  </ul></li>
  <li><a href="#arima以外の時系列分析手法" id="toc-arima以外の時系列分析手法" class="nav-link" data-scroll-target="#arima以外の時系列分析手法"><span class="header-section-number">29.13</span> ARIMA以外の時系列分析手法</a></li>
  <li><a href="#時系列の要素を分離する" id="toc-時系列の要素を分離する" class="nav-link" data-scroll-target="#時系列の要素を分離する"><span class="header-section-number">29.14</span> 時系列の要素を分離する</a></li>
  <li><a href="#状態空間モデル" id="toc-状態空間モデル" class="nav-link" data-scroll-target="#状態空間モデル"><span class="header-section-number">29.15</span> 状態空間モデル</a>
  <ul>
  <li><a href="#カルマンフィルタ" id="toc-カルマンフィルタ" class="nav-link" data-scroll-target="#カルマンフィルタ"><span class="header-section-number">29.15.1</span> カルマンフィルタ</a></li>
  <li><a href="#stan" id="toc-stan" class="nav-link" data-scroll-target="#stan"><span class="header-section-number">29.15.2</span> Stan</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./chapter24.html">統計解析の基礎</a></li><li class="breadcrumb-item"><a href="./chapter29.html"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">時系列分析</span></a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title"><span class="chapter-number">29</span>&nbsp; <span class="chapter-title">時系列分析</span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><strong>時系列</strong>とは、<a href="./chapter17.html">17章</a>で少し説明した通り、時間と共に変化する量を繰り返し測定したデータのことです。例えば、日経平均株価の推移は典型的な時系列の例です。Rでは、以下に示す<code>Nile</code>データセットが時系列の例としてよく用いられています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>時系列データの例：Nileデータセット</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>Nile <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-1-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-1"><img src="chapter29_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>Nile</code>はナイル川の水量を1871～1970年にかけて測定したデータです。各時点（各年）には、その時点の数値が登録されています。<code>Nile</code>では時間間隔は1年おきと一定で、取得されたデータは1種類（ナイル川の水量）です。</p>
<p>時系列データは<code>Nile</code>のように時間間隔が一定で1種類のデータとなる場合が多いです。ただし、時間間隔が一定ではない場合や、データの抜けがある場合（休業時間帯や休日などでデータが取れなかったりする場合）、目的とするデータ（目的変数）だけでなく、目的変数を説明するためのデータ（説明変数）を含んでいる場合もあります。このような違いがあっても、いずれも時系列データとして取り扱われます。</p>
<p>このような時系列データを取り扱い、分析する統計方法のことを、<strong>時系列分析</strong>と呼びます。時系列分析には時系列分析のみを取り扱う教科書がたくさん出ており、ココですべてを説明することはできません。説明は基礎の要点のみとし、Rでの統計手法の利用方法の説明にとどめます。</p>
<p>まずは、典型的な時系列データの例として、<strong>ホワイトノイズ</strong>と<strong>ランダムウォーク</strong>について説明します。</p>
<section id="ホワイトノイズ" class="level2" data-number="29.1">
<h2 data-number="29.1" class="anchored" data-anchor-id="ホワイトノイズ"><span class="header-section-number">29.1</span> ホワイトノイズ</h2>
<p>測定したすべての期間の平均値が一定で、一定の分散（標準偏差、ばらつき）を持つ時系列データのことを、<strong>ホワイトノイズ</strong>と呼びます。典型的なホワイトノイズの例はラジオやテレビのノイズです。ホワイトノイズを数式で表すと以下のようになります。</p>
<p><span class="math display">\[y_{t}=c+\epsilon_{t}\]</span></p>
<p>y<sub>t</sub>は時点tにおける値、cは切片、ε<sub>t</sub>は下に示すように、平均0、標準偏差σの正規分布に従う誤差項です。cが0であれば、y<sub>t</sub>は平均0、標準偏差σの正規分布に従うランダムな値となります。</p>
<p><span class="math display">\[\epsilon_{t} \sim Normal(0, \sigma) \]</span></p>
<p>ホワイトノイズをグラフで示したものが以下の図です。時間<code>t</code>に伴い<code>y</code>の値は上下に揺れますが、平均すると概ね一定で、ばらつきの幅も一定となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ホワイトノイズ</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>)</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">200</span>, <span class="dv">0</span>, <span class="fl">0.5</span>)</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(t, y),</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y)</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-2-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-2"><img src="chapter29_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="ランダムウォーク" class="level2" data-number="29.2">
<h2 data-number="29.2" class="anchored" data-anchor-id="ランダムウォーク"><span class="header-section-number">29.2</span> ランダムウォーク</h2>
<p>上に示したε<sub>t</sub>を時間tまで合計し、切片項cを足したものを<strong>ランダムウォーク</strong>と呼びます。ランダムウォークはその名の通り、上にふらふら、下にふらふら移動する、予想のつきにくい変動をする時系列データです。ランダムウォークの時系列は以下の式で表すことができます。</p>
<p><span class="math display">\[y_{t}=c+\sum_{i=1}^{t} \epsilon_{i}\]</span></p>
<p>ランダムウォークは時点tと時点t-1の値の<strong>差分系列</strong>（1階差分、<span class="math inline">\(y_{t}-y_{t-1}\)</span>）を取ると、ε<sub>t</sub>、つまりホワイトノイズになるという性質を持ちます。</p>
<p><span class="math display">\[y_{t} - y_{t-1}=\epsilon_{t}\]</span></p>
<p>ランダムウォークをグラフで示したものが以下の図です。値が上下にギザギザと動くだけでなく、時に大きく値が変動します。ランダムウォークでは平均値が一定とならず、分散も一定とはなりません。株価や為替変動などが典型的なランダムウォークの時系列データの例です。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ランダムウォーク</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>y1 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> temp <span class="sc">+</span> y[i]</span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  y1 <span class="ot">&lt;-</span> <span class="fu">c</span>(y1, temp)</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(t, y1),</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y1)</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-3-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-3"><img src="chapter29_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="季節性" class="level2" data-number="29.3">
<h2 data-number="29.3" class="anchored" data-anchor-id="季節性"><span class="header-section-number">29.3</span> 季節性</h2>
<p>時系列には、一定の周期ごとに値が似ている場合があります。例えば、アイスクリームの売上には夏に高く、冬に低いような周期があります。このような周期性のことを、<strong>季節性</strong>と呼びます。季節性には色々な形のものがあり、年次の周期（4半期周期や12ヶ月周期）、週の周期（曜日ごとの周期）などがあります。季節性のあるデータは、ランダムなばらつきを持ちつつ、ある周期で上下する、以下の図のような変動を持ちます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>季節性</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 季節性ありのデータ</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>ys <span class="ot">&lt;-</span> y <span class="sc">+</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.5</span>, <span class="fl">1.5</span>, <span class="fl">2.5</span>, <span class="dv">3</span>, <span class="fl">2.5</span>, <span class="fl">1.5</span>, <span class="fl">0.5</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="dv">10</span>)</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(t, ys),</span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> ys)</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-4-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-4"><img src="chapter29_files/figure-html/unnamed-chunk-4-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
<section id="トレンド" class="level2" data-number="29.4">
<h2 data-number="29.4" class="anchored" data-anchor-id="トレンド"><span class="header-section-number">29.4</span> トレンド</h2>
<p>時系列データには、時間とともに徐々に値が大きくなったり小さくなったりするものがあります。例えば、<a href="https://www.kaggle.com/datasets/mnassrib/dow-jones-industrial-average">ダウ平均株価</a>を2000年ぐらいから調べると、下の図のようにその値が徐々に大きくなっていることがわかるかと思います。このような、時間とともに徐々に上昇・下降していくような傾向のことを<strong>トレンド</strong>と呼びます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>トレンドを持つデータ：ダウ平均株価の推移</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co"># kaggleよりデータを取得</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="co">#（https://www.kaggle.com/datasets/mnassrib/dow-jones-industrial-average）</span></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>djm <span class="ot">&lt;-</span> <span class="fu">read_csv</span>(<span class="st">"./data/Dow Jones Industrial Average Historical Data.csv"</span>)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a><span class="do">## Rows: 2766 Columns: 7</span></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a><span class="do">## ── Column specification ────────────────────────────────────────────────────────</span></span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Delimiter: ","</span></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="do">## chr (3): Date, Vol., Change %</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a><span class="do">## num (4): Price, Open, High, Low</span></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="do">## ℹ Use `spec()` to retrieve the full column specification for this data.</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="do">## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>djm<span class="sc">$</span>Date <span class="ot">&lt;-</span> lubridate<span class="sc">::</span><span class="fu">mdy</span>(djm<span class="sc">$</span>Date)</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a>djm<span class="sc">$</span>Price <span class="ot">&lt;-</span> djm<span class="sc">$</span>Price <span class="sc">|&gt;</span> <span class="fu">str_remove_all</span>(<span class="st">","</span>) <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(djm, <span class="fu">aes</span>(<span class="at">x =</span> Date, <span class="at">y =</span> Price))<span class="sc">+</span></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-5-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-5"><img src="chapter29_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>トレンドを持つデータは、季節性やホワイトノイズに時間とともに変化するような関数を足し合わせたような形を持つ、以下のようなデータとなります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>トレンド</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>yt <span class="ot">&lt;-</span> ys <span class="sc">+</span> t <span class="sc">*</span> <span class="fl">0.1</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">data.frame</span>(t, yt),</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> yt)</span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a>)<span class="sc">+</span></span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-6-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-6"><img src="chapter29_files/figure-html/unnamed-chunk-6-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<section id="tsstudioパッケージで季節性トレンドを図示" class="level3" data-number="29.4.1">
<h3 data-number="29.4.1" class="anchored" data-anchor-id="tsstudioパッケージで季節性トレンドを図示"><span class="header-section-number">29.4.1</span> TSstudioパッケージで季節性・トレンドを図示</h3>
<p>季節性とトレンドを持つデータの例としては、大気中二酸化炭素（CO<sub>2</sub>）濃度の変化があります。</p>
<p>1950年頃からマウナロア（ハワイの活火山）で大気中CO<sub>2</sub>濃度が<a href="https://gml.noaa.gov/ccgg/trends/weekly.html">データとして取得</a>されており、Rでは<code>co2</code>データセットとして登録されています。<code>co2</code>は1959～1997年の毎月のCO<sub>2</sub>濃度を記録したデータセットで、単位はppm（μmol/mol）です。</p>
<p>大気中のCO<sub>2</sub>濃度は、北半球の夏に合わせて減少し、冬に合わせて増加する傾向があります（実際には少し遅れて、10月頃に最小、5月頃に最大となります）。これは、北半球の針葉樹林（タイガ）のCO<sub>2</sub>吸収量が夏季に大きく、冬季に小さくなるためです。また、CO<sub>2</sub>濃度は化石燃料の消費と共に増加しており、20世紀末で360ppm、2023年時点では420ppm程度になっています。1960～2000年の伸びが50ppm程度ですので、CO<sub>2</sub>の増加が倍程度に加速していることがわかります。この「夏季に低く冬季に高い」傾向が季節性、「化石燃料の消費と共に増加」の部分がトレンドに当たります。</p>
<p><a href="https://ramikrispin.github.io/TSstudio/"><code>TSstudio</code></a>パッケージ<span class="citation" data-cites="TSstudio_bib">(<a href="references.html#ref-TSstudio_bib" role="doc-biblioref">Krispin 2023</a>)</span>は時系列データを<code>plotly</code>を用いてグラフにする関数を備えたライブラリです。<code>ts_plot</code>関数は時系列をそのままプロットする、<code>ts_seasonal</code>関数は季節ごとの値を、<code>ts_heatmap</code>は年と月の季節性をそれぞれヒートマップとして表示する関数です。いずれも季節性やトレンドを持つデータをグラフにする、データの傾向を捉える場合に便利な関数です。いずれも<a href="./chapter17.html">17章</a>で紹介した<code>ts</code>クラスの時系列データを引数に取ります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>co2データセット：TSstudioの関数で季節性データを表示</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">|&gt;</span> <span class="fu">class</span>() <span class="co"># tsクラスのオブジェクト</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] "ts"</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(TSstudio)</span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">|&gt;</span> <span class="fu">ts_plot</span>() <span class="co"># 時系列をplotlyでプロット</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-d9ac6052d99643cff0da" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-d9ac6052d99643cff0da">{"x":{"visdat":{"1bd0421b4aa2":["function () ","plotlyVisDat"]},"cur_data":"1bd0421b4aa2","attrs":{"1bd0421b4aa2":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"xaxis":{"domain":[0,1],"automargin":true,"title":"","showgrid":false},"yaxis":{"domain":[0,1],"automargin":true,"title":"","showgrid":false},"title":"co2","hovermode":"closest","showlegend":false},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":[1959,1959.0833333333405,1959.1666666666808,1959.2500000000214,1959.3333333333619,1959.4166666667024,1959.5000000000427,1959.5833333333833,1959.6666666667238,1959.7500000000643,1959.8333333334047,1959.9166666667452,1960,1960.083333333426,1960.1666666667666,1960.2500000001071,1960.3333333334476,1960.4166666667879,1960.5000000001285,1960.583333333469,1960.6666666668095,1960.7500000001498,1960.8333333334904,1960.9166666668309,1961,1961.0833333335117,1961.1666666668523,1961.2500000001928,1961.3333333335331,1961.4166666668737,1961.5000000002142,1961.5833333335547,1961.666666666895,1961.7500000002356,1961.8333333335761,1961.9166666669164,1962,1962.0833333335975,1962.166666666938,1962.2500000002783,1962.3333333336188,1962.4166666669594,1962.5000000002997,1962.5833333336402,1962.6666666669807,1962.7500000003213,1962.8333333336616,1962.9166666670021,1963,1963.0833333336832,1963.1666666670235,1963.250000000364,1963.3333333337046,1963.4166666670449,1963.5000000003854,1963.5833333337259,1963.6666666670665,1963.7500000004068,1963.8333333337473,1963.9166666670878,1964,1964.0833333337687,1964.1666666671092,1964.2500000004497,1964.3333333337901,1964.4166666671306,1964.5000000004711,1964.5833333338117,1964.666666667152,1964.7500000004925,1964.833333333833,1964.9166666671736,1965,1965.0833333338544,1965.1666666671949,1965.2500000005352,1965.3333333338758,1965.4166666672163,1965.5000000005568,1965.5833333338971,1965.6666666672377,1965.7500000005782,1965.8333333339187,1965.9166666672591,1966,1966.0833333339401,1966.1666666672804,1966.250000000621,1966.3333333339615,1966.416666667302,1966.5000000006423,1966.5833333339829,1966.6666666673234,1966.7500000006639,1966.8333333340042,1966.9166666673448,1967,1967.0833333340256,1967.1666666673661,1967.2500000007067,1967.3333333340472,1967.4166666673875,1967.5000000007281,1967.5833333340686,1967.6666666674089,1967.7500000007494,1967.83333333409,1967.9166666674305,1968,1968.0833333341113,1968.1666666674519,1968.2500000007924,1968.3333333341327,1968.4166666674732,1968.5000000008138,1968.5833333341541,1968.6666666674946,1968.7500000008351,1968.8333333341757,1968.916666667516,1969,1969.0833333341971,1969.1666666675376,1969.2500000008779,1969.3333333342184,1969.416666667559,1969.5000000008993,1969.5833333342398,1969.6666666675803,1969.7500000009209,1969.8333333342612,1969.9166666676017,1970,1970.0833333342828,1970.1666666676231,1970.2500000009636,1970.3333333343041,1970.4166666676444,1970.500000000985,1970.5833333343255,1970.666666667666,1970.7500000010064,1970.8333333343469,1970.9166666676874,1971,1971.0833333343683,1971.1666666677088,1971.2500000010493,1971.3333333343896,1971.4166666677302,1971.5000000010707,1971.5833333344112,1971.6666666677515,1971.7500000010921,1971.8333333344326,1971.9166666677731,1972,1972.083333334454,1972.1666666677945,1972.2500000011348,1972.3333333344754,1972.4166666678159,1972.5000000011564,1972.5833333344967,1972.6666666678373,1972.7500000011778,1972.8333333345181,1972.9166666678586,1973,1973.0833333345397,1973.16666666788,1973.2500000012205,1973.3333333345611,1973.4166666679016,1973.5000000012419,1973.5833333345824,1973.666666667923,1973.7500000012633,1973.8333333346038,1973.9166666679444,1974,1974.0833333346252,1974.1666666679657,1974.2500000013063,1974.3333333346468,1974.4166666679871,1974.5000000013276,1974.5833333346682,1974.6666666680085,1974.750000001349,1974.8333333346895,1974.9166666680301,1975,1975.0833333347109,1975.1666666680514,1975.250000001392,1975.3333333347323,1975.4166666680728,1975.5000000014134,1975.5833333347537,1975.6666666680942,1975.7500000014347,1975.8333333347753,1975.9166666681156,1976,1976.0833333347966,1976.1666666681372,1976.2500000014775,1976.333333334818,1976.4166666681585,1976.5000000014988,1976.5833333348394,1976.6666666681799,1976.7500000015204,1976.8333333348608,1976.9166666682013,1977,1977.0833333348824,1977.1666666682227,1977.2500000015632,1977.3333333349037,1977.416666668244,1977.5000000015846,1977.5833333349251,1977.6666666682656,1977.7500000016059,1977.8333333349465,1977.916666668287,1978,1978.0833333349678,1978.1666666683084,1978.2500000016489,1978.3333333349892,1978.4166666683298,1978.5000000016703,1978.5833333350108,1978.6666666683511,1978.7500000016917,1978.8333333350322,1978.9166666683725,1979,1979.0833333350536,1979.1666666683941,1979.2500000017344,1979.3333333350749,1979.4166666684155,1979.500000001756,1979.5833333350963,1979.6666666684368,1979.7500000017774,1979.8333333351177,1979.9166666684582,1980,1980.0833333351393,1980.1666666684796,1980.2500000018201,1980.3333333351607,1980.4166666685012,1980.5000000018415,1980.583333335182,1980.6666666685226,1980.7500000018629,1980.8333333352034,1980.9166666685439,1981,1981.0833333352248,1981.1666666685653,1981.2500000019058,1981.3333333352464,1981.4166666685867,1981.5000000019272,1981.5833333352678,1981.6666666686081,1981.7500000019486,1981.8333333352891,1981.9166666686297,1982,1982.0833333353105,1982.166666668651,1982.2500000019916,1982.3333333353319,1982.4166666686724,1982.5000000020129,1982.5833333353532,1982.6666666686938,1982.7500000020343,1982.8333333353748,1982.9166666687152,1983,1983.0833333353962,1983.1666666687368,1983.2500000020771,1983.3333333354176,1983.4166666687581,1983.5000000020984,1983.583333335439,1983.6666666687795,1983.75000000212,1983.8333333354603,1983.9166666688009,1984,1984.0833333354817,1984.1666666688222,1984.2500000021628,1984.3333333355033,1984.4166666688436,1984.5000000021842,1984.5833333355247,1984.6666666688652,1984.7500000022055,1984.8333333355461,1984.9166666688866,1985,1985.0833333355674,1985.166666668908,1985.2500000022485,1985.3333333355888,1985.4166666689293,1985.5000000022699,1985.5833333356104,1985.6666666689507,1985.7500000022912,1985.8333333356318,1985.9166666689721,1986,1986.0833333356532,1986.1666666689937,1986.250000002334,1986.3333333356745,1986.4166666690151,1986.5000000023556,1986.5833333356959,1986.6666666690364,1986.750000002377,1986.8333333357173,1986.9166666690578,1987,1987.0833333357389,1987.1666666690792,1987.2500000024197,1987.3333333357602,1987.4166666691008,1987.5000000024411,1987.5833333357816,1987.6666666691222,1987.7500000024625,1987.833333335803,1987.9166666691435,1988,1988.0833333358244,1988.1666666691649,1988.2500000025054,1988.333333335846,1988.4166666691863,1988.5000000025268,1988.5833333358673,1988.6666666692076,1988.7500000025482,1988.8333333358887,1988.9166666692292,1989,1989.0833333359101,1989.1666666692506,1989.2500000025912,1989.3333333359315,1989.416666669272,1989.5000000026125,1989.5833333359528,1989.6666666692934,1989.7500000026339,1989.8333333359744,1989.9166666693147,1990,1990.0833333359958,1990.1666666693361,1990.2500000026766,1990.3333333360172,1990.4166666693577,1990.500000002698,1990.5833333360385,1990.6666666693791,1990.7500000027196,1990.8333333360599,1990.9166666694005,1991,1991.0833333360813,1991.1666666694218,1991.2500000027624,1991.3333333361029,1991.4166666694432,1991.5000000027837,1991.5833333361243,1991.6666666694648,1991.7500000028051,1991.8333333361456,1991.9166666694862,1992,1992.083333336167,1992.1666666695075,1992.2500000028481,1992.3333333361884,1992.4166666695289,1992.5000000028695,1992.58333333621,1992.6666666695503,1992.7500000028908,1992.8333333362314,1992.9166666695717,1993,1993.0833333362527,1993.1666666695933,1993.2500000029336,1993.3333333362741,1993.4166666696146,1993.5000000029552,1993.5833333362955,1993.666666669636,1993.7500000029765,1993.8333333363169,1993.9166666696574,1994,1994.0833333363385,1994.1666666696788,1994.2500000030193,1994.3333333363598,1994.4166666697001,1994.5000000030407,1994.5833333363812,1994.6666666697217,1994.750000003062,1994.8333333364026,1994.9166666697431,1995,1995.0833333364239,1995.1666666697645,1995.250000003105,1995.3333333364453,1995.4166666697859,1995.5000000031264,1995.5833333364669,1995.6666666698072,1995.7500000031478,1995.8333333364883,1995.9166666698288,1996,1996.0833333365097,1996.1666666698502,1996.2500000031905,1996.333333336531,1996.4166666698716,1996.5000000032121,1996.5833333365524,1996.6666666698929,1996.7500000032335,1996.833333336574,1996.9166666699143,1997,1997.0833333365954,1997.1666666699357,1997.2500000032762,1997.3333333366168,1997.4166666699573,1997.5000000032976,1997.5833333366381,1997.6666666699787,1997.7500000033192,1997.8333333366595,1997.91666667],"y":[315.42000000000002,316.31,316.5,317.56,318.13,318,316.38999999999999,314.64999999999998,313.68000000000001,313.18000000000001,314.66000000000003,315.43000000000001,316.26999999999998,316.81,317.42000000000002,318.87,319.87,319.43000000000001,318.00999999999999,315.74000000000001,314,313.68000000000001,314.83999999999997,316.02999999999997,316.73000000000002,317.54000000000002,318.38,319.31,320.42000000000002,319.61000000000001,318.42000000000002,316.63,314.82999999999998,315.16000000000003,315.94,316.85000000000002,317.77999999999997,318.39999999999998,319.52999999999997,320.42000000000002,320.85000000000002,320.44999999999999,319.44999999999999,317.25,316.11000000000001,315.26999999999998,316.52999999999997,317.52999999999997,318.57999999999998,318.92000000000002,319.69999999999999,321.22000000000003,322.07999999999998,321.31,319.57999999999998,317.61000000000001,316.05000000000001,315.82999999999998,316.91000000000003,318.19999999999999,319.41000000000003,320.06999999999999,320.74000000000001,321.39999999999998,322.06,321.73000000000002,320.26999999999998,318.54000000000002,316.54000000000002,316.70999999999998,317.52999999999997,318.55000000000001,319.26999999999998,320.27999999999997,320.73000000000002,321.97000000000003,322,321.70999999999998,321.05000000000001,318.70999999999998,317.66000000000003,317.13999999999999,318.69999999999999,319.25,320.45999999999998,321.43000000000001,322.23000000000002,323.54000000000002,323.91000000000003,323.58999999999997,322.24000000000001,320.19999999999999,318.48000000000002,317.94,319.63,320.87,322.17000000000002,322.33999999999997,322.88,324.25,324.82999999999998,323.93000000000001,322.38,320.75999999999999,319.10000000000002,319.24000000000001,320.56,321.80000000000001,322.39999999999998,322.99000000000001,323.73000000000002,324.86000000000001,325.39999999999998,325.19999999999999,323.98000000000002,321.94999999999999,320.18000000000001,320.08999999999997,321.16000000000003,322.74000000000001,323.82999999999998,324.25999999999999,325.47000000000003,326.5,327.20999999999998,326.54000000000002,325.72000000000003,323.5,322.22000000000003,321.62,322.69,323.94999999999999,324.88999999999999,325.81999999999999,326.76999999999998,327.97000000000003,327.91000000000003,327.5,326.18000000000001,324.52999999999997,322.93000000000001,322.89999999999998,323.85000000000002,324.95999999999998,326.00999999999999,326.50999999999999,327.00999999999999,327.62,328.75999999999999,328.39999999999998,327.19999999999999,325.26999999999998,323.19999999999999,323.39999999999998,324.63,325.85000000000002,326.60000000000002,327.47000000000003,327.57999999999998,329.56,329.89999999999998,328.92000000000002,327.88,326.16000000000003,324.68000000000001,325.04000000000002,326.33999999999997,327.38999999999999,328.37,329.39999999999998,330.13999999999999,331.32999999999998,332.31,331.89999999999998,330.69999999999999,329.14999999999998,327.35000000000002,327.01999999999998,327.99000000000001,328.48000000000002,329.18000000000001,330.55000000000001,331.31999999999999,332.48000000000002,332.92000000000002,332.07999999999998,331.00999999999999,329.23000000000002,327.26999999999998,327.20999999999998,328.29000000000002,329.41000000000003,330.23000000000002,331.25,331.87,333.13999999999999,333.80000000000001,333.43000000000001,331.73000000000002,329.89999999999998,328.39999999999998,328.17000000000002,329.31999999999999,330.58999999999997,331.57999999999998,332.38999999999999,333.32999999999998,334.41000000000003,334.70999999999998,334.17000000000002,332.88999999999999,330.76999999999998,329.13999999999999,328.77999999999997,330.13999999999999,331.51999999999998,332.75,333.24000000000001,334.52999999999997,335.89999999999998,336.56999999999999,336.10000000000002,334.75999999999999,332.58999999999997,331.42000000000002,330.98000000000002,332.24000000000001,333.68000000000001,334.80000000000001,335.22000000000003,336.47000000000003,337.58999999999997,337.83999999999997,337.72000000000003,336.37,334.50999999999999,332.60000000000002,332.38,333.75,334.77999999999997,336.05000000000001,336.58999999999997,337.79000000000002,338.70999999999998,339.30000000000001,339.12,337.56,335.92000000000002,333.75,333.69999999999999,335.12,336.56,337.83999999999997,338.19,339.91000000000003,340.60000000000002,341.29000000000002,341,339.38999999999999,337.43000000000001,335.72000000000003,335.83999999999997,336.93000000000001,338.04000000000002,339.06,340.30000000000001,341.20999999999998,342.32999999999998,342.74000000000001,342.07999999999998,340.31999999999999,338.25999999999999,336.51999999999998,336.68000000000001,338.19,339.44,340.56999999999999,341.44,342.52999999999997,343.38999999999999,343.95999999999998,343.18000000000001,341.88,339.64999999999998,337.81,337.69,339.08999999999997,340.31999999999999,341.19999999999999,342.35000000000002,342.93000000000001,344.76999999999998,345.57999999999998,345.13999999999999,343.81,342.20999999999998,339.69,339.81999999999999,340.98000000000002,342.81999999999999,343.51999999999998,344.32999999999998,345.11000000000001,346.88,347.25,346.62,345.22000000000003,343.11000000000001,340.89999999999998,341.18000000000001,342.80000000000001,344.04000000000002,344.79000000000002,345.81999999999999,347.25,348.17000000000002,348.74000000000001,348.06999999999999,346.38,344.50999999999999,342.92000000000002,342.62,344.06,345.38,346.11000000000001,346.77999999999997,347.68000000000001,349.37,350.02999999999997,349.37,347.75999999999999,345.73000000000002,344.68000000000001,343.99000000000001,345.48000000000002,346.72000000000003,347.83999999999997,348.29000000000002,349.23000000000002,350.80000000000001,351.66000000000003,351.06999999999999,349.32999999999998,347.92000000000002,346.26999999999998,346.18000000000001,347.63999999999999,348.77999999999997,350.25,351.54000000000002,352.05000000000001,353.41000000000003,354.04000000000002,353.62,352.22000000000003,350.26999999999998,348.55000000000001,348.72000000000003,349.91000000000003,351.18000000000001,352.60000000000002,352.92000000000002,353.52999999999997,355.25999999999999,355.51999999999998,354.97000000000003,353.75,351.51999999999998,349.63999999999999,349.82999999999998,351.13999999999999,352.37,353.5,354.55000000000001,355.23000000000002,356.04000000000002,357,356.06999999999999,354.67000000000002,352.75999999999999,350.81999999999999,351.04000000000002,352.69,354.06999999999999,354.58999999999997,355.63,357.02999999999997,358.48000000000002,359.22000000000003,358.12,356.06,353.92000000000002,352.05000000000001,352.11000000000001,353.63999999999999,354.88999999999999,355.88,356.63,357.72000000000003,359.06999999999999,359.57999999999998,359.17000000000002,356.94,354.92000000000002,352.94,353.23000000000002,354.08999999999997,355.32999999999998,356.63,357.10000000000002,358.31999999999999,359.41000000000003,360.23000000000002,359.55000000000001,357.52999999999997,355.48000000000002,353.67000000000002,353.94999999999999,355.30000000000001,356.77999999999997,358.33999999999997,358.88999999999999,359.94999999999999,361.25,361.67000000000002,360.94,359.55000000000001,357.49000000000001,355.83999999999997,356,357.58999999999997,359.05000000000001,359.98000000000002,361.02999999999997,361.66000000000003,363.48000000000002,363.81999999999999,363.30000000000001,361.94,359.5,358.11000000000001,357.80000000000001,359.61000000000001,360.74000000000001,362.08999999999997,363.29000000000002,364.06,364.75999999999999,365.44999999999999,365.00999999999999,363.69999999999999,361.54000000000002,359.50999999999999,359.64999999999998,360.80000000000001,362.38,363.23000000000002,364.06,364.61000000000001,366.39999999999998,366.83999999999997,365.68000000000001,364.51999999999998,362.56999999999999,360.24000000000001,360.82999999999998,362.49000000000001,364.33999999999997],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">|&gt;</span> <span class="fu">ts_seasonal</span>() <span class="co"># 時系列を季節で分離してグラフ化</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b8667e65fcb3cfa1dcec" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b8667e65fcb3cfa1dcec">{"x":{"visdat":{"1bd07de32152":["function () ","plotlyVisDat"]},"cur_data":"1bd07de32152","attrs":{"1bd07de32152":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[315.42000000000002,316.31,316.5,317.56,318.13,318,316.38999999999999,314.64999999999998,313.68000000000001,313.18000000000001,314.66000000000003,315.43000000000001],"type":"scatter","mode":"lines","name":1959,"line":{"color":"#440154FF"},"inherit":true},"1bd07de32152.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[316.26999999999998,316.81,317.42000000000002,318.87,319.87,319.43000000000001,318.00999999999999,315.74000000000001,314,313.68000000000001,314.83999999999997,316.02999999999997],"type":"scatter","mode":"lines","name":1960,"line":{"color":"#460B5EFF"},"inherit":true},"1bd07de32152.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[316.73000000000002,317.54000000000002,318.38,319.31,320.42000000000002,319.61000000000001,318.42000000000002,316.63,314.82999999999998,315.16000000000003,315.94,316.85000000000002],"type":"scatter","mode":"lines","name":1961,"line":{"color":"#481568FF"},"inherit":true},"1bd07de32152.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[317.77999999999997,318.39999999999998,319.52999999999997,320.42000000000002,320.85000000000002,320.44999999999999,319.44999999999999,317.25,316.11000000000001,315.26999999999998,316.52999999999997,317.52999999999997],"type":"scatter","mode":"lines","name":1962,"line":{"color":"#481D6FFF"},"inherit":true},"1bd07de32152.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[318.57999999999998,318.92000000000002,319.69999999999999,321.22000000000003,322.07999999999998,321.31,319.57999999999998,317.61000000000001,316.05000000000001,315.82999999999998,316.91000000000003,318.19999999999999],"type":"scatter","mode":"lines","name":1963,"line":{"color":"#482677FF"},"inherit":true},"1bd07de32152.5":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[319.41000000000003,320.06999999999999,320.74000000000001,321.39999999999998,322.06,321.73000000000002,320.26999999999998,318.54000000000002,316.54000000000002,316.70999999999998,317.52999999999997,318.55000000000001],"type":"scatter","mode":"lines","name":1964,"line":{"color":"#472F7DFF"},"inherit":true},"1bd07de32152.6":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[319.26999999999998,320.27999999999997,320.73000000000002,321.97000000000003,322,321.70999999999998,321.05000000000001,318.70999999999998,317.66000000000003,317.13999999999999,318.69999999999999,319.25],"type":"scatter","mode":"lines","name":1965,"line":{"color":"#453781FF"},"inherit":true},"1bd07de32152.7":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[320.45999999999998,321.43000000000001,322.23000000000002,323.54000000000002,323.91000000000003,323.58999999999997,322.24000000000001,320.19999999999999,318.48000000000002,317.94,319.63,320.87],"type":"scatter","mode":"lines","name":1966,"line":{"color":"#423F85FF"},"inherit":true},"1bd07de32152.8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[322.17000000000002,322.33999999999997,322.88,324.25,324.82999999999998,323.93000000000001,322.38,320.75999999999999,319.10000000000002,319.24000000000001,320.56,321.80000000000001],"type":"scatter","mode":"lines","name":1967,"line":{"color":"#3F4788FF"},"inherit":true},"1bd07de32152.9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[322.39999999999998,322.99000000000001,323.73000000000002,324.86000000000001,325.39999999999998,325.19999999999999,323.98000000000002,321.94999999999999,320.18000000000001,320.08999999999997,321.16000000000003,322.74000000000001],"type":"scatter","mode":"lines","name":1968,"line":{"color":"#3D4E8AFF"},"inherit":true},"1bd07de32152.10":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[323.82999999999998,324.25999999999999,325.47000000000003,326.5,327.20999999999998,326.54000000000002,325.72000000000003,323.5,322.22000000000003,321.62,322.69,323.94999999999999],"type":"scatter","mode":"lines","name":1969,"line":{"color":"#39558CFF"},"inherit":true},"1bd07de32152.11":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[324.88999999999999,325.81999999999999,326.76999999999998,327.97000000000003,327.91000000000003,327.5,326.18000000000001,324.52999999999997,322.93000000000001,322.89999999999998,323.85000000000002,324.95999999999998],"type":"scatter","mode":"lines","name":1970,"line":{"color":"#365D8DFF"},"inherit":true},"1bd07de32152.12":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[326.00999999999999,326.50999999999999,327.00999999999999,327.62,328.75999999999999,328.39999999999998,327.19999999999999,325.26999999999998,323.19999999999999,323.39999999999998,324.63,325.85000000000002],"type":"scatter","mode":"lines","name":1971,"line":{"color":"#32648EFF"},"inherit":true},"1bd07de32152.13":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[326.60000000000002,327.47000000000003,327.57999999999998,329.56,329.89999999999998,328.92000000000002,327.88,326.16000000000003,324.68000000000001,325.04000000000002,326.33999999999997,327.38999999999999],"type":"scatter","mode":"lines","name":1972,"line":{"color":"#306A8EFF"},"inherit":true},"1bd07de32152.14":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[328.37,329.39999999999998,330.13999999999999,331.32999999999998,332.31,331.89999999999998,330.69999999999999,329.14999999999998,327.35000000000002,327.01999999999998,327.99000000000001,328.48000000000002],"type":"scatter","mode":"lines","name":1973,"line":{"color":"#2D718EFF"},"inherit":true},"1bd07de32152.15":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[329.18000000000001,330.55000000000001,331.31999999999999,332.48000000000002,332.92000000000002,332.07999999999998,331.00999999999999,329.23000000000002,327.26999999999998,327.20999999999998,328.29000000000002,329.41000000000003],"type":"scatter","mode":"lines","name":1974,"line":{"color":"#2A778EFF"},"inherit":true},"1bd07de32152.16":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[330.23000000000002,331.25,331.87,333.13999999999999,333.80000000000001,333.43000000000001,331.73000000000002,329.89999999999998,328.39999999999998,328.17000000000002,329.31999999999999,330.58999999999997],"type":"scatter","mode":"lines","name":1975,"line":{"color":"#287D8EFF"},"inherit":true},"1bd07de32152.17":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[331.57999999999998,332.38999999999999,333.32999999999998,334.41000000000003,334.70999999999998,334.17000000000002,332.88999999999999,330.76999999999998,329.13999999999999,328.77999999999997,330.13999999999999,331.51999999999998],"type":"scatter","mode":"lines","name":1976,"line":{"color":"#25838EFF"},"inherit":true},"1bd07de32152.18":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[332.75,333.24000000000001,334.52999999999997,335.89999999999998,336.56999999999999,336.10000000000002,334.75999999999999,332.58999999999997,331.42000000000002,330.98000000000002,332.24000000000001,333.68000000000001],"type":"scatter","mode":"lines","name":1977,"line":{"color":"#238A8DFF"},"inherit":true},"1bd07de32152.19":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[334.80000000000001,335.22000000000003,336.47000000000003,337.58999999999997,337.83999999999997,337.72000000000003,336.37,334.50999999999999,332.60000000000002,332.38,333.75,334.77999999999997],"type":"scatter","mode":"lines","name":1978,"line":{"color":"#21908CFF"},"inherit":true},"1bd07de32152.20":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[336.05000000000001,336.58999999999997,337.79000000000002,338.70999999999998,339.30000000000001,339.12,337.56,335.92000000000002,333.75,333.69999999999999,335.12,336.56],"type":"scatter","mode":"lines","name":1979,"line":{"color":"#1F968BFF"},"inherit":true},"1bd07de32152.21":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[337.83999999999997,338.19,339.91000000000003,340.60000000000002,341.29000000000002,341,339.38999999999999,337.43000000000001,335.72000000000003,335.83999999999997,336.93000000000001,338.04000000000002],"type":"scatter","mode":"lines","name":1980,"line":{"color":"#1E9D89FF"},"inherit":true},"1bd07de32152.22":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[339.06,340.30000000000001,341.20999999999998,342.32999999999998,342.74000000000001,342.07999999999998,340.31999999999999,338.25999999999999,336.51999999999998,336.68000000000001,338.19,339.44],"type":"scatter","mode":"lines","name":1981,"line":{"color":"#20A386FF"},"inherit":true},"1bd07de32152.23":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[340.56999999999999,341.44,342.52999999999997,343.38999999999999,343.95999999999998,343.18000000000001,341.88,339.64999999999998,337.81,337.69,339.08999999999997,340.31999999999999],"type":"scatter","mode":"lines","name":1982,"line":{"color":"#23A983FF"},"inherit":true},"1bd07de32152.24":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[341.19999999999999,342.35000000000002,342.93000000000001,344.76999999999998,345.57999999999998,345.13999999999999,343.81,342.20999999999998,339.69,339.81999999999999,340.98000000000002,342.81999999999999],"type":"scatter","mode":"lines","name":1983,"line":{"color":"#29AF7FFF"},"inherit":true},"1bd07de32152.25":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[343.51999999999998,344.32999999999998,345.11000000000001,346.88,347.25,346.62,345.22000000000003,343.11000000000001,340.89999999999998,341.18000000000001,342.80000000000001,344.04000000000002],"type":"scatter","mode":"lines","name":1984,"line":{"color":"#32B67AFF"},"inherit":true},"1bd07de32152.26":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[344.79000000000002,345.81999999999999,347.25,348.17000000000002,348.74000000000001,348.06999999999999,346.38,344.50999999999999,342.92000000000002,342.62,344.06,345.38],"type":"scatter","mode":"lines","name":1985,"line":{"color":"#3CBC75FF"},"inherit":true},"1bd07de32152.27":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[346.11000000000001,346.77999999999997,347.68000000000001,349.37,350.02999999999997,349.37,347.75999999999999,345.73000000000002,344.68000000000001,343.99000000000001,345.48000000000002,346.72000000000003],"type":"scatter","mode":"lines","name":1986,"line":{"color":"#48C16EFF"},"inherit":true},"1bd07de32152.28":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[347.83999999999997,348.29000000000002,349.23000000000002,350.80000000000001,351.66000000000003,351.06999999999999,349.32999999999998,347.92000000000002,346.26999999999998,346.18000000000001,347.63999999999999,348.77999999999997],"type":"scatter","mode":"lines","name":1987,"line":{"color":"#56C667FF"},"inherit":true},"1bd07de32152.29":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[350.25,351.54000000000002,352.05000000000001,353.41000000000003,354.04000000000002,353.62,352.22000000000003,350.26999999999998,348.55000000000001,348.72000000000003,349.91000000000003,351.18000000000001],"type":"scatter","mode":"lines","name":1988,"line":{"color":"#64CB5FFF"},"inherit":true},"1bd07de32152.30":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[352.60000000000002,352.92000000000002,353.52999999999997,355.25999999999999,355.51999999999998,354.97000000000003,353.75,351.51999999999998,349.63999999999999,349.82999999999998,351.13999999999999,352.37],"type":"scatter","mode":"lines","name":1989,"line":{"color":"#74D055FF"},"inherit":true},"1bd07de32152.31":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[353.5,354.55000000000001,355.23000000000002,356.04000000000002,357,356.06999999999999,354.67000000000002,352.75999999999999,350.81999999999999,351.04000000000002,352.69,354.06999999999999],"type":"scatter","mode":"lines","name":1990,"line":{"color":"#84D44BFF"},"inherit":true},"1bd07de32152.32":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[354.58999999999997,355.63,357.02999999999997,358.48000000000002,359.22000000000003,358.12,356.06,353.92000000000002,352.05000000000001,352.11000000000001,353.63999999999999,354.88999999999999],"type":"scatter","mode":"lines","name":1991,"line":{"color":"#94D840FF"},"inherit":true},"1bd07de32152.33":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[355.88,356.63,357.72000000000003,359.06999999999999,359.57999999999998,359.17000000000002,356.94,354.92000000000002,352.94,353.23000000000002,354.08999999999997,355.32999999999998],"type":"scatter","mode":"lines","name":1992,"line":{"color":"#A6DB35FF"},"inherit":true},"1bd07de32152.34":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[356.63,357.10000000000002,358.31999999999999,359.41000000000003,360.23000000000002,359.55000000000001,357.52999999999997,355.48000000000002,353.67000000000002,353.94999999999999,355.30000000000001,356.77999999999997],"type":"scatter","mode":"lines","name":1993,"line":{"color":"#B8DE29FF"},"inherit":true},"1bd07de32152.35":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[358.33999999999997,358.88999999999999,359.94999999999999,361.25,361.67000000000002,360.94,359.55000000000001,357.49000000000001,355.83999999999997,356,357.58999999999997,359.05000000000001],"type":"scatter","mode":"lines","name":1994,"line":{"color":"#CAE11FFF"},"inherit":true},"1bd07de32152.36":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[359.98000000000002,361.02999999999997,361.66000000000003,363.48000000000002,363.81999999999999,363.30000000000001,361.94,359.5,358.11000000000001,357.80000000000001,359.61000000000001,360.74000000000001],"type":"scatter","mode":"lines","name":1995,"line":{"color":"#DCE318FF"},"inherit":true},"1bd07de32152.37":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[362.08999999999997,363.29000000000002,364.06,364.75999999999999,365.44999999999999,365.00999999999999,363.69999999999999,361.54000000000002,359.50999999999999,359.64999999999998,360.80000000000001,362.38],"type":"scatter","mode":"lines","name":1996,"line":{"color":"#EDE51BFF"},"inherit":true},"1bd07de32152.38":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[363.23000000000002,364.06,364.61000000000001,366.39999999999998,366.83999999999997,365.68000000000001,364.51999999999998,362.56999999999999,360.24000000000001,360.82999999999998,362.49000000000001,364.33999999999997],"type":"scatter","mode":"lines","name":1997,"line":{"color":"#FDE725FF"},"inherit":true}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"yaxis":{"domain":[0,1],"automargin":true,"title":"By Frequency Cycle"},"title":"Seasonality Plot - co2","xaxis":{"domain":[0,1],"automargin":true,"title":[],"type":"category","categoryorder":"array","categoryarray":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]},"hovermode":"closest","showlegend":true},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[315.42000000000002,316.31,316.5,317.56,318.13,318,316.38999999999999,314.64999999999998,313.68000000000001,313.18000000000001,314.66000000000003,315.43000000000001],"type":"scatter","mode":"lines","name":1959,"line":{"color":"#440154FF"},"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[316.26999999999998,316.81,317.42000000000002,318.87,319.87,319.43000000000001,318.00999999999999,315.74000000000001,314,313.68000000000001,314.83999999999997,316.02999999999997],"type":"scatter","mode":"lines","name":1960,"line":{"color":"#460B5EFF"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[316.73000000000002,317.54000000000002,318.38,319.31,320.42000000000002,319.61000000000001,318.42000000000002,316.63,314.82999999999998,315.16000000000003,315.94,316.85000000000002],"type":"scatter","mode":"lines","name":1961,"line":{"color":"#481568FF"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[317.77999999999997,318.39999999999998,319.52999999999997,320.42000000000002,320.85000000000002,320.44999999999999,319.44999999999999,317.25,316.11000000000001,315.26999999999998,316.52999999999997,317.52999999999997],"type":"scatter","mode":"lines","name":1962,"line":{"color":"#481D6FFF"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[318.57999999999998,318.92000000000002,319.69999999999999,321.22000000000003,322.07999999999998,321.31,319.57999999999998,317.61000000000001,316.05000000000001,315.82999999999998,316.91000000000003,318.19999999999999],"type":"scatter","mode":"lines","name":1963,"line":{"color":"#482677FF"},"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[319.41000000000003,320.06999999999999,320.74000000000001,321.39999999999998,322.06,321.73000000000002,320.26999999999998,318.54000000000002,316.54000000000002,316.70999999999998,317.52999999999997,318.55000000000001],"type":"scatter","mode":"lines","name":1964,"line":{"color":"#472F7DFF"},"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[319.26999999999998,320.27999999999997,320.73000000000002,321.97000000000003,322,321.70999999999998,321.05000000000001,318.70999999999998,317.66000000000003,317.13999999999999,318.69999999999999,319.25],"type":"scatter","mode":"lines","name":1965,"line":{"color":"#453781FF"},"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[320.45999999999998,321.43000000000001,322.23000000000002,323.54000000000002,323.91000000000003,323.58999999999997,322.24000000000001,320.19999999999999,318.48000000000002,317.94,319.63,320.87],"type":"scatter","mode":"lines","name":1966,"line":{"color":"#423F85FF"},"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[322.17000000000002,322.33999999999997,322.88,324.25,324.82999999999998,323.93000000000001,322.38,320.75999999999999,319.10000000000002,319.24000000000001,320.56,321.80000000000001],"type":"scatter","mode":"lines","name":1967,"line":{"color":"#3F4788FF"},"marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[322.39999999999998,322.99000000000001,323.73000000000002,324.86000000000001,325.39999999999998,325.19999999999999,323.98000000000002,321.94999999999999,320.18000000000001,320.08999999999997,321.16000000000003,322.74000000000001],"type":"scatter","mode":"lines","name":1968,"line":{"color":"#3D4E8AFF"},"marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[323.82999999999998,324.25999999999999,325.47000000000003,326.5,327.20999999999998,326.54000000000002,325.72000000000003,323.5,322.22000000000003,321.62,322.69,323.94999999999999],"type":"scatter","mode":"lines","name":1969,"line":{"color":"#39558CFF"},"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[324.88999999999999,325.81999999999999,326.76999999999998,327.97000000000003,327.91000000000003,327.5,326.18000000000001,324.52999999999997,322.93000000000001,322.89999999999998,323.85000000000002,324.95999999999998],"type":"scatter","mode":"lines","name":1970,"line":{"color":"#365D8DFF"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[326.00999999999999,326.50999999999999,327.00999999999999,327.62,328.75999999999999,328.39999999999998,327.19999999999999,325.26999999999998,323.19999999999999,323.39999999999998,324.63,325.85000000000002],"type":"scatter","mode":"lines","name":1971,"line":{"color":"#32648EFF"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[326.60000000000002,327.47000000000003,327.57999999999998,329.56,329.89999999999998,328.92000000000002,327.88,326.16000000000003,324.68000000000001,325.04000000000002,326.33999999999997,327.38999999999999],"type":"scatter","mode":"lines","name":1972,"line":{"color":"#306A8EFF"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[328.37,329.39999999999998,330.13999999999999,331.32999999999998,332.31,331.89999999999998,330.69999999999999,329.14999999999998,327.35000000000002,327.01999999999998,327.99000000000001,328.48000000000002],"type":"scatter","mode":"lines","name":1973,"line":{"color":"#2D718EFF"},"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[329.18000000000001,330.55000000000001,331.31999999999999,332.48000000000002,332.92000000000002,332.07999999999998,331.00999999999999,329.23000000000002,327.26999999999998,327.20999999999998,328.29000000000002,329.41000000000003],"type":"scatter","mode":"lines","name":1974,"line":{"color":"#2A778EFF"},"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[330.23000000000002,331.25,331.87,333.13999999999999,333.80000000000001,333.43000000000001,331.73000000000002,329.89999999999998,328.39999999999998,328.17000000000002,329.31999999999999,330.58999999999997],"type":"scatter","mode":"lines","name":1975,"line":{"color":"#287D8EFF"},"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[331.57999999999998,332.38999999999999,333.32999999999998,334.41000000000003,334.70999999999998,334.17000000000002,332.88999999999999,330.76999999999998,329.13999999999999,328.77999999999997,330.13999999999999,331.51999999999998],"type":"scatter","mode":"lines","name":1976,"line":{"color":"#25838EFF"},"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[332.75,333.24000000000001,334.52999999999997,335.89999999999998,336.56999999999999,336.10000000000002,334.75999999999999,332.58999999999997,331.42000000000002,330.98000000000002,332.24000000000001,333.68000000000001],"type":"scatter","mode":"lines","name":1977,"line":{"color":"#238A8DFF"},"marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[334.80000000000001,335.22000000000003,336.47000000000003,337.58999999999997,337.83999999999997,337.72000000000003,336.37,334.50999999999999,332.60000000000002,332.38,333.75,334.77999999999997],"type":"scatter","mode":"lines","name":1978,"line":{"color":"#21908CFF"},"marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[336.05000000000001,336.58999999999997,337.79000000000002,338.70999999999998,339.30000000000001,339.12,337.56,335.92000000000002,333.75,333.69999999999999,335.12,336.56],"type":"scatter","mode":"lines","name":1979,"line":{"color":"#1F968BFF"},"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[337.83999999999997,338.19,339.91000000000003,340.60000000000002,341.29000000000002,341,339.38999999999999,337.43000000000001,335.72000000000003,335.83999999999997,336.93000000000001,338.04000000000002],"type":"scatter","mode":"lines","name":1980,"line":{"color":"#1E9D89FF"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[339.06,340.30000000000001,341.20999999999998,342.32999999999998,342.74000000000001,342.07999999999998,340.31999999999999,338.25999999999999,336.51999999999998,336.68000000000001,338.19,339.44],"type":"scatter","mode":"lines","name":1981,"line":{"color":"#20A386FF"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[340.56999999999999,341.44,342.52999999999997,343.38999999999999,343.95999999999998,343.18000000000001,341.88,339.64999999999998,337.81,337.69,339.08999999999997,340.31999999999999],"type":"scatter","mode":"lines","name":1982,"line":{"color":"#23A983FF"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[341.19999999999999,342.35000000000002,342.93000000000001,344.76999999999998,345.57999999999998,345.13999999999999,343.81,342.20999999999998,339.69,339.81999999999999,340.98000000000002,342.81999999999999],"type":"scatter","mode":"lines","name":1983,"line":{"color":"#29AF7FFF"},"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[343.51999999999998,344.32999999999998,345.11000000000001,346.88,347.25,346.62,345.22000000000003,343.11000000000001,340.89999999999998,341.18000000000001,342.80000000000001,344.04000000000002],"type":"scatter","mode":"lines","name":1984,"line":{"color":"#32B67AFF"},"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[344.79000000000002,345.81999999999999,347.25,348.17000000000002,348.74000000000001,348.06999999999999,346.38,344.50999999999999,342.92000000000002,342.62,344.06,345.38],"type":"scatter","mode":"lines","name":1985,"line":{"color":"#3CBC75FF"},"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[346.11000000000001,346.77999999999997,347.68000000000001,349.37,350.02999999999997,349.37,347.75999999999999,345.73000000000002,344.68000000000001,343.99000000000001,345.48000000000002,346.72000000000003],"type":"scatter","mode":"lines","name":1986,"line":{"color":"#48C16EFF"},"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[347.83999999999997,348.29000000000002,349.23000000000002,350.80000000000001,351.66000000000003,351.06999999999999,349.32999999999998,347.92000000000002,346.26999999999998,346.18000000000001,347.63999999999999,348.77999999999997],"type":"scatter","mode":"lines","name":1987,"line":{"color":"#56C667FF"},"marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[350.25,351.54000000000002,352.05000000000001,353.41000000000003,354.04000000000002,353.62,352.22000000000003,350.26999999999998,348.55000000000001,348.72000000000003,349.91000000000003,351.18000000000001],"type":"scatter","mode":"lines","name":1988,"line":{"color":"#64CB5FFF"},"marker":{"color":"rgba(23,190,207,1)","line":{"color":"rgba(23,190,207,1)"}},"error_y":{"color":"rgba(23,190,207,1)"},"error_x":{"color":"rgba(23,190,207,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[352.60000000000002,352.92000000000002,353.52999999999997,355.25999999999999,355.51999999999998,354.97000000000003,353.75,351.51999999999998,349.63999999999999,349.82999999999998,351.13999999999999,352.37],"type":"scatter","mode":"lines","name":1989,"line":{"color":"#74D055FF"},"marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[353.5,354.55000000000001,355.23000000000002,356.04000000000002,357,356.06999999999999,354.67000000000002,352.75999999999999,350.81999999999999,351.04000000000002,352.69,354.06999999999999],"type":"scatter","mode":"lines","name":1990,"line":{"color":"#84D44BFF"},"marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[354.58999999999997,355.63,357.02999999999997,358.48000000000002,359.22000000000003,358.12,356.06,353.92000000000002,352.05000000000001,352.11000000000001,353.63999999999999,354.88999999999999],"type":"scatter","mode":"lines","name":1991,"line":{"color":"#94D840FF"},"marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[355.88,356.63,357.72000000000003,359.06999999999999,359.57999999999998,359.17000000000002,356.94,354.92000000000002,352.94,353.23000000000002,354.08999999999997,355.32999999999998],"type":"scatter","mode":"lines","name":1992,"line":{"color":"#A6DB35FF"},"marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[356.63,357.10000000000002,358.31999999999999,359.41000000000003,360.23000000000002,359.55000000000001,357.52999999999997,355.48000000000002,353.67000000000002,353.94999999999999,355.30000000000001,356.77999999999997],"type":"scatter","mode":"lines","name":1993,"line":{"color":"#B8DE29FF"},"marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[358.33999999999997,358.88999999999999,359.94999999999999,361.25,361.67000000000002,360.94,359.55000000000001,357.49000000000001,355.83999999999997,356,357.58999999999997,359.05000000000001],"type":"scatter","mode":"lines","name":1994,"line":{"color":"#CAE11FFF"},"marker":{"color":"rgba(140,86,75,1)","line":{"color":"rgba(140,86,75,1)"}},"error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[359.98000000000002,361.02999999999997,361.66000000000003,363.48000000000002,363.81999999999999,363.30000000000001,361.94,359.5,358.11000000000001,357.80000000000001,359.61000000000001,360.74000000000001],"type":"scatter","mode":"lines","name":1995,"line":{"color":"#DCE318FF"},"marker":{"color":"rgba(227,119,194,1)","line":{"color":"rgba(227,119,194,1)"}},"error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[362.08999999999997,363.29000000000002,364.06,364.75999999999999,365.44999999999999,365.00999999999999,363.69999999999999,361.54000000000002,359.50999999999999,359.64999999999998,360.80000000000001,362.38],"type":"scatter","mode":"lines","name":1996,"line":{"color":"#EDE51BFF"},"marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"y":[363.23000000000002,364.06,364.61000000000001,366.39999999999998,366.83999999999997,365.68000000000001,364.51999999999998,362.56999999999999,360.24000000000001,360.82999999999998,362.49000000000001,364.33999999999997],"type":"scatter","mode":"lines","name":1997,"line":{"color":"#FDE725FF"},"marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>co2 <span class="sc">|&gt;</span> <span class="fu">ts_heatmap</span>() <span class="co"># 時系列をヒートマップで表示</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a249c5bba630e0d6bda0" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a249c5bba630e0d6bda0">{"x":{"visdat":{"1bd054622448":["function () ","plotlyVisDat"]},"cur_data":"1bd054622448","attrs":{"1bd054622448":{"z":[[315.42000000000002,316.26999999999998,316.73000000000002,317.77999999999997,318.57999999999998,319.41000000000003,319.26999999999998,320.45999999999998,322.17000000000002,322.39999999999998,323.82999999999998,324.88999999999999,326.00999999999999,326.60000000000002,328.37,329.18000000000001,330.23000000000002,331.57999999999998,332.75,334.80000000000001,336.05000000000001,337.83999999999997,339.06,340.56999999999999,341.19999999999999,343.51999999999998,344.79000000000002,346.11000000000001,347.83999999999997,350.25,352.60000000000002,353.5,354.58999999999997,355.88,356.63,358.33999999999997,359.98000000000002,362.08999999999997,363.23000000000002],[316.31,316.81,317.54000000000002,318.39999999999998,318.92000000000002,320.06999999999999,320.27999999999997,321.43000000000001,322.33999999999997,322.99000000000001,324.25999999999999,325.81999999999999,326.50999999999999,327.47000000000003,329.39999999999998,330.55000000000001,331.25,332.38999999999999,333.24000000000001,335.22000000000003,336.58999999999997,338.19,340.30000000000001,341.44,342.35000000000002,344.32999999999998,345.81999999999999,346.77999999999997,348.29000000000002,351.54000000000002,352.92000000000002,354.55000000000001,355.63,356.63,357.10000000000002,358.88999999999999,361.02999999999997,363.29000000000002,364.06],[316.5,317.42000000000002,318.38,319.52999999999997,319.69999999999999,320.74000000000001,320.73000000000002,322.23000000000002,322.88,323.73000000000002,325.47000000000003,326.76999999999998,327.00999999999999,327.57999999999998,330.13999999999999,331.31999999999999,331.87,333.32999999999998,334.52999999999997,336.47000000000003,337.79000000000002,339.91000000000003,341.20999999999998,342.52999999999997,342.93000000000001,345.11000000000001,347.25,347.68000000000001,349.23000000000002,352.05000000000001,353.52999999999997,355.23000000000002,357.02999999999997,357.72000000000003,358.31999999999999,359.94999999999999,361.66000000000003,364.06,364.61000000000001],[317.56,318.87,319.31,320.42000000000002,321.22000000000003,321.39999999999998,321.97000000000003,323.54000000000002,324.25,324.86000000000001,326.5,327.97000000000003,327.62,329.56,331.32999999999998,332.48000000000002,333.13999999999999,334.41000000000003,335.89999999999998,337.58999999999997,338.70999999999998,340.60000000000002,342.32999999999998,343.38999999999999,344.76999999999998,346.88,348.17000000000002,349.37,350.80000000000001,353.41000000000003,355.25999999999999,356.04000000000002,358.48000000000002,359.06999999999999,359.41000000000003,361.25,363.48000000000002,364.75999999999999,366.39999999999998],[318.13,319.87,320.42000000000002,320.85000000000002,322.07999999999998,322.06,322,323.91000000000003,324.82999999999998,325.39999999999998,327.20999999999998,327.91000000000003,328.75999999999999,329.89999999999998,332.31,332.92000000000002,333.80000000000001,334.70999999999998,336.56999999999999,337.83999999999997,339.30000000000001,341.29000000000002,342.74000000000001,343.95999999999998,345.57999999999998,347.25,348.74000000000001,350.02999999999997,351.66000000000003,354.04000000000002,355.51999999999998,357,359.22000000000003,359.57999999999998,360.23000000000002,361.67000000000002,363.81999999999999,365.44999999999999,366.83999999999997],[318,319.43000000000001,319.61000000000001,320.44999999999999,321.31,321.73000000000002,321.70999999999998,323.58999999999997,323.93000000000001,325.19999999999999,326.54000000000002,327.5,328.39999999999998,328.92000000000002,331.89999999999998,332.07999999999998,333.43000000000001,334.17000000000002,336.10000000000002,337.72000000000003,339.12,341,342.07999999999998,343.18000000000001,345.13999999999999,346.62,348.06999999999999,349.37,351.06999999999999,353.62,354.97000000000003,356.06999999999999,358.12,359.17000000000002,359.55000000000001,360.94,363.30000000000001,365.00999999999999,365.68000000000001],[316.38999999999999,318.00999999999999,318.42000000000002,319.44999999999999,319.57999999999998,320.26999999999998,321.05000000000001,322.24000000000001,322.38,323.98000000000002,325.72000000000003,326.18000000000001,327.19999999999999,327.88,330.69999999999999,331.00999999999999,331.73000000000002,332.88999999999999,334.75999999999999,336.37,337.56,339.38999999999999,340.31999999999999,341.88,343.81,345.22000000000003,346.38,347.75999999999999,349.32999999999998,352.22000000000003,353.75,354.67000000000002,356.06,356.94,357.52999999999997,359.55000000000001,361.94,363.69999999999999,364.51999999999998],[314.64999999999998,315.74000000000001,316.63,317.25,317.61000000000001,318.54000000000002,318.70999999999998,320.19999999999999,320.75999999999999,321.94999999999999,323.5,324.52999999999997,325.26999999999998,326.16000000000003,329.14999999999998,329.23000000000002,329.89999999999998,330.76999999999998,332.58999999999997,334.50999999999999,335.92000000000002,337.43000000000001,338.25999999999999,339.64999999999998,342.20999999999998,343.11000000000001,344.50999999999999,345.73000000000002,347.92000000000002,350.26999999999998,351.51999999999998,352.75999999999999,353.92000000000002,354.92000000000002,355.48000000000002,357.49000000000001,359.5,361.54000000000002,362.56999999999999],[313.68000000000001,314,314.82999999999998,316.11000000000001,316.05000000000001,316.54000000000002,317.66000000000003,318.48000000000002,319.10000000000002,320.18000000000001,322.22000000000003,322.93000000000001,323.19999999999999,324.68000000000001,327.35000000000002,327.26999999999998,328.39999999999998,329.13999999999999,331.42000000000002,332.60000000000002,333.75,335.72000000000003,336.51999999999998,337.81,339.69,340.89999999999998,342.92000000000002,344.68000000000001,346.26999999999998,348.55000000000001,349.63999999999999,350.81999999999999,352.05000000000001,352.94,353.67000000000002,355.83999999999997,358.11000000000001,359.50999999999999,360.24000000000001],[313.18000000000001,313.68000000000001,315.16000000000003,315.26999999999998,315.82999999999998,316.70999999999998,317.13999999999999,317.94,319.24000000000001,320.08999999999997,321.62,322.89999999999998,323.39999999999998,325.04000000000002,327.01999999999998,327.20999999999998,328.17000000000002,328.77999999999997,330.98000000000002,332.38,333.69999999999999,335.83999999999997,336.68000000000001,337.69,339.81999999999999,341.18000000000001,342.62,343.99000000000001,346.18000000000001,348.72000000000003,349.82999999999998,351.04000000000002,352.11000000000001,353.23000000000002,353.94999999999999,356,357.80000000000001,359.64999999999998,360.82999999999998],[314.66000000000003,314.83999999999997,315.94,316.52999999999997,316.91000000000003,317.52999999999997,318.69999999999999,319.63,320.56,321.16000000000003,322.69,323.85000000000002,324.63,326.33999999999997,327.99000000000001,328.29000000000002,329.31999999999999,330.13999999999999,332.24000000000001,333.75,335.12,336.93000000000001,338.19,339.08999999999997,340.98000000000002,342.80000000000001,344.06,345.48000000000002,347.63999999999999,349.91000000000003,351.13999999999999,352.69,353.63999999999999,354.08999999999997,355.30000000000001,357.58999999999997,359.61000000000001,360.80000000000001,362.49000000000001],[315.43000000000001,316.02999999999997,316.85000000000002,317.52999999999997,318.19999999999999,318.55000000000001,319.25,320.87,321.80000000000001,322.74000000000001,323.94999999999999,324.95999999999998,325.85000000000002,327.38999999999999,328.48000000000002,329.41000000000003,330.58999999999997,331.51999999999998,333.68000000000001,334.77999999999997,336.56,338.04000000000002,339.44,340.31999999999999,342.81999999999999,344.04000000000002,345.38,346.72000000000003,348.77999999999997,351.18000000000001,352.37,354.06999999999999,354.88999999999999,355.32999999999998,356.77999999999997,359.05000000000001,360.74000000000001,362.38,364.33999999999997]],"x":["1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997"],"y":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"colorscale":[[0,"#F7FBFF"],[0.0093179276928811085,"#F5FAFE"],[0.015281401416324891,"#F4F9FE"],[0.027394707417069911,"#F2F7FD"],[0.027581065970928419,"#F1F7FD"],[0.030749161386507236,"#F1F7FD"],[0.030935519940364687,"#F1F7FD"],[0.036898993663809533,"#F0F6FD"],[0.038948937756242571,"#EFF6FD"],[0.041744316064107535,"#EFF6FC"],[0.041930674617964993,"#EFF6FC"],[0.047707789787551316,"#EDF5FC"],[0.049385016772269454,"#EDF5FC"],[0.051434960864703554,"#EDF4FC"],[0.053112187849421684,"#ECF4FC"],[0.053484904957137647,"#ECF4FC"],[0.054603056280283425,"#ECF4FC"],[0.057584793142004785,"#ECF4FB"],[0.058330227357435656,"#EBF4FB"],[0.059821095788296336,"#EBF3FB"],[0.061871039880730436,"#EBF3FB"],[0.062430115542302794,"#EBF3FB"],[0.062616474096161306,"#EAF3FB"],[0.064293701080879437,"#EAF3FB"],[0.065784569511740124,"#EAF3FB"],[0.066157286619456079,"#EAF3FB"],[0.067648155050316766,"#E9F2FB"],[0.068393589265747637,"#E9F2FB"],[0.069511740588893409,"#E9F2FB"],[0.073797987327617998,"#E8F2FA"],[0.075847931420052098,"#E8F1FA"],[0.079016026835631969,"#E7F1FA"],[0.081065970928065015,"#E7F1FA"],[0.081252329481923527,"#E7F1FA"],[0.081625046589638428,"#E7F1FA"],[0.082556839358926756,"#E7F0FA"],[0.083488632128215071,"#E6F0FA"],[0.08572493477450556,"#E6F0FA"],[0.088706671636227988,"#E5F0F9"],[0.08982482295937376,"#E5EFF9"],[0.090011181513231217,"#E5EFF9"],[0.092247484159522761,"#E5EFF9"],[0.09355199403652599,"#E4EFF9"],[0.096906448005963319,"#E4EFF9"],[0.09727916511367822,"#E4EFF9"],[0.09765188222139419,"#E3EEF9"],[0.098770033544539962,"#E3EEF9"],[0.099888184867685734,"#E3EEF9"],[0.10007454342154319,"#E3EEF9"],[0.10063361908311555,"#E3EEF9"],[0.10286992172940711,"#E2EEF8"],[0.10305628028326455,"#E2EEF8"],[0.10603801714498698,"#E2EDF8"],[0.10696980991427529,"#E2EDF8"],[0.11032426388371262,"#E1EDF8"],[0.11293328363771908,"#E0EDF8"],[0.11311964219157654,"#E0EDF8"],[0.11349235929929144,"#E0ECF8"],[0.11423779351472231,"#E0ECF8"],[0.11610137905329895,"#E0ECF8"],[0.11647409616101385,"#E0ECF8"],[0.11684681326872877,"#E0ECF8"],[0.11833768169958944,"#DFECF7"],[0.11926947446887777,"#DFECF7"],[0.11982855013045118,"#DFECF7"],[0.12020126723816608,"#DFECF7"],[0.12150577711516931,"#DFEBF7"],[0.1246738725307492,"#DEEBF7"],[0.12840104360790142,"#DDEBF7"],[0.12877376071561633,"#DDEBF7"],[0.13045098770033553,"#DDEAF7"],[0.13082370480805042,"#DDEAF7"],[0.13212821468505365,"#DDEAF7"],[0.1323145732389111,"#DDEAF7"],[0.13492359299291862,"#DCEAF6"],[0.13548266865449099,"#DCEAF6"],[0.13566902720834845,"#DCEAF6"],[0.13753261274692508,"#DCE9F6"],[0.14070070816250496,"#DBE9F6"],[0.14088706671636242,"#DBE9F6"],[0.14125978382407731,"#DBE9F6"],[0.14293701080879651,"#DBE9F6"],[0.14330972791651142,"#DBE9F6"],[0.14666418188594874,"#DAE8F6"],[0.14871412597838282,"#D9E8F5"],[0.14983227730152862,"#D9E8F5"],[0.15150950428624674,"#D9E8F5"],[0.15318673127096488,"#D9E7F5"],[0.15374580693253828,"#D9E7F5"],[0.15728661945583308,"#D8E7F5"],[0.1589638464405512,"#D8E7F5"],[0.15933656354826717,"#D7E7F5"],[0.1606410734252704,"#D7E6F5"],[0.16343645173313431,"#D7E6F5"],[0.16380916884085028,"#D7E6F5"],[0.16436824450242263,"#D6E6F4"],[0.1654863958255684,"#D6E6F4"],[0.16585911293328331,"#D6E6F4"],[0.16753633991800251,"#D6E6F4"],[0.16846813268729083,"#D6E5F4"],[0.16865449124114829,"#D6E5F4"],[0.16884084979500574,"#D6E5F4"],[0.17070443533358132,"#D5E5F4"],[0.1714498695490122,"#D5E5F4"],[0.17182258665672709,"#D5E5F4"],[0.17722698471859852,"#D4E4F4"],[0.17815877748788683,"#D4E4F4"],[0.18076779724189329,"#D3E4F3"],[0.18114051434960821,"#D3E4F3"],[0.18169959001118163,"#D3E4F3"],[0.1828177413343274,"#D3E4F3"],[0.18673127096533709,"#D2E3F3"],[0.19045844204248932,"#D1E3F3"],[0.19232202758106595,"#D1E2F3"],[0.19306746179649684,"#D1E2F3"],[0.1939992545657841,"#D1E2F3"],[0.19660827431979161,"#D0E2F2"],[0.19847185985836718,"#D0E2F2"],[0.19884457696608315,"#D0E2F2"],[0.19996272828922892,"#D0E1F2"],[0.20033544539694384,"#D0E1F2"],[0.20070816250465875,"#CFE1F2"],[0.20126723816623215,"#CFE1F2"],[0.20629891912038761,"#CEE1F2"],[0.20648527767424507,"#CEE1F2"],[0.21151695862840053,"#CDE0F1"],[0.21338054416697719,"#CDE0F1"],[0.2143123369362655,"#CDE0F1"],[0.21710771524412942,"#CCDFF1"],[0.21766679090570282,"#CCDFF1"],[0.21822586656727519,"#CCDFF1"],[0.21953037644427842,"#CCDFF1"],[0.22102124487514016,"#CCDFF1"],[0.22400298173686151,"#CBDEF1"],[0.22530749161386474,"#CBDEF1"],[0.22773015281401374,"#CADEF0"],[0.22903466269101805,"#CADEF0"],[0.23369362653745859,"#C9DDF0"],[0.23555721207603417,"#C9DDF0"],[0.23611628773760759,"#C9DDF0"],[0.23909802459932897,"#C8DCF0"],[0.24189340290719391,"#C8DCF0"],[0.24226612001490883,"#C7DCEF"],[0.2452478568766302,"#C7DCEF"],[0.2482295937383526,"#C6DBEF"],[0.24841595229221006,"#C6DBEF"],[0.24897502795378348,"#C6DBEF"],[0.25009317927692926,"#C6DBEF"],[0.25326127469250809,"#C5DBEF"],[0.25773387998509117,"#C4DAEE"],[0.25792023853894863,"#C4DAEE"],[0.26127469250838598,"#C2D9EE"],[0.26146105106224338,"#C2D9EE"],[0.26257920238538918,"#C2D9EE"],[0.26407007081625095,"#C2D9ED"],[0.26481550503168072,"#C1D9ED"],[0.26630637346254249,"#C1D9ED"],[0.26686544912411481,"#C1D9ED"],[0.26835631755497552,"#C0D9ED"],[0.26910175177040641,"#C0D8ED"],[0.27394707417070441,"#BED8EC"],[0.27450614983227778,"#BED8EC"],[0.27562430115542358,"#BED8EC"],[0.27599701826313849,"#BED7EC"],[0.27935147223257584,"#BDD7EC"],[0.28158777487886738,"#BCD7EB"],[0.28307864330972804,"#BCD6EB"],[0.28363771897130041,"#BBD6EB"],[0.28512858740216213,"#BBD6EB"],[0.29034662691017504,"#B9D6EA"],[0.29071934401788996,"#B9D5EA"],[0.29332836377189747,"#B8D5EA"],[0.29742825195676459,"#B7D5EA"],[0.29761461051062205,"#B7D5EA"],[0.29817368617219547,"#B7D4EA"],[0.29910547894148382,"#B7D4E9"],[0.30078270592620193,"#B6D4E9"],[0.30227357435706259,"#B6D4E9"],[0.3024599329109211,"#B5D4E9"],[0.30525531121878502,"#B5D3E9"],[0.31159150204994374,"#B3D3E8"],[0.31606410734252682,"#B1D2E8"],[0.31774133432724599,"#B1D2E7"],[0.3237048080506898,"#AFD1E7"],[0.32445024226611963,"#AED1E7"],[0.32650018635855371,"#AED1E6"],[0.32780469623555691,"#ADD0E6"],[0.33171822586656768,"#ACD0E6"],[0.33227730152814006,"#ACD0E6"],[0.33674990682072314,"#AACFE5"],[0.33805441669772635,"#AACFE5"],[0.3382407752515838,"#AACFE5"],[0.33991800223630303,"#A9CFE5"],[0.3417815877748786,"#A9CFE5"],[0.3428997390980244,"#A8CEE5"],[0.34569511740588937,"#A8CEE4"],[0.34830413715989578,"#A7CEE4"],[0.34886321282146815,"#A7CEE4"],[0.35221766679090549,"#A5CDE4"],[0.35519940365262792,"#A4CDE3"],[0.35650391352963112,"#A4CDE3"],[0.35780842340663438,"#A4CCE3"],[0.35799478196049184,"#A4CCE3"],[0.35967200894521101,"#A3CCE3"],[0.36172195303764404,"#A2CCE2"],[0.36190831159150255,"#A2CCE2"],[0.36470368989936647,"#A1CBE2"],[0.36731270965337293,"#A1CBE2"],[0.36787178531494635,"#A0CBE2"],[0.37197167349981347,"#9FCAE1"],[0.3738352590383901,"#9ECAE1"],[0.37551248602310827,"#9ECAE1"],[0.3773760715616849,"#9DC9E1"],[0.38203503540812545,"#9BC8E0"],[0.38240775251584036,"#9BC8E0"],[0.3833395452851287,"#9BC8E0"],[0.38427133805441699,"#9AC8E0"],[0.39116660454714913,"#98C6E0"],[0.39563920983973222,"#96C5DF"],[0.39750279537830779,"#95C5DF"],[0.39787551248602271,"#95C5DF"],[0.40122996645546005,"#94C4DF"],[0.40216175922474834,"#94C4DF"],[0.40253447633246325,"#93C4DF"],[0.40290719344017922,"#93C4DF"],[0.40887066716362302,"#91C2DE"],[0.41073425270219965,"#90C2DE"],[0.42005218039508074,"#8DC0DD"],[0.42228848304137123,"#8CBFDD"],[0.42340663436451703,"#8BBFDD"],[0.423779351472233,"#8BBFDD"],[0.426202012672382,"#8ABEDD"],[0.42713380544167034,"#8ABEDC"],[0.4321654863958258,"#88BDDC"],[0.43402907193440243,"#87BDDC"],[0.43496086470368966,"#87BCDC"],[0.43570629891912055,"#86BCDC"],[0.43589265747297801,"#86BCDC"],[0.43626537458069292,"#86BCDC"],[0.43794260156541209,"#85BCDB"],[0.44260156541185269,"#84BBDB"],[0.45191949310473378,"#80B9DA"],[0.45434215430488278,"#7FB8DA"],[0.45490122996645516,"#7EB8DA"],[0.45676481550503178,"#7EB8DA"],[0.45732389116660521,"#7DB7DA"],[0.45862840104360841,"#7DB7DA"],[0.45900111815132333,"#7DB7DA"],[0.4595601938128957,"#7DB7DA"],[0.46328736489004896,"#7BB6D9"],[0.46608274319791287,"#7AB6D9"],[0.46738725307491613,"#79B5D9"],[0.47577338799850888,"#76B3D8"],[0.48229593738352611,"#73B2D8"],[0.48285501304509848,"#73B2D8"],[0.48341408870667191,"#72B2D7"],[0.48676854267610919,"#71B1D7"],[0.48844576966082737,"#70B1D7"],[0.48937756243011565,"#70B0D7"],[0.49329109206112537,"#6EAFD7"],[0.4940365262765562,"#6EAFD7"],[0.4964591874767052,"#6DAFD6"],[0.49813641446142443,"#6CAED6"],[0.50540439806187143,"#69ADD5"],[0.50577711516958634,"#69ADD5"],[0.51043607901602683,"#68ACD5"],[0.51099515467760026,"#68ABD5"],[0.51658591129332809,"#66AAD4"],[0.51807677972418986,"#66AAD4"],[0.51844949683190478,"#65AAD4"],[0.52180395080134212,"#64A9D3"],[0.52217666790905704,"#64A9D3"],[0.52236302646291444,"#64A9D3"],[0.52385389489377621,"#64A9D3"],[0.52664927320164012,"#63A8D3"],[0.53484904957137547,"#60A6D2"],[0.53857622064852761,"#5FA5D1"],[0.54099888184867662,"#5FA5D1"],[0.54323518449496822,"#5EA4D0"],[0.54360790160268413,"#5EA4D0"],[0.54696235557212047,"#5DA3D0"],[0.54863958255683964,"#5CA3D0"],[0.55087588520313124,"#5BA2CF"],[0.55199403652627699,"#5BA2CF"],[0.5523667536339919,"#5BA2CF"],[0.55423033917256848,"#5AA2CF"],[0.55441669772642599,"#5AA2CF"],[0.55777115169586333,"#59A1CF"],[0.55907566157286648,"#59A1CE"],[0.56298919120387625,"#58A0CE"],[0.56541185240402525,"#579FCE"],[0.57081625046589668,"#559ECD"],[0.5736116287737606,"#549DCD"],[0.57417070443533391,"#549DCD"],[0.57510249720462225,"#549DCC"],[0.57547521431233717,"#549DCC"],[0.58050689526649268,"#529CCC"],[0.58386134923593003,"#519BCB"],[0.58702944465150986,"#509ACB"],[0.58870667163622803,"#4F9ACB"],[0.58907938874394394,"#4F9ACB"],[0.59504286246738769,"#4D99CA"],[0.59560193812896012,"#4D98CA"],[0.59709280655982178,"#4C98CA"],[0.60007454342154321,"#4B97C9"],[0.60193812896011989,"#4A97C9"],[0.60380171449869546,"#4A97C9"],[0.60659709280656038,"#4996C8"],[0.60827431979127855,"#4896C8"],[0.61367871785314998,"#4694C7"],[0.61498322773015313,"#4694C7"],[0.6166604547148713,"#4594C7"],[0.61871039880730538,"#4493C7"],[0.62318300409988847,"#4392C6"],[0.62504658963846516,"#4292C6"],[0.6261647409616099,"#4292C6"],[0.62802832650018647,"#4191C6"],[0.63492359299291867,"#408FC5"],[0.64219157659336568,"#3E8DC4"],[0.64293701080879651,"#3E8DC4"],[0.64442787923965716,"#3E8DC3"],[0.64591874767051782,"#3D8CC3"],[0.64740961610137959,"#3D8CC3"],[0.65020499440924351,"#3C8BC3"],[0.65206857994782019,"#3C8BC2"],[0.65430488259411168,"#3B8AC2"],[0.65915020499440968,"#3A89C1"],[0.66231830040998962,"#3A88C1"],[0.66269101751770454,"#3A88C1"],[0.66343645173313426,"#3988C1"],[0.67182258665672812,"#3785C0"],[0.67368617219530369,"#3785BF"],[0.67443160641073463,"#3785BF"],[0.67946328736489003,"#3583BF"],[0.68300409988818489,"#3582BE"],[0.68449496831904655,"#3482BE"],[0.68673127096533704,"#3482BE"],[0.69083115915020532,"#3380BD"],[0.69120387625792024,"#3280BD"],[0.70108087961237475,"#307EBC"],[0.70145359672008967,"#307EBC"],[0.70555348490495784,"#2F7DBB"],[0.70611256056653016,"#2F7CBB"],[0.70741707044353341,"#2E7CBB"],[0.70816250465896424,"#2E7CBB"],[0.7144986954901229,"#2C7ABA"],[0.71487141259783893,"#2C7ABA"],[0.71710771524413042,"#2B7AB9"],[0.72437569884457753,"#2978B8"],[0.72549385016772328,"#2977B8"],[0.72754379426015736,"#2877B8"],[0.73033917256802128,"#2876B8"],[0.73462541930674696,"#2675B7"],[0.73630264629146502,"#2675B7"],[0.73760715616846828,"#2574B7"],[0.74058889303019071,"#2473B6"],[0.74096161013790562,"#2473B6"],[0.74636600819977705,"#2272B5"],[0.7497204621692144,"#2171B5"],[0.75139768915393246,"#2171B5"],[0.75195676481550489,"#2170B5"],[0.75363399180022406,"#2070B4"],[0.75400670890793897,"#2070B4"],[0.7545657845695124,"#2070B4"],[0.75605665300037306,"#206FB4"],[0.75922474841595289,"#206FB3"],[0.75978382407752532,"#206EB3"],[0.76146105106224449,"#1F6EB3"],[0.7620201267238168,"#1F6EB3"],[0.76239284383153172,"#1F6EB3"],[0.77096533730898298,"#1E6CB1"],[0.77171077152441281,"#1E6BB1"],[0.77320163995527458,"#1E6BB0"],[0.77730152814014175,"#1D6AAF"],[0.77786060380171518,"#1D6AAF"],[0.77879239657100341,"#1D69AF"],[0.78363771897130141,"#1C68AE"],[0.78419679463287384,"#1C68AE"],[0.78494222884830467,"#1C68AE"],[0.7855013045098771,"#1C68AE"],[0.78829668281774201,"#1B67AD"],[0.78904211703317184,"#1B67AD"],[0.79109206112560593,"#1B66AD"],[0.79500559075661559,"#1A65AC"],[0.79575102497204653,"#1A65AC"],[0.79798732761833802,"#1A65AB"],[0.79873276183376885,"#1964AB"],[0.79910547894148376,"#1964AB"],[0.79929183749534127,"#1964AB"],[0.80972791651136811,"#1762A9"],[0.81252329481923202,"#1761A8"],[0.81550503168095445,"#1660A8"],[0.81662318300410019,"#1660A8"],[0.81718225866567262,"#1660A8"],[0.81848676854267688,"#165FA7"],[0.82575475214312388,"#145DA6"],[0.82650018635855371,"#145DA6"],[0.82761833768169946,"#145DA5"],[0.83004099888184957,"#145CA5"],[0.83153186731271023,"#135CA5"],[0.83730898248229657,"#125AA3"],[0.83749534103615397,"#125AA3"],[0.84122251211330623,"#1159A3"],[0.84159522922102115,"#1159A3"],[0.84420424897502866,"#1059A2"],[0.85184494968319058,"#0F57A1"],[0.85482668654491301,"#0E56A0"],[0.85519940365262792,"#0E56A0"],[0.8570629891912046,"#0D55A0"],[0.85799478196049284,"#0D559F"],[0.86153559448378769,"#0C549F"],[0.86321282146850575,"#0C549E"],[0.86339918002236327,"#0C549E"],[0.8641446142377941,"#0B549E"],[0.86470368989936652,"#0B549E"],[0.86526276556093984,"#0B539E"],[0.86600819977636967,"#0B539E"],[0.87159895639209861,"#09529D"],[0.87215803205367204,"#09529D"],[0.87681699590011253,"#08519B"],[0.87700335445397004,"#08509B"],[0.88632128214685113,"#084E97"],[0.88743943346999687,"#084E97"],[0.88799850913156919,"#084D97"],[0.89004845322400339,"#084D96"],[0.89172568020872145,"#084C95"],[0.89582556839358962,"#084B94"],[0.90122996645546105,"#094A91"],[0.90346626910175265,"#094991"],[0.90365262765561005,"#094990"],[0.90868430860976557,"#09488E"],[0.91147968691762948,"#09478D"],[0.91688408497950091,"#09468B"],[0.918934029071935,"#09458A"],[0.92042489750279566,"#09458A"],[0.93272456205739918,"#094185"],[0.93384271338054492,"#094185"],[0.93402907193440243,"#094184"],[0.93738352590383978,"#094083"],[0.94148341408870684,"#093F82"],[0.94371971673499844,"#093F81"],[0.94819232202758152,"#093D7F"],[0.95341036153559444,"#093C7D"],[0.95676481550503178,"#093B7C"],[0.95844204248975096,"#093B7B"],[0.96123742079761487,"#093A7A"],[0.96589638464405547,"#093978"],[0.97409616101379082,"#083775"],[0.97838240775251639,"#083673"],[0.99180022363026465,"#08326E"],[1,"#08306B"]],"hoverinfo":"text","text":[["Value:  315.42 <br> Year :  1959 <br> Month  : 1","Value:  316.27 <br> Year :  1960 <br> Month  : 1","Value:  316.73 <br> Year :  1961 <br> Month  : 1","Value:  317.78 <br> Year :  1962 <br> Month  : 1","Value:  318.58 <br> Year :  1963 <br> Month  : 1","Value:  319.41 <br> Year :  1964 <br> Month  : 1","Value:  319.27 <br> Year :  1965 <br> Month  : 1","Value:  320.46 <br> Year :  1966 <br> Month  : 1","Value:  322.17 <br> Year :  1967 <br> Month  : 1","Value:  322.4 <br> Year :  1968 <br> Month  : 1","Value:  323.83 <br> Year :  1969 <br> Month  : 1","Value:  324.89 <br> Year :  1970 <br> Month  : 1","Value:  326.01 <br> Year :  1971 <br> Month  : 1","Value:  326.6 <br> Year :  1972 <br> Month  : 1","Value:  328.37 <br> Year :  1973 <br> Month  : 1","Value:  329.18 <br> Year :  1974 <br> Month  : 1","Value:  330.23 <br> Year :  1975 <br> Month  : 1","Value:  331.58 <br> Year :  1976 <br> Month  : 1","Value:  332.75 <br> Year :  1977 <br> Month  : 1","Value:  334.8 <br> Year :  1978 <br> Month  : 1","Value:  336.05 <br> Year :  1979 <br> Month  : 1","Value:  337.84 <br> Year :  1980 <br> Month  : 1","Value:  339.06 <br> Year :  1981 <br> Month  : 1","Value:  340.57 <br> Year :  1982 <br> Month  : 1","Value:  341.2 <br> Year :  1983 <br> Month  : 1","Value:  343.52 <br> Year :  1984 <br> Month  : 1","Value:  344.79 <br> Year :  1985 <br> Month  : 1","Value:  346.11 <br> Year :  1986 <br> Month  : 1","Value:  347.84 <br> Year :  1987 <br> Month  : 1","Value:  350.25 <br> Year :  1988 <br> Month  : 1","Value:  352.6 <br> Year :  1989 <br> Month  : 1","Value:  353.5 <br> Year :  1990 <br> Month  : 1","Value:  354.59 <br> Year :  1991 <br> Month  : 1","Value:  355.88 <br> Year :  1992 <br> Month  : 1","Value:  356.63 <br> Year :  1993 <br> Month  : 1","Value:  358.34 <br> Year :  1994 <br> Month  : 1","Value:  359.98 <br> Year :  1995 <br> Month  : 1","Value:  362.09 <br> Year :  1996 <br> Month  : 1","Value:  363.23 <br> Year :  1997 <br> Month  : 1"],["Value:  316.31 <br> Year :  1959 <br> Month  : 2","Value:  316.81 <br> Year :  1960 <br> Month  : 2","Value:  317.54 <br> Year :  1961 <br> Month  : 2","Value:  318.4 <br> Year :  1962 <br> Month  : 2","Value:  318.92 <br> Year :  1963 <br> Month  : 2","Value:  320.07 <br> Year :  1964 <br> Month  : 2","Value:  320.28 <br> Year :  1965 <br> Month  : 2","Value:  321.43 <br> Year :  1966 <br> Month  : 2","Value:  322.34 <br> Year :  1967 <br> Month  : 2","Value:  322.99 <br> Year :  1968 <br> Month  : 2","Value:  324.26 <br> Year :  1969 <br> Month  : 2","Value:  325.82 <br> Year :  1970 <br> Month  : 2","Value:  326.51 <br> Year :  1971 <br> Month  : 2","Value:  327.47 <br> Year :  1972 <br> Month  : 2","Value:  329.4 <br> Year :  1973 <br> Month  : 2","Value:  330.55 <br> Year :  1974 <br> Month  : 2","Value:  331.25 <br> Year :  1975 <br> Month  : 2","Value:  332.39 <br> Year :  1976 <br> Month  : 2","Value:  333.24 <br> Year :  1977 <br> Month  : 2","Value:  335.22 <br> Year :  1978 <br> Month  : 2","Value:  336.59 <br> Year :  1979 <br> Month  : 2","Value:  338.19 <br> Year :  1980 <br> Month  : 2","Value:  340.3 <br> Year :  1981 <br> Month  : 2","Value:  341.44 <br> Year :  1982 <br> Month  : 2","Value:  342.35 <br> Year :  1983 <br> Month  : 2","Value:  344.33 <br> Year :  1984 <br> Month  : 2","Value:  345.82 <br> Year :  1985 <br> Month  : 2","Value:  346.78 <br> Year :  1986 <br> Month  : 2","Value:  348.29 <br> Year :  1987 <br> Month  : 2","Value:  351.54 <br> Year :  1988 <br> Month  : 2","Value:  352.92 <br> Year :  1989 <br> Month  : 2","Value:  354.55 <br> Year :  1990 <br> Month  : 2","Value:  355.63 <br> Year :  1991 <br> Month  : 2","Value:  356.63 <br> Year :  1992 <br> Month  : 2","Value:  357.1 <br> Year :  1993 <br> Month  : 2","Value:  358.89 <br> Year :  1994 <br> Month  : 2","Value:  361.03 <br> Year :  1995 <br> Month  : 2","Value:  363.29 <br> Year :  1996 <br> Month  : 2","Value:  364.06 <br> Year :  1997 <br> Month  : 2"],["Value:  316.5 <br> Year :  1959 <br> Month  : 3","Value:  317.42 <br> Year :  1960 <br> Month  : 3","Value:  318.38 <br> Year :  1961 <br> Month  : 3","Value:  319.53 <br> Year :  1962 <br> Month  : 3","Value:  319.7 <br> Year :  1963 <br> Month  : 3","Value:  320.74 <br> Year :  1964 <br> Month  : 3","Value:  320.73 <br> Year :  1965 <br> Month  : 3","Value:  322.23 <br> Year :  1966 <br> Month  : 3","Value:  322.88 <br> Year :  1967 <br> Month  : 3","Value:  323.73 <br> Year :  1968 <br> Month  : 3","Value:  325.47 <br> Year :  1969 <br> Month  : 3","Value:  326.77 <br> Year :  1970 <br> Month  : 3","Value:  327.01 <br> Year :  1971 <br> Month  : 3","Value:  327.58 <br> Year :  1972 <br> Month  : 3","Value:  330.14 <br> Year :  1973 <br> Month  : 3","Value:  331.32 <br> Year :  1974 <br> Month  : 3","Value:  331.87 <br> Year :  1975 <br> Month  : 3","Value:  333.33 <br> Year :  1976 <br> Month  : 3","Value:  334.53 <br> Year :  1977 <br> Month  : 3","Value:  336.47 <br> Year :  1978 <br> Month  : 3","Value:  337.79 <br> Year :  1979 <br> Month  : 3","Value:  339.91 <br> Year :  1980 <br> Month  : 3","Value:  341.21 <br> Year :  1981 <br> Month  : 3","Value:  342.53 <br> Year :  1982 <br> Month  : 3","Value:  342.93 <br> Year :  1983 <br> Month  : 3","Value:  345.11 <br> Year :  1984 <br> Month  : 3","Value:  347.25 <br> Year :  1985 <br> Month  : 3","Value:  347.68 <br> Year :  1986 <br> Month  : 3","Value:  349.23 <br> Year :  1987 <br> Month  : 3","Value:  352.05 <br> Year :  1988 <br> Month  : 3","Value:  353.53 <br> Year :  1989 <br> Month  : 3","Value:  355.23 <br> Year :  1990 <br> Month  : 3","Value:  357.03 <br> Year :  1991 <br> Month  : 3","Value:  357.72 <br> Year :  1992 <br> Month  : 3","Value:  358.32 <br> Year :  1993 <br> Month  : 3","Value:  359.95 <br> Year :  1994 <br> Month  : 3","Value:  361.66 <br> Year :  1995 <br> Month  : 3","Value:  364.06 <br> Year :  1996 <br> Month  : 3","Value:  364.61 <br> Year :  1997 <br> Month  : 3"],["Value:  317.56 <br> Year :  1959 <br> Month  : 4","Value:  318.87 <br> Year :  1960 <br> Month  : 4","Value:  319.31 <br> Year :  1961 <br> Month  : 4","Value:  320.42 <br> Year :  1962 <br> Month  : 4","Value:  321.22 <br> Year :  1963 <br> Month  : 4","Value:  321.4 <br> Year :  1964 <br> Month  : 4","Value:  321.97 <br> Year :  1965 <br> Month  : 4","Value:  323.54 <br> Year :  1966 <br> Month  : 4","Value:  324.25 <br> Year :  1967 <br> Month  : 4","Value:  324.86 <br> Year :  1968 <br> Month  : 4","Value:  326.5 <br> Year :  1969 <br> Month  : 4","Value:  327.97 <br> Year :  1970 <br> Month  : 4","Value:  327.62 <br> Year :  1971 <br> Month  : 4","Value:  329.56 <br> Year :  1972 <br> Month  : 4","Value:  331.33 <br> Year :  1973 <br> Month  : 4","Value:  332.48 <br> Year :  1974 <br> Month  : 4","Value:  333.14 <br> Year :  1975 <br> Month  : 4","Value:  334.41 <br> Year :  1976 <br> Month  : 4","Value:  335.9 <br> Year :  1977 <br> Month  : 4","Value:  337.59 <br> Year :  1978 <br> Month  : 4","Value:  338.71 <br> Year :  1979 <br> Month  : 4","Value:  340.6 <br> Year :  1980 <br> Month  : 4","Value:  342.33 <br> Year :  1981 <br> Month  : 4","Value:  343.39 <br> Year :  1982 <br> Month  : 4","Value:  344.77 <br> Year :  1983 <br> Month  : 4","Value:  346.88 <br> Year :  1984 <br> Month  : 4","Value:  348.17 <br> Year :  1985 <br> Month  : 4","Value:  349.37 <br> Year :  1986 <br> Month  : 4","Value:  350.8 <br> Year :  1987 <br> Month  : 4","Value:  353.41 <br> Year :  1988 <br> Month  : 4","Value:  355.26 <br> Year :  1989 <br> Month  : 4","Value:  356.04 <br> Year :  1990 <br> Month  : 4","Value:  358.48 <br> Year :  1991 <br> Month  : 4","Value:  359.07 <br> Year :  1992 <br> Month  : 4","Value:  359.41 <br> Year :  1993 <br> Month  : 4","Value:  361.25 <br> Year :  1994 <br> Month  : 4","Value:  363.48 <br> Year :  1995 <br> Month  : 4","Value:  364.76 <br> Year :  1996 <br> Month  : 4","Value:  366.4 <br> Year :  1997 <br> Month  : 4"],["Value:  318.13 <br> Year :  1959 <br> Month  : 5","Value:  319.87 <br> Year :  1960 <br> Month  : 5","Value:  320.42 <br> Year :  1961 <br> Month  : 5","Value:  320.85 <br> Year :  1962 <br> Month  : 5","Value:  322.08 <br> Year :  1963 <br> Month  : 5","Value:  322.06 <br> Year :  1964 <br> Month  : 5","Value:  322 <br> Year :  1965 <br> Month  : 5","Value:  323.91 <br> Year :  1966 <br> Month  : 5","Value:  324.83 <br> Year :  1967 <br> Month  : 5","Value:  325.4 <br> Year :  1968 <br> Month  : 5","Value:  327.21 <br> Year :  1969 <br> Month  : 5","Value:  327.91 <br> Year :  1970 <br> Month  : 5","Value:  328.76 <br> Year :  1971 <br> Month  : 5","Value:  329.9 <br> Year :  1972 <br> Month  : 5","Value:  332.31 <br> Year :  1973 <br> Month  : 5","Value:  332.92 <br> Year :  1974 <br> Month  : 5","Value:  333.8 <br> Year :  1975 <br> Month  : 5","Value:  334.71 <br> Year :  1976 <br> Month  : 5","Value:  336.57 <br> Year :  1977 <br> Month  : 5","Value:  337.84 <br> Year :  1978 <br> Month  : 5","Value:  339.3 <br> Year :  1979 <br> Month  : 5","Value:  341.29 <br> Year :  1980 <br> Month  : 5","Value:  342.74 <br> Year :  1981 <br> Month  : 5","Value:  343.96 <br> Year :  1982 <br> Month  : 5","Value:  345.58 <br> Year :  1983 <br> Month  : 5","Value:  347.25 <br> Year :  1984 <br> Month  : 5","Value:  348.74 <br> Year :  1985 <br> Month  : 5","Value:  350.03 <br> Year :  1986 <br> Month  : 5","Value:  351.66 <br> Year :  1987 <br> Month  : 5","Value:  354.04 <br> Year :  1988 <br> Month  : 5","Value:  355.52 <br> Year :  1989 <br> Month  : 5","Value:  357 <br> Year :  1990 <br> Month  : 5","Value:  359.22 <br> Year :  1991 <br> Month  : 5","Value:  359.58 <br> Year :  1992 <br> Month  : 5","Value:  360.23 <br> Year :  1993 <br> Month  : 5","Value:  361.67 <br> Year :  1994 <br> Month  : 5","Value:  363.82 <br> Year :  1995 <br> Month  : 5","Value:  365.45 <br> Year :  1996 <br> Month  : 5","Value:  366.84 <br> Year :  1997 <br> Month  : 5"],["Value:  318 <br> Year :  1959 <br> Month  : 6","Value:  319.43 <br> Year :  1960 <br> Month  : 6","Value:  319.61 <br> Year :  1961 <br> Month  : 6","Value:  320.45 <br> Year :  1962 <br> Month  : 6","Value:  321.31 <br> Year :  1963 <br> Month  : 6","Value:  321.73 <br> Year :  1964 <br> Month  : 6","Value:  321.71 <br> Year :  1965 <br> Month  : 6","Value:  323.59 <br> Year :  1966 <br> Month  : 6","Value:  323.93 <br> Year :  1967 <br> Month  : 6","Value:  325.2 <br> Year :  1968 <br> Month  : 6","Value:  326.54 <br> Year :  1969 <br> Month  : 6","Value:  327.5 <br> Year :  1970 <br> Month  : 6","Value:  328.4 <br> Year :  1971 <br> Month  : 6","Value:  328.92 <br> Year :  1972 <br> Month  : 6","Value:  331.9 <br> Year :  1973 <br> Month  : 6","Value:  332.08 <br> Year :  1974 <br> Month  : 6","Value:  333.43 <br> Year :  1975 <br> Month  : 6","Value:  334.17 <br> Year :  1976 <br> Month  : 6","Value:  336.1 <br> Year :  1977 <br> Month  : 6","Value:  337.72 <br> Year :  1978 <br> Month  : 6","Value:  339.12 <br> Year :  1979 <br> Month  : 6","Value:  341 <br> Year :  1980 <br> Month  : 6","Value:  342.08 <br> Year :  1981 <br> Month  : 6","Value:  343.18 <br> Year :  1982 <br> Month  : 6","Value:  345.14 <br> Year :  1983 <br> Month  : 6","Value:  346.62 <br> Year :  1984 <br> Month  : 6","Value:  348.07 <br> Year :  1985 <br> Month  : 6","Value:  349.37 <br> Year :  1986 <br> Month  : 6","Value:  351.07 <br> Year :  1987 <br> Month  : 6","Value:  353.62 <br> Year :  1988 <br> Month  : 6","Value:  354.97 <br> Year :  1989 <br> Month  : 6","Value:  356.07 <br> Year :  1990 <br> Month  : 6","Value:  358.12 <br> Year :  1991 <br> Month  : 6","Value:  359.17 <br> Year :  1992 <br> Month  : 6","Value:  359.55 <br> Year :  1993 <br> Month  : 6","Value:  360.94 <br> Year :  1994 <br> Month  : 6","Value:  363.3 <br> Year :  1995 <br> Month  : 6","Value:  365.01 <br> Year :  1996 <br> Month  : 6","Value:  365.68 <br> Year :  1997 <br> Month  : 6"],["Value:  316.39 <br> Year :  1959 <br> Month  : 7","Value:  318.01 <br> Year :  1960 <br> Month  : 7","Value:  318.42 <br> Year :  1961 <br> Month  : 7","Value:  319.45 <br> Year :  1962 <br> Month  : 7","Value:  319.58 <br> Year :  1963 <br> Month  : 7","Value:  320.27 <br> Year :  1964 <br> Month  : 7","Value:  321.05 <br> Year :  1965 <br> Month  : 7","Value:  322.24 <br> Year :  1966 <br> Month  : 7","Value:  322.38 <br> Year :  1967 <br> Month  : 7","Value:  323.98 <br> Year :  1968 <br> Month  : 7","Value:  325.72 <br> Year :  1969 <br> Month  : 7","Value:  326.18 <br> Year :  1970 <br> Month  : 7","Value:  327.2 <br> Year :  1971 <br> Month  : 7","Value:  327.88 <br> Year :  1972 <br> Month  : 7","Value:  330.7 <br> Year :  1973 <br> Month  : 7","Value:  331.01 <br> Year :  1974 <br> Month  : 7","Value:  331.73 <br> Year :  1975 <br> Month  : 7","Value:  332.89 <br> Year :  1976 <br> Month  : 7","Value:  334.76 <br> Year :  1977 <br> Month  : 7","Value:  336.37 <br> Year :  1978 <br> Month  : 7","Value:  337.56 <br> Year :  1979 <br> Month  : 7","Value:  339.39 <br> Year :  1980 <br> Month  : 7","Value:  340.32 <br> Year :  1981 <br> Month  : 7","Value:  341.88 <br> Year :  1982 <br> Month  : 7","Value:  343.81 <br> Year :  1983 <br> Month  : 7","Value:  345.22 <br> Year :  1984 <br> Month  : 7","Value:  346.38 <br> Year :  1985 <br> Month  : 7","Value:  347.76 <br> Year :  1986 <br> Month  : 7","Value:  349.33 <br> Year :  1987 <br> Month  : 7","Value:  352.22 <br> Year :  1988 <br> Month  : 7","Value:  353.75 <br> Year :  1989 <br> Month  : 7","Value:  354.67 <br> Year :  1990 <br> Month  : 7","Value:  356.06 <br> Year :  1991 <br> Month  : 7","Value:  356.94 <br> Year :  1992 <br> Month  : 7","Value:  357.53 <br> Year :  1993 <br> Month  : 7","Value:  359.55 <br> Year :  1994 <br> Month  : 7","Value:  361.94 <br> Year :  1995 <br> Month  : 7","Value:  363.7 <br> Year :  1996 <br> Month  : 7","Value:  364.52 <br> Year :  1997 <br> Month  : 7"],["Value:  314.65 <br> Year :  1959 <br> Month  : 8","Value:  315.74 <br> Year :  1960 <br> Month  : 8","Value:  316.63 <br> Year :  1961 <br> Month  : 8","Value:  317.25 <br> Year :  1962 <br> Month  : 8","Value:  317.61 <br> Year :  1963 <br> Month  : 8","Value:  318.54 <br> Year :  1964 <br> Month  : 8","Value:  318.71 <br> Year :  1965 <br> Month  : 8","Value:  320.2 <br> Year :  1966 <br> Month  : 8","Value:  320.76 <br> Year :  1967 <br> Month  : 8","Value:  321.95 <br> Year :  1968 <br> Month  : 8","Value:  323.5 <br> Year :  1969 <br> Month  : 8","Value:  324.53 <br> Year :  1970 <br> Month  : 8","Value:  325.27 <br> Year :  1971 <br> Month  : 8","Value:  326.16 <br> Year :  1972 <br> Month  : 8","Value:  329.15 <br> Year :  1973 <br> Month  : 8","Value:  329.23 <br> Year :  1974 <br> Month  : 8","Value:  329.9 <br> Year :  1975 <br> Month  : 8","Value:  330.77 <br> Year :  1976 <br> Month  : 8","Value:  332.59 <br> Year :  1977 <br> Month  : 8","Value:  334.51 <br> Year :  1978 <br> Month  : 8","Value:  335.92 <br> Year :  1979 <br> Month  : 8","Value:  337.43 <br> Year :  1980 <br> Month  : 8","Value:  338.26 <br> Year :  1981 <br> Month  : 8","Value:  339.65 <br> Year :  1982 <br> Month  : 8","Value:  342.21 <br> Year :  1983 <br> Month  : 8","Value:  343.11 <br> Year :  1984 <br> Month  : 8","Value:  344.51 <br> Year :  1985 <br> Month  : 8","Value:  345.73 <br> Year :  1986 <br> Month  : 8","Value:  347.92 <br> Year :  1987 <br> Month  : 8","Value:  350.27 <br> Year :  1988 <br> Month  : 8","Value:  351.52 <br> Year :  1989 <br> Month  : 8","Value:  352.76 <br> Year :  1990 <br> Month  : 8","Value:  353.92 <br> Year :  1991 <br> Month  : 8","Value:  354.92 <br> Year :  1992 <br> Month  : 8","Value:  355.48 <br> Year :  1993 <br> Month  : 8","Value:  357.49 <br> Year :  1994 <br> Month  : 8","Value:  359.5 <br> Year :  1995 <br> Month  : 8","Value:  361.54 <br> Year :  1996 <br> Month  : 8","Value:  362.57 <br> Year :  1997 <br> Month  : 8"],["Value:  313.68 <br> Year :  1959 <br> Month  : 9","Value:  314 <br> Year :  1960 <br> Month  : 9","Value:  314.83 <br> Year :  1961 <br> Month  : 9","Value:  316.11 <br> Year :  1962 <br> Month  : 9","Value:  316.05 <br> Year :  1963 <br> Month  : 9","Value:  316.54 <br> Year :  1964 <br> Month  : 9","Value:  317.66 <br> Year :  1965 <br> Month  : 9","Value:  318.48 <br> Year :  1966 <br> Month  : 9","Value:  319.1 <br> Year :  1967 <br> Month  : 9","Value:  320.18 <br> Year :  1968 <br> Month  : 9","Value:  322.22 <br> Year :  1969 <br> Month  : 9","Value:  322.93 <br> Year :  1970 <br> Month  : 9","Value:  323.2 <br> Year :  1971 <br> Month  : 9","Value:  324.68 <br> Year :  1972 <br> Month  : 9","Value:  327.35 <br> Year :  1973 <br> Month  : 9","Value:  327.27 <br> Year :  1974 <br> Month  : 9","Value:  328.4 <br> Year :  1975 <br> Month  : 9","Value:  329.14 <br> Year :  1976 <br> Month  : 9","Value:  331.42 <br> Year :  1977 <br> Month  : 9","Value:  332.6 <br> Year :  1978 <br> Month  : 9","Value:  333.75 <br> Year :  1979 <br> Month  : 9","Value:  335.72 <br> Year :  1980 <br> Month  : 9","Value:  336.52 <br> Year :  1981 <br> Month  : 9","Value:  337.81 <br> Year :  1982 <br> Month  : 9","Value:  339.69 <br> Year :  1983 <br> Month  : 9","Value:  340.9 <br> Year :  1984 <br> Month  : 9","Value:  342.92 <br> Year :  1985 <br> Month  : 9","Value:  344.68 <br> Year :  1986 <br> Month  : 9","Value:  346.27 <br> Year :  1987 <br> Month  : 9","Value:  348.55 <br> Year :  1988 <br> Month  : 9","Value:  349.64 <br> Year :  1989 <br> Month  : 9","Value:  350.82 <br> Year :  1990 <br> Month  : 9","Value:  352.05 <br> Year :  1991 <br> Month  : 9","Value:  352.94 <br> Year :  1992 <br> Month  : 9","Value:  353.67 <br> Year :  1993 <br> Month  : 9","Value:  355.84 <br> Year :  1994 <br> Month  : 9","Value:  358.11 <br> Year :  1995 <br> Month  : 9","Value:  359.51 <br> Year :  1996 <br> Month  : 9","Value:  360.24 <br> Year :  1997 <br> Month  : 9"],["Value:  313.18 <br> Year :  1959 <br> Month  : 10","Value:  313.68 <br> Year :  1960 <br> Month  : 10","Value:  315.16 <br> Year :  1961 <br> Month  : 10","Value:  315.27 <br> Year :  1962 <br> Month  : 10","Value:  315.83 <br> Year :  1963 <br> Month  : 10","Value:  316.71 <br> Year :  1964 <br> Month  : 10","Value:  317.14 <br> Year :  1965 <br> Month  : 10","Value:  317.94 <br> Year :  1966 <br> Month  : 10","Value:  319.24 <br> Year :  1967 <br> Month  : 10","Value:  320.09 <br> Year :  1968 <br> Month  : 10","Value:  321.62 <br> Year :  1969 <br> Month  : 10","Value:  322.9 <br> Year :  1970 <br> Month  : 10","Value:  323.4 <br> Year :  1971 <br> Month  : 10","Value:  325.04 <br> Year :  1972 <br> Month  : 10","Value:  327.02 <br> Year :  1973 <br> Month  : 10","Value:  327.21 <br> Year :  1974 <br> Month  : 10","Value:  328.17 <br> Year :  1975 <br> Month  : 10","Value:  328.78 <br> Year :  1976 <br> Month  : 10","Value:  330.98 <br> Year :  1977 <br> Month  : 10","Value:  332.38 <br> Year :  1978 <br> Month  : 10","Value:  333.7 <br> Year :  1979 <br> Month  : 10","Value:  335.84 <br> Year :  1980 <br> Month  : 10","Value:  336.68 <br> Year :  1981 <br> Month  : 10","Value:  337.69 <br> Year :  1982 <br> Month  : 10","Value:  339.82 <br> Year :  1983 <br> Month  : 10","Value:  341.18 <br> Year :  1984 <br> Month  : 10","Value:  342.62 <br> Year :  1985 <br> Month  : 10","Value:  343.99 <br> Year :  1986 <br> Month  : 10","Value:  346.18 <br> Year :  1987 <br> Month  : 10","Value:  348.72 <br> Year :  1988 <br> Month  : 10","Value:  349.83 <br> Year :  1989 <br> Month  : 10","Value:  351.04 <br> Year :  1990 <br> Month  : 10","Value:  352.11 <br> Year :  1991 <br> Month  : 10","Value:  353.23 <br> Year :  1992 <br> Month  : 10","Value:  353.95 <br> Year :  1993 <br> Month  : 10","Value:  356 <br> Year :  1994 <br> Month  : 10","Value:  357.8 <br> Year :  1995 <br> Month  : 10","Value:  359.65 <br> Year :  1996 <br> Month  : 10","Value:  360.83 <br> Year :  1997 <br> Month  : 10"],["Value:  314.66 <br> Year :  1959 <br> Month  : 11","Value:  314.84 <br> Year :  1960 <br> Month  : 11","Value:  315.94 <br> Year :  1961 <br> Month  : 11","Value:  316.53 <br> Year :  1962 <br> Month  : 11","Value:  316.91 <br> Year :  1963 <br> Month  : 11","Value:  317.53 <br> Year :  1964 <br> Month  : 11","Value:  318.7 <br> Year :  1965 <br> Month  : 11","Value:  319.63 <br> Year :  1966 <br> Month  : 11","Value:  320.56 <br> Year :  1967 <br> Month  : 11","Value:  321.16 <br> Year :  1968 <br> Month  : 11","Value:  322.69 <br> Year :  1969 <br> Month  : 11","Value:  323.85 <br> Year :  1970 <br> Month  : 11","Value:  324.63 <br> Year :  1971 <br> Month  : 11","Value:  326.34 <br> Year :  1972 <br> Month  : 11","Value:  327.99 <br> Year :  1973 <br> Month  : 11","Value:  328.29 <br> Year :  1974 <br> Month  : 11","Value:  329.32 <br> Year :  1975 <br> Month  : 11","Value:  330.14 <br> Year :  1976 <br> Month  : 11","Value:  332.24 <br> Year :  1977 <br> Month  : 11","Value:  333.75 <br> Year :  1978 <br> Month  : 11","Value:  335.12 <br> Year :  1979 <br> Month  : 11","Value:  336.93 <br> Year :  1980 <br> Month  : 11","Value:  338.19 <br> Year :  1981 <br> Month  : 11","Value:  339.09 <br> Year :  1982 <br> Month  : 11","Value:  340.98 <br> Year :  1983 <br> Month  : 11","Value:  342.8 <br> Year :  1984 <br> Month  : 11","Value:  344.06 <br> Year :  1985 <br> Month  : 11","Value:  345.48 <br> Year :  1986 <br> Month  : 11","Value:  347.64 <br> Year :  1987 <br> Month  : 11","Value:  349.91 <br> Year :  1988 <br> Month  : 11","Value:  351.14 <br> Year :  1989 <br> Month  : 11","Value:  352.69 <br> Year :  1990 <br> Month  : 11","Value:  353.64 <br> Year :  1991 <br> Month  : 11","Value:  354.09 <br> Year :  1992 <br> Month  : 11","Value:  355.3 <br> Year :  1993 <br> Month  : 11","Value:  357.59 <br> Year :  1994 <br> Month  : 11","Value:  359.61 <br> Year :  1995 <br> Month  : 11","Value:  360.8 <br> Year :  1996 <br> Month  : 11","Value:  362.49 <br> Year :  1997 <br> Month  : 11"],["Value:  315.43 <br> Year :  1959 <br> Month  : 12","Value:  316.03 <br> Year :  1960 <br> Month  : 12","Value:  316.85 <br> Year :  1961 <br> Month  : 12","Value:  317.53 <br> Year :  1962 <br> Month  : 12","Value:  318.2 <br> Year :  1963 <br> Month  : 12","Value:  318.55 <br> Year :  1964 <br> Month  : 12","Value:  319.25 <br> Year :  1965 <br> Month  : 12","Value:  320.87 <br> Year :  1966 <br> Month  : 12","Value:  321.8 <br> Year :  1967 <br> Month  : 12","Value:  322.74 <br> Year :  1968 <br> Month  : 12","Value:  323.95 <br> Year :  1969 <br> Month  : 12","Value:  324.96 <br> Year :  1970 <br> Month  : 12","Value:  325.85 <br> Year :  1971 <br> Month  : 12","Value:  327.39 <br> Year :  1972 <br> Month  : 12","Value:  328.48 <br> Year :  1973 <br> Month  : 12","Value:  329.41 <br> Year :  1974 <br> Month  : 12","Value:  330.59 <br> Year :  1975 <br> Month  : 12","Value:  331.52 <br> Year :  1976 <br> Month  : 12","Value:  333.68 <br> Year :  1977 <br> Month  : 12","Value:  334.78 <br> Year :  1978 <br> Month  : 12","Value:  336.56 <br> Year :  1979 <br> Month  : 12","Value:  338.04 <br> Year :  1980 <br> Month  : 12","Value:  339.44 <br> Year :  1981 <br> Month  : 12","Value:  340.32 <br> Year :  1982 <br> Month  : 12","Value:  342.82 <br> Year :  1983 <br> Month  : 12","Value:  344.04 <br> Year :  1984 <br> Month  : 12","Value:  345.38 <br> Year :  1985 <br> Month  : 12","Value:  346.72 <br> Year :  1986 <br> Month  : 12","Value:  348.78 <br> Year :  1987 <br> Month  : 12","Value:  351.18 <br> Year :  1988 <br> Month  : 12","Value:  352.37 <br> Year :  1989 <br> Month  : 12","Value:  354.07 <br> Year :  1990 <br> Month  : 12","Value:  354.89 <br> Year :  1991 <br> Month  : 12","Value:  355.33 <br> Year :  1992 <br> Month  : 12","Value:  356.78 <br> Year :  1993 <br> Month  : 12","Value:  359.05 <br> Year :  1994 <br> Month  : 12","Value:  360.74 <br> Year :  1995 <br> Month  : 12","Value:  362.38 <br> Year :  1996 <br> Month  : 12","Value:  364.34 <br> Year :  1997 <br> Month  : 12"]],"xgap":3,"ygap":3,"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"heatmap"}},"layout":{"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Heatmap - co2","xaxis":{"domain":[0,1],"automargin":true,"title":"Year"},"yaxis":{"domain":[0,1],"automargin":true,"title":"Month"},"scene":{"zaxis":{"title":[]}},"hovermode":"closest","showlegend":false,"legend":{"yanchor":"top","y":0.5}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"data":[{"colorbar":{"title":"","ticklen":2,"len":0.5,"lenmode":"fraction","y":1,"yanchor":"top"},"colorscale":[[0,"#F7FBFF"],[0.0093179276928811085,"#F5FAFE"],[0.015281401416324891,"#F4F9FE"],[0.027394707417069911,"#F2F7FD"],[0.027581065970928419,"#F1F7FD"],[0.030749161386507236,"#F1F7FD"],[0.030935519940364687,"#F1F7FD"],[0.036898993663809533,"#F0F6FD"],[0.038948937756242571,"#EFF6FD"],[0.041744316064107535,"#EFF6FC"],[0.041930674617964993,"#EFF6FC"],[0.047707789787551316,"#EDF5FC"],[0.049385016772269454,"#EDF5FC"],[0.051434960864703554,"#EDF4FC"],[0.053112187849421684,"#ECF4FC"],[0.053484904957137647,"#ECF4FC"],[0.054603056280283425,"#ECF4FC"],[0.057584793142004785,"#ECF4FB"],[0.058330227357435656,"#EBF4FB"],[0.059821095788296336,"#EBF3FB"],[0.061871039880730436,"#EBF3FB"],[0.062430115542302794,"#EBF3FB"],[0.062616474096161306,"#EAF3FB"],[0.064293701080879437,"#EAF3FB"],[0.065784569511740124,"#EAF3FB"],[0.066157286619456079,"#EAF3FB"],[0.067648155050316766,"#E9F2FB"],[0.068393589265747637,"#E9F2FB"],[0.069511740588893409,"#E9F2FB"],[0.073797987327617998,"#E8F2FA"],[0.075847931420052098,"#E8F1FA"],[0.079016026835631969,"#E7F1FA"],[0.081065970928065015,"#E7F1FA"],[0.081252329481923527,"#E7F1FA"],[0.081625046589638428,"#E7F1FA"],[0.082556839358926756,"#E7F0FA"],[0.083488632128215071,"#E6F0FA"],[0.08572493477450556,"#E6F0FA"],[0.088706671636227988,"#E5F0F9"],[0.08982482295937376,"#E5EFF9"],[0.090011181513231217,"#E5EFF9"],[0.092247484159522761,"#E5EFF9"],[0.09355199403652599,"#E4EFF9"],[0.096906448005963319,"#E4EFF9"],[0.09727916511367822,"#E4EFF9"],[0.09765188222139419,"#E3EEF9"],[0.098770033544539962,"#E3EEF9"],[0.099888184867685734,"#E3EEF9"],[0.10007454342154319,"#E3EEF9"],[0.10063361908311555,"#E3EEF9"],[0.10286992172940711,"#E2EEF8"],[0.10305628028326455,"#E2EEF8"],[0.10603801714498698,"#E2EDF8"],[0.10696980991427529,"#E2EDF8"],[0.11032426388371262,"#E1EDF8"],[0.11293328363771908,"#E0EDF8"],[0.11311964219157654,"#E0EDF8"],[0.11349235929929144,"#E0ECF8"],[0.11423779351472231,"#E0ECF8"],[0.11610137905329895,"#E0ECF8"],[0.11647409616101385,"#E0ECF8"],[0.11684681326872877,"#E0ECF8"],[0.11833768169958944,"#DFECF7"],[0.11926947446887777,"#DFECF7"],[0.11982855013045118,"#DFECF7"],[0.12020126723816608,"#DFECF7"],[0.12150577711516931,"#DFEBF7"],[0.1246738725307492,"#DEEBF7"],[0.12840104360790142,"#DDEBF7"],[0.12877376071561633,"#DDEBF7"],[0.13045098770033553,"#DDEAF7"],[0.13082370480805042,"#DDEAF7"],[0.13212821468505365,"#DDEAF7"],[0.1323145732389111,"#DDEAF7"],[0.13492359299291862,"#DCEAF6"],[0.13548266865449099,"#DCEAF6"],[0.13566902720834845,"#DCEAF6"],[0.13753261274692508,"#DCE9F6"],[0.14070070816250496,"#DBE9F6"],[0.14088706671636242,"#DBE9F6"],[0.14125978382407731,"#DBE9F6"],[0.14293701080879651,"#DBE9F6"],[0.14330972791651142,"#DBE9F6"],[0.14666418188594874,"#DAE8F6"],[0.14871412597838282,"#D9E8F5"],[0.14983227730152862,"#D9E8F5"],[0.15150950428624674,"#D9E8F5"],[0.15318673127096488,"#D9E7F5"],[0.15374580693253828,"#D9E7F5"],[0.15728661945583308,"#D8E7F5"],[0.1589638464405512,"#D8E7F5"],[0.15933656354826717,"#D7E7F5"],[0.1606410734252704,"#D7E6F5"],[0.16343645173313431,"#D7E6F5"],[0.16380916884085028,"#D7E6F5"],[0.16436824450242263,"#D6E6F4"],[0.1654863958255684,"#D6E6F4"],[0.16585911293328331,"#D6E6F4"],[0.16753633991800251,"#D6E6F4"],[0.16846813268729083,"#D6E5F4"],[0.16865449124114829,"#D6E5F4"],[0.16884084979500574,"#D6E5F4"],[0.17070443533358132,"#D5E5F4"],[0.1714498695490122,"#D5E5F4"],[0.17182258665672709,"#D5E5F4"],[0.17722698471859852,"#D4E4F4"],[0.17815877748788683,"#D4E4F4"],[0.18076779724189329,"#D3E4F3"],[0.18114051434960821,"#D3E4F3"],[0.18169959001118163,"#D3E4F3"],[0.1828177413343274,"#D3E4F3"],[0.18673127096533709,"#D2E3F3"],[0.19045844204248932,"#D1E3F3"],[0.19232202758106595,"#D1E2F3"],[0.19306746179649684,"#D1E2F3"],[0.1939992545657841,"#D1E2F3"],[0.19660827431979161,"#D0E2F2"],[0.19847185985836718,"#D0E2F2"],[0.19884457696608315,"#D0E2F2"],[0.19996272828922892,"#D0E1F2"],[0.20033544539694384,"#D0E1F2"],[0.20070816250465875,"#CFE1F2"],[0.20126723816623215,"#CFE1F2"],[0.20629891912038761,"#CEE1F2"],[0.20648527767424507,"#CEE1F2"],[0.21151695862840053,"#CDE0F1"],[0.21338054416697719,"#CDE0F1"],[0.2143123369362655,"#CDE0F1"],[0.21710771524412942,"#CCDFF1"],[0.21766679090570282,"#CCDFF1"],[0.21822586656727519,"#CCDFF1"],[0.21953037644427842,"#CCDFF1"],[0.22102124487514016,"#CCDFF1"],[0.22400298173686151,"#CBDEF1"],[0.22530749161386474,"#CBDEF1"],[0.22773015281401374,"#CADEF0"],[0.22903466269101805,"#CADEF0"],[0.23369362653745859,"#C9DDF0"],[0.23555721207603417,"#C9DDF0"],[0.23611628773760759,"#C9DDF0"],[0.23909802459932897,"#C8DCF0"],[0.24189340290719391,"#C8DCF0"],[0.24226612001490883,"#C7DCEF"],[0.2452478568766302,"#C7DCEF"],[0.2482295937383526,"#C6DBEF"],[0.24841595229221006,"#C6DBEF"],[0.24897502795378348,"#C6DBEF"],[0.25009317927692926,"#C6DBEF"],[0.25326127469250809,"#C5DBEF"],[0.25773387998509117,"#C4DAEE"],[0.25792023853894863,"#C4DAEE"],[0.26127469250838598,"#C2D9EE"],[0.26146105106224338,"#C2D9EE"],[0.26257920238538918,"#C2D9EE"],[0.26407007081625095,"#C2D9ED"],[0.26481550503168072,"#C1D9ED"],[0.26630637346254249,"#C1D9ED"],[0.26686544912411481,"#C1D9ED"],[0.26835631755497552,"#C0D9ED"],[0.26910175177040641,"#C0D8ED"],[0.27394707417070441,"#BED8EC"],[0.27450614983227778,"#BED8EC"],[0.27562430115542358,"#BED8EC"],[0.27599701826313849,"#BED7EC"],[0.27935147223257584,"#BDD7EC"],[0.28158777487886738,"#BCD7EB"],[0.28307864330972804,"#BCD6EB"],[0.28363771897130041,"#BBD6EB"],[0.28512858740216213,"#BBD6EB"],[0.29034662691017504,"#B9D6EA"],[0.29071934401788996,"#B9D5EA"],[0.29332836377189747,"#B8D5EA"],[0.29742825195676459,"#B7D5EA"],[0.29761461051062205,"#B7D5EA"],[0.29817368617219547,"#B7D4EA"],[0.29910547894148382,"#B7D4E9"],[0.30078270592620193,"#B6D4E9"],[0.30227357435706259,"#B6D4E9"],[0.3024599329109211,"#B5D4E9"],[0.30525531121878502,"#B5D3E9"],[0.31159150204994374,"#B3D3E8"],[0.31606410734252682,"#B1D2E8"],[0.31774133432724599,"#B1D2E7"],[0.3237048080506898,"#AFD1E7"],[0.32445024226611963,"#AED1E7"],[0.32650018635855371,"#AED1E6"],[0.32780469623555691,"#ADD0E6"],[0.33171822586656768,"#ACD0E6"],[0.33227730152814006,"#ACD0E6"],[0.33674990682072314,"#AACFE5"],[0.33805441669772635,"#AACFE5"],[0.3382407752515838,"#AACFE5"],[0.33991800223630303,"#A9CFE5"],[0.3417815877748786,"#A9CFE5"],[0.3428997390980244,"#A8CEE5"],[0.34569511740588937,"#A8CEE4"],[0.34830413715989578,"#A7CEE4"],[0.34886321282146815,"#A7CEE4"],[0.35221766679090549,"#A5CDE4"],[0.35519940365262792,"#A4CDE3"],[0.35650391352963112,"#A4CDE3"],[0.35780842340663438,"#A4CCE3"],[0.35799478196049184,"#A4CCE3"],[0.35967200894521101,"#A3CCE3"],[0.36172195303764404,"#A2CCE2"],[0.36190831159150255,"#A2CCE2"],[0.36470368989936647,"#A1CBE2"],[0.36731270965337293,"#A1CBE2"],[0.36787178531494635,"#A0CBE2"],[0.37197167349981347,"#9FCAE1"],[0.3738352590383901,"#9ECAE1"],[0.37551248602310827,"#9ECAE1"],[0.3773760715616849,"#9DC9E1"],[0.38203503540812545,"#9BC8E0"],[0.38240775251584036,"#9BC8E0"],[0.3833395452851287,"#9BC8E0"],[0.38427133805441699,"#9AC8E0"],[0.39116660454714913,"#98C6E0"],[0.39563920983973222,"#96C5DF"],[0.39750279537830779,"#95C5DF"],[0.39787551248602271,"#95C5DF"],[0.40122996645546005,"#94C4DF"],[0.40216175922474834,"#94C4DF"],[0.40253447633246325,"#93C4DF"],[0.40290719344017922,"#93C4DF"],[0.40887066716362302,"#91C2DE"],[0.41073425270219965,"#90C2DE"],[0.42005218039508074,"#8DC0DD"],[0.42228848304137123,"#8CBFDD"],[0.42340663436451703,"#8BBFDD"],[0.423779351472233,"#8BBFDD"],[0.426202012672382,"#8ABEDD"],[0.42713380544167034,"#8ABEDC"],[0.4321654863958258,"#88BDDC"],[0.43402907193440243,"#87BDDC"],[0.43496086470368966,"#87BCDC"],[0.43570629891912055,"#86BCDC"],[0.43589265747297801,"#86BCDC"],[0.43626537458069292,"#86BCDC"],[0.43794260156541209,"#85BCDB"],[0.44260156541185269,"#84BBDB"],[0.45191949310473378,"#80B9DA"],[0.45434215430488278,"#7FB8DA"],[0.45490122996645516,"#7EB8DA"],[0.45676481550503178,"#7EB8DA"],[0.45732389116660521,"#7DB7DA"],[0.45862840104360841,"#7DB7DA"],[0.45900111815132333,"#7DB7DA"],[0.4595601938128957,"#7DB7DA"],[0.46328736489004896,"#7BB6D9"],[0.46608274319791287,"#7AB6D9"],[0.46738725307491613,"#79B5D9"],[0.47577338799850888,"#76B3D8"],[0.48229593738352611,"#73B2D8"],[0.48285501304509848,"#73B2D8"],[0.48341408870667191,"#72B2D7"],[0.48676854267610919,"#71B1D7"],[0.48844576966082737,"#70B1D7"],[0.48937756243011565,"#70B0D7"],[0.49329109206112537,"#6EAFD7"],[0.4940365262765562,"#6EAFD7"],[0.4964591874767052,"#6DAFD6"],[0.49813641446142443,"#6CAED6"],[0.50540439806187143,"#69ADD5"],[0.50577711516958634,"#69ADD5"],[0.51043607901602683,"#68ACD5"],[0.51099515467760026,"#68ABD5"],[0.51658591129332809,"#66AAD4"],[0.51807677972418986,"#66AAD4"],[0.51844949683190478,"#65AAD4"],[0.52180395080134212,"#64A9D3"],[0.52217666790905704,"#64A9D3"],[0.52236302646291444,"#64A9D3"],[0.52385389489377621,"#64A9D3"],[0.52664927320164012,"#63A8D3"],[0.53484904957137547,"#60A6D2"],[0.53857622064852761,"#5FA5D1"],[0.54099888184867662,"#5FA5D1"],[0.54323518449496822,"#5EA4D0"],[0.54360790160268413,"#5EA4D0"],[0.54696235557212047,"#5DA3D0"],[0.54863958255683964,"#5CA3D0"],[0.55087588520313124,"#5BA2CF"],[0.55199403652627699,"#5BA2CF"],[0.5523667536339919,"#5BA2CF"],[0.55423033917256848,"#5AA2CF"],[0.55441669772642599,"#5AA2CF"],[0.55777115169586333,"#59A1CF"],[0.55907566157286648,"#59A1CE"],[0.56298919120387625,"#58A0CE"],[0.56541185240402525,"#579FCE"],[0.57081625046589668,"#559ECD"],[0.5736116287737606,"#549DCD"],[0.57417070443533391,"#549DCD"],[0.57510249720462225,"#549DCC"],[0.57547521431233717,"#549DCC"],[0.58050689526649268,"#529CCC"],[0.58386134923593003,"#519BCB"],[0.58702944465150986,"#509ACB"],[0.58870667163622803,"#4F9ACB"],[0.58907938874394394,"#4F9ACB"],[0.59504286246738769,"#4D99CA"],[0.59560193812896012,"#4D98CA"],[0.59709280655982178,"#4C98CA"],[0.60007454342154321,"#4B97C9"],[0.60193812896011989,"#4A97C9"],[0.60380171449869546,"#4A97C9"],[0.60659709280656038,"#4996C8"],[0.60827431979127855,"#4896C8"],[0.61367871785314998,"#4694C7"],[0.61498322773015313,"#4694C7"],[0.6166604547148713,"#4594C7"],[0.61871039880730538,"#4493C7"],[0.62318300409988847,"#4392C6"],[0.62504658963846516,"#4292C6"],[0.6261647409616099,"#4292C6"],[0.62802832650018647,"#4191C6"],[0.63492359299291867,"#408FC5"],[0.64219157659336568,"#3E8DC4"],[0.64293701080879651,"#3E8DC4"],[0.64442787923965716,"#3E8DC3"],[0.64591874767051782,"#3D8CC3"],[0.64740961610137959,"#3D8CC3"],[0.65020499440924351,"#3C8BC3"],[0.65206857994782019,"#3C8BC2"],[0.65430488259411168,"#3B8AC2"],[0.65915020499440968,"#3A89C1"],[0.66231830040998962,"#3A88C1"],[0.66269101751770454,"#3A88C1"],[0.66343645173313426,"#3988C1"],[0.67182258665672812,"#3785C0"],[0.67368617219530369,"#3785BF"],[0.67443160641073463,"#3785BF"],[0.67946328736489003,"#3583BF"],[0.68300409988818489,"#3582BE"],[0.68449496831904655,"#3482BE"],[0.68673127096533704,"#3482BE"],[0.69083115915020532,"#3380BD"],[0.69120387625792024,"#3280BD"],[0.70108087961237475,"#307EBC"],[0.70145359672008967,"#307EBC"],[0.70555348490495784,"#2F7DBB"],[0.70611256056653016,"#2F7CBB"],[0.70741707044353341,"#2E7CBB"],[0.70816250465896424,"#2E7CBB"],[0.7144986954901229,"#2C7ABA"],[0.71487141259783893,"#2C7ABA"],[0.71710771524413042,"#2B7AB9"],[0.72437569884457753,"#2978B8"],[0.72549385016772328,"#2977B8"],[0.72754379426015736,"#2877B8"],[0.73033917256802128,"#2876B8"],[0.73462541930674696,"#2675B7"],[0.73630264629146502,"#2675B7"],[0.73760715616846828,"#2574B7"],[0.74058889303019071,"#2473B6"],[0.74096161013790562,"#2473B6"],[0.74636600819977705,"#2272B5"],[0.7497204621692144,"#2171B5"],[0.75139768915393246,"#2171B5"],[0.75195676481550489,"#2170B5"],[0.75363399180022406,"#2070B4"],[0.75400670890793897,"#2070B4"],[0.7545657845695124,"#2070B4"],[0.75605665300037306,"#206FB4"],[0.75922474841595289,"#206FB3"],[0.75978382407752532,"#206EB3"],[0.76146105106224449,"#1F6EB3"],[0.7620201267238168,"#1F6EB3"],[0.76239284383153172,"#1F6EB3"],[0.77096533730898298,"#1E6CB1"],[0.77171077152441281,"#1E6BB1"],[0.77320163995527458,"#1E6BB0"],[0.77730152814014175,"#1D6AAF"],[0.77786060380171518,"#1D6AAF"],[0.77879239657100341,"#1D69AF"],[0.78363771897130141,"#1C68AE"],[0.78419679463287384,"#1C68AE"],[0.78494222884830467,"#1C68AE"],[0.7855013045098771,"#1C68AE"],[0.78829668281774201,"#1B67AD"],[0.78904211703317184,"#1B67AD"],[0.79109206112560593,"#1B66AD"],[0.79500559075661559,"#1A65AC"],[0.79575102497204653,"#1A65AC"],[0.79798732761833802,"#1A65AB"],[0.79873276183376885,"#1964AB"],[0.79910547894148376,"#1964AB"],[0.79929183749534127,"#1964AB"],[0.80972791651136811,"#1762A9"],[0.81252329481923202,"#1761A8"],[0.81550503168095445,"#1660A8"],[0.81662318300410019,"#1660A8"],[0.81718225866567262,"#1660A8"],[0.81848676854267688,"#165FA7"],[0.82575475214312388,"#145DA6"],[0.82650018635855371,"#145DA6"],[0.82761833768169946,"#145DA5"],[0.83004099888184957,"#145CA5"],[0.83153186731271023,"#135CA5"],[0.83730898248229657,"#125AA3"],[0.83749534103615397,"#125AA3"],[0.84122251211330623,"#1159A3"],[0.84159522922102115,"#1159A3"],[0.84420424897502866,"#1059A2"],[0.85184494968319058,"#0F57A1"],[0.85482668654491301,"#0E56A0"],[0.85519940365262792,"#0E56A0"],[0.8570629891912046,"#0D55A0"],[0.85799478196049284,"#0D559F"],[0.86153559448378769,"#0C549F"],[0.86321282146850575,"#0C549E"],[0.86339918002236327,"#0C549E"],[0.8641446142377941,"#0B549E"],[0.86470368989936652,"#0B549E"],[0.86526276556093984,"#0B539E"],[0.86600819977636967,"#0B539E"],[0.87159895639209861,"#09529D"],[0.87215803205367204,"#09529D"],[0.87681699590011253,"#08519B"],[0.87700335445397004,"#08509B"],[0.88632128214685113,"#084E97"],[0.88743943346999687,"#084E97"],[0.88799850913156919,"#084D97"],[0.89004845322400339,"#084D96"],[0.89172568020872145,"#084C95"],[0.89582556839358962,"#084B94"],[0.90122996645546105,"#094A91"],[0.90346626910175265,"#094991"],[0.90365262765561005,"#094990"],[0.90868430860976557,"#09488E"],[0.91147968691762948,"#09478D"],[0.91688408497950091,"#09468B"],[0.918934029071935,"#09458A"],[0.92042489750279566,"#09458A"],[0.93272456205739918,"#094185"],[0.93384271338054492,"#094185"],[0.93402907193440243,"#094184"],[0.93738352590383978,"#094083"],[0.94148341408870684,"#093F82"],[0.94371971673499844,"#093F81"],[0.94819232202758152,"#093D7F"],[0.95341036153559444,"#093C7D"],[0.95676481550503178,"#093B7C"],[0.95844204248975096,"#093B7B"],[0.96123742079761487,"#093A7A"],[0.96589638464405547,"#093978"],[0.97409616101379082,"#083775"],[0.97838240775251639,"#083673"],[0.99180022363026465,"#08326E"],[1,"#08306B"]],"showscale":true,"z":[[315.42000000000002,316.26999999999998,316.73000000000002,317.77999999999997,318.57999999999998,319.41000000000003,319.26999999999998,320.45999999999998,322.17000000000002,322.39999999999998,323.82999999999998,324.88999999999999,326.00999999999999,326.60000000000002,328.37,329.18000000000001,330.23000000000002,331.57999999999998,332.75,334.80000000000001,336.05000000000001,337.83999999999997,339.06,340.56999999999999,341.19999999999999,343.51999999999998,344.79000000000002,346.11000000000001,347.83999999999997,350.25,352.60000000000002,353.5,354.58999999999997,355.88,356.63,358.33999999999997,359.98000000000002,362.08999999999997,363.23000000000002],[316.31,316.81,317.54000000000002,318.39999999999998,318.92000000000002,320.06999999999999,320.27999999999997,321.43000000000001,322.33999999999997,322.99000000000001,324.25999999999999,325.81999999999999,326.50999999999999,327.47000000000003,329.39999999999998,330.55000000000001,331.25,332.38999999999999,333.24000000000001,335.22000000000003,336.58999999999997,338.19,340.30000000000001,341.44,342.35000000000002,344.32999999999998,345.81999999999999,346.77999999999997,348.29000000000002,351.54000000000002,352.92000000000002,354.55000000000001,355.63,356.63,357.10000000000002,358.88999999999999,361.02999999999997,363.29000000000002,364.06],[316.5,317.42000000000002,318.38,319.52999999999997,319.69999999999999,320.74000000000001,320.73000000000002,322.23000000000002,322.88,323.73000000000002,325.47000000000003,326.76999999999998,327.00999999999999,327.57999999999998,330.13999999999999,331.31999999999999,331.87,333.32999999999998,334.52999999999997,336.47000000000003,337.79000000000002,339.91000000000003,341.20999999999998,342.52999999999997,342.93000000000001,345.11000000000001,347.25,347.68000000000001,349.23000000000002,352.05000000000001,353.52999999999997,355.23000000000002,357.02999999999997,357.72000000000003,358.31999999999999,359.94999999999999,361.66000000000003,364.06,364.61000000000001],[317.56,318.87,319.31,320.42000000000002,321.22000000000003,321.39999999999998,321.97000000000003,323.54000000000002,324.25,324.86000000000001,326.5,327.97000000000003,327.62,329.56,331.32999999999998,332.48000000000002,333.13999999999999,334.41000000000003,335.89999999999998,337.58999999999997,338.70999999999998,340.60000000000002,342.32999999999998,343.38999999999999,344.76999999999998,346.88,348.17000000000002,349.37,350.80000000000001,353.41000000000003,355.25999999999999,356.04000000000002,358.48000000000002,359.06999999999999,359.41000000000003,361.25,363.48000000000002,364.75999999999999,366.39999999999998],[318.13,319.87,320.42000000000002,320.85000000000002,322.07999999999998,322.06,322,323.91000000000003,324.82999999999998,325.39999999999998,327.20999999999998,327.91000000000003,328.75999999999999,329.89999999999998,332.31,332.92000000000002,333.80000000000001,334.70999999999998,336.56999999999999,337.83999999999997,339.30000000000001,341.29000000000002,342.74000000000001,343.95999999999998,345.57999999999998,347.25,348.74000000000001,350.02999999999997,351.66000000000003,354.04000000000002,355.51999999999998,357,359.22000000000003,359.57999999999998,360.23000000000002,361.67000000000002,363.81999999999999,365.44999999999999,366.83999999999997],[318,319.43000000000001,319.61000000000001,320.44999999999999,321.31,321.73000000000002,321.70999999999998,323.58999999999997,323.93000000000001,325.19999999999999,326.54000000000002,327.5,328.39999999999998,328.92000000000002,331.89999999999998,332.07999999999998,333.43000000000001,334.17000000000002,336.10000000000002,337.72000000000003,339.12,341,342.07999999999998,343.18000000000001,345.13999999999999,346.62,348.06999999999999,349.37,351.06999999999999,353.62,354.97000000000003,356.06999999999999,358.12,359.17000000000002,359.55000000000001,360.94,363.30000000000001,365.00999999999999,365.68000000000001],[316.38999999999999,318.00999999999999,318.42000000000002,319.44999999999999,319.57999999999998,320.26999999999998,321.05000000000001,322.24000000000001,322.38,323.98000000000002,325.72000000000003,326.18000000000001,327.19999999999999,327.88,330.69999999999999,331.00999999999999,331.73000000000002,332.88999999999999,334.75999999999999,336.37,337.56,339.38999999999999,340.31999999999999,341.88,343.81,345.22000000000003,346.38,347.75999999999999,349.32999999999998,352.22000000000003,353.75,354.67000000000002,356.06,356.94,357.52999999999997,359.55000000000001,361.94,363.69999999999999,364.51999999999998],[314.64999999999998,315.74000000000001,316.63,317.25,317.61000000000001,318.54000000000002,318.70999999999998,320.19999999999999,320.75999999999999,321.94999999999999,323.5,324.52999999999997,325.26999999999998,326.16000000000003,329.14999999999998,329.23000000000002,329.89999999999998,330.76999999999998,332.58999999999997,334.50999999999999,335.92000000000002,337.43000000000001,338.25999999999999,339.64999999999998,342.20999999999998,343.11000000000001,344.50999999999999,345.73000000000002,347.92000000000002,350.26999999999998,351.51999999999998,352.75999999999999,353.92000000000002,354.92000000000002,355.48000000000002,357.49000000000001,359.5,361.54000000000002,362.56999999999999],[313.68000000000001,314,314.82999999999998,316.11000000000001,316.05000000000001,316.54000000000002,317.66000000000003,318.48000000000002,319.10000000000002,320.18000000000001,322.22000000000003,322.93000000000001,323.19999999999999,324.68000000000001,327.35000000000002,327.26999999999998,328.39999999999998,329.13999999999999,331.42000000000002,332.60000000000002,333.75,335.72000000000003,336.51999999999998,337.81,339.69,340.89999999999998,342.92000000000002,344.68000000000001,346.26999999999998,348.55000000000001,349.63999999999999,350.81999999999999,352.05000000000001,352.94,353.67000000000002,355.83999999999997,358.11000000000001,359.50999999999999,360.24000000000001],[313.18000000000001,313.68000000000001,315.16000000000003,315.26999999999998,315.82999999999998,316.70999999999998,317.13999999999999,317.94,319.24000000000001,320.08999999999997,321.62,322.89999999999998,323.39999999999998,325.04000000000002,327.01999999999998,327.20999999999998,328.17000000000002,328.77999999999997,330.98000000000002,332.38,333.69999999999999,335.83999999999997,336.68000000000001,337.69,339.81999999999999,341.18000000000001,342.62,343.99000000000001,346.18000000000001,348.72000000000003,349.82999999999998,351.04000000000002,352.11000000000001,353.23000000000002,353.94999999999999,356,357.80000000000001,359.64999999999998,360.82999999999998],[314.66000000000003,314.83999999999997,315.94,316.52999999999997,316.91000000000003,317.52999999999997,318.69999999999999,319.63,320.56,321.16000000000003,322.69,323.85000000000002,324.63,326.33999999999997,327.99000000000001,328.29000000000002,329.31999999999999,330.13999999999999,332.24000000000001,333.75,335.12,336.93000000000001,338.19,339.08999999999997,340.98000000000002,342.80000000000001,344.06,345.48000000000002,347.63999999999999,349.91000000000003,351.13999999999999,352.69,353.63999999999999,354.08999999999997,355.30000000000001,357.58999999999997,359.61000000000001,360.80000000000001,362.49000000000001],[315.43000000000001,316.02999999999997,316.85000000000002,317.52999999999997,318.19999999999999,318.55000000000001,319.25,320.87,321.80000000000001,322.74000000000001,323.94999999999999,324.95999999999998,325.85000000000002,327.38999999999999,328.48000000000002,329.41000000000003,330.58999999999997,331.51999999999998,333.68000000000001,334.77999999999997,336.56,338.04000000000002,339.44,340.31999999999999,342.81999999999999,344.04000000000002,345.38,346.72000000000003,348.77999999999997,351.18000000000001,352.37,354.06999999999999,354.88999999999999,355.32999999999998,356.77999999999997,359.05000000000001,360.74000000000001,362.38,364.33999999999997]],"x":["1959","1960","1961","1962","1963","1964","1965","1966","1967","1968","1969","1970","1971","1972","1973","1974","1975","1976","1977","1978","1979","1980","1981","1982","1983","1984","1985","1986","1987","1988","1989","1990","1991","1992","1993","1994","1995","1996","1997"],"y":["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],"hoverinfo":"text","text":[["Value:  315.42 <br> Year :  1959 <br> Month  : 1","Value:  316.27 <br> Year :  1960 <br> Month  : 1","Value:  316.73 <br> Year :  1961 <br> Month  : 1","Value:  317.78 <br> Year :  1962 <br> Month  : 1","Value:  318.58 <br> Year :  1963 <br> Month  : 1","Value:  319.41 <br> Year :  1964 <br> Month  : 1","Value:  319.27 <br> Year :  1965 <br> Month  : 1","Value:  320.46 <br> Year :  1966 <br> Month  : 1","Value:  322.17 <br> Year :  1967 <br> Month  : 1","Value:  322.4 <br> Year :  1968 <br> Month  : 1","Value:  323.83 <br> Year :  1969 <br> Month  : 1","Value:  324.89 <br> Year :  1970 <br> Month  : 1","Value:  326.01 <br> Year :  1971 <br> Month  : 1","Value:  326.6 <br> Year :  1972 <br> Month  : 1","Value:  328.37 <br> Year :  1973 <br> Month  : 1","Value:  329.18 <br> Year :  1974 <br> Month  : 1","Value:  330.23 <br> Year :  1975 <br> Month  : 1","Value:  331.58 <br> Year :  1976 <br> Month  : 1","Value:  332.75 <br> Year :  1977 <br> Month  : 1","Value:  334.8 <br> Year :  1978 <br> Month  : 1","Value:  336.05 <br> Year :  1979 <br> Month  : 1","Value:  337.84 <br> Year :  1980 <br> Month  : 1","Value:  339.06 <br> Year :  1981 <br> Month  : 1","Value:  340.57 <br> Year :  1982 <br> Month  : 1","Value:  341.2 <br> Year :  1983 <br> Month  : 1","Value:  343.52 <br> Year :  1984 <br> Month  : 1","Value:  344.79 <br> Year :  1985 <br> Month  : 1","Value:  346.11 <br> Year :  1986 <br> Month  : 1","Value:  347.84 <br> Year :  1987 <br> Month  : 1","Value:  350.25 <br> Year :  1988 <br> Month  : 1","Value:  352.6 <br> Year :  1989 <br> Month  : 1","Value:  353.5 <br> Year :  1990 <br> Month  : 1","Value:  354.59 <br> Year :  1991 <br> Month  : 1","Value:  355.88 <br> Year :  1992 <br> Month  : 1","Value:  356.63 <br> Year :  1993 <br> Month  : 1","Value:  358.34 <br> Year :  1994 <br> Month  : 1","Value:  359.98 <br> Year :  1995 <br> Month  : 1","Value:  362.09 <br> Year :  1996 <br> Month  : 1","Value:  363.23 <br> Year :  1997 <br> Month  : 1"],["Value:  316.31 <br> Year :  1959 <br> Month  : 2","Value:  316.81 <br> Year :  1960 <br> Month  : 2","Value:  317.54 <br> Year :  1961 <br> Month  : 2","Value:  318.4 <br> Year :  1962 <br> Month  : 2","Value:  318.92 <br> Year :  1963 <br> Month  : 2","Value:  320.07 <br> Year :  1964 <br> Month  : 2","Value:  320.28 <br> Year :  1965 <br> Month  : 2","Value:  321.43 <br> Year :  1966 <br> Month  : 2","Value:  322.34 <br> Year :  1967 <br> Month  : 2","Value:  322.99 <br> Year :  1968 <br> Month  : 2","Value:  324.26 <br> Year :  1969 <br> Month  : 2","Value:  325.82 <br> Year :  1970 <br> Month  : 2","Value:  326.51 <br> Year :  1971 <br> Month  : 2","Value:  327.47 <br> Year :  1972 <br> Month  : 2","Value:  329.4 <br> Year :  1973 <br> Month  : 2","Value:  330.55 <br> Year :  1974 <br> Month  : 2","Value:  331.25 <br> Year :  1975 <br> Month  : 2","Value:  332.39 <br> Year :  1976 <br> Month  : 2","Value:  333.24 <br> Year :  1977 <br> Month  : 2","Value:  335.22 <br> Year :  1978 <br> Month  : 2","Value:  336.59 <br> Year :  1979 <br> Month  : 2","Value:  338.19 <br> Year :  1980 <br> Month  : 2","Value:  340.3 <br> Year :  1981 <br> Month  : 2","Value:  341.44 <br> Year :  1982 <br> Month  : 2","Value:  342.35 <br> Year :  1983 <br> Month  : 2","Value:  344.33 <br> Year :  1984 <br> Month  : 2","Value:  345.82 <br> Year :  1985 <br> Month  : 2","Value:  346.78 <br> Year :  1986 <br> Month  : 2","Value:  348.29 <br> Year :  1987 <br> Month  : 2","Value:  351.54 <br> Year :  1988 <br> Month  : 2","Value:  352.92 <br> Year :  1989 <br> Month  : 2","Value:  354.55 <br> Year :  1990 <br> Month  : 2","Value:  355.63 <br> Year :  1991 <br> Month  : 2","Value:  356.63 <br> Year :  1992 <br> Month  : 2","Value:  357.1 <br> Year :  1993 <br> Month  : 2","Value:  358.89 <br> Year :  1994 <br> Month  : 2","Value:  361.03 <br> Year :  1995 <br> Month  : 2","Value:  363.29 <br> Year :  1996 <br> Month  : 2","Value:  364.06 <br> Year :  1997 <br> Month  : 2"],["Value:  316.5 <br> Year :  1959 <br> Month  : 3","Value:  317.42 <br> Year :  1960 <br> Month  : 3","Value:  318.38 <br> Year :  1961 <br> Month  : 3","Value:  319.53 <br> Year :  1962 <br> Month  : 3","Value:  319.7 <br> Year :  1963 <br> Month  : 3","Value:  320.74 <br> Year :  1964 <br> Month  : 3","Value:  320.73 <br> Year :  1965 <br> Month  : 3","Value:  322.23 <br> Year :  1966 <br> Month  : 3","Value:  322.88 <br> Year :  1967 <br> Month  : 3","Value:  323.73 <br> Year :  1968 <br> Month  : 3","Value:  325.47 <br> Year :  1969 <br> Month  : 3","Value:  326.77 <br> Year :  1970 <br> Month  : 3","Value:  327.01 <br> Year :  1971 <br> Month  : 3","Value:  327.58 <br> Year :  1972 <br> Month  : 3","Value:  330.14 <br> Year :  1973 <br> Month  : 3","Value:  331.32 <br> Year :  1974 <br> Month  : 3","Value:  331.87 <br> Year :  1975 <br> Month  : 3","Value:  333.33 <br> Year :  1976 <br> Month  : 3","Value:  334.53 <br> Year :  1977 <br> Month  : 3","Value:  336.47 <br> Year :  1978 <br> Month  : 3","Value:  337.79 <br> Year :  1979 <br> Month  : 3","Value:  339.91 <br> Year :  1980 <br> Month  : 3","Value:  341.21 <br> Year :  1981 <br> Month  : 3","Value:  342.53 <br> Year :  1982 <br> Month  : 3","Value:  342.93 <br> Year :  1983 <br> Month  : 3","Value:  345.11 <br> Year :  1984 <br> Month  : 3","Value:  347.25 <br> Year :  1985 <br> Month  : 3","Value:  347.68 <br> Year :  1986 <br> Month  : 3","Value:  349.23 <br> Year :  1987 <br> Month  : 3","Value:  352.05 <br> Year :  1988 <br> Month  : 3","Value:  353.53 <br> Year :  1989 <br> Month  : 3","Value:  355.23 <br> Year :  1990 <br> Month  : 3","Value:  357.03 <br> Year :  1991 <br> Month  : 3","Value:  357.72 <br> Year :  1992 <br> Month  : 3","Value:  358.32 <br> Year :  1993 <br> Month  : 3","Value:  359.95 <br> Year :  1994 <br> Month  : 3","Value:  361.66 <br> Year :  1995 <br> Month  : 3","Value:  364.06 <br> Year :  1996 <br> Month  : 3","Value:  364.61 <br> Year :  1997 <br> Month  : 3"],["Value:  317.56 <br> Year :  1959 <br> Month  : 4","Value:  318.87 <br> Year :  1960 <br> Month  : 4","Value:  319.31 <br> Year :  1961 <br> Month  : 4","Value:  320.42 <br> Year :  1962 <br> Month  : 4","Value:  321.22 <br> Year :  1963 <br> Month  : 4","Value:  321.4 <br> Year :  1964 <br> Month  : 4","Value:  321.97 <br> Year :  1965 <br> Month  : 4","Value:  323.54 <br> Year :  1966 <br> Month  : 4","Value:  324.25 <br> Year :  1967 <br> Month  : 4","Value:  324.86 <br> Year :  1968 <br> Month  : 4","Value:  326.5 <br> Year :  1969 <br> Month  : 4","Value:  327.97 <br> Year :  1970 <br> Month  : 4","Value:  327.62 <br> Year :  1971 <br> Month  : 4","Value:  329.56 <br> Year :  1972 <br> Month  : 4","Value:  331.33 <br> Year :  1973 <br> Month  : 4","Value:  332.48 <br> Year :  1974 <br> Month  : 4","Value:  333.14 <br> Year :  1975 <br> Month  : 4","Value:  334.41 <br> Year :  1976 <br> Month  : 4","Value:  335.9 <br> Year :  1977 <br> Month  : 4","Value:  337.59 <br> Year :  1978 <br> Month  : 4","Value:  338.71 <br> Year :  1979 <br> Month  : 4","Value:  340.6 <br> Year :  1980 <br> Month  : 4","Value:  342.33 <br> Year :  1981 <br> Month  : 4","Value:  343.39 <br> Year :  1982 <br> Month  : 4","Value:  344.77 <br> Year :  1983 <br> Month  : 4","Value:  346.88 <br> Year :  1984 <br> Month  : 4","Value:  348.17 <br> Year :  1985 <br> Month  : 4","Value:  349.37 <br> Year :  1986 <br> Month  : 4","Value:  350.8 <br> Year :  1987 <br> Month  : 4","Value:  353.41 <br> Year :  1988 <br> Month  : 4","Value:  355.26 <br> Year :  1989 <br> Month  : 4","Value:  356.04 <br> Year :  1990 <br> Month  : 4","Value:  358.48 <br> Year :  1991 <br> Month  : 4","Value:  359.07 <br> Year :  1992 <br> Month  : 4","Value:  359.41 <br> Year :  1993 <br> Month  : 4","Value:  361.25 <br> Year :  1994 <br> Month  : 4","Value:  363.48 <br> Year :  1995 <br> Month  : 4","Value:  364.76 <br> Year :  1996 <br> Month  : 4","Value:  366.4 <br> Year :  1997 <br> Month  : 4"],["Value:  318.13 <br> Year :  1959 <br> Month  : 5","Value:  319.87 <br> Year :  1960 <br> Month  : 5","Value:  320.42 <br> Year :  1961 <br> Month  : 5","Value:  320.85 <br> Year :  1962 <br> Month  : 5","Value:  322.08 <br> Year :  1963 <br> Month  : 5","Value:  322.06 <br> Year :  1964 <br> Month  : 5","Value:  322 <br> Year :  1965 <br> Month  : 5","Value:  323.91 <br> Year :  1966 <br> Month  : 5","Value:  324.83 <br> Year :  1967 <br> Month  : 5","Value:  325.4 <br> Year :  1968 <br> Month  : 5","Value:  327.21 <br> Year :  1969 <br> Month  : 5","Value:  327.91 <br> Year :  1970 <br> Month  : 5","Value:  328.76 <br> Year :  1971 <br> Month  : 5","Value:  329.9 <br> Year :  1972 <br> Month  : 5","Value:  332.31 <br> Year :  1973 <br> Month  : 5","Value:  332.92 <br> Year :  1974 <br> Month  : 5","Value:  333.8 <br> Year :  1975 <br> Month  : 5","Value:  334.71 <br> Year :  1976 <br> Month  : 5","Value:  336.57 <br> Year :  1977 <br> Month  : 5","Value:  337.84 <br> Year :  1978 <br> Month  : 5","Value:  339.3 <br> Year :  1979 <br> Month  : 5","Value:  341.29 <br> Year :  1980 <br> Month  : 5","Value:  342.74 <br> Year :  1981 <br> Month  : 5","Value:  343.96 <br> Year :  1982 <br> Month  : 5","Value:  345.58 <br> Year :  1983 <br> Month  : 5","Value:  347.25 <br> Year :  1984 <br> Month  : 5","Value:  348.74 <br> Year :  1985 <br> Month  : 5","Value:  350.03 <br> Year :  1986 <br> Month  : 5","Value:  351.66 <br> Year :  1987 <br> Month  : 5","Value:  354.04 <br> Year :  1988 <br> Month  : 5","Value:  355.52 <br> Year :  1989 <br> Month  : 5","Value:  357 <br> Year :  1990 <br> Month  : 5","Value:  359.22 <br> Year :  1991 <br> Month  : 5","Value:  359.58 <br> Year :  1992 <br> Month  : 5","Value:  360.23 <br> Year :  1993 <br> Month  : 5","Value:  361.67 <br> Year :  1994 <br> Month  : 5","Value:  363.82 <br> Year :  1995 <br> Month  : 5","Value:  365.45 <br> Year :  1996 <br> Month  : 5","Value:  366.84 <br> Year :  1997 <br> Month  : 5"],["Value:  318 <br> Year :  1959 <br> Month  : 6","Value:  319.43 <br> Year :  1960 <br> Month  : 6","Value:  319.61 <br> Year :  1961 <br> Month  : 6","Value:  320.45 <br> Year :  1962 <br> Month  : 6","Value:  321.31 <br> Year :  1963 <br> Month  : 6","Value:  321.73 <br> Year :  1964 <br> Month  : 6","Value:  321.71 <br> Year :  1965 <br> Month  : 6","Value:  323.59 <br> Year :  1966 <br> Month  : 6","Value:  323.93 <br> Year :  1967 <br> Month  : 6","Value:  325.2 <br> Year :  1968 <br> Month  : 6","Value:  326.54 <br> Year :  1969 <br> Month  : 6","Value:  327.5 <br> Year :  1970 <br> Month  : 6","Value:  328.4 <br> Year :  1971 <br> Month  : 6","Value:  328.92 <br> Year :  1972 <br> Month  : 6","Value:  331.9 <br> Year :  1973 <br> Month  : 6","Value:  332.08 <br> Year :  1974 <br> Month  : 6","Value:  333.43 <br> Year :  1975 <br> Month  : 6","Value:  334.17 <br> Year :  1976 <br> Month  : 6","Value:  336.1 <br> Year :  1977 <br> Month  : 6","Value:  337.72 <br> Year :  1978 <br> Month  : 6","Value:  339.12 <br> Year :  1979 <br> Month  : 6","Value:  341 <br> Year :  1980 <br> Month  : 6","Value:  342.08 <br> Year :  1981 <br> Month  : 6","Value:  343.18 <br> Year :  1982 <br> Month  : 6","Value:  345.14 <br> Year :  1983 <br> Month  : 6","Value:  346.62 <br> Year :  1984 <br> Month  : 6","Value:  348.07 <br> Year :  1985 <br> Month  : 6","Value:  349.37 <br> Year :  1986 <br> Month  : 6","Value:  351.07 <br> Year :  1987 <br> Month  : 6","Value:  353.62 <br> Year :  1988 <br> Month  : 6","Value:  354.97 <br> Year :  1989 <br> Month  : 6","Value:  356.07 <br> Year :  1990 <br> Month  : 6","Value:  358.12 <br> Year :  1991 <br> Month  : 6","Value:  359.17 <br> Year :  1992 <br> Month  : 6","Value:  359.55 <br> Year :  1993 <br> Month  : 6","Value:  360.94 <br> Year :  1994 <br> Month  : 6","Value:  363.3 <br> Year :  1995 <br> Month  : 6","Value:  365.01 <br> Year :  1996 <br> Month  : 6","Value:  365.68 <br> Year :  1997 <br> Month  : 6"],["Value:  316.39 <br> Year :  1959 <br> Month  : 7","Value:  318.01 <br> Year :  1960 <br> Month  : 7","Value:  318.42 <br> Year :  1961 <br> Month  : 7","Value:  319.45 <br> Year :  1962 <br> Month  : 7","Value:  319.58 <br> Year :  1963 <br> Month  : 7","Value:  320.27 <br> Year :  1964 <br> Month  : 7","Value:  321.05 <br> Year :  1965 <br> Month  : 7","Value:  322.24 <br> Year :  1966 <br> Month  : 7","Value:  322.38 <br> Year :  1967 <br> Month  : 7","Value:  323.98 <br> Year :  1968 <br> Month  : 7","Value:  325.72 <br> Year :  1969 <br> Month  : 7","Value:  326.18 <br> Year :  1970 <br> Month  : 7","Value:  327.2 <br> Year :  1971 <br> Month  : 7","Value:  327.88 <br> Year :  1972 <br> Month  : 7","Value:  330.7 <br> Year :  1973 <br> Month  : 7","Value:  331.01 <br> Year :  1974 <br> Month  : 7","Value:  331.73 <br> Year :  1975 <br> Month  : 7","Value:  332.89 <br> Year :  1976 <br> Month  : 7","Value:  334.76 <br> Year :  1977 <br> Month  : 7","Value:  336.37 <br> Year :  1978 <br> Month  : 7","Value:  337.56 <br> Year :  1979 <br> Month  : 7","Value:  339.39 <br> Year :  1980 <br> Month  : 7","Value:  340.32 <br> Year :  1981 <br> Month  : 7","Value:  341.88 <br> Year :  1982 <br> Month  : 7","Value:  343.81 <br> Year :  1983 <br> Month  : 7","Value:  345.22 <br> Year :  1984 <br> Month  : 7","Value:  346.38 <br> Year :  1985 <br> Month  : 7","Value:  347.76 <br> Year :  1986 <br> Month  : 7","Value:  349.33 <br> Year :  1987 <br> Month  : 7","Value:  352.22 <br> Year :  1988 <br> Month  : 7","Value:  353.75 <br> Year :  1989 <br> Month  : 7","Value:  354.67 <br> Year :  1990 <br> Month  : 7","Value:  356.06 <br> Year :  1991 <br> Month  : 7","Value:  356.94 <br> Year :  1992 <br> Month  : 7","Value:  357.53 <br> Year :  1993 <br> Month  : 7","Value:  359.55 <br> Year :  1994 <br> Month  : 7","Value:  361.94 <br> Year :  1995 <br> Month  : 7","Value:  363.7 <br> Year :  1996 <br> Month  : 7","Value:  364.52 <br> Year :  1997 <br> Month  : 7"],["Value:  314.65 <br> Year :  1959 <br> Month  : 8","Value:  315.74 <br> Year :  1960 <br> Month  : 8","Value:  316.63 <br> Year :  1961 <br> Month  : 8","Value:  317.25 <br> Year :  1962 <br> Month  : 8","Value:  317.61 <br> Year :  1963 <br> Month  : 8","Value:  318.54 <br> Year :  1964 <br> Month  : 8","Value:  318.71 <br> Year :  1965 <br> Month  : 8","Value:  320.2 <br> Year :  1966 <br> Month  : 8","Value:  320.76 <br> Year :  1967 <br> Month  : 8","Value:  321.95 <br> Year :  1968 <br> Month  : 8","Value:  323.5 <br> Year :  1969 <br> Month  : 8","Value:  324.53 <br> Year :  1970 <br> Month  : 8","Value:  325.27 <br> Year :  1971 <br> Month  : 8","Value:  326.16 <br> Year :  1972 <br> Month  : 8","Value:  329.15 <br> Year :  1973 <br> Month  : 8","Value:  329.23 <br> Year :  1974 <br> Month  : 8","Value:  329.9 <br> Year :  1975 <br> Month  : 8","Value:  330.77 <br> Year :  1976 <br> Month  : 8","Value:  332.59 <br> Year :  1977 <br> Month  : 8","Value:  334.51 <br> Year :  1978 <br> Month  : 8","Value:  335.92 <br> Year :  1979 <br> Month  : 8","Value:  337.43 <br> Year :  1980 <br> Month  : 8","Value:  338.26 <br> Year :  1981 <br> Month  : 8","Value:  339.65 <br> Year :  1982 <br> Month  : 8","Value:  342.21 <br> Year :  1983 <br> Month  : 8","Value:  343.11 <br> Year :  1984 <br> Month  : 8","Value:  344.51 <br> Year :  1985 <br> Month  : 8","Value:  345.73 <br> Year :  1986 <br> Month  : 8","Value:  347.92 <br> Year :  1987 <br> Month  : 8","Value:  350.27 <br> Year :  1988 <br> Month  : 8","Value:  351.52 <br> Year :  1989 <br> Month  : 8","Value:  352.76 <br> Year :  1990 <br> Month  : 8","Value:  353.92 <br> Year :  1991 <br> Month  : 8","Value:  354.92 <br> Year :  1992 <br> Month  : 8","Value:  355.48 <br> Year :  1993 <br> Month  : 8","Value:  357.49 <br> Year :  1994 <br> Month  : 8","Value:  359.5 <br> Year :  1995 <br> Month  : 8","Value:  361.54 <br> Year :  1996 <br> Month  : 8","Value:  362.57 <br> Year :  1997 <br> Month  : 8"],["Value:  313.68 <br> Year :  1959 <br> Month  : 9","Value:  314 <br> Year :  1960 <br> Month  : 9","Value:  314.83 <br> Year :  1961 <br> Month  : 9","Value:  316.11 <br> Year :  1962 <br> Month  : 9","Value:  316.05 <br> Year :  1963 <br> Month  : 9","Value:  316.54 <br> Year :  1964 <br> Month  : 9","Value:  317.66 <br> Year :  1965 <br> Month  : 9","Value:  318.48 <br> Year :  1966 <br> Month  : 9","Value:  319.1 <br> Year :  1967 <br> Month  : 9","Value:  320.18 <br> Year :  1968 <br> Month  : 9","Value:  322.22 <br> Year :  1969 <br> Month  : 9","Value:  322.93 <br> Year :  1970 <br> Month  : 9","Value:  323.2 <br> Year :  1971 <br> Month  : 9","Value:  324.68 <br> Year :  1972 <br> Month  : 9","Value:  327.35 <br> Year :  1973 <br> Month  : 9","Value:  327.27 <br> Year :  1974 <br> Month  : 9","Value:  328.4 <br> Year :  1975 <br> Month  : 9","Value:  329.14 <br> Year :  1976 <br> Month  : 9","Value:  331.42 <br> Year :  1977 <br> Month  : 9","Value:  332.6 <br> Year :  1978 <br> Month  : 9","Value:  333.75 <br> Year :  1979 <br> Month  : 9","Value:  335.72 <br> Year :  1980 <br> Month  : 9","Value:  336.52 <br> Year :  1981 <br> Month  : 9","Value:  337.81 <br> Year :  1982 <br> Month  : 9","Value:  339.69 <br> Year :  1983 <br> Month  : 9","Value:  340.9 <br> Year :  1984 <br> Month  : 9","Value:  342.92 <br> Year :  1985 <br> Month  : 9","Value:  344.68 <br> Year :  1986 <br> Month  : 9","Value:  346.27 <br> Year :  1987 <br> Month  : 9","Value:  348.55 <br> Year :  1988 <br> Month  : 9","Value:  349.64 <br> Year :  1989 <br> Month  : 9","Value:  350.82 <br> Year :  1990 <br> Month  : 9","Value:  352.05 <br> Year :  1991 <br> Month  : 9","Value:  352.94 <br> Year :  1992 <br> Month  : 9","Value:  353.67 <br> Year :  1993 <br> Month  : 9","Value:  355.84 <br> Year :  1994 <br> Month  : 9","Value:  358.11 <br> Year :  1995 <br> Month  : 9","Value:  359.51 <br> Year :  1996 <br> Month  : 9","Value:  360.24 <br> Year :  1997 <br> Month  : 9"],["Value:  313.18 <br> Year :  1959 <br> Month  : 10","Value:  313.68 <br> Year :  1960 <br> Month  : 10","Value:  315.16 <br> Year :  1961 <br> Month  : 10","Value:  315.27 <br> Year :  1962 <br> Month  : 10","Value:  315.83 <br> Year :  1963 <br> Month  : 10","Value:  316.71 <br> Year :  1964 <br> Month  : 10","Value:  317.14 <br> Year :  1965 <br> Month  : 10","Value:  317.94 <br> Year :  1966 <br> Month  : 10","Value:  319.24 <br> Year :  1967 <br> Month  : 10","Value:  320.09 <br> Year :  1968 <br> Month  : 10","Value:  321.62 <br> Year :  1969 <br> Month  : 10","Value:  322.9 <br> Year :  1970 <br> Month  : 10","Value:  323.4 <br> Year :  1971 <br> Month  : 10","Value:  325.04 <br> Year :  1972 <br> Month  : 10","Value:  327.02 <br> Year :  1973 <br> Month  : 10","Value:  327.21 <br> Year :  1974 <br> Month  : 10","Value:  328.17 <br> Year :  1975 <br> Month  : 10","Value:  328.78 <br> Year :  1976 <br> Month  : 10","Value:  330.98 <br> Year :  1977 <br> Month  : 10","Value:  332.38 <br> Year :  1978 <br> Month  : 10","Value:  333.7 <br> Year :  1979 <br> Month  : 10","Value:  335.84 <br> Year :  1980 <br> Month  : 10","Value:  336.68 <br> Year :  1981 <br> Month  : 10","Value:  337.69 <br> Year :  1982 <br> Month  : 10","Value:  339.82 <br> Year :  1983 <br> Month  : 10","Value:  341.18 <br> Year :  1984 <br> Month  : 10","Value:  342.62 <br> Year :  1985 <br> Month  : 10","Value:  343.99 <br> Year :  1986 <br> Month  : 10","Value:  346.18 <br> Year :  1987 <br> Month  : 10","Value:  348.72 <br> Year :  1988 <br> Month  : 10","Value:  349.83 <br> Year :  1989 <br> Month  : 10","Value:  351.04 <br> Year :  1990 <br> Month  : 10","Value:  352.11 <br> Year :  1991 <br> Month  : 10","Value:  353.23 <br> Year :  1992 <br> Month  : 10","Value:  353.95 <br> Year :  1993 <br> Month  : 10","Value:  356 <br> Year :  1994 <br> Month  : 10","Value:  357.8 <br> Year :  1995 <br> Month  : 10","Value:  359.65 <br> Year :  1996 <br> Month  : 10","Value:  360.83 <br> Year :  1997 <br> Month  : 10"],["Value:  314.66 <br> Year :  1959 <br> Month  : 11","Value:  314.84 <br> Year :  1960 <br> Month  : 11","Value:  315.94 <br> Year :  1961 <br> Month  : 11","Value:  316.53 <br> Year :  1962 <br> Month  : 11","Value:  316.91 <br> Year :  1963 <br> Month  : 11","Value:  317.53 <br> Year :  1964 <br> Month  : 11","Value:  318.7 <br> Year :  1965 <br> Month  : 11","Value:  319.63 <br> Year :  1966 <br> Month  : 11","Value:  320.56 <br> Year :  1967 <br> Month  : 11","Value:  321.16 <br> Year :  1968 <br> Month  : 11","Value:  322.69 <br> Year :  1969 <br> Month  : 11","Value:  323.85 <br> Year :  1970 <br> Month  : 11","Value:  324.63 <br> Year :  1971 <br> Month  : 11","Value:  326.34 <br> Year :  1972 <br> Month  : 11","Value:  327.99 <br> Year :  1973 <br> Month  : 11","Value:  328.29 <br> Year :  1974 <br> Month  : 11","Value:  329.32 <br> Year :  1975 <br> Month  : 11","Value:  330.14 <br> Year :  1976 <br> Month  : 11","Value:  332.24 <br> Year :  1977 <br> Month  : 11","Value:  333.75 <br> Year :  1978 <br> Month  : 11","Value:  335.12 <br> Year :  1979 <br> Month  : 11","Value:  336.93 <br> Year :  1980 <br> Month  : 11","Value:  338.19 <br> Year :  1981 <br> Month  : 11","Value:  339.09 <br> Year :  1982 <br> Month  : 11","Value:  340.98 <br> Year :  1983 <br> Month  : 11","Value:  342.8 <br> Year :  1984 <br> Month  : 11","Value:  344.06 <br> Year :  1985 <br> Month  : 11","Value:  345.48 <br> Year :  1986 <br> Month  : 11","Value:  347.64 <br> Year :  1987 <br> Month  : 11","Value:  349.91 <br> Year :  1988 <br> Month  : 11","Value:  351.14 <br> Year :  1989 <br> Month  : 11","Value:  352.69 <br> Year :  1990 <br> Month  : 11","Value:  353.64 <br> Year :  1991 <br> Month  : 11","Value:  354.09 <br> Year :  1992 <br> Month  : 11","Value:  355.3 <br> Year :  1993 <br> Month  : 11","Value:  357.59 <br> Year :  1994 <br> Month  : 11","Value:  359.61 <br> Year :  1995 <br> Month  : 11","Value:  360.8 <br> Year :  1996 <br> Month  : 11","Value:  362.49 <br> Year :  1997 <br> Month  : 11"],["Value:  315.43 <br> Year :  1959 <br> Month  : 12","Value:  316.03 <br> Year :  1960 <br> Month  : 12","Value:  316.85 <br> Year :  1961 <br> Month  : 12","Value:  317.53 <br> Year :  1962 <br> Month  : 12","Value:  318.2 <br> Year :  1963 <br> Month  : 12","Value:  318.55 <br> Year :  1964 <br> Month  : 12","Value:  319.25 <br> Year :  1965 <br> Month  : 12","Value:  320.87 <br> Year :  1966 <br> Month  : 12","Value:  321.8 <br> Year :  1967 <br> Month  : 12","Value:  322.74 <br> Year :  1968 <br> Month  : 12","Value:  323.95 <br> Year :  1969 <br> Month  : 12","Value:  324.96 <br> Year :  1970 <br> Month  : 12","Value:  325.85 <br> Year :  1971 <br> Month  : 12","Value:  327.39 <br> Year :  1972 <br> Month  : 12","Value:  328.48 <br> Year :  1973 <br> Month  : 12","Value:  329.41 <br> Year :  1974 <br> Month  : 12","Value:  330.59 <br> Year :  1975 <br> Month  : 12","Value:  331.52 <br> Year :  1976 <br> Month  : 12","Value:  333.68 <br> Year :  1977 <br> Month  : 12","Value:  334.78 <br> Year :  1978 <br> Month  : 12","Value:  336.56 <br> Year :  1979 <br> Month  : 12","Value:  338.04 <br> Year :  1980 <br> Month  : 12","Value:  339.44 <br> Year :  1981 <br> Month  : 12","Value:  340.32 <br> Year :  1982 <br> Month  : 12","Value:  342.82 <br> Year :  1983 <br> Month  : 12","Value:  344.04 <br> Year :  1984 <br> Month  : 12","Value:  345.38 <br> Year :  1985 <br> Month  : 12","Value:  346.72 <br> Year :  1986 <br> Month  : 12","Value:  348.78 <br> Year :  1987 <br> Month  : 12","Value:  351.18 <br> Year :  1988 <br> Month  : 12","Value:  352.37 <br> Year :  1989 <br> Month  : 12","Value:  354.07 <br> Year :  1990 <br> Month  : 12","Value:  354.89 <br> Year :  1991 <br> Month  : 12","Value:  355.33 <br> Year :  1992 <br> Month  : 12","Value:  356.78 <br> Year :  1993 <br> Month  : 12","Value:  359.05 <br> Year :  1994 <br> Month  : 12","Value:  360.74 <br> Year :  1995 <br> Month  : 12","Value:  362.38 <br> Year :  1996 <br> Month  : 12","Value:  364.34 <br> Year :  1997 <br> Month  : 12"]],"xgap":3,"ygap":3,"type":"heatmap","xaxis":"x","yaxis":"y","frame":null}],"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</section>
</section>
<section id="定常性" class="level2" data-number="29.5">
<h2 data-number="29.5" class="anchored" data-anchor-id="定常性"><span class="header-section-number">29.5</span> 定常性</h2>
<p>ここまでにホワイトノイズ、ランダムウォーク、季節性、トレンドと4つの時系列の要素について説明しました。多くの時系列データは、この4つが様々なバランスで合わさったような形をしています。</p>
<p><span class="math display">\[時系列データ=ノイズ+季節性+トレンド+(ランダムウォーク)\]</span></p>
<p>このような時系列データを統計的に適切に取り扱えればいいのですが、時系列を解析する最も基本的な統計の枠組み（ARIMAモデル）では、基本的には<strong>定常性</strong>という特徴を持つデータを取り扱うこととなっており、この定常性を持たないデータは統計的に取り扱いにくいとされています。</p>
<p>定常性とは、時系列データをある時間間隔で切り取ったとき、<strong>どの時期を切り取っても値の平均値と分散（ばらつき）がおおむね一定</strong>であることを指します。</p>
<p>ホワイトノイズは乱数の系列ですので、どの時間でも平均値は一定で、分散も一定となります。したがって、ホワイトノイズは定常過程となります。一方で、ランダムウォークやトレンドを持つデータは、平均値が移動するため定常では無い時系列データ、つまり非定常過程となります。季節性に関しては、ある程度長めの系列では平均値と分散は一定ですが、短い期間で切ると平均値と分散が上下する、非定常過程となります。</p>
</section>
<section id="自己回帰arモデル" class="level2" data-number="29.6">
<h2 data-number="29.6" class="anchored" data-anchor-id="自己回帰arモデル"><span class="header-section-number">29.6</span> 自己回帰（AR）モデル</h2>
<p><strong>自己回帰（Auto regression、AR）</strong>とは、簡単に説明すると、<strong>時点tの値がそれ以前の値（時点t-1や時点t-2）によく似ている</strong>、という性質を持つ時系列データのことを指します。数式で書くと、AR(p)モデルは以下のような形で書くことができます。</p>
<p><span class="math display">\[y_{t}=\alpha_{1} \cdot y_{t-1}+\alpha_{2} \cdot y_{t-2}+ \cdots \alpha_{p} \cdot y_{t-p}+\epsilon_{t}\]</span></p>
<p>AR(p)のpを<strong>次数（order）</strong>と呼びます。AR(1)モデルであれば、<span class="math inline">\(\alpha_{1} \cdot y_{t-1}\)</span>のみ、AR(2)モデルでは<span class="math inline">\(\alpha_{1} \cdot y_{t-1}+\alpha_{2} \cdot y_{t-2}\)</span>となります。αは係数です。AR(1)モデルで、かつα<sub>1</sub>が1である場合には、以下のようにランダムウォークとなります。</p>
<p><span class="math display">\[y_{t} =1 \cdot y_{t-1}+\epsilon_{t}\]</span></p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
時系列データの生成：arima.sim関数について
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>arima.sim</code>関数は、後に説明するARモデル、MAモデル、和分（I）を用いてシミュレーションした時系列データを生成する関数です。AR、I、MAの次数を<code>order</code>、AR、MAの係数を<code>ar</code>、<code>ma</code>として、以下のようにリストで引数<code>model</code>に与えることで、時系列データを生成することができます。また、時系列の長さは引数<code>n</code>に指定します。以下の例では、AR(2)、I(0)、MA(0)のモデルで、ARの係数が<code>0.5</code>、<code>0.5</code>の場合の時系列データ200時点分を生成しています。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>arima.sim関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>)), <span class="at">n =</span> <span class="dv">200</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>ただし、この関数では定常過程となるARの係数を指定する必要があります（定常過程とならない係数を指定した場合にはエラーが出ます）。MAは常に定常過程なので、様々な係数を設定することができます。定常過程となる条件は以下の計算式（特性方程式の解が1以上であることの判定式）が<code>TRUE</code>となることです。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ARの係数から定常過程であるか判定する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>ar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>) <span class="co"># ARの係数のベクター</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a><span class="co"># ARの係数が定常過程となるかどうかの判定（FALSEなら非定常）</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">Mod</span>(<span class="fu">polyroot</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span>ar)))) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>以下のAR、MAの例では、この<code>arima.sim</code>関数を用いてAR、MAの時系列を生成しています。</p>
</div>
</div>
</div>
<p>ARモデルの例として、AR(1)モデル、AR(2)モデル、AR(3)モデルの時系列をそれぞれ以下に図示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-1-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-1" role="tab" aria-controls="tabset-1-1" aria-selected="true" aria-current="page">AR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-2" role="tab" aria-controls="tabset-1-2" aria-selected="false">AR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-1-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-1-3" role="tab" aria-controls="tabset-1-3" aria-selected="false">AR(3)モデル</a></li></ul>
<div class="tab-content">
<div id="tabset-1-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-1-1-tab">
<p><span class="math display">\[y_{t}=\alpha_{1} \cdot y_{t-1}+\epsilon_{t}\]</span></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>AR(1)に従うモデル</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>y1a <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ar =</span> <span class="fl">0.6</span>), <span class="dv">200</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y1a)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-10-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-7"><img src="chapter29_files/figure-html/unnamed-chunk-10-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-2-tab">
<p><span class="math display">\[y_{t}=\alpha_{2} \cdot y_{t-2} +  \alpha_{1} \cdot y_{t-1} + \epsilon_{t}\]</span></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>AR(2)に従うモデル</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>y2 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.6</span>)), <span class="dv">200</span>)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-11-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-8"><img src="chapter29_files/figure-html/unnamed-chunk-11-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-1-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-1-3-tab">
<p><span class="math display">\[y_{t}=\alpha_{3} \cdot y_{t-3} + \alpha_{2} \cdot y_{t-2} + \alpha_{1} \cdot y_{t-1} + \epsilon_{t}\]</span></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>AR(3)に従うモデル</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>y3 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>, <span class="dv">0</span>), <span class="at">ar =</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.6</span>)), <span class="dv">200</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-12-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-9"><img src="chapter29_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="自己相関と偏自己相関" class="level2" data-number="29.7">
<h2 data-number="29.7" class="anchored" data-anchor-id="自己相関と偏自己相関"><span class="header-section-number">29.7</span> 自己相関と偏自己相関</h2>
<p>ARモデルは、時間tの値とそれ以前の値がよく似ている時系列です。この「よく似ている」度合いを評価するためのものが、<strong>自己相関</strong>と<strong>偏自己相関</strong>です。</p>
<p><strong>自己相関</strong>とは、時系列の値y<sub>t</sub>とp時点前の値y<sub>t-p</sub>の値の相関のことを指します。pには整数が入り、pのことをラグ（log）と呼びます。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./image/autocorrelation.png" class="lightbox" data-glightbox="description: .lightbox-desc-10" data-gallery="quarto-lightbox-gallery-10" title="図1：自己相関のイメージ"><img src="./image/autocorrelation.png" class="img-fluid figure-img" alt="図1：自己相関のイメージ"></a></p>
<figcaption>図1：自己相関のイメージ</figcaption>
</figure>
</div>
<p>自己相関は、Rでは以下のように計算することができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>自己相関の計算</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co"># y1はランダムウォークのデータ</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(y1)</span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.6314771 0.4683605 1.1332601 1.7694748 1.9767955 1.2068205</span></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a><span class="co"># p = 1のとき</span></span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(y1[<span class="dv">1</span><span class="sc">:</span><span class="dv">199</span>], y1[<span class="dv">2</span><span class="sc">:</span><span class="dv">200</span>])</span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.947694</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a><span class="co"># p = 2のとき</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(y1[<span class="dv">1</span><span class="sc">:</span><span class="dv">198</span>], y1[<span class="dv">3</span><span class="sc">:</span><span class="dv">200</span>])</span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8920951</span></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a><span class="co"># p = 3のとき</span></span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(y1[<span class="dv">1</span><span class="sc">:</span><span class="dv">197</span>], y1[<span class="dv">4</span><span class="sc">:</span><span class="dv">200</span>])</span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 0.8312737</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>上のスクリプトで用いている時系列はランダムウォークですが、ランダムウォークではpが大きくなると少しずつ自己相関が小さくなっていく傾向があります。これは、以下の式のように、時点tの値は時点t-1の値で、時点t-1の値は時点t-2の値で説明できることから、時点tの値は時点t-2の値にも依存するためです。</p>
<p><span class="math display">\[y_{t} =1 \cdot y_{t-1}+\epsilon_{t}\]</span> <span class="math display">\[y_{t-1} =1 \cdot y_{t-2}+\epsilon_{t-1}\]</span> <span class="math display">\[y_{t} =1 \cdot y_{t-2}+\epsilon_{t}+\epsilon_{t-1}\]</span></p>
<p>ただし、ランダムウォークでは1段階差の相関が最も重要です。このような、1段階差が似ているために2段階差以降にも自己相関が出てしまうような効果を取り除いたものを<strong>偏自己相関</strong>と呼びます。偏自己相関は自己相関ほどには簡単に求まりませんが、時系列が以前のどの時点とよく似ているのかを調べるのに有用です。</p>
<section id="acfpacf関数" class="level3" data-number="29.7.1">
<h3 data-number="29.7.1" class="anchored" data-anchor-id="acfpacf関数"><span class="header-section-number">29.7.1</span> acf、pacf関数</h3>
<p>上記のように<code>cor</code>関数を用いれば自己相関は求まりますが、各時点の自己相関・偏自己相関をいちいち<code>cor</code>関数で計算するのは大変です。</p>
<p>Rには、自己相関・偏自己相関を計算する関数として、<code>acf</code>関数と<code>pacf</code>関数が備わっています。いずれも時系列データを引数に取り、自己相関・偏自己相関の値を返す関数です。ただし、デフォルトでは<code>plot</code>引数が<code>TRUE</code>に設定されているため、<code>acf</code>関数は<strong>自己相関プロット</strong>・<code>pacf</code>関数は<strong>偏自己相関プロット</strong>を自動的に表示します。数値として自己相関・偏自己相関を得る場合には、引数に<code>plot=FALSE</code>を指定します。</p>
<p>グラフの横軸は階差（ラグ、Lag）で、Lag=0は時点tの値と時点tの値の相関、つまり同じもの同士の相関ですので、必ず1になります。Lag=1が1段階差の（偏）自己相関、Lag=2だと2段階差の（偏）自己相関ということになります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>acf関数とpacf関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="fu">acf</span>(y1) <span class="co"># 自己相関（グラフが表示される、plot=FALSEとすると数値が返ってくる）</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-14-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-11"><img src="chapter29_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pacf</span>(y1) <span class="co"># 偏自己相関</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-14-2.png" class="lightbox" data-gallery="quarto-lightbox-gallery-12"><img src="chapter29_files/figure-html/unnamed-chunk-14-2.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p><code>TSstudio</code>パッケージの<code>ts_cor</code>関数を用いれば、自己相関と偏自己相関のグラフを一度に表示することができます。また、<code>ts_lags</code>関数を用いると、引数<code>lag</code>に指定したラグでの相関について、散布図を表示することもできます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y1 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>()) <span class="co"># 自己相関と偏自己相関プロット</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-228a8cf6b1e43b59596f" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-228a8cf6b1e43b59596f">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.94575742206088109,0.88910512476678238,0.82582708464478505,0.7669332209624562,0.71910621819867493,0.66570095577058819,0.61751512877486436,0.57547059750940832,0.52287536765432518,0.47320584737661203,0.42602021527164746,0.38912944925148873,0.34987976750532962,0.30527914866785266,0.26067367409916775,0.21792012884475906,0.18536605960181463,0.15628538594376251,0.13748481877370836,0.13238570015690398,0.12862608419171315,0.12635552656067267,0.11998506706575936],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.94575742206088109,-0.050709016775207609,-0.09244991875250709,0.0096478248857275184,0.074719087299796733,-0.091373993645371535,0.0087061059284055508,0.043569750247004824,-0.1337379239934508,-0.017676341893776062,0.023689089750454324,0.060444487168492426,-0.088618819104441734,-0.068979558351750112,-0.014909698674241516,-0.012323019312154428,0.055976531625988278,0.0028472938619697281,0.068812516977571306,0.087543139090160399,0.0010043127385459295,0.0014260871051396996,-0.015894782569567438],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(y1) ACF and PACF Plots"},"attrs":{"1bd0428ba4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd0428ba4.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.94575742206088109,0.88910512476678238,0.82582708464478505,0.7669332209624562,0.71910621819867493,0.66570095577058819,0.61751512877486436,0.57547059750940832,0.52287536765432518,0.47320584737661203,0.42602021527164746,0.38912944925148873,0.34987976750532962,0.30527914866785266,0.26067367409916775,0.21792012884475906,0.18536605960181463,0.15628538594376251,0.13748481877370836,0.13238570015690398,0.12862608419171315,0.12635552656067267,0.11998506706575936],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd0428ba4.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd0428ba4.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd0428ba4.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd06f425265":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.94575742206088109,-0.050709016775207609,-0.09244991875250709,0.0096478248857275184,0.074719087299796733,-0.091373993645371535,0.0087061059284055508,0.043569750247004824,-0.1337379239934508,-0.017676341893776062,0.023689089750454324,0.060444487168492426,-0.088618819104441734,-0.068979558351750112,-0.014909698674241516,-0.012323019312154428,0.055976531625988278,0.0028472938619697281,0.068812516977571306,0.087543139090160399,0.0010043127385459295,0.0014260871051396996,-0.015894782569567438],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd06f425265.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd06f425265.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd06f425265.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_lags</span>(y1 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>(), <span class="at">lag =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co"># lagで指定した系列との散布図</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a7a1433718a550d748ac" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a7a1433718a550d748ac">{"x":{"data":[{"x":[0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147],"y":[0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147,-1.1441554335799675],"mode":"markers","type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"line":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646],"y":[1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147,-1.1441554335799675],"mode":"markers","type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"line":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y","frame":null},{"x":[0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723],"y":[1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147,-1.1441554335799675],"mode":"markers","type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"line":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y","frame":null}],"layout":{"xaxis":{"domain":[0,0.3133333333333333],"automargin":true,"title":"","range":[-4.1388433776276159,2.2580318319086357],"anchor":"y"},"xaxis2":{"domain":[0.35333333333333333,0.64666666666666661],"automargin":true,"title":"","range":[-4.1388433776276159,2.2580318319086357],"anchor":"y"},"xaxis3":{"domain":[0.68666666666666665,1],"automargin":true,"title":"","range":[-4.1388433776276159,2.2580318319086357],"anchor":"y"},"yaxis":{"domain":[0,1],"automargin":true,"range":[-4.1388433776276159,2.2580318319086357],"title":[],"anchor":"x"},"annotations":[{"text":"Lag 1","xref":"paper","yref":"paper","yanchor":"bottom","xanchor":"center","align":"center","x":0.15666666666666665,"y":0.90000000000000002,"showarrow":false},{"text":"Lag 2","xref":"paper","yref":"paper","yanchor":"bottom","xanchor":"center","align":"center","x":0.5,"y":0.90000000000000002,"showarrow":false},{"text":"Lag 3","xref":"paper","yref":"paper","yanchor":"bottom","xanchor":"center","align":"center","x":0.84333333333333327,"y":0.90000000000000002,"showarrow":false}],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"closest","showlegend":false,"title":"as.ts(y1) - Series (Y axis) vs. Lags (X axis)"},"attrs":{"1bd04a785b7c":{"x":[null,0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147],"y":[0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147,-1.1441554335799675],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1bd063a864aa":{"x":[null,null,0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646],"y":[0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147,-1.1441554335799675],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1bd073853601":{"x":[null,null,null,0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723],"y":[0.63147714244039665,0.46836046208757198,1.1332600935488224,1.7694747542635247,1.9767954714917289,1.2068204505398741,0.7425369331831051,0.595176709787825,0.59229312341405649,1.7946198178430319,2.1764165484132616,1.7769119239185776,1.2030834193004019,1.0583526324562902,0.90874507350763212,0.70298965711009864,0.82910138118816479,0.38314081754588047,0.60098246722373982,-0.01778674374123923,-0.12992068638039389,0.058777136610456637,0.12544531701787734,0.52754007189033125,0.49898668469842689,0.75079067081528994,1.2936753518881334,0.94819843203971832,0.30589875510362419,0.32926184119780016,0.21140856297804955,-0.060035564527077645,-0.27669072325546873,-0.6014265466535853,-0.23805117296085981,0.33790470408274015,0.83398488680563909,0.61922833205969852,1.2383803824863886,1.098707241559254,1.9776587864646076,2.2580318319086357,2.0316398456320566,1.6156181975731405,1.032332924030787,0.49953763383663896,-0.28235339169886353,0.29591510687622613,0.71193867116242093,0.59827432545004322,0.73134300628609561,0.5429916469942816,1.7636739614415764,1.3660044028138905,1.3385656659581011,1.4636363273851773,1.7727579741683008,1.6864462228453723,0.57449608584040357,-0.057311106644887921,0.12205334134078802,0.11653060210795624,-0.35379397920134797,-0.41170664027982518,-0.81919099471478396,-0.69805925428494098,-1.410608451651191,-1.227637890126581,-1.1034315656902827,-1.0707874748544723,-1.0612092790243355,-0.93254009044656883,-1.2570451293010176,-1.3166295105100367,-0.98456166056298144,-0.43407710946593792,-0.36219136908690297,-0.42106816816987863,-0.8771023516440476,-1.595895472059037,-1.9944402345950194,-1.3673986813700338,-0.9813275884677688,-1.0910854018444887,-1.3034905435331323,-1.5129805932441118,-1.0144871627895589,-1.1523761773335726,-0.52436676868052257,-0.20102957343285011,0.44862657784886539,0.011995521976647883,0.016181001974664537,-0.42425485965160775,-0.12612535134627795,-0.066266530701509702,-0.20735346936273544,0.52064073117043597,0.63515052651778192,1.1334224907898451,1.5243520830899742,1.1359637722076759,0.82796881835371683,0.85125896975621518,0.28606608095586905,0.57442547190411219,-0.065949243990049755,0.74677440774242232,0.49642610974106999,1.3355747136492164,1.1293147699080175,0.64317135215523757,0.65586278594914027,0.66960045432173665,-0.1704909068762297,0.35638452463807879,-0.20341502764801112,-0.035606422663603615,0.21179146089297543,0.28081781524884375,0.22142180235942963,0.32026393353232713,-0.21408242209506584,-0.61568903077743609,-1.1725715989372021,-0.38252575708528391,0.36638362343392283,0.49770635276530395,-0.11874424702032826,-0.12060601391641852,0.63523012748902774,0.3973809852742608,0.79633920403980041,0.30933792348353695,0.6540242723662737,0.1761047207278747,-0.43974880847917358,-0.91819474914198307,-1.3530861859852297,-1.808426527231874,-1.4377883746017701,-1.403532607963198,-1.5654079852571789,-2.1086595087540276,-2.6166239821814736,-3.000519074546903,-3.5603791051103948,-3.7844662234120925,-3.5485980361854774,-4.1388433776276159,-3.4037148790861229,-4.0594251748985641,-4.1076876362800547,-2.9228276823043831,-2.4775144440856725,-2.6036060247811461,-3.0364879022032776,-2.7451949022600557,-2.7514595757579139,-2.9388869568148612,-2.7799440892686249,-3.0243469066869357,-1.695017893187702,-0.85487879084292751,-0.46508678630500083,-0.10846652624859054,-0.37990749480455621,0.062981692145909651,-0.11131565010946703,-0.61534293919423644,0.32624833199706138,-0.13823720760352637,-0.28533543440698284,-0.59281056980516045,-1.0663484656756699,-0.76686089077051312,-1.5286683319592898,-1.6317628330179326,-1.9189105401686355,-2.6139935584861749,-2.6492022497397523,-2.8646420145417943,-3.1607547010225883,-2.6701966210692807,-2.4039919427340277,-2.4492200048545252,-2.3709747590064802,-2.7396306044264649,-2.8403012073625549,-2.2892129098257081,-2.2975870379016454,-2.2166927211230241,-1.2043120260841567,-1.5561591530335255,-1.075762961058262,-0.18052043428935427,-0.71260301595606723,-0.70378474274376646,-0.89873905739669147,-1.1441554335799675],"mode":"markers","alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,".hideLegend":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>以下に、ホワイトノイズ、ランダムウォーク、AR(1)、AR(2)、AR(3)モデル、季節性、トレンドの自己相関と偏自己相関を示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-2-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-1" role="tab" aria-controls="tabset-2-1" aria-selected="true">ホワイトノイズ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-2" role="tab" aria-controls="tabset-2-2" aria-selected="false">ランダムウォーク</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-3" role="tab" aria-controls="tabset-2-3" aria-selected="false">AR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-4" role="tab" aria-controls="tabset-2-4" aria-selected="false">AR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-5" role="tab" aria-controls="tabset-2-5" aria-selected="false">AR(3)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-6" role="tab" aria-controls="tabset-2-6" aria-selected="false">季節性あり</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-2-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-2-7" role="tab" aria-controls="tabset-2-7" aria-selected="false">トレンドあり</a></li></ul>
<div class="tab-content">
<div id="tabset-2-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-2-1-tab">
<p>ホワイトノイズでは、自己相関はLag=0だけ1となり、自己相関も偏自己相関も0に近い値となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ホワイトノイズの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-eddd48ca24df6702b292" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-eddd48ca24df6702b292">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.028464689337097171,0.059507853511498628,-0.048242141974157216,-0.098159617576552533,0.044707908948027418,-0.053571322455201222,-0.051043476126304811,0.082364017086931293,-0.04134934098176217,-0.027728455926319735,-0.10387575724992872,0.029122796827861511,0.058014822732062037,-0.00031054248961671015,-0.015229562527544016,-0.10302907004532923,-0.037535980535540532,-0.095033325360608017,-0.12065653622758341,-0.011367206021613207,-0.0043130260675555646,0.042919315973988396,-0.0010529447904073258],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.028464689337097171,0.058745212607681042,-0.051728956643340415,-0.099515254239852954,0.057010015496044585,-0.047260038139015824,-0.065841959439417008,0.090300643428836591,-0.035590767213322078,-0.058016152706824142,-0.094473725461033664,0.060112226048313996,0.04308754433605648,-0.021863294342057638,-0.026292093017619592,-0.095716705942618413,-0.035183778846997166,-0.09588493438677452,-0.10640642787591496,-0.025916365420460736,-0.015829837261848362,0.00083274088175522352,-0.021008578227174189],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(y) ACF and PACF Plots"},"attrs":{"1bd019e742f8":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd019e742f8.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.028464689337097171,0.059507853511498628,-0.048242141974157216,-0.098159617576552533,0.044707908948027418,-0.053571322455201222,-0.051043476126304811,0.082364017086931293,-0.04134934098176217,-0.027728455926319735,-0.10387575724992872,0.029122796827861511,0.058014822732062037,-0.00031054248961671015,-0.015229562527544016,-0.10302907004532923,-0.037535980535540532,-0.095033325360608017,-0.12065653622758341,-0.011367206021613207,-0.0043130260675555646,0.042919315973988396,-0.0010529447904073258],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd019e742f8.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd019e742f8.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd019e742f8.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd05317ce":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.028464689337097171,0.058745212607681042,-0.051728956643340415,-0.099515254239852954,0.057010015496044585,-0.047260038139015824,-0.065841959439417008,0.090300643428836591,-0.035590767213322078,-0.058016152706824142,-0.094473725461033664,0.060112226048313996,0.04308754433605648,-0.021863294342057638,-0.026292093017619592,-0.095716705942618413,-0.035183778846997166,-0.09588493438677452,-0.10640642787591496,-0.025916365420460736,-0.015829837261848362,0.00083274088175522352,-0.021008578227174189],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd05317ce.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd05317ce.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd05317ce.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-2-tab">
<p>ランダムウォークでは、自己相関はLagが大きくなるほど減っていきます。偏自己相関はLag=1だけが高い値となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ランダムウォークの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y1 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-a07fb37e03cc3b40bfe7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-a07fb37e03cc3b40bfe7">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.94575742206088109,0.88910512476678238,0.82582708464478505,0.7669332209624562,0.71910621819867493,0.66570095577058819,0.61751512877486436,0.57547059750940832,0.52287536765432518,0.47320584737661203,0.42602021527164746,0.38912944925148873,0.34987976750532962,0.30527914866785266,0.26067367409916775,0.21792012884475906,0.18536605960181463,0.15628538594376251,0.13748481877370836,0.13238570015690398,0.12862608419171315,0.12635552656067267,0.11998506706575936],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.94575742206088109,-0.050709016775207609,-0.09244991875250709,0.0096478248857275184,0.074719087299796733,-0.091373993645371535,0.0087061059284055508,0.043569750247004824,-0.1337379239934508,-0.017676341893776062,0.023689089750454324,0.060444487168492426,-0.088618819104441734,-0.068979558351750112,-0.014909698674241516,-0.012323019312154428,0.055976531625988278,0.0028472938619697281,0.068812516977571306,0.087543139090160399,0.0010043127385459295,0.0014260871051396996,-0.015894782569567438],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(y1) ACF and PACF Plots"},"attrs":{"1bd015202032":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd015202032.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.94575742206088109,0.88910512476678238,0.82582708464478505,0.7669332209624562,0.71910621819867493,0.66570095577058819,0.61751512877486436,0.57547059750940832,0.52287536765432518,0.47320584737661203,0.42602021527164746,0.38912944925148873,0.34987976750532962,0.30527914866785266,0.26067367409916775,0.21792012884475906,0.18536605960181463,0.15628538594376251,0.13748481877370836,0.13238570015690398,0.12862608419171315,0.12635552656067267,0.11998506706575936],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd015202032.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd015202032.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd015202032.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd013d6140b":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.94575742206088109,-0.050709016775207609,-0.09244991875250709,0.0096478248857275184,0.074719087299796733,-0.091373993645371535,0.0087061059284055508,0.043569750247004824,-0.1337379239934508,-0.017676341893776062,0.023689089750454324,0.060444487168492426,-0.088618819104441734,-0.068979558351750112,-0.014909698674241516,-0.012323019312154428,0.055976531625988278,0.0028472938619697281,0.068812516977571306,0.087543139090160399,0.0010043127385459295,0.0014260871051396996,-0.015894782569567438],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd013d6140b.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd013d6140b.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd013d6140b.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-3-tab">
<p>AR(1)モデルはランダムウォークとよく似た自己相関・偏自己相関を示します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>AR(1)モデルの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y1a <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-b4fd8469ab2278169c74" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-b4fd8469ab2278169c74">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.54176923125806886,0.22703323768542821,0.056001850790652834,-0.044510973706137033,-0.071634061188476345,-0.09444110704739285,-0.23301343635196878,-0.32287675400152699,-0.29603510102439989,-0.19305932999831574,-0.073361576317370281,-0.0032291036885649643,0.012761886941350848,-0.017530518936469241,-0.078217054274542647,-0.058255819300736596,0.039367041391717143,0.08426600556040291,0.0084282262857553469,-0.058253676686763928,-0.057381491121821532,-0.0095386181699911501,0.020253145981701678],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.54176923125806886,-0.094100453280952873,-0.039403270966086208,-0.05734114702861888,-0.01289190113690159,-0.05330435804940277,-0.22435432394621085,-0.14587221646328061,-0.054383130241357942,-0.0013059804197173808,0.0098014114545043121,-0.020519185017891454,-0.026806008530773518,-0.085486898048418622,-0.1550432101658733,-0.056097568806023228,0.045874031334419411,0.0024758580236882133,-0.1224924344789723,-0.071014163768065255,-0.0052293740619658493,-0.017509446081017115,-0.088252116492484253],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(y1a) ACF and PACF Plots"},"attrs":{"1bd078a42481":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd078a42481.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.54176923125806886,0.22703323768542821,0.056001850790652834,-0.044510973706137033,-0.071634061188476345,-0.09444110704739285,-0.23301343635196878,-0.32287675400152699,-0.29603510102439989,-0.19305932999831574,-0.073361576317370281,-0.0032291036885649643,0.012761886941350848,-0.017530518936469241,-0.078217054274542647,-0.058255819300736596,0.039367041391717143,0.08426600556040291,0.0084282262857553469,-0.058253676686763928,-0.057381491121821532,-0.0095386181699911501,0.020253145981701678],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd078a42481.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd078a42481.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd078a42481.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd0773e223c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.54176923125806886,-0.094100453280952873,-0.039403270966086208,-0.05734114702861888,-0.01289190113690159,-0.05330435804940277,-0.22435432394621085,-0.14587221646328061,-0.054383130241357942,-0.0013059804197173808,0.0098014114545043121,-0.020519185017891454,-0.026806008530773518,-0.085486898048418622,-0.1550432101658733,-0.056097568806023228,0.045874031334419411,0.0024758580236882133,-0.1224924344789723,-0.071014163768065255,-0.0052293740619658493,-0.017509446081017115,-0.088252116492484253],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd0773e223c.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd0773e223c.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd0773e223c.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-4-tab">
<p>AR(2)モデルでは、（係数によりますが）自己相関はlag2つ置きに高い値を示し、偏自己相関はlag=2で高くなります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>AR(2)モデルの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y2 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-22a3c87662a2939578a8" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-22a3c87662a2939578a8">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.26334206047420905,0.70250204315996112,0.27679638966072589,0.45589076898322578,0.21746913478702815,0.31548513281960977,0.08898715697934198,0.20233196360403355,-0.039954221324160183,0.13202294767235842,-0.14941795984518413,0.020940422100733266,-0.16027455516612613,-0.078021132263689286,-0.11934950350500972,-0.096018981239290743,-0.14853767023930661,-0.14212571392407092,-0.15029904285460849,-0.18694297667235638,-0.15649875888116077,-0.19945470195049028,-0.17413888936040547],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.26334206047420905,0.68033347636529184,0.077012443859572371,-0.093714881516203649,-0.072734965216137842,0.032365791382392227,-0.13874868029447152,-0.023759544088123762,-0.11237285272436098,0.063964784032262051,-0.11416133465784804,-0.07562660580584224,0.052805975405301991,-0.028937687227021502,0.074716412059022949,0.02740330642995736,-0.082996577149886813,-0.15094244132270171,0.025607175028833109,-0.088682013306234958,-0.02665930655459799,-0.032472495309913758,-0.03443200060806844],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(y2) ACF and PACF Plots"},"attrs":{"1bd031ea2eed":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd031ea2eed.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.26334206047420905,0.70250204315996112,0.27679638966072589,0.45589076898322578,0.21746913478702815,0.31548513281960977,0.08898715697934198,0.20233196360403355,-0.039954221324160183,0.13202294767235842,-0.14941795984518413,0.020940422100733266,-0.16027455516612613,-0.078021132263689286,-0.11934950350500972,-0.096018981239290743,-0.14853767023930661,-0.14212571392407092,-0.15029904285460849,-0.18694297667235638,-0.15649875888116077,-0.19945470195049028,-0.17413888936040547],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd031ea2eed.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd031ea2eed.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd031ea2eed.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd04f236770":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.26334206047420905,0.68033347636529184,0.077012443859572371,-0.093714881516203649,-0.072734965216137842,0.032365791382392227,-0.13874868029447152,-0.023759544088123762,-0.11237285272436098,0.063964784032262051,-0.11416133465784804,-0.07562660580584224,0.052805975405301991,-0.028937687227021502,0.074716412059022949,0.02740330642995736,-0.082996577149886813,-0.15094244132270171,0.025607175028833109,-0.088682013306234958,-0.02665930655459799,-0.032472495309913758,-0.03443200060806844],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd04f236770.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd04f236770.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd04f236770.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-5-tab">
<p>AR(3)モデルでは、（係数によりますが）自己相関はlag3つ置きに高い値を示し、偏自己相関はlag=3で高くなります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>AR(3)モデルの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y3 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-55d26bfe112ba61c5aa3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-55d26bfe112ba61c5aa3">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.26412515251295404,0.25812996197173621,0.66318387965552228,0.22006374869328321,0.18534572180293724,0.41372293549188283,0.11547197818008742,0.088627144469390087,0.23361630683138765,-0.021654570289514619,0.036014288800109012,0.12008239629578758,-0.050379196288057038,-0.0074211575167292838,0.069082915044124435,-0.084279429030533537,-0.027969512485337154,0.064292625611499829,-0.075047548661546032,-0.012721275333186137,-0.0081828450363486682,-0.096430014304559511,0.037045530884455294],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.26412515251295404,0.20249429206253575,0.62249819655224947,-0.034543260111227832,-0.071981320733431636,-0.044152091673594782,-0.091150109274350535,-0.052270569797179249,-0.0089292114680975272,-0.11825525377135865,0.04597906317132356,0.024481282142842807,0.055082532247360427,-0.015489442545480851,0.020942717501677244,-0.06254342552745,-0.010149775905957932,0.048480975439517515,0.0090028829907671803,0.012909282834985934,-0.11575081747478178,-0.065739780948816023,0.11983518472594044],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(y3) ACF and PACF Plots"},"attrs":{"1bd0305e496d":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd0305e496d.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.26412515251295404,0.25812996197173621,0.66318387965552228,0.22006374869328321,0.18534572180293724,0.41372293549188283,0.11547197818008742,0.088627144469390087,0.23361630683138765,-0.021654570289514619,0.036014288800109012,0.12008239629578758,-0.050379196288057038,-0.0074211575167292838,0.069082915044124435,-0.084279429030533537,-0.027969512485337154,0.064292625611499829,-0.075047548661546032,-0.012721275333186137,-0.0081828450363486682,-0.096430014304559511,0.037045530884455294],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd0305e496d.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd0305e496d.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd0305e496d.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd06ce839b1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.26412515251295404,0.20249429206253575,0.62249819655224947,-0.034543260111227832,-0.071981320733431636,-0.044152091673594782,-0.091150109274350535,-0.052270569797179249,-0.0089292114680975272,-0.11825525377135865,0.04597906317132356,0.024481282142842807,0.055082532247360427,-0.015489442545480851,0.020942717501677244,-0.06254342552745,-0.010149775905957932,0.048480975439517515,0.0090028829907671803,0.012909282834985934,-0.11575081747478178,-0.065739780948816023,0.11983518472594044],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd06ce839b1.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd06ce839b1.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd06ce839b1.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-6-tab">
<p>季節性がある場合には、自己相関に季節周期の波が生じます。偏自己相関には際立った特徴はありません。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>季節性ありの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(ys <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-1fde3276d0e432f67cb3" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-1fde3276d0e432f67cb3">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.69731818784646082,0.32402619202073463,-0.11184290245484547,-0.43049877002918518,-0.55998894157951984,-0.62014176421842915,-0.57239124310496692,-0.39572560753369374,-0.11148747183655131,0.29804926995781916,0.64588145004739195,0.81298640428122748,0.66504442029585564,0.29950053005100497,-0.10767764859275204,-0.42076832422492022,-0.55470863493200839,-0.60079681837006293,-0.54598558503341943,-0.37819608178716124,-0.093589466401233223,0.28844152056628675,0.61075969414121012],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.69731818784646082,-0.31577090313289957,-0.40851706033091117,-0.19872672879314632,-0.074020920686211189,-0.37591475993554063,-0.38035606359328133,-0.20777546276356657,-0.13730663706779644,0.14272338004153751,0.23700713447172564,0.27708584992768276,0.0016302007838653037,-0.10887546738649367,-0.087950221312327645,-0.064649881631203915,0.047060171845934647,-0.079148131489383031,-0.08928768276757991,-0.060269892925658389,-0.033125371850797218,-0.0016422664128669475,-0.0087514182423820489],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(ys) ACF and PACF Plots"},"attrs":{"1bd038337ffd":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd038337ffd.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.69731818784646082,0.32402619202073463,-0.11184290245484547,-0.43049877002918518,-0.55998894157951984,-0.62014176421842915,-0.57239124310496692,-0.39572560753369374,-0.11148747183655131,0.29804926995781916,0.64588145004739195,0.81298640428122748,0.66504442029585564,0.29950053005100497,-0.10767764859275204,-0.42076832422492022,-0.55470863493200839,-0.60079681837006293,-0.54598558503341943,-0.37819608178716124,-0.093589466401233223,0.28844152056628675,0.61075969414121012],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd038337ffd.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd038337ffd.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd038337ffd.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd05af046d4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.69731818784646082,-0.31577090313289957,-0.40851706033091117,-0.19872672879314632,-0.074020920686211189,-0.37591475993554063,-0.38035606359328133,-0.20777546276356657,-0.13730663706779644,0.14272338004153751,0.23700713447172564,0.27708584992768276,0.0016302007838653037,-0.10887546738649367,-0.087950221312327645,-0.064649881631203915,0.047060171845934647,-0.079148131489383031,-0.08928768276757991,-0.060269892925658389,-0.033125371850797218,-0.0016422664128669475,-0.0087514182423820489],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd05af046d4.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd05af046d4.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd05af046d4.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-2-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-2-7-tab">
<p>トレンドの傾向にもよりますが、直線的なトレンドがある場合には、AR(1)とよく似た自己相関・偏自己相関を示します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>トレンドありの自己相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(yt <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-58c894144e72fb64bfd7" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-58c894144e72fb64bfd7">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.97376813813001883,0.9427050113411044,0.90996337431054997,0.88349154578229971,0.86356281616938579,0.84639393652947237,0.83529982179851159,0.82728672160916683,0.82452108784907685,0.82877661684885462,0.8285408368253776,0.82071486340157074,0.79938675540857607,0.76839025610025591,0.73585880336701481,0.70738521806074051,0.68787033829692013,0.67301797605634395,0.66318559722955195,0.65584922287079772,0.65429581587304875,0.6566245055785267,0.65609955177441992],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.97376813813001861,-0.10660183740836372,-0.040345916344722128,0.11055183324643496,0.093572423537374522,0.014640304402520081,0.11025079660681819,0.06086595873777479,0.10547832699339062,0.16053600374605742,-0.069635667586565281,-0.1027622242824222,-0.18442217266759114,-0.15540949008582292,-0.043681078062569552,0.030440071813937625,0.0871108160693225,0.025252524694631615,0.047015401280830225,-0.012301831884926928,0.072963954330207706,0.048732118126252506,-0.02224132254412672],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(yt) ACF and PACF Plots"},"attrs":{"1bd0679f3455":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd0679f3455.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.97376813813001883,0.9427050113411044,0.90996337431054997,0.88349154578229971,0.86356281616938579,0.84639393652947237,0.83529982179851159,0.82728672160916683,0.82452108784907685,0.82877661684885462,0.8285408368253776,0.82071486340157074,0.79938675540857607,0.76839025610025591,0.73585880336701481,0.70738521806074051,0.68787033829692013,0.67301797605634395,0.66318559722955195,0.65584922287079772,0.65429581587304875,0.6566245055785267,0.65609955177441992],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd0679f3455.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd0679f3455.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd0679f3455.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd036f94e9":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.97376813813001861,-0.10660183740836372,-0.040345916344722128,0.11055183324643496,0.093572423537374522,0.014640304402520081,0.11025079660681819,0.06086595873777479,0.10547832699339062,0.16053600374605742,-0.069635667586565281,-0.1027622242824222,-0.18442217266759114,-0.15540949008582292,-0.043681078062569552,0.030440071813937625,0.0871108160693225,0.025252524694631615,0.047015401280830225,-0.012301831884926928,0.072963954330207706,0.048732118126252506,-0.02224132254412672],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd036f94e9.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd036f94e9.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd036f94e9.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="ar関数でモデルを推定" class="level3" data-number="29.7.2">
<h3 data-number="29.7.2" class="anchored" data-anchor-id="ar関数でモデルを推定"><span class="header-section-number">29.7.2</span> ar関数でモデルを推定</h3>
<p>上記のように、「前の値とよく似ている」のがARモデルです。ただし、時系列データがARモデルを取っているということがあらかじめわかっているという場合は稀です。ですので、時系列データが取れたときに、その時系列がAR(1)モデルなのかAR(2)モデルなのか、ARの係数αがいくつなのか、といったことが求まる方が、その時系列の理解が深まります。</p>
<p>時系列データが得られた時に、ARのモデルと係数をそれぞれ求めるための関数が<code>ar</code>関数です。<code>ar</code>関数は時系列データ（ベクター）を引数に取り、ARの次数と係数を返します。<code>ar</code>関数はAICによるモデル選択でARの次数を求めています。以下に様々な時系列における<code>ar</code>関数の計算結果を示します。必ずしも正しい次数・係数が求まるわけではありませんが、データが増えれば<code>ar</code>関数でより正確にARモデルを求めることができます。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-3-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-1" role="tab" aria-controls="tabset-3-1" aria-selected="true">ホワイトノイズ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-2" role="tab" aria-controls="tabset-3-2" aria-selected="false">ランダムウォーク</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-3" role="tab" aria-controls="tabset-3-3" aria-selected="false">AR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-4" role="tab" aria-controls="tabset-3-4" aria-selected="false">AR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-5" role="tab" aria-controls="tabset-3-5" aria-selected="false">AR(3)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-6" role="tab" aria-controls="tabset-3-6" aria-selected="false">季節性あり</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-3-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-3-7" role="tab" aria-controls="tabset-3-7" aria-selected="false">トレンドあり</a></li></ul>
<div class="tab-content">
<div id="tabset-3-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-3-1-tab">
<p>ホワイトノイズはARモデルで示せないため、次数（order）は0、係数は示されません。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = y)</span></span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 0  sigma^2 estimated as  0.2131</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-2-tab">
<p>ランダムウォークはAR(1)の特別な場合（<span class="math inline">\(\alpha=1\)</span>）なので、Orderは1（AR(1)モデル）で、係数（Coefficients）はほぼ1となります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y1)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = y1)</span></span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      1  </span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.9458  </span></span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 1  sigma^2 estimated as  0.2145</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-3-tab">
<p>AR(1)モデルのorderは1になるはずですが、lag=8の自己相関が大きめに出るためにAR(8)が選ばれています。1次の係数は設定した0.6に近い値を示します。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y1a)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = y1a)</span></span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       1        2        3        4        5        6        7        8  </span></span>
<span id="cb29-8"><a href="#cb29-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.5407  -0.0620  -0.0189  -0.0634  -0.0018   0.0673  -0.1407  -0.1459  </span></span>
<span id="cb29-9"><a href="#cb29-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb29-10"><a href="#cb29-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 8  sigma^2 estimated as  0.9814</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-4-tab">
<p>AR(2)モデルのorderは2で、Coefficientsとして1次は0.08で設定値0.1に近い値、2次は0.68で設定値0.6に近い値となっています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y2)</span>
<span id="cb30-2"><a href="#cb30-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-3"><a href="#cb30-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb30-4"><a href="#cb30-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = y2)</span></span>
<span id="cb30-5"><a href="#cb30-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-6"><a href="#cb30-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb30-7"><a href="#cb30-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      1       2  </span></span>
<span id="cb30-8"><a href="#cb30-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.0842  0.6803  </span></span>
<span id="cb30-9"><a href="#cb30-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb30-10"><a href="#cb30-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 2  sigma^2 estimated as  0.9906</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-5-tab">
<p>AR(3)モデルのorderは3で、Coeffientsは0.08、0.07、0.62と、設定値の0.1、0.1、0.6に近い値が得られています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y3)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = y3)</span></span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="do">##      1       2       3  </span></span>
<span id="cb31-8"><a href="#cb31-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 0.0846  0.0714  0.6225  </span></span>
<span id="cb31-9"><a href="#cb31-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb31-10"><a href="#cb31-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 3  sigma^2 estimated as  1.057</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-6-tab">
<p>12ごとの周期性のある季節性データでは、AR(12)が選ばれています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb32"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(ys)</span>
<span id="cb32-2"><a href="#cb32-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-3"><a href="#cb32-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb32-4"><a href="#cb32-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = ys)</span></span>
<span id="cb32-5"><a href="#cb32-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-6"><a href="#cb32-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb32-7"><a href="#cb32-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       1        2        3        4        5        6        7        8  </span></span>
<span id="cb32-8"><a href="#cb32-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.3344   0.0616  -0.2348  -0.2019   0.1221  -0.0921  -0.1720  -0.0091  </span></span>
<span id="cb32-9"><a href="#cb32-9" aria-hidden="true" tabindex="-1"></a><span class="do">##       9       10       11       12  </span></span>
<span id="cb32-10"><a href="#cb32-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.1220   0.0198   0.1262   0.2771  </span></span>
<span id="cb32-11"><a href="#cb32-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb32-12"><a href="#cb32-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 12  sigma^2 estimated as  0.3312</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-3-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-3-7-tab">
<p>季節性とトレンドを含むデータでは、AR(14)が選ばれ、1次の係数が1に近い値（0.9908）になっています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(yt)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="do">## ar(x = yt)</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       1        2        3        4        5        6        7        8  </span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a><span class="do">##  0.9908  -0.0001  -0.1176   0.0442   0.0554  -0.0791   0.0767  -0.0475  </span></span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a><span class="do">##       9       10       11       12       13       14  </span></span>
<span id="cb33-10"><a href="#cb33-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.0666   0.1996   0.0148   0.0866  -0.0260  -0.1554  </span></span>
<span id="cb33-11"><a href="#cb33-11" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb33-12"><a href="#cb33-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Order selected 14  sigma^2 estimated as  1.658</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
</section>
<section id="移動平均" class="level2" data-number="29.8">
<h2 data-number="29.8" class="anchored" data-anchor-id="移動平均"><span class="header-section-number">29.8</span> 移動平均</h2>
<p>時系列データでは、通常ホワイトノイズに準じたばらつきが生じます。このばらつきが大きい場合には、全体としての時系列のトレンドがはっきりとしなくなる場合があります。ばらつきの大きい時系列データでは、このようなばらつきを<strong>平滑化</strong>して、時系列のトレンドが明確になるようにすることがあります。</p>
<p>平滑化の方法には様々なものがありますが、最も簡単な平滑化の手法が<strong>移動平均（rolling mean）</strong>です。移動平均では、y<sub>1</sub>、y<sub>2</sub>、y<sub>3</sub>、… y<sub>t</sub>の時系列データがあった時、例えばy<sub>1</sub>、y<sub>2</sub>、y<sub>3</sub>の平均、y<sub>2</sub>、y<sub>3</sub>、y<sub>4</sub>の平均、y<sub>3</sub>、y<sub>4</sub>、y<sub>5</sub>の平均…といった風に、一定の時間間隔のデータを平均していきます。このとき、3つの平均を取るときには3 rolling windowの移動平均を取る、といったように、英語では平均を取る個数のことを「窓（window）」で表現するのが一般的です。ただし、移動平均を取ると窓の幅に応じて時系列の長さが短くなるという特徴があります。</p>
<p>Rでは、<a href="https://cran.r-project.org/web/packages/zoo/index.html"><code>zoo</code></a>パッケージ<span class="citation" data-cites="zoo_bib">(<a href="references.html#ref-zoo_bib" role="doc-biblioref">Zeileis and Grothendieck 2005</a>)</span>の<code>rollmean</code>関数で移動平均を計算することができます。<code>rollmean</code>関数は第一引数に時系列、第二引数にwindow（引数名は<code>k</code>）を取り、移動平均計算の結果を返します。以下に移動平均を5、10、20のwindowの設定で計算した結果を示します。windowを大きく設定するほど時系列は短くなり、よりギザギザのない、平滑な線になっていくのがわかります。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-4-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-1" role="tab" aria-controls="tabset-4-1" aria-selected="true">もとのデータ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-2" role="tab" aria-controls="tabset-4-2" aria-selected="false">5時点の移動平均</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-3" role="tab" aria-controls="tabset-4-3" aria-selected="false">10時点の移動平均</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-4-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-4-4" role="tab" aria-controls="tabset-4-4" aria-selected="false">20時点の移動平均</a></li></ul>
<div class="tab-content">
<div id="tabset-4-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-4-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>y2<span class="fl">.1</span> <span class="ot">&lt;-</span> y2</span>
<span id="cb34-2"><a href="#cb34-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb34-3"><a href="#cb34-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(t, y2<span class="fl">.1</span>), <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y2<span class="fl">.1</span>))<span class="sc">+</span></span>
<span id="cb34-4"><a href="#cb34-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb34-5"><a href="#cb34-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb34-6"><a href="#cb34-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-30-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-13"><img src="chapter29_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>y2<span class="fl">.5</span> <span class="ot">&lt;-</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(y2, <span class="dv">5</span>)</span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">t =</span> t[<span class="dv">5</span><span class="sc">:</span><span class="dv">200</span>], y2<span class="fl">.5</span>), <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y2<span class="fl">.5</span>))<span class="sc">+</span></span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-31-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-14"><img src="chapter29_files/figure-html/unnamed-chunk-31-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>y2<span class="fl">.10</span> <span class="ot">&lt;-</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(y2, <span class="dv">10</span>)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb36-3"><a href="#cb36-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">t =</span> t[<span class="dv">10</span><span class="sc">:</span><span class="dv">200</span>], y2<span class="fl">.10</span>), <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y2<span class="fl">.10</span>))<span class="sc">+</span></span>
<span id="cb36-4"><a href="#cb36-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb36-5"><a href="#cb36-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb36-6"><a href="#cb36-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-32-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-15"><img src="chapter29_files/figure-html/unnamed-chunk-32-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
<div id="tabset-4-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-4-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>y2<span class="fl">.20</span> <span class="ot">&lt;-</span> zoo<span class="sc">::</span><span class="fu">rollmean</span>(y2, <span class="dv">20</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(<span class="fu">data.frame</span>(<span class="at">t =</span> t[<span class="dv">20</span><span class="sc">:</span><span class="dv">200</span>], y2<span class="fl">.20</span>), <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y2<span class="fl">.20</span>))<span class="sc">+</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="dv">2</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb37-5"><a href="#cb37-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>)<span class="sc">+</span></span>
<span id="cb37-6"><a href="#cb37-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">expand_limits</span>(<span class="at">x =</span> <span class="dv">0</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-33-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-16"><img src="chapter29_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="maモデル" class="level2" data-number="29.9">
<h2 data-number="29.9" class="anchored" data-anchor-id="maモデル"><span class="header-section-number">29.9</span> MAモデル</h2>
<p>移動平均と日本語では同じ名前の時系列モデルとして、<strong>MA（Moving average）モデル</strong>というものがあります。MAモデルは上で説明したrolling meanとは少し異なり、時間tにおける値y<sub>t</sub>が正規分布に従う乱数εと係数の積を足した値に従うようなモデルとなります。以下の数式では、<strong>MA(q)モデル</strong>として、係数とεの積をq個足しあわせた式を示します。</p>
<p><span class="math display">\[y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1}  + \cdots \theta_{q} \cdot \epsilon_{t-q}\]</span> <span class="math display">\[\epsilon_{t} \sim Normal(0, \sigma)\]</span></p>
<p>以下に、MA(1)～MA(3)モデルの式とグラフ、自己相関・偏自己相関を示します。MAモデルは定常過程で、平均値や分散が時間とともに大きく変化しないような過程となります。MAモデルでは、自己相関にはあまり特徴がなく、偏自己相関には比較的大きい値が維持されるような傾向をもちます。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-5-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-1" role="tab" aria-controls="tabset-5-1" aria-selected="true">MA(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-2" role="tab" aria-controls="tabset-5-2" aria-selected="false">MA(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-5-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-5-3" role="tab" aria-controls="tabset-5-3" aria-selected="false">MA(3)モデル</a></li></ul>
<div class="tab-content">
<div id="tabset-5-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-5-1-tab">
<p><span class="math display">\[y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1} \]</span></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>MA(1)モデルの例</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>ym1 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ma =</span> <span class="fl">0.8</span>), <span class="dv">200</span>)</span>
<span id="cb38-2"><a href="#cb38-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb38-3"><a href="#cb38-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ym1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-34-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-17"><img src="chapter29_files/figure-html/unnamed-chunk-34-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(ym1 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-4d467f3ada599dec390e" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-4d467f3ada599dec390e">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.39252351725687645,-0.1376066798350678,-0.12306708607661,-0.12548030683620978,-0.085027288802725906,0.024043330213129436,0.05251802098652833,0.0040055152601112341,0.033719408171021537,-0.028831437766791743,-0.04861222248736996,0.034256670577377357,0.016573242531966872,-0.035380289739249435,-0.051737898637638141,-0.040642478865402031,-0.039103194421256766,-0.064462741132952264,-0.086120865312790382,-0.046607993335434916,-0.081656782671577,-0.10174531700779894,0.042368564739041832],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.39252351725687645,-0.34480750893068707,0.11392776223225637,-0.21221982380810089,0.063059652509873318,-0.020626674201787792,0.02142365108494524,-0.039719384865958746,0.079496778330856152,-0.12618490439006297,0.082213719325907056,-0.0092933219986610187,-0.0094307757410888905,-0.030753932677503051,-0.03957942450036555,-0.014025982067387111,-0.031870859762559239,-0.085010934172301059,-0.056780638943742842,-0.015981427098531984,-0.1580453240291802,-0.014164099210631536,0.051854920755594815],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(ym1) ACF and PACF Plots"},"attrs":{"1bd078565035":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd078565035.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.39252351725687645,-0.1376066798350678,-0.12306708607661,-0.12548030683620978,-0.085027288802725906,0.024043330213129436,0.05251802098652833,0.0040055152601112341,0.033719408171021537,-0.028831437766791743,-0.04861222248736996,0.034256670577377357,0.016573242531966872,-0.035380289739249435,-0.051737898637638141,-0.040642478865402031,-0.039103194421256766,-0.064462741132952264,-0.086120865312790382,-0.046607993335434916,-0.081656782671577,-0.10174531700779894,0.042368564739041832],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd078565035.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd078565035.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd078565035.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd030a59de":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.39252351725687645,-0.34480750893068707,0.11392776223225637,-0.21221982380810089,0.063059652509873318,-0.020626674201787792,0.02142365108494524,-0.039719384865958746,0.079496778330856152,-0.12618490439006297,0.082213719325907056,-0.0092933219986610187,-0.0094307757410888905,-0.030753932677503051,-0.03957942450036555,-0.014025982067387111,-0.031870859762559239,-0.085010934172301059,-0.056780638943742842,-0.015981427098531984,-0.1580453240291802,-0.014164099210631536,0.051854920755594815],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd030a59de.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd030a59de.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd030a59de.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-2-tab">
<p><span class="math display">\[y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1}  + \theta_{2} \cdot \epsilon_{t-2}\]</span></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>MA(2)モデルの例</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>ym2 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">2</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.3</span>, <span class="fl">0.7</span>)), <span class="dv">200</span>)</span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb40-3"><a href="#cb40-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ym2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-36-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-18"><img src="chapter29_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(ym2 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-713f8521140010cc3d74" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-713f8521140010cc3d74">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.34581406677539939,0.43533825205141757,0.084218955460370767,0.072546358445957818,0.038382285920130689,-0.10689201306325881,-0.13718536633465889,-0.17143206296755104,-0.043142308834898488,-0.04675731083121993,-0.013234617116286027,0.0019920605008509973,-0.029996440219294897,0.13070123359861283,0.027039669446358154,0.075627944567069741,-0.049693392744527082,-0.069517445441577508,-0.073009639347608055,-0.045886094212772489,-0.037409401903019453,-0.11443566999849758,-0.037679351148361892],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.34581406677539939,0.3586396560826754,-0.17774111066177617,-0.085239002016181092,0.1066300001870274,-0.16534446359138003,-0.15657211150061026,0.023532106563940489,0.14563281601699937,-0.031380006609734529,-0.064718961517399615,0.065409032476054049,-0.048586795098496498,0.11021779663604298,-0.018273502542158118,-0.046514055037121027,-0.057584424282172239,-0.067243567118005707,-0.018960887070042468,0.064691369292426984,0.016182580912006986,-0.12331403996140528,0.025922380195145939],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(ym2) ACF and PACF Plots"},"attrs":{"1bd09796744":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd09796744.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.34581406677539939,0.43533825205141757,0.084218955460370767,0.072546358445957818,0.038382285920130689,-0.10689201306325881,-0.13718536633465889,-0.17143206296755104,-0.043142308834898488,-0.04675731083121993,-0.013234617116286027,0.0019920605008509973,-0.029996440219294897,0.13070123359861283,0.027039669446358154,0.075627944567069741,-0.049693392744527082,-0.069517445441577508,-0.073009639347608055,-0.045886094212772489,-0.037409401903019453,-0.11443566999849758,-0.037679351148361892],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd09796744.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd09796744.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd09796744.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd0548f958":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.34581406677539939,0.3586396560826754,-0.17774111066177617,-0.085239002016181092,0.1066300001870274,-0.16534446359138003,-0.15657211150061026,0.023532106563940489,0.14563281601699937,-0.031380006609734529,-0.064718961517399615,0.065409032476054049,-0.048586795098496498,0.11021779663604298,-0.018273502542158118,-0.046514055037121027,-0.057584424282172239,-0.067243567118005707,-0.018960887070042468,0.064691369292426984,0.016182580912006986,-0.12331403996140528,0.025922380195145939],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd0548f958.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd0548f958.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd0548f958.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
<div id="tabset-5-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-5-3-tab">
<p><span class="math display">\[y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1}  + \theta_{2} \cdot \epsilon_{t-2}  + \theta_{3} \cdot \epsilon_{t-3}\]</span></p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>MA(3)モデルの例</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>ym3 <span class="ot">&lt;-</span> <span class="fu">arima.sim</span>(<span class="at">model =</span> <span class="fu">list</span>(<span class="at">order =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">3</span>), <span class="at">ma =</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.4</span>)), <span class="dv">200</span>)</span>
<span id="cb42-2"><a href="#cb42-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb42-3"><a href="#cb42-3" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ym3)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-38-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-19"><img src="chapter29_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(ym3 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>())</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-2cd9a741287887f718de" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-2cd9a741287887f718de">{"x":{"data":[{"x":[0],"y":[1],"type":"bar","marker":{"color":"black","line":{"color":"rgba(31,119,180,1)"}},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.22368917679992023,0.22933978806536121,0.30346286482834794,0.044671457439405891,0.10174003859859945,-0.043581764951414297,0.024400482683673622,0.042572356436032743,-0.12331621766145522,-0.013510458704518766,-0.051286359875662192,-0.043802042999498296,0.10375841264901685,-0.096329898139728851,-0.043093995740510788,0.0021507334958833684,-0.023645467645323704,-0.10034245862955171,-0.1450081024682609,-0.030486339411105963,-0.081295487110691386,-0.030330150041815562,-0.018261062752133236],"type":"bar","marker":{"color":"red","line":{"color":"rgba(255,127,14,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","name":"Seasonal Lag 1","error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x","yaxis":"y","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(44,160,44,1)"}},"orientation":"h","error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[0,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(148,103,189,1)","line":{"color":"rgba(148,103,189,1)"}},"error_y":{"color":"rgba(148,103,189,1)"},"error_x":{"color":"rgba(148,103,189,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.22368917679992023,0.18874725807625317,0.23973295755779409,-0.096820888661583893,0.011605864608928483,-0.14388623880603948,0.061509539113892189,0.039126250041706716,-0.10302284446421298,-0.018322475758404996,-0.02479963152102347,0.032519097270364554,0.14695567798397266,-0.11750717014984237,-0.089944475088805986,-0.013905331640047208,0.082390482690456249,-0.1178623504132356,-0.11563506644495185,-0.0035170005438778253,0.01604752064266815,0.12298694867969988,-0.025294636008423438],"type":"bar","marker":{"color":"red","line":{"color":"rgba(140,86,75,1)"}},"width":[0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001,0.10000000000000001],"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","error_y":{"color":"rgba(140,86,75,1)"},"error_x":{"color":"rgba(140,86,75,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"type":"bar","marker":{"color":"#00526d","line":{"color":"rgba(227,119,194,1)"}},"showlegend":false,"orientation":"h","error_y":{"color":"rgba(227,119,194,1)"},"error_x":{"color":"rgba(227,119,194,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[0.13859038243496774,0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","marker":{"color":"rgba(127,127,127,1)","line":{"color":"rgba(127,127,127,1)"}},"error_y":{"color":"rgba(127,127,127,1)"},"error_x":{"color":"rgba(127,127,127,1)"},"xaxis":"x","yaxis":"y2","frame":null},{"x":[1,23],"y":[-0.13859038243496774,-0.13859038243496774],"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","marker":{"color":"rgba(188,189,34,1)","line":{"color":"rgba(188,189,34,1)"}},"error_y":{"color":"rgba(188,189,34,1)"},"error_x":{"color":"rgba(188,189,34,1)"},"xaxis":"x","yaxis":"y2","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"dtick":1,"title":"Lag","anchor":"y2"},"yaxis2":{"domain":[0,0.47999999999999998],"automargin":true,"title":"PACF","anchor":"x"},"yaxis":{"domain":[0.52000000000000002,1],"automargin":true,"title":"ACF","anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"hovermode":"compare","showlegend":true,"title":"as.ts(ym3) ACF and PACF Plots"},"attrs":{"1bd077a5416c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[1,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"black"},"width":0.10000000000000001,"name":"Lag-Zero","legendgroup":"lagzero","showlegend":false,"inherit":true},"1bd077a5416c.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,0.22368917679992023,0.22933978806536121,0.30346286482834794,0.044671457439405891,0.10174003859859945,-0.043581764951414297,0.024400482683673622,0.042572356436032743,-0.12331621766145522,-0.013510458704518766,-0.051286359875662192,-0.043802042999498296,0.10375841264901685,-0.096329898139728851,-0.043093995740510788,0.0021507334958833684,-0.023645467645323704,-0.10034245862955171,-0.1450081024682609,-0.030486339411105963,-0.081295487110691386,-0.030330150041815562,-0.018261062752133236],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","name":"Seasonal Lag 1","inherit":true},"1bd077a5416c.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","name":"Non-Seasonal","inherit":true},"1bd077a5416c.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd077a5416c.4":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":0,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true},"1bd070926c5c":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[0.22368917679992023,0.18874725807625317,0.23973295755779409,-0.096820888661583893,0.011605864608928483,-0.14388623880603948,0.061509539113892189,0.039126250041706716,-0.10302284446421298,-0.018322475758404996,-0.02479963152102347,0.032519097270364554,0.14695567798397266,-0.11750717014984237,-0.089944475088805986,-0.013905331640047208,0.082390482690456249,-0.1178623504132356,-0.11563506644495185,-0.0035170005438778253,0.01604752064266815,0.12298694867969988,-0.025294636008423438],"type":"bar","marker":{"color":"red"},"width":0.10000000000000001,"legendgroup":"seasonal","showlegend":false,"name":"Seasonal Lag 1","inherit":true},"1bd070926c5c.1":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23],"y":[null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],"type":"bar","marker":{"color":"#00526d"},"width":0.10000000000000001,"legendgroup":"nonseasonal","showlegend":false,"name":"Non-Seasonal","inherit":true},"1bd070926c5c.2":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":0.13859038243496774,"xend":23,"yend":0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Upper Bound","inherit":true},"1bd070926c5c.3":{"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"x":1,"y":-0.13859038243496774,"xend":23,"yend":-0.13859038243496774,"type":"scatter","mode":"lines","line":{"color":"green","dash":"dash"},"legendgroup":"ci","showlegend":false,"name":"CI Lower Bound","inherit":true}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="単位根過程と反転可能性" class="level2" data-number="29.10">
<h2 data-number="29.10" class="anchored" data-anchor-id="単位根過程と反転可能性"><span class="header-section-number">29.10</span> 単位根過程と反転可能性</h2>
<section id="単位根過程" class="level3" data-number="29.10.1">
<h3 data-number="29.10.1" class="anchored" data-anchor-id="単位根過程"><span class="header-section-number">29.10.1</span> 単位根過程</h3>
<p><strong>単位根過程（unit root）</strong>とは、特性方程式というものの解が1を含むような過程のことを指します。特性方程式とは以下のような式で、Φについて解くことで解を求めます。</p>
<p><span class="math display">\[1-\alpha_{1}\phi - \alpha_{2}\phi^2 -\alpha_{3}\phi^3 \cdots -\alpha_{p}\phi^p=0\]</span></p>
<p>上の<code>arima.sim</code>関数の説明で、以下のようにARの係数から定常過程の判定を行うRのスクリプトを記載していますが、この下の式の一部が特性方程式の解を求めるスクリプトになっています。特性方程式の解の最小値が1以上なら定常過程、解に1を含むなら単位根過程となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>特性方程式の解</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>ar <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>) <span class="co"># ARの係数のベクター</span></span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a><span class="co"># これが特性方程式の解の最小値を求める計算式</span></span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a><span class="co"># （正確には解の原点からの距離の最小値）</span></span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">Mod</span>(<span class="fu">polyroot</span>(<span class="fu">c</span>(<span class="dv">1</span>, <span class="sc">-</span>ar))))</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] 1.045891</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>…定義上はこのように単位根過程であるかどうかを判定するのですが、正直よくわからないと思います。我々が最低限知っておくべきこととしては、<strong>ランダムウォークが単位根過程</strong>であることです。以下の2つの式から分かる通り、ランダムウォークはAR(1)でかつα<sub>1</sub>=1なので、特性方程式Φの解が1になります。</p>
<p><span class="math display">\[y_{t}=y_{t-1}+\epsilon_{t}\]</span> <span class="math display">\[1 - 1 \cdot \phi = 0\]</span></p>
</section>
<section id="独立な単位根過程同士で相関を取る" class="level3" data-number="29.10.2">
<h3 data-number="29.10.2" class="anchored" data-anchor-id="独立な単位根過程同士で相関を取る"><span class="header-section-number">29.10.2</span> 独立な単位根過程同士で相関を取る</h3>
<p>単位根過程である時系列データには、<strong>「2つの独立な単位根過程では、その2つの相関を取ると有意な相関が得られる」</strong>、という特殊な性質があります。この相関には全く意味は無いので、時系列データ同士の相関を取る場合には注意が必要です。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>独立な単位根過程間の相関</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="co"># y1とy1_2は乱数から作った2つの独立な単位根過程</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>y1_2 <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a>temp <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb45-4"><a href="#cb45-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>){</span>
<span id="cb45-5"><a href="#cb45-5" aria-hidden="true" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> temp<span class="sc">+</span><span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>)</span>
<span id="cb45-6"><a href="#cb45-6" aria-hidden="true" tabindex="-1"></a>  y1_2 <span class="ot">&lt;-</span> <span class="fu">c</span>(y1_2, temp)</span>
<span id="cb45-7"><a href="#cb45-7" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb45-8"><a href="#cb45-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-9"><a href="#cb45-9" aria-hidden="true" tabindex="-1"></a><span class="co"># 相関係数が-0.6</span></span>
<span id="cb45-10"><a href="#cb45-10" aria-hidden="true" tabindex="-1"></a><span class="fu">cor</span>(y1, y1_2) </span>
<span id="cb45-11"><a href="#cb45-11" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] -0.5992427</span></span>
<span id="cb45-12"><a href="#cb45-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-13"><a href="#cb45-13" aria-hidden="true" tabindex="-1"></a><span class="co"># 相関の有意性を検定すると有意になる</span></span>
<span id="cb45-14"><a href="#cb45-14" aria-hidden="true" tabindex="-1"></a><span class="fu">cor.test</span>(y1, y1_2)</span>
<span id="cb45-15"><a href="#cb45-15" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb45-16"><a href="#cb45-16" aria-hidden="true" tabindex="-1"></a><span class="do">##  Pearson's product-moment correlation</span></span>
<span id="cb45-17"><a href="#cb45-17" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb45-18"><a href="#cb45-18" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y1 and y1_2</span></span>
<span id="cb45-19"><a href="#cb45-19" aria-hidden="true" tabindex="-1"></a><span class="do">## t = -10.533, df = 198, p-value &lt; 2.2e-16</span></span>
<span id="cb45-20"><a href="#cb45-20" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true correlation is not equal to 0</span></span>
<span id="cb45-21"><a href="#cb45-21" aria-hidden="true" tabindex="-1"></a><span class="do">## 95 percent confidence interval:</span></span>
<span id="cb45-22"><a href="#cb45-22" aria-hidden="true" tabindex="-1"></a><span class="do">##  -0.6813376 -0.5022593</span></span>
<span id="cb45-23"><a href="#cb45-23" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb45-24"><a href="#cb45-24" aria-hidden="true" tabindex="-1"></a><span class="do">##        cor </span></span>
<span id="cb45-25"><a href="#cb45-25" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.5992427</span></span>
<span id="cb45-26"><a href="#cb45-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb45-27"><a href="#cb45-27" aria-hidden="true" tabindex="-1"></a><span class="co"># バラバラしているけど相関がある</span></span>
<span id="cb45-28"><a href="#cb45-28" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(y1, y1_2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-41-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-20"><img src="chapter29_files/figure-html/unnamed-chunk-41-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>例えば、トルコリラの為替変動と日経平均株価は共にランダムウォークの過程ですが、相関を取ると有意な相関がある、という結果が得られます。だからといって、トルコリラが上がった（又は下がった）から日経平均株価も上がるだろうと想定して株を買い込むと痛い目にあいます。</p>
</section>
<section id="単位根検定" class="level3" data-number="29.10.3">
<h3 data-number="29.10.3" class="anchored" data-anchor-id="単位根検定"><span class="header-section-number">29.10.3</span> 単位根検定</h3>
<p>とは言っても、時系列データが単位根過程であるか判定するための特性方程式はα<sub>p</sub>、つまりARモデルの係数がわからないと解くことができませんし、時系列データが得られればα<sub>p</sub>が求まるというものでもありません。得られた時系列データが単位根過程であるかどうかを判定する場合には、特性方程式を解くのではなく、通常は<strong>単位根検定</strong>という検定手法を用いることになります。</p>
<p>時系列データが単位根過程であるかどうかは、<strong>ADF検定</strong>というものを用いて検定します。ADF検定は「単位根過程である」場合を帰無仮説とし、棄却された場合、つまりp値が十分に小さい場合には「単位根過程である」という帰無仮説を棄却して、「単位根過程ではない」という対立仮説を採用する検定手法です。要は<strong>p値が小さい場合には単位根過程では無い</strong>と判断します。</p>
<p>Rでは<a href="https://cran.r-project.org/web/packages/CADFtest/index.html"><code>CADFtest</code></a>パッケージ<span class="citation" data-cites="CADFtest_bib">(<a href="references.html#ref-CADFtest_bib" role="doc-biblioref">Lupi 2009</a>)</span>の<code>CADFtest</code>関数を用いてADF検定を行います。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>ADF検定で単位根過程の判定</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(CADFtest)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y1</span></span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -3.2007, p-value = 0.08728</span></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb46-9"><a href="#cb46-9" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb46-10"><a href="#cb46-10" aria-hidden="true" tabindex="-1"></a><span class="do">##       delta </span></span>
<span id="cb46-11"><a href="#cb46-11" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.09773805</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>以下に、CADFtest関数を用いた各種時系列データの検定結果を示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-6-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-1" role="tab" aria-controls="tabset-6-1" aria-selected="true">ホワイトノイズ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-2" role="tab" aria-controls="tabset-6-2" aria-selected="false">ランダムウォーク</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-3" role="tab" aria-controls="tabset-6-3" aria-selected="false">ランダムウォークの差分</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-4" role="tab" aria-controls="tabset-6-4" aria-selected="false">AR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-5" role="tab" aria-controls="tabset-6-5" aria-selected="false">AR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-6-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-6-6" role="tab" aria-controls="tabset-6-6" aria-selected="false">AR(3)モデル</a></li></ul>
<div class="tab-content">
<div id="tabset-6-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-6-1-tab">
<p>ホワイトノイズは単位根過程ではないので、帰無仮説は棄却されます。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -9.1384, p-value = 3.329e-13</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb47-8"><a href="#cb47-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb47-9"><a href="#cb47-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      delta </span></span>
<span id="cb47-10"><a href="#cb47-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.9116643</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-2-tab">
<p>ランダムウォークは単位根過程なので、帰無仮説は棄却されません。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1)</span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y1</span></span>
<span id="cb48-6"><a href="#cb48-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -3.2007, p-value = 0.08728</span></span>
<span id="cb48-7"><a href="#cb48-7" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb48-8"><a href="#cb48-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb48-9"><a href="#cb48-9" aria-hidden="true" tabindex="-1"></a><span class="do">##       delta </span></span>
<span id="cb48-10"><a href="#cb48-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.09773805</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-3-tab">
<p>ランダムウォークの差分系列を取ると、ホワイトノイズとなるため、単位根過程ではなくなります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1 <span class="sc">|&gt;</span>  <span class="fu">diff</span>())</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  diff(y1)</span></span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -9.2234, p-value = 2.166e-13</span></span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      delta </span></span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.9191055</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-4-tab">
<p>AR(1)モデルでかつαが1でない場合には、単位根過程ではありません。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1a)</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y1a</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -7.243, p-value = 8.453e-09</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      delta </span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.4944694</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-5-tab">
<p>AR(2)モデル以降は係数によって単位根過程かどうかが変わります。以下の例は単位根過程ではない場合です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y2)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y2</span></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -3.5976, p-value = 0.03252</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="do">##      delta </span></span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.2281931</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-6-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-6-6-tab">
<p>AR(3)モデルも係数によって単位根過程かどうかが変わります。以下の例は単位根過程ではない場合です。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y3)</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb52-3"><a href="#cb52-3" aria-hidden="true" tabindex="-1"></a><span class="do">##  ADF test</span></span>
<span id="cb52-4"><a href="#cb52-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb52-5"><a href="#cb52-5" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y3</span></span>
<span id="cb52-6"><a href="#cb52-6" aria-hidden="true" tabindex="-1"></a><span class="do">## ADF(1) = -6.921, p-value = 4.41e-08</span></span>
<span id="cb52-7"><a href="#cb52-7" aria-hidden="true" tabindex="-1"></a><span class="do">## alternative hypothesis: true delta is less than 0</span></span>
<span id="cb52-8"><a href="#cb52-8" aria-hidden="true" tabindex="-1"></a><span class="do">## sample estimates:</span></span>
<span id="cb52-9"><a href="#cb52-9" aria-hidden="true" tabindex="-1"></a><span class="do">##     delta </span></span>
<span id="cb52-10"><a href="#cb52-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.593555</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>単位根検定には他に<strong>KPSS検定</strong>と呼ばれる、帰無仮説が「単位根過程ではない」、つまり<strong>棄却された場合に単位根過程である</strong>とされる検定もあります。Rでは、<a href="https://cran.r-project.org/web/packages/tseries/index.html"><code>tseries</code></a>パッケージ<span class="citation" data-cites="tseries_bib">(<a href="references.html#ref-tseries_bib" role="doc-biblioref">Trapletti and Hornik 2023</a>)</span>の<code>kpss.test</code>関数を用いてKPSS検定を行うことができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>tseries::kpss.testでKPSS検定</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(tseries)</span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="fu">kpss.test</span>(y1)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in kpss.test(y1): p-value smaller than printed p-value</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a><span class="do">##  KPSS Test for Level Stationarity</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="do">## data:  y1</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a><span class="do">## KPSS Level = 1.9409, Truncation lag parameter = 4, p-value = 0.01</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="反転可能性" class="level3" data-number="29.10.4">
<h3 data-number="29.10.4" class="anchored" data-anchor-id="反転可能性"><span class="header-section-number">29.10.4</span> 反転可能性</h3>
<p>MAモデルの一部は、AR(∞)モデルの形に書き換えることができます。このAR(∞)モデルに書き換えることができることを<strong>反転可能性</strong>と呼びます。反転可能なMAモデルは反転不可能なモデルよりも統計的には取り扱いやすいとされています。</p>
<p>反転可能性の条件は以下の特性方程式の解がすべて1以上となることです。</p>
<p><span class="math display">\[1+\theta_{1}\phi + \theta_{2}\phi^2 +\theta_{3}\phi^3 \cdots +\theta_{q}\phi^q=0\]</span></p>
<p>ARモデルの特性方程式と同じように、MAモデルの特性方程式も以下のスクリプトで計算することができ、下の式が<code>TRUE</code>になる場合は反転可能、<code>FALSE</code>になる場合は反転不可能となります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>MAモデル：特性方程式の解</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>ma <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.2</span>, <span class="fl">0.2</span>, <span class="fl">0.5</span>) <span class="co"># MAの係数のベクター</span></span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 特性方程式の解の最小値が1以上なら反転可能</span></span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a><span class="fu">min</span>(<span class="fu">Mod</span>(<span class="fu">polyroot</span>(<span class="fu">c</span>(<span class="dv">1</span>, ma)))) <span class="sc">&gt;</span> <span class="dv">1</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a><span class="do">## [1] TRUE</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
</section>
<section id="armaモデル" class="level2" data-number="29.11">
<h2 data-number="29.11" class="anchored" data-anchor-id="armaモデル"><span class="header-section-number">29.11</span> ARMAモデル</h2>
<p>以上のように、ARモデルやMAモデルで時系列データを説明することはできるのですが、では時系列データが得られた時にARの次数（order）がいくつで、MAの次数がいくつで、それぞれの係数はいくつになるのか、というのはよくわからないままです。このAR・MAの次数や係数を定めるときに用いられるのが<strong>ARMAモデル</strong>です。</p>
<p>ARMAモデルは、その名の通りARモデルとMAモデルを含んだ時系列モデルです。平均値一定で分散が時間とともに大きく変化しない、定常性を持つ時系列データはこのARMAモデルで記述することができます。ARMAモデルは、ARの次数pとMAの次数qを用いて、<strong>ARMA(p,q)</strong>という形で示します。例えば、ARMA(1,2)であれば、AR(1)モデルでかつMA(2)モデルであることを示しています。</p>
<p>上に示した<code>ar</code>関数では、ARモデルの次数と係数を求めることができましたが、MAモデルが混じっているARMAモデルの次数と係数を求めることはできません。</p>
<p>RでARMAモデルの次数と係数を求めるときには、<code>tseries</code>パッケージの<code>arma</code>関数を用います。<code>arma</code>関数は時系列データ（ベクターや<code>ts</code>オブジェクト）と次数を引数に取り、AR、MAの係数、切片項（intercept）をそれぞれ計算してくれます。ただし、<code>arma</code>関数は次数を与えずに計算させるとARMA(1,1)であるとして計算してしまうので、可能であれば次数を<code>order</code>引数に与える必要があります。以下に、各種時系列データを<code>arma</code>関数で分析したときの結果を示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-7-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-1" role="tab" aria-controls="tabset-7-1" aria-selected="true">ホワイトノイズ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-2" role="tab" aria-controls="tabset-7-2" aria-selected="false">ランダムウォーク</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-3" role="tab" aria-controls="tabset-7-3" aria-selected="false">AR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-4" role="tab" aria-controls="tabset-7-4" aria-selected="false">AR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-5" role="tab" aria-controls="tabset-7-5" aria-selected="false">AR(3)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-6" role="tab" aria-controls="tabset-7-6" aria-selected="false">MA(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-7" role="tab" aria-controls="tabset-7-7" aria-selected="false">MA(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-7-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-7-8" role="tab" aria-controls="tabset-7-8" aria-selected="false">MA(3)モデル</a></li></ul>
<div class="tab-content">
<div id="tabset-7-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-7-1-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># 切片項だけが得られる</span></span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Warning in optim(coef, err, gr = NULL, hessian = TRUE, ...): one-dimensional optimization by Nelder-Mead is unreliable:</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="do">## use "Brent" or optimize() directly</span></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = y, order = c(0, 0))</span></span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a><span class="do">## intercept  </span></span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a><span class="do">## -0.005762</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-2-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y1, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="co"># ランダムウォークはARMA(1,0)</span></span>
<span id="cb56-2"><a href="#cb56-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb56-3"><a href="#cb56-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb56-4"><a href="#cb56-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = y1, order = c(1, 0))</span></span>
<span id="cb56-5"><a href="#cb56-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb56-6"><a href="#cb56-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb56-7"><a href="#cb56-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ar1  intercept  </span></span>
<span id="cb56-8"><a href="#cb56-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.94703   -0.03081</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-3-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y1a, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="co"># AR(1)モデルはARMA(1,0)</span></span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = y1a, order = c(1, 0))</span></span>
<span id="cb57-5"><a href="#cb57-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb57-6"><a href="#cb57-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb57-7"><a href="#cb57-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ar1  intercept  </span></span>
<span id="cb57-8"><a href="#cb57-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.54624    0.04701</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-4-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y2, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>)) <span class="co"># AR(2)モデルはARMA(2,0)</span></span>
<span id="cb58-2"><a href="#cb58-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb58-3"><a href="#cb58-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb58-4"><a href="#cb58-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = y2, order = c(2, 0))</span></span>
<span id="cb58-5"><a href="#cb58-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb58-6"><a href="#cb58-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb58-7"><a href="#cb58-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ar1        ar2  intercept  </span></span>
<span id="cb58-8"><a href="#cb58-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.07898    0.69440   -0.04239</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-5-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y3, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>)) <span class="co"># AR(3)モデルはARMA(3,0)</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = y3, order = c(3, 0))</span></span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb59-7"><a href="#cb59-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ar1        ar2        ar3  intercept  </span></span>
<span id="cb59-8"><a href="#cb59-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.08845    0.06730    0.62943    0.02617</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-6-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(ym1, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="co"># MA(1)モデルはARMA(0,1)</span></span>
<span id="cb60-2"><a href="#cb60-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-3"><a href="#cb60-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb60-4"><a href="#cb60-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = ym1, order = c(0, 1))</span></span>
<span id="cb60-5"><a href="#cb60-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb60-6"><a href="#cb60-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb60-7"><a href="#cb60-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ma1  intercept  </span></span>
<span id="cb60-8"><a href="#cb60-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    0.7059    -0.3002</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-7-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(ym2, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="co"># MA(2)モデルはARMA(0,2)</span></span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = ym2, order = c(0, 2))</span></span>
<span id="cb61-5"><a href="#cb61-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb61-6"><a href="#cb61-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb61-7"><a href="#cb61-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ma1        ma2  intercept  </span></span>
<span id="cb61-8"><a href="#cb61-8" aria-hidden="true" tabindex="-1"></a><span class="do">##   0.31962    0.59392    0.08629</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-7-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-7-8-tab">
<div class="cell">
<div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(ym3, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="co"># MA(3)モデルはARMA(0,3)</span></span>
<span id="cb62-2"><a href="#cb62-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb62-3"><a href="#cb62-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb62-4"><a href="#cb62-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arma(x = ym3, order = c(0, 3))</span></span>
<span id="cb62-5"><a href="#cb62-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb62-6"><a href="#cb62-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficient(s):</span></span>
<span id="cb62-7"><a href="#cb62-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       ma1        ma2        ma3  intercept  </span></span>
<span id="cb62-8"><a href="#cb62-8" aria-hidden="true" tabindex="-1"></a><span class="do">##    0.1585     0.1494     0.3318    -0.1404</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
</section>
<section id="arimaモデル" class="level2" data-number="29.12">
<h2 data-number="29.12" class="anchored" data-anchor-id="arimaモデル"><span class="header-section-number">29.12</span> ARIMAモデル</h2>
<p>ARMAは基本的に定常過程を対象とするモデルです。しかし、単位根過程となる時系列は定常過程ではなく、ARMAでは取り扱いにくい場合があります。このような単位根過程となる時系列にも対応したモデルが<strong>ARIMA（auto-regression integrated moving average）モデル</strong>です。ARIMAモデルは、ARモデルとMAモデルに<strong>和分(I)</strong>を付け加えたモデルとなります。</p>
<p>典型的な単位根過程であるランダムウォークの差分を取るとホワイトノイズとなるように、<strong>単位根過程の何段階かの差分を取ると、定常過程</strong>を得ることができます。このことから、単位根過程である時系列は、定常過程を足し合わせたもの、つまり<strong>和分</strong>であるとすることができます。</p>
<p>単位根過程の時系列データで、d階差分を取ると定常過程となる場合、そのデータは<strong>I(d)</strong>、つまり<strong>d次の和分</strong>であるとします。この和分I(d)をARMAモデルに加えたものがARIMAモデルで、AR(p)、I(d)、MA(q)のぞれぞれの次数を合わせて<strong>ARIMA(p,d,q)</strong>という形でモデルを表現します。</p>
<p>ARIMAモデルの計算では、まず時系列が単位根過程であるかを判定し、その後I(d)のdの次数を決定します。その後差分系列のAR、MAの次数と係数を決定するという過程で、ARIMA(p,d,q)のp、d、qの部分を求めます。Rでは、<code>arima</code>関数でARIMAモデルの係数を求めることができます。ただし、<code>arima</code>関数ではあらかじめ(p,d,q)の次数を引数に与える必要があります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>arima関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a><span class="fu">arima</span>(y1, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># ARIMA(1, 0, 0)として係数を求める</span></span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Call:</span></span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a><span class="do">## arima(x = y1, order = c(1, 0, 0))</span></span>
<span id="cb63-5"><a href="#cb63-5" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb63-6"><a href="#cb63-6" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb63-7"><a href="#cb63-7" aria-hidden="true" tabindex="-1"></a><span class="do">##          ar1  intercept</span></span>
<span id="cb63-8"><a href="#cb63-8" aria-hidden="true" tabindex="-1"></a><span class="do">##       0.9451    -0.3930</span></span>
<span id="cb63-9"><a href="#cb63-9" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.  0.0217     0.5385</span></span>
<span id="cb63-10"><a href="#cb63-10" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb63-11"><a href="#cb63-11" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 estimated as 0.205:  log likelihood = -126.45,  aic = 258.91</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<p>しかし、時系列データを得た時に、そのデータがARIMA(1,1,0)である、といった風に、次数をあらかじめ決めることは普通はできません。Rには次数を含めてARIMAモデルを計算してくれる、<code>auto.arima</code>関数が備わっています。実際に時系列分析を行う際には、<code>arima</code>関数を用いることはほぼなく、<code>auto.arima</code>関数を用いることになります。<code>auto.arima</code>関数はAICに従いモデル選択を行う関数で、<a href="./chapter26.html">26章</a>で説明したAICによるモデル選択における<code>step</code>関数のARIMA版のようなものになります。</p>
<p><code>auto.arima</code>関数には、モデルを総当り計算するかステップワイズな計算をするかを決定する<code>stepwise</code>引数を設定できます。<code>stepwise=T</code>とするとステップワイズ計算を行い、計算が速くなります。一方で<code>stepwise=F</code>とすると、総当り計算を行うため計算は正確になりますが、モデルが複雑な場合には計算に時間がかかります。また、<code>trace</code>引数を<code>TRUE</code>に設定すると、繰り返し計算をすべて表示してくれます。</p>
<p>以下に、<code>auto.arima</code>関数を用いて各種の時系列データを分析した例を示します。</p>
<div class="tabset-margin-container"></div><div class="panel-tabset">
<ul class="nav nav-tabs" role="tablist"><li class="nav-item" role="presentation"><a class="nav-link active" id="tabset-8-1-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-1" role="tab" aria-controls="tabset-8-1" aria-selected="true">ホワイトノイズ</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-2-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-2" role="tab" aria-controls="tabset-8-2" aria-selected="false">ランダムウォーク</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-3-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-3" role="tab" aria-controls="tabset-8-3" aria-selected="false">AR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-4-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-4" role="tab" aria-controls="tabset-8-4" aria-selected="false">AR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-5-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-5" role="tab" aria-controls="tabset-8-5" aria-selected="false">AR(3)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-6-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-6" role="tab" aria-controls="tabset-8-6" aria-selected="false">MR(1)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-7-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-7" role="tab" aria-controls="tabset-8-7" aria-selected="false">MR(2)モデル</a></li><li class="nav-item" role="presentation"><a class="nav-link" id="tabset-8-8-tab" data-bs-toggle="tab" data-bs-target="#tabset-8-8" role="tab" aria-controls="tabset-8-8" aria-selected="false">MR(3)モデル</a></li></ul>
<div class="tab-content">
<div id="tabset-8-1" class="tab-pane active" role="tabpanel" aria-labelledby="tabset-8-1-tab">
<p>ホワイトノイズはARIMA(0,0,0)モデルですので、正しくモデルが求まっています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(y) </span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(0,0,0) with zero mean </span></span>
<span id="cb64-4"><a href="#cb64-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb64-5"><a href="#cb64-5" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 0.2121:  log likelihood = -128.71</span></span>
<span id="cb64-6"><a href="#cb64-6" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=259.43   AICc=259.45   BIC=262.72</span></span>
<span id="cb64-7"><a href="#cb64-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb64-8"><a href="#cb64-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb64-9"><a href="#cb64-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                        ME      RMSE       MAE MPE MAPE      MASE       ACF1</span></span>
<span id="cb64-10"><a href="#cb64-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.005720777 0.4605318 0.3724083 100  100 0.7227597 0.02846469</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-2" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-2-tab">
<p>ランダムウォークは単位根ありの和分過程ですので、ARIMA(0,1,0)となります。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y1), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(y1) </span></span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(0,1,0) </span></span>
<span id="cb65-4"><a href="#cb65-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-5"><a href="#cb65-5" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 0.2112:  log likelihood = -127.63</span></span>
<span id="cb65-6"><a href="#cb65-6" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=257.26   AICc=257.28   BIC=260.55</span></span>
<span id="cb65-7"><a href="#cb65-7" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb65-8"><a href="#cb65-8" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb65-9"><a href="#cb65-9" aria-hidden="true" tabindex="-1"></a><span class="do">##                        ME     RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb65-10"><a href="#cb65-10" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.008875005 0.458362 0.3692541 25.84799 116.8924 0.9950085</span></span>
<span id="cb65-11"><a href="#cb65-11" aria-hidden="true" tabindex="-1"></a><span class="do">##                    ACF1</span></span>
<span id="cb65-12"><a href="#cb65-12" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.03107499</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-3" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-3-tab">
<p>単位根の無いAR(1)モデルはARIMA(1,0,0)ですが、ARIMA(2,0,1)と推定されています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb66"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y1a), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb66-2"><a href="#cb66-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(y1a) </span></span>
<span id="cb66-3"><a href="#cb66-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(2,0,1) with zero mean </span></span>
<span id="cb66-4"><a href="#cb66-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb66-5"><a href="#cb66-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb66-6"><a href="#cb66-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          ar1      ar2      ma1</span></span>
<span id="cb66-7"><a href="#cb66-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       1.4858  -0.5857  -0.9430</span></span>
<span id="cb66-8"><a href="#cb66-8" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.  0.0600   0.0574   0.0284</span></span>
<span id="cb66-9"><a href="#cb66-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb66-10"><a href="#cb66-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 0.9733:  log likelihood = -280.02</span></span>
<span id="cb66-11"><a href="#cb66-11" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=568.05   AICc=568.25   BIC=581.24</span></span>
<span id="cb66-12"><a href="#cb66-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb66-13"><a href="#cb66-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb66-14"><a href="#cb66-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                     ME      RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb66-15"><a href="#cb66-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.1115677 0.9791473 0.7685823 32.28064 229.3899 0.8382321</span></span>
<span id="cb66-16"><a href="#cb66-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                     ACF1</span></span>
<span id="cb66-17"><a href="#cb66-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.01643774</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-4" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-4-tab">
<p>AR(2)モデルはARIMA(2,0,0)モデルですが、ARIMA(3,0,0)と推定されています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y2), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(y2) </span></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(3,0,0) with non-zero mean </span></span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          ar1     ar2     ar3     mean</span></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       0.0185  0.6854  0.0985  -0.2964</span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.  0.0702  0.0510  0.0712   0.3328</span></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb67-10"><a href="#cb67-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 0.9577:  log likelihood = -278.16</span></span>
<span id="cb67-11"><a href="#cb67-11" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=566.31   AICc=566.62   BIC=582.81</span></span>
<span id="cb67-12"><a href="#cb67-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb67-13"><a href="#cb67-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb67-14"><a href="#cb67-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                      ME      RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb67-15"><a href="#cb67-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.01878576 0.9687765 0.7920465 66.62805 144.2256 0.5901585</span></span>
<span id="cb67-16"><a href="#cb67-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                    ACF1</span></span>
<span id="cb67-17"><a href="#cb67-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.00562248</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-5" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-5-tab">
<p>AR(3)モデルはARIMA(3,0,0)モデルですが、ARIMA(0,0,3)と推定されています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb68"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y3), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(y3) </span></span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(0,0,3) with zero mean </span></span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb68-6"><a href="#cb68-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          ma1     ma2     ma3</span></span>
<span id="cb68-7"><a href="#cb68-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       0.1581  0.1368  0.5761</span></span>
<span id="cb68-8"><a href="#cb68-8" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.  0.0601  0.0687  0.0556</span></span>
<span id="cb68-9"><a href="#cb68-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb68-10"><a href="#cb68-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 1.211:  log likelihood = -302.02</span></span>
<span id="cb68-11"><a href="#cb68-11" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=612.04   AICc=612.25   BIC=625.24</span></span>
<span id="cb68-12"><a href="#cb68-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb68-13"><a href="#cb68-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb68-14"><a href="#cb68-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                      ME     RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb68-15"><a href="#cb68-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.03989579 1.092088 0.8902643 207.5248 257.3231 0.6549154</span></span>
<span id="cb68-16"><a href="#cb68-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                    ACF1</span></span>
<span id="cb68-17"><a href="#cb68-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.01566343</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-6" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-6-tab">
<p>MA(1)モデルはARIMA(0,0,1)モデルなので、正しく推定されています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(ym1), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(ym1) </span></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(0,0,1) with non-zero mean </span></span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          ma1     mean</span></span>
<span id="cb69-7"><a href="#cb69-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       0.7085  -0.2820</span></span>
<span id="cb69-8"><a href="#cb69-8" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.  0.0577   0.1275</span></span>
<span id="cb69-9"><a href="#cb69-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb69-10"><a href="#cb69-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 1.129:  log likelihood = -295.28</span></span>
<span id="cb69-11"><a href="#cb69-11" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=596.56   AICc=596.68   BIC=606.46</span></span>
<span id="cb69-12"><a href="#cb69-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb69-13"><a href="#cb69-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb69-14"><a href="#cb69-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                        ME     RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb69-15"><a href="#cb69-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.002073118 1.057302 0.8466552 58.08614 210.9915 0.7558314</span></span>
<span id="cb69-16"><a href="#cb69-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                     ACF1</span></span>
<span id="cb69-17"><a href="#cb69-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.06563672</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-7" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-7-tab">
<p>MA(2)モデルはARIMA(0,0,2)モデルなので、正しく推定されています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb70"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(ym2), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(ym2) </span></span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(0,0,2) with zero mean </span></span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a><span class="do">##          ma1     ma2</span></span>
<span id="cb70-7"><a href="#cb70-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       0.3216  0.5933</span></span>
<span id="cb70-8"><a href="#cb70-8" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.  0.0571  0.0627</span></span>
<span id="cb70-9"><a href="#cb70-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb70-10"><a href="#cb70-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 0.9629:  log likelihood = -279.46</span></span>
<span id="cb70-11"><a href="#cb70-11" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=564.92   AICc=565.04   BIC=574.82</span></span>
<span id="cb70-12"><a href="#cb70-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb70-13"><a href="#cb70-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb70-14"><a href="#cb70-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                      ME      RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb70-15"><a href="#cb70-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set 0.04296999 0.9763719 0.7801817 57.34941 177.9415 0.7341903</span></span>
<span id="cb70-16"><a href="#cb70-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                     ACF1</span></span>
<span id="cb70-17"><a href="#cb70-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.02243839</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div id="tabset-8-8" class="tab-pane" role="tabpanel" aria-labelledby="tabset-8-8-tab">
<p>MA(3)モデルはARIMA(0,0,3)モデルですが、ARIMA(3,0,1)モデルと推定されています。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(ym3), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="do">## Series: ts(ym3) </span></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="do">## ARIMA(3,0,1) with zero mean </span></span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="do">## Coefficients:</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="do">##           ar1     ar2     ar3     ma1</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="do">##       -0.3327  0.2490  0.3377  0.5132</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="do">## s.e.   0.1998  0.0814  0.0678  0.2110</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="do">## sigma^2 = 1.009:  log likelihood = -282.83</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="do">## AIC=575.66   AICc=575.97   BIC=592.16</span></span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a><span class="do">## </span></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set error measures:</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a><span class="do">##                       ME      RMSE       MAE      MPE     MAPE      MASE</span></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.07330069 0.9942121 0.7860151 54.59213 167.2121 0.7073544</span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a><span class="do">##                    ACF1</span></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a><span class="do">## Training set -0.0121561</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<p>上記のように<code>auto.arima</code>関数を用いれば必ず正しいモデルが計算できる、というわけではありませんし、MAモデルが反転可能な場合にはARとMAの次数が逆転することもありますが、時系列のデータ数が十分に多ければ、ある程度信頼できる結果を返してくれます。</p>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
ARIMAモデルをシミュレートする
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><code>auto.arima</code>関数の結果と次数、データ数の関係をより調べたい方は、以下のリンクにあるシミュレーションを触ってみて下さい。また、下のスクリプトをRで実行することでもシミュレーションを動かすことができます。</p>
<p><a href="https://xjorv.shinyapps.io/ARIMA_simulator/">ARIMAシミュレーター</a></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb72"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span>(<span class="sc">!</span><span class="fu">require</span>(shiny)){<span class="fu">install.packages</span>(<span class="st">"shiny"</span>)};<span class="fu">runGitHub</span>(<span class="st">"ARIMAsim"</span>, <span class="st">"sb8001at"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>このシミュレーターでは、<code>arima.sim</code>関数で生成した時系列に対して<code>auto.arima</code>関数や単位根検定を行った結果を確認することができます。</p>
</div>
</div>
</div>
<section id="arimaモデルを用いた予測" class="level3" data-number="29.12.1">
<h3 data-number="29.12.1" class="anchored" data-anchor-id="arimaモデルを用いた予測"><span class="header-section-number">29.12.1</span> ARIMAモデルを用いた予測</h3>
<p>上記のように、<code>auto.arima</code>関数を用いれば、ARIMAモデルの次数と係数を求めることができます。とは言っても、次数と係数が求まったら何かわかるのかと言われると、イマイチよくわかりません。ARIMA(3,2,1)モデルがどんな形をしていて、どういう意味があるのか、パッと分かる人はなかなかいないでしょう。</p>
<p>ARIMAモデルの意味がわからなくても、この計算したARIMAモデルがあれば、その<strong>時系列の将来の変化を予測</strong>することはできます。</p>
<p>Rでは<code>forecast</code>パッケージの<code>forecast</code>関数を用いることで、ARIMAモデルでの予測を行うことができます。<code>forecast</code>関数は第一引数に<code>auto.arima</code>関数の返り値を、第二引数に予測する期間の長さ（<code>h</code>）を取ります。<code>forecast</code>関数の返り値はデータフレームで、予測値とその推定区間を返してくれます。予測区間を見るとわかりますが、明確なトレンドや季節性が無いデータでは、予測する時期が遠い未来になると点推定値も範囲推定値もほぼ一定になります。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>forecast関数で予測する</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(<span class="st">"forecast"</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a><span class="co"># auto.arimaの返り値を変数に代入</span></span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>y1a_arima <span class="ot">&lt;-</span> <span class="fu">auto.arima</span>(<span class="fu">ts</span>(y1a), <span class="at">ic =</span> <span class="st">"aic"</span>, <span class="at">stepwise =</span> F, <span class="at">trace =</span> F) </span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">forecast</span>(y1a_arima, <span class="at">h =</span> <span class="dv">5</span>, <span class="at">level =</span> <span class="dv">95</span>) <span class="co"># 5時点先まで予測する</span></span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 左から点推定値、95％下限推定値、95％上限推定値</span></span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>fc</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a><span class="do">##     Point Forecast     Lo 95    Hi 95</span></span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a><span class="do">## 201     0.61331914 -1.320332 2.546970</span></span>
<span id="cb73-9"><a href="#cb73-9" aria-hidden="true" tabindex="-1"></a><span class="do">## 202    -0.03486291 -2.235006 2.165280</span></span>
<span id="cb73-10"><a href="#cb73-10" aria-hidden="true" tabindex="-1"></a><span class="do">## 203    -0.41103196 -2.652208 1.830144</span></span>
<span id="cb73-11"><a href="#cb73-11" aria-hidden="true" tabindex="-1"></a><span class="do">## 204    -0.59029108 -2.831552 1.650970</span></span>
<span id="cb73-12"><a href="#cb73-12" aria-hidden="true" tabindex="-1"></a><span class="do">## 205    -0.63630478 -2.888439 1.615829</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
下のグラフを描画するスクリプト
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<div class="cell">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>fc <span class="ot">&lt;-</span> <span class="fu">forecast</span>(y1a_arima, <span class="at">h =</span> <span class="dv">100</span>) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>fc<span class="sc">$</span>t <span class="ot">&lt;-</span> <span class="dv">201</span><span class="sc">:</span><span class="dv">300</span></span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>()<span class="sc">+</span></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">t =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">200</span>, y1a), <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> y1a))<span class="sc">+</span></span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> fc, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> <span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">linewidth=</span><span class="dv">3</span>))<span class="sc">+</span></span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_ribbon</span>(<span class="at">data =</span> fc, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> <span class="st">`</span><span class="at">Point Forecast</span><span class="st">`</span>, <span class="at">ymax =</span> <span class="st">`</span><span class="at">Hi 95</span><span class="st">`</span>, <span class="at">ymin =</span> <span class="st">`</span><span class="at">Lo 95</span><span class="st">`</span>, <span class="at">color =</span> <span class="st">"red"</span>, <span class="at">fill =</span> <span class="st">"red"</span>, <span class="at">alpha =</span> <span class="fl">0.2</span>))<span class="sc">+</span></span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">caption =</span> <span class="st">"赤の太線が点推定値、リボンが95%推定区間"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</div>
</div>
<div class="cell">
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-71-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-21"><img src="chapter29_files/figure-html/unnamed-chunk-71-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
</section>
</section>
<section id="arima以外の時系列分析手法" class="level2" data-number="29.13">
<h2 data-number="29.13" class="anchored" data-anchor-id="arima以外の時系列分析手法"><span class="header-section-number">29.13</span> ARIMA以外の時系列分析手法</h2>
<p>上記のARIMAモデルが時系列分析手法では最も有名な手法の一つですが、時系列分析にはARIMAの他に、以下のような手法があります。</p>
<ul>
<li>SARIMA：季節性を含めたARIMAモデルの拡張</li>
<li>ARIMAX：共変量（例えば、Nileの例であればアスワンハイダムの建造など）を含めたARIMAモデルの拡張</li>
<li>VAR：複数の関連する時系列を一度に取り扱う、多変量時系列解析の手法</li>
<li>ARCH・GARCH：分散の変動（ボラティリティ、volatility）に注目した統計手法</li>
</ul>
<p>Rではそれぞれ以下のライブラリ・関数を用いて計算することができます。</p>
<ul>
<li>SARIMA：<code>auto.arima</code>関数の<code>seasonal</code>引数をTRUEに設定</li>
<li>ARIMAX：<code>auto.arima</code>関数の<code>xreg</code>引数に共変量をベクターで設定</li>
<li>VAR：<a href="https://cran.r-project.org/web/packages/vars/index.html">vars</a>パッケージ<span class="citation" data-cites="vars_bib1 vars_bib2">(<a href="references.html#ref-vars_bib1" role="doc-biblioref">Bernhard Pfaff 2008</a>; <a href="references.html#ref-vars_bib2" role="doc-biblioref">B. Pfaff 2008</a>)</span>の<code>VAR</code>関数</li>
<li>ARCH・GARCH：<a href="https://cran.r-project.org/web/packages/fGarch/index.html">fGarch</a>パッケージ<span class="citation" data-cites="fGarch_bib">(<a href="references.html#ref-fGarch_bib" role="doc-biblioref">Wuertz et al. 2023</a>)</span>の<code>garchFit</code>関数</li>
</ul>
</section>
<section id="時系列の要素を分離する" class="level2" data-number="29.14">
<h2 data-number="29.14" class="anchored" data-anchor-id="時系列の要素を分離する"><span class="header-section-number">29.14</span> 時系列の要素を分離する</h2>
<p>上に述べたARIMAやその他の分析が時系列分析手法の主なものになりますが、もうちょっと手軽に季節性やトレンドを評価する方法もあります。最も単純なものは、<a href="./chapter20.html">20章</a>で説明した<code>decompose</code>関数を用いる方法です。<code>decompose</code>関数は時系列データをトレンド、季節性、ランダム要素の3つに分離してくれる関数です。<code>decompose</code>関数の返り値をそのまま<code>plot</code>関数に与えると、時系列データを分離してグラフにしてくれます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>decompose関数でトレンド・季節性を分ける</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts</span>(co2, <span class="at">frequency =</span> <span class="dv">12</span>) <span class="sc">|&gt;</span> <span class="fu">decompose</span>() <span class="sc">|&gt;</span> <span class="fu">plot</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-72-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-22"><img src="chapter29_files/figure-html/unnamed-chunk-72-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>同様の関数に、<code>TSstudio</code>パッケージの<code>ts_decompose</code>関数があります。こちらは<code>decompose</code>関数で分離したものを<code>plotly</code>でグラフにしてくれる関数です。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>TSstudio::ts_decompose関数</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_decompose</span>(<span class="fu">ts</span>(co2, <span class="at">frequency =</span> <span class="dv">12</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div class="plotly html-widget html-fill-item" id="htmlwidget-93ed79d30449eb13b637" style="width:100%;height:464px;"></div>
<script type="application/json" data-for="htmlwidget-93ed79d30449eb13b637">{"x":{"data":[{"x":[1,1.0833333333333333,1.1666666666666667,1.25,1.3333333333333333,1.4166666666666665,1.5,1.5833333333333333,1.6666666666666665,1.75,1.8333333333333333,1.9166666666666665,2,2.083333333333333,2.1666666666666665,2.25,2.333333333333333,2.4166666666666665,2.5,2.583333333333333,2.6666666666666665,2.75,2.833333333333333,2.9166666666666665,3,3.083333333333333,3.1666666666666665,3.25,3.333333333333333,3.4166666666666665,3.5,3.583333333333333,3.6666666666666665,3.75,3.833333333333333,3.9166666666666665,4,4.083333333333333,4.1666666666666661,4.25,4.333333333333333,4.4166666666666661,4.5,4.583333333333333,4.6666666666666661,4.75,4.833333333333333,4.9166666666666661,5,5.083333333333333,5.1666666666666661,5.25,5.333333333333333,5.4166666666666661,5.5,5.583333333333333,5.6666666666666661,5.75,5.833333333333333,5.9166666666666661,6,6.083333333333333,6.1666666666666661,6.25,6.333333333333333,6.4166666666666661,6.5,6.583333333333333,6.6666666666666661,6.75,6.833333333333333,6.9166666666666661,7,7.083333333333333,7.1666666666666661,7.25,7.333333333333333,7.4166666666666661,7.5,7.583333333333333,7.6666666666666661,7.75,7.833333333333333,7.9166666666666661,8,8.0833333333333321,8.1666666666666661,8.25,8.3333333333333321,8.4166666666666661,8.5,8.5833333333333321,8.6666666666666661,8.75,8.8333333333333321,8.9166666666666661,9,9.0833333333333321,9.1666666666666661,9.25,9.3333333333333321,9.4166666666666661,9.5,9.5833333333333321,9.6666666666666661,9.75,9.8333333333333321,9.9166666666666661,10,10.083333333333332,10.166666666666666,10.25,10.333333333333332,10.416666666666666,10.5,10.583333333333332,10.666666666666666,10.75,10.833333333333332,10.916666666666666,11,11.083333333333332,11.166666666666666,11.25,11.333333333333332,11.416666666666666,11.5,11.583333333333332,11.666666666666666,11.75,11.833333333333332,11.916666666666666,12,12.083333333333332,12.166666666666666,12.25,12.333333333333332,12.416666666666666,12.5,12.583333333333332,12.666666666666666,12.75,12.833333333333332,12.916666666666666,13,13.083333333333332,13.166666666666666,13.25,13.333333333333332,13.416666666666666,13.5,13.583333333333332,13.666666666666666,13.75,13.833333333333332,13.916666666666666,14,14.083333333333332,14.166666666666666,14.25,14.333333333333332,14.416666666666666,14.5,14.583333333333332,14.666666666666666,14.75,14.833333333333332,14.916666666666666,15,15.083333333333332,15.166666666666666,15.25,15.333333333333332,15.416666666666666,15.5,15.583333333333332,15.666666666666666,15.75,15.833333333333332,15.916666666666666,16,16.083333333333332,16.166666666666664,16.25,16.333333333333332,16.416666666666664,16.5,16.583333333333332,16.666666666666664,16.75,16.833333333333332,16.916666666666664,17,17.083333333333332,17.166666666666664,17.25,17.333333333333332,17.416666666666664,17.5,17.583333333333332,17.666666666666664,17.75,17.833333333333332,17.916666666666664,18,18.083333333333332,18.166666666666664,18.25,18.333333333333332,18.416666666666664,18.5,18.583333333333332,18.666666666666664,18.75,18.833333333333332,18.916666666666664,19,19.083333333333332,19.166666666666664,19.25,19.333333333333332,19.416666666666664,19.5,19.583333333333332,19.666666666666664,19.75,19.833333333333332,19.916666666666664,20,20.083333333333332,20.166666666666664,20.25,20.333333333333332,20.416666666666664,20.5,20.583333333333332,20.666666666666664,20.75,20.833333333333332,20.916666666666664,21,21.083333333333332,21.166666666666664,21.25,21.333333333333332,21.416666666666664,21.5,21.583333333333332,21.666666666666664,21.75,21.833333333333332,21.916666666666664,22,22.083333333333332,22.166666666666664,22.25,22.333333333333332,22.416666666666664,22.5,22.583333333333332,22.666666666666664,22.75,22.833333333333332,22.916666666666664,23,23.083333333333332,23.166666666666664,23.25,23.333333333333332,23.416666666666664,23.5,23.583333333333332,23.666666666666664,23.75,23.833333333333332,23.916666666666664,24,24.083333333333332,24.166666666666664,24.25,24.333333333333332,24.416666666666664,24.5,24.583333333333332,24.666666666666664,24.75,24.833333333333332,24.916666666666664,25,25.083333333333332,25.166666666666664,25.25,25.333333333333332,25.416666666666664,25.5,25.583333333333332,25.666666666666664,25.75,25.833333333333332,25.916666666666664,26,26.083333333333332,26.166666666666664,26.25,26.333333333333332,26.416666666666664,26.5,26.583333333333332,26.666666666666664,26.75,26.833333333333332,26.916666666666664,27,27.083333333333332,27.166666666666664,27.25,27.333333333333332,27.416666666666664,27.5,27.583333333333332,27.666666666666664,27.75,27.833333333333332,27.916666666666664,28,28.083333333333332,28.166666666666664,28.25,28.333333333333332,28.416666666666664,28.5,28.583333333333332,28.666666666666664,28.75,28.833333333333332,28.916666666666664,29,29.083333333333332,29.166666666666664,29.25,29.333333333333332,29.416666666666664,29.5,29.583333333333332,29.666666666666664,29.75,29.833333333333332,29.916666666666664,30,30.083333333333332,30.166666666666664,30.25,30.333333333333332,30.416666666666664,30.5,30.583333333333332,30.666666666666664,30.75,30.833333333333332,30.916666666666664,31,31.083333333333332,31.166666666666664,31.25,31.333333333333332,31.416666666666664,31.5,31.583333333333332,31.666666666666664,31.75,31.833333333333332,31.916666666666664,32,32.083333333333329,32.166666666666664,32.25,32.333333333333329,32.416666666666664,32.5,32.583333333333329,32.666666666666664,32.75,32.833333333333329,32.916666666666664,33,33.083333333333329,33.166666666666664,33.25,33.333333333333329,33.416666666666664,33.5,33.583333333333329,33.666666666666664,33.75,33.833333333333329,33.916666666666664,34,34.083333333333329,34.166666666666664,34.25,34.333333333333329,34.416666666666664,34.5,34.583333333333329,34.666666666666664,34.75,34.833333333333329,34.916666666666664,35,35.083333333333329,35.166666666666664,35.25,35.333333333333329,35.416666666666664,35.5,35.583333333333329,35.666666666666664,35.75,35.833333333333329,35.916666666666664,36,36.083333333333329,36.166666666666664,36.25,36.333333333333329,36.416666666666664,36.5,36.583333333333329,36.666666666666664,36.75,36.833333333333329,36.916666666666664,37,37.083333333333329,37.166666666666664,37.25,37.333333333333329,37.416666666666664,37.5,37.583333333333329,37.666666666666664,37.75,37.833333333333329,37.916666666666664,38,38.083333333333329,38.166666666666664,38.25,38.333333333333329,38.416666666666664,38.5,38.583333333333329,38.666666666666664,38.75,38.833333333333329,38.916666666666664,39,39.083333333333329,39.166666666666664,39.25,39.333333333333329,39.416666666666664,39.5,39.583333333333329,39.666666666666664,39.75,39.833333333333329,39.916666666666664],"y":[315.42000000000002,316.31,316.5,317.56,318.13,318,316.38999999999999,314.64999999999998,313.68000000000001,313.18000000000001,314.66000000000003,315.43000000000001,316.26999999999998,316.81,317.42000000000002,318.87,319.87,319.43000000000001,318.00999999999999,315.74000000000001,314,313.68000000000001,314.83999999999997,316.02999999999997,316.73000000000002,317.54000000000002,318.38,319.31,320.42000000000002,319.61000000000001,318.42000000000002,316.63,314.82999999999998,315.16000000000003,315.94,316.85000000000002,317.77999999999997,318.39999999999998,319.52999999999997,320.42000000000002,320.85000000000002,320.44999999999999,319.44999999999999,317.25,316.11000000000001,315.26999999999998,316.52999999999997,317.52999999999997,318.57999999999998,318.92000000000002,319.69999999999999,321.22000000000003,322.07999999999998,321.31,319.57999999999998,317.61000000000001,316.05000000000001,315.82999999999998,316.91000000000003,318.19999999999999,319.41000000000003,320.06999999999999,320.74000000000001,321.39999999999998,322.06,321.73000000000002,320.26999999999998,318.54000000000002,316.54000000000002,316.70999999999998,317.52999999999997,318.55000000000001,319.26999999999998,320.27999999999997,320.73000000000002,321.97000000000003,322,321.70999999999998,321.05000000000001,318.70999999999998,317.66000000000003,317.13999999999999,318.69999999999999,319.25,320.45999999999998,321.43000000000001,322.23000000000002,323.54000000000002,323.91000000000003,323.58999999999997,322.24000000000001,320.19999999999999,318.48000000000002,317.94,319.63,320.87,322.17000000000002,322.33999999999997,322.88,324.25,324.82999999999998,323.93000000000001,322.38,320.75999999999999,319.10000000000002,319.24000000000001,320.56,321.80000000000001,322.39999999999998,322.99000000000001,323.73000000000002,324.86000000000001,325.39999999999998,325.19999999999999,323.98000000000002,321.94999999999999,320.18000000000001,320.08999999999997,321.16000000000003,322.74000000000001,323.82999999999998,324.25999999999999,325.47000000000003,326.5,327.20999999999998,326.54000000000002,325.72000000000003,323.5,322.22000000000003,321.62,322.69,323.94999999999999,324.88999999999999,325.81999999999999,326.76999999999998,327.97000000000003,327.91000000000003,327.5,326.18000000000001,324.52999999999997,322.93000000000001,322.89999999999998,323.85000000000002,324.95999999999998,326.00999999999999,326.50999999999999,327.00999999999999,327.62,328.75999999999999,328.39999999999998,327.19999999999999,325.26999999999998,323.19999999999999,323.39999999999998,324.63,325.85000000000002,326.60000000000002,327.47000000000003,327.57999999999998,329.56,329.89999999999998,328.92000000000002,327.88,326.16000000000003,324.68000000000001,325.04000000000002,326.33999999999997,327.38999999999999,328.37,329.39999999999998,330.13999999999999,331.32999999999998,332.31,331.89999999999998,330.69999999999999,329.14999999999998,327.35000000000002,327.01999999999998,327.99000000000001,328.48000000000002,329.18000000000001,330.55000000000001,331.31999999999999,332.48000000000002,332.92000000000002,332.07999999999998,331.00999999999999,329.23000000000002,327.26999999999998,327.20999999999998,328.29000000000002,329.41000000000003,330.23000000000002,331.25,331.87,333.13999999999999,333.80000000000001,333.43000000000001,331.73000000000002,329.89999999999998,328.39999999999998,328.17000000000002,329.31999999999999,330.58999999999997,331.57999999999998,332.38999999999999,333.32999999999998,334.41000000000003,334.70999999999998,334.17000000000002,332.88999999999999,330.76999999999998,329.13999999999999,328.77999999999997,330.13999999999999,331.51999999999998,332.75,333.24000000000001,334.52999999999997,335.89999999999998,336.56999999999999,336.10000000000002,334.75999999999999,332.58999999999997,331.42000000000002,330.98000000000002,332.24000000000001,333.68000000000001,334.80000000000001,335.22000000000003,336.47000000000003,337.58999999999997,337.83999999999997,337.72000000000003,336.37,334.50999999999999,332.60000000000002,332.38,333.75,334.77999999999997,336.05000000000001,336.58999999999997,337.79000000000002,338.70999999999998,339.30000000000001,339.12,337.56,335.92000000000002,333.75,333.69999999999999,335.12,336.56,337.83999999999997,338.19,339.91000000000003,340.60000000000002,341.29000000000002,341,339.38999999999999,337.43000000000001,335.72000000000003,335.83999999999997,336.93000000000001,338.04000000000002,339.06,340.30000000000001,341.20999999999998,342.32999999999998,342.74000000000001,342.07999999999998,340.31999999999999,338.25999999999999,336.51999999999998,336.68000000000001,338.19,339.44,340.56999999999999,341.44,342.52999999999997,343.38999999999999,343.95999999999998,343.18000000000001,341.88,339.64999999999998,337.81,337.69,339.08999999999997,340.31999999999999,341.19999999999999,342.35000000000002,342.93000000000001,344.76999999999998,345.57999999999998,345.13999999999999,343.81,342.20999999999998,339.69,339.81999999999999,340.98000000000002,342.81999999999999,343.51999999999998,344.32999999999998,345.11000000000001,346.88,347.25,346.62,345.22000000000003,343.11000000000001,340.89999999999998,341.18000000000001,342.80000000000001,344.04000000000002,344.79000000000002,345.81999999999999,347.25,348.17000000000002,348.74000000000001,348.06999999999999,346.38,344.50999999999999,342.92000000000002,342.62,344.06,345.38,346.11000000000001,346.77999999999997,347.68000000000001,349.37,350.02999999999997,349.37,347.75999999999999,345.73000000000002,344.68000000000001,343.99000000000001,345.48000000000002,346.72000000000003,347.83999999999997,348.29000000000002,349.23000000000002,350.80000000000001,351.66000000000003,351.06999999999999,349.32999999999998,347.92000000000002,346.26999999999998,346.18000000000001,347.63999999999999,348.77999999999997,350.25,351.54000000000002,352.05000000000001,353.41000000000003,354.04000000000002,353.62,352.22000000000003,350.26999999999998,348.55000000000001,348.72000000000003,349.91000000000003,351.18000000000001,352.60000000000002,352.92000000000002,353.52999999999997,355.25999999999999,355.51999999999998,354.97000000000003,353.75,351.51999999999998,349.63999999999999,349.82999999999998,351.13999999999999,352.37,353.5,354.55000000000001,355.23000000000002,356.04000000000002,357,356.06999999999999,354.67000000000002,352.75999999999999,350.81999999999999,351.04000000000002,352.69,354.06999999999999,354.58999999999997,355.63,357.02999999999997,358.48000000000002,359.22000000000003,358.12,356.06,353.92000000000002,352.05000000000001,352.11000000000001,353.63999999999999,354.88999999999999,355.88,356.63,357.72000000000003,359.06999999999999,359.57999999999998,359.17000000000002,356.94,354.92000000000002,352.94,353.23000000000002,354.08999999999997,355.32999999999998,356.63,357.10000000000002,358.31999999999999,359.41000000000003,360.23000000000002,359.55000000000001,357.52999999999997,355.48000000000002,353.67000000000002,353.94999999999999,355.30000000000001,356.77999999999997,358.33999999999997,358.88999999999999,359.94999999999999,361.25,361.67000000000002,360.94,359.55000000000001,357.49000000000001,355.83999999999997,356,357.58999999999997,359.05000000000001,359.98000000000002,361.02999999999997,361.66000000000003,363.48000000000002,363.81999999999999,363.30000000000001,361.94,359.5,358.11000000000001,357.80000000000001,359.61000000000001,360.74000000000001,362.08999999999997,363.29000000000002,364.06,364.75999999999999,365.44999999999999,365.00999999999999,363.69999999999999,361.54000000000002,359.50999999999999,359.64999999999998,360.80000000000001,362.38,363.23000000000002,364.06,364.61000000000001,366.39999999999998,366.83999999999997,365.68000000000001,364.51999999999998,362.56999999999999,360.24000000000001,360.82999999999998,362.49000000000001,364.33999999999997],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(31,119,180,1)","line":{"color":"rgba(31,119,180,1)"}},"error_y":{"color":"rgba(31,119,180,1)"},"error_x":{"color":"rgba(31,119,180,1)"},"xaxis":"x","yaxis":"y","frame":null},{"x":[1.5,1.5833333333333333,1.6666666666666665,1.75,1.8333333333333333,1.9166666666666665,2,2.083333333333333,2.1666666666666665,2.25,2.333333333333333,2.4166666666666665,2.5,2.583333333333333,2.6666666666666665,2.75,2.833333333333333,2.9166666666666665,3,3.083333333333333,3.1666666666666665,3.25,3.333333333333333,3.4166666666666665,3.5,3.583333333333333,3.6666666666666665,3.75,3.833333333333333,3.9166666666666665,4,4.083333333333333,4.1666666666666661,4.25,4.333333333333333,4.4166666666666661,4.5,4.583333333333333,4.6666666666666661,4.75,4.833333333333333,4.9166666666666661,5,5.083333333333333,5.1666666666666661,5.25,5.333333333333333,5.4166666666666661,5.5,5.583333333333333,5.6666666666666661,5.75,5.833333333333333,5.9166666666666661,6,6.083333333333333,6.1666666666666661,6.25,6.333333333333333,6.4166666666666661,6.5,6.583333333333333,6.6666666666666661,6.75,6.833333333333333,6.9166666666666661,7,7.083333333333333,7.1666666666666661,7.25,7.333333333333333,7.4166666666666661,7.5,7.583333333333333,7.6666666666666661,7.75,7.833333333333333,7.9166666666666661,8,8.0833333333333321,8.1666666666666661,8.25,8.3333333333333321,8.4166666666666661,8.5,8.5833333333333321,8.6666666666666661,8.75,8.8333333333333321,8.9166666666666661,9,9.0833333333333321,9.1666666666666661,9.25,9.3333333333333321,9.4166666666666661,9.5,9.5833333333333321,9.6666666666666661,9.75,9.8333333333333321,9.9166666666666661,10,10.083333333333332,10.166666666666666,10.25,10.333333333333332,10.416666666666666,10.5,10.583333333333332,10.666666666666666,10.75,10.833333333333332,10.916666666666666,11,11.083333333333332,11.166666666666666,11.25,11.333333333333332,11.416666666666666,11.5,11.583333333333332,11.666666666666666,11.75,11.833333333333332,11.916666666666666,12,12.083333333333332,12.166666666666666,12.25,12.333333333333332,12.416666666666666,12.5,12.583333333333332,12.666666666666666,12.75,12.833333333333332,12.916666666666666,13,13.083333333333332,13.166666666666666,13.25,13.333333333333332,13.416666666666666,13.5,13.583333333333332,13.666666666666666,13.75,13.833333333333332,13.916666666666666,14,14.083333333333332,14.166666666666666,14.25,14.333333333333332,14.416666666666666,14.5,14.583333333333332,14.666666666666666,14.75,14.833333333333332,14.916666666666666,15,15.083333333333332,15.166666666666666,15.25,15.333333333333332,15.416666666666666,15.5,15.583333333333332,15.666666666666666,15.75,15.833333333333332,15.916666666666666,16,16.083333333333332,16.166666666666664,16.25,16.333333333333332,16.416666666666664,16.5,16.583333333333332,16.666666666666664,16.75,16.833333333333332,16.916666666666664,17,17.083333333333332,17.166666666666664,17.25,17.333333333333332,17.416666666666664,17.5,17.583333333333332,17.666666666666664,17.75,17.833333333333332,17.916666666666664,18,18.083333333333332,18.166666666666664,18.25,18.333333333333332,18.416666666666664,18.5,18.583333333333332,18.666666666666664,18.75,18.833333333333332,18.916666666666664,19,19.083333333333332,19.166666666666664,19.25,19.333333333333332,19.416666666666664,19.5,19.583333333333332,19.666666666666664,19.75,19.833333333333332,19.916666666666664,20,20.083333333333332,20.166666666666664,20.25,20.333333333333332,20.416666666666664,20.5,20.583333333333332,20.666666666666664,20.75,20.833333333333332,20.916666666666664,21,21.083333333333332,21.166666666666664,21.25,21.333333333333332,21.416666666666664,21.5,21.583333333333332,21.666666666666664,21.75,21.833333333333332,21.916666666666664,22,22.083333333333332,22.166666666666664,22.25,22.333333333333332,22.416666666666664,22.5,22.583333333333332,22.666666666666664,22.75,22.833333333333332,22.916666666666664,23,23.083333333333332,23.166666666666664,23.25,23.333333333333332,23.416666666666664,23.5,23.583333333333332,23.666666666666664,23.75,23.833333333333332,23.916666666666664,24,24.083333333333332,24.166666666666664,24.25,24.333333333333332,24.416666666666664,24.5,24.583333333333332,24.666666666666664,24.75,24.833333333333332,24.916666666666664,25,25.083333333333332,25.166666666666664,25.25,25.333333333333332,25.416666666666664,25.5,25.583333333333332,25.666666666666664,25.75,25.833333333333332,25.916666666666664,26,26.083333333333332,26.166666666666664,26.25,26.333333333333332,26.416666666666664,26.5,26.583333333333332,26.666666666666664,26.75,26.833333333333332,26.916666666666664,27,27.083333333333332,27.166666666666664,27.25,27.333333333333332,27.416666666666664,27.5,27.583333333333332,27.666666666666664,27.75,27.833333333333332,27.916666666666664,28,28.083333333333332,28.166666666666664,28.25,28.333333333333332,28.416666666666664,28.5,28.583333333333332,28.666666666666664,28.75,28.833333333333332,28.916666666666664,29,29.083333333333332,29.166666666666664,29.25,29.333333333333332,29.416666666666664,29.5,29.583333333333332,29.666666666666664,29.75,29.833333333333332,29.916666666666664,30,30.083333333333332,30.166666666666664,30.25,30.333333333333332,30.416666666666664,30.5,30.583333333333332,30.666666666666664,30.75,30.833333333333332,30.916666666666664,31,31.083333333333332,31.166666666666664,31.25,31.333333333333332,31.416666666666664,31.5,31.583333333333332,31.666666666666664,31.75,31.833333333333332,31.916666666666664,32,32.083333333333329,32.166666666666664,32.25,32.333333333333329,32.416666666666664,32.5,32.583333333333329,32.666666666666664,32.75,32.833333333333329,32.916666666666664,33,33.083333333333329,33.166666666666664,33.25,33.333333333333329,33.416666666666664,33.5,33.583333333333329,33.666666666666664,33.75,33.833333333333329,33.916666666666664,34,34.083333333333329,34.166666666666664,34.25,34.333333333333329,34.416666666666664,34.5,34.583333333333329,34.666666666666664,34.75,34.833333333333329,34.916666666666664,35,35.083333333333329,35.166666666666664,35.25,35.333333333333329,35.416666666666664,35.5,35.583333333333329,35.666666666666664,35.75,35.833333333333329,35.916666666666664,36,36.083333333333329,36.166666666666664,36.25,36.333333333333329,36.416666666666664,36.5,36.583333333333329,36.666666666666664,36.75,36.833333333333329,36.916666666666664,37,37.083333333333329,37.166666666666664,37.25,37.333333333333329,37.416666666666664,37.5,37.583333333333329,37.666666666666664,37.75,37.833333333333329,37.916666666666664,38,38.083333333333329,38.166666666666664,38.25,38.333333333333329,38.416666666666664,38.5,38.583333333333329,38.666666666666664,38.75,38.833333333333329,38.916666666666664,39,39.083333333333329,39.166666666666664,39.25,39.333333333333329,39.416666666666664],"y":[315.86125000000004,315.91749999999996,315.97666666666663,316.06958333333336,316.19666666666666,316.32874999999996,316.45583333333332,316.56874999999997,316.6275,316.66166666666669,316.69,316.72249999999997,316.76666666666659,316.81625000000003,316.88666666666666,316.94499999999994,316.98625000000004,317.01666666666659,317.04124999999999,317.09541666666667,317.16708333333332,317.26333333333338,317.37083333333328,317.45083333333332,317.52875,317.60833333333341,317.6920833333333,317.78624999999994,317.85041666666666,317.90333333333336,317.98124999999993,318.05000000000001,318.12916666666661,318.18708333333331,318.21624999999995,318.26916666666671,318.33083333333337,318.38583333333332,318.41458333333333,318.45500000000004,318.53958333333327,318.62666666666667,318.6679166666666,318.68833333333339,318.70083333333326,318.72166666666669,318.76083333333327,318.80458333333331,318.86708333333331,318.94958333333335,319.0408333333333,319.09166666666664,319.09833333333336,319.11500000000001,319.16125,319.22874999999999,319.28791666666666,319.34500000000003,319.40749999999997,319.44791666666663,319.45666666666665,319.45958333333334,319.46791666666667,319.49124999999998,319.51250000000005,319.50916666666666,319.54083333333335,319.58041666666662,319.6341666666666,319.69875000000002,319.76541666666668,319.84333333333336,319.92208333333332,320.01958333333334,320.12999999999994,320.25791666666663,320.40291666666673,320.56083333333333,320.68875000000003,320.80041666666665,320.89666666666665,320.96416666666664,321.03625,321.14249999999998,321.28125000000006,321.39041666666668,321.45541666666662,321.51208333333335,321.57999999999993,321.63249999999999,321.65249999999997,321.68166666666662,321.73083333333335,321.81083333333328,321.90375000000006,321.98124999999999,322.02958333333333,322.06624999999997,322.12874999999997,322.1895833333333,322.23874999999998,322.31541666666664,322.435,322.55124999999998,322.64583333333331,322.72624999999999,322.78666666666663,322.85083333333336,322.94958333333335,323.06208333333336,323.18749999999994,323.32833333333338,323.47208333333339,323.60333333333335,323.73166666666668,323.86875000000003,324.01833333333332,324.16708333333332,324.29458333333332,324.40875,324.50333333333327,324.61249999999995,324.73166666666668,324.84708333333327,324.9375,325.00666666666666,325.06583333333333,325.12791666666669,325.20041666666663,325.2833333333333,325.38499999999999,325.4754166666666,325.56416666666661,325.63958333333329,325.67833333333328,325.67374999999998,325.69458333333336,325.76749999999998,325.84749999999997,325.92083333333329,325.96291666666662,325.995,326.04833333333329,326.11791666666664,326.17958333333331,326.24416666666662,326.30791666666664,326.41249999999997,326.5408333333333,326.61000000000001,326.66000000000003,326.7254166666666,326.82416666666666,326.95416666666665,327.09375,327.22916666666674,327.36708333333337,327.52125000000001,327.70833333333331,327.88875000000007,328.06291666666664,328.28749999999997,328.5291666666667,328.77124999999995,329.0070833333333,329.20083333333332,329.35208333333327,329.46625,329.5454166666666,329.62708333333336,329.72416666666669,329.82125000000002,329.89458333333329,329.92750000000001,329.94791666666669,329.9641666666667,329.9641666666667,329.96875,329.98916666666668,330.04041666666666,330.12291666666664,330.19583333333338,330.2479166666667,330.29833333333335,330.36250000000001,330.45541666666662,330.54166666666663,330.59958333333333,330.67458333333332,330.76166666666666,330.84458333333328,330.93666666666661,331.04208333333332,331.14583333333331,331.25416666666666,331.3679166666667,331.45875000000001,331.52749999999997,331.60666666666668,331.69125000000003,331.75833333333333,331.8145833333333,331.87416666666672,331.9470833333333,332.03458333333327,332.11874999999998,332.20416666666671,332.31624999999997,332.45583333333337,332.61374999999998,332.77208333333328,332.92583333333329,333.09666666666658,333.2833333333333,333.46249999999998,333.63999999999999,333.81541666666664,333.98333333333335,334.14666666666676,334.29791666666671,334.42124999999999,334.54166666666663,334.67624999999998,334.82333333333327,334.95249999999999,335.06,335.18124999999998,335.28999999999996,335.38791666666668,335.49708333333331,335.60916666666662,335.71083333333331,335.81833333333333,335.93749999999994,336.04541666666671,336.15374999999995,336.26041666666663,336.36333333333334,336.4754166666666,336.60666666666663,336.75541666666669,336.89666666666665,337.05166666666668,337.21874999999994,337.38041666666669,337.54166666666669,337.69625000000002,337.83541666666667,337.98041666666666,338.15166666666664,338.31624999999997,338.45333333333326,338.56583333333333,338.70458333333335,338.84666666666664,338.97291666666666,339.1054166666666,339.21083333333337,339.29458333333338,339.36791666666664,339.43583333333333,339.50416666666666,339.5916666666667,339.70249999999993,339.82374999999996,339.93416666666661,340.03666666666663,340.13583333333332,340.23083333333329,340.32749999999999,340.43833333333333,340.56124999999997,340.67291666666665,340.76874999999995,340.8483333333333,340.92249999999996,340.98541666666671,341.04958333333337,341.10416666666674,341.17833333333334,341.30333333333328,341.45249999999999,341.61458333333326,341.80166666666662,341.98666666666662,342.15375,342.32125000000008,342.50416666666661,342.70499999999998,342.88416666666666,343.0575,343.23624999999993,343.3937499999999,343.52499999999992,343.64541666666668,343.74166666666667,343.82958333333335,343.93666666666672,344.06916666666666,344.19583333333338,344.29958333333332,344.41458333333327,344.56583333333333,344.70874999999995,344.82458333333329,344.94708333333335,345.05583333333328,345.16250000000002,345.30500000000001,345.44916666666666,345.56166666666672,345.67000000000002,345.78083333333331,345.87583333333333,345.93375000000003,346.00166666666667,346.10541666666666,346.21333333333331,346.32499999999999,346.43333333333334,346.55750000000006,346.68791666666664,346.80416666666656,346.91916666666663,347.04708333333332,347.18208333333337,347.30958333333336,347.43374999999997,347.56125000000003,347.69999999999999,347.83625000000006,347.9929166666667,348.15041666666673,348.3079166666667,348.48916666666668,348.66500000000002,348.85124999999999,349.0870833333334,349.33999999999997,349.56624999999997,349.77416666666659,349.97958333333338,350.20625000000001,350.42458333333337,350.61749999999995,350.81833333333338,351.01875000000001,351.21333333333337,351.41125,351.56666666666661,351.68583333333333,351.82458333333329,351.96333333333337,352.08125000000001,352.20124999999996,352.31708333333336,352.41458333333338,352.50625000000002,352.60374999999999,352.70458333333329,352.79166666666663,352.89708333333328,353.0358333333333,353.13916666666665,353.23333333333335,353.34083333333336,353.42500000000001,353.51499999999999,353.61583333333328,353.71541666666667,353.83041666666662,353.96583333333336,354.0820833333334,354.17250000000001,354.29250000000002,354.46916666666664,354.6633333333333,354.84125,354.98458333333332,355.09083333333331,355.19041666666664,355.28625,355.3704166666667,355.44416666666672,355.53208333333339,355.62750000000005,355.69791666666663,355.75125000000003,355.79083333333335,355.84958333333333,355.92999999999995,356.00833333333333,356.08708333333328,356.17083333333335,356.23624999999993,356.27333333333326,356.32291666666669,356.37374999999997,356.41833333333329,356.45749999999998,356.49875000000003,356.54166666666669,356.58208333333334,356.63,356.68374999999997,356.74416666666667,356.82458333333341,356.93541666666664,357.0670833333333,357.21291666666662,357.3554166666666,357.49999999999994,357.63666666666666,357.75458333333336,357.8966666666667,358.06458333333336,358.23874999999998,358.41458333333333,358.59541666666667,358.78541666666666,358.94833333333338,359.10583333333335,359.26624999999996,359.43041666666659,359.61291666666671,359.80083333333334,359.99875000000003,360.18208333333331,360.36041666666665,360.53000000000003,360.68916666666667,360.84375,361.0020833333333,361.18416666666667,361.37833333333333,361.53166666666664,361.65291666666667,361.79208333333332,361.93666666666667,362.09500000000008,362.23833333333329,362.37375000000003,362.50041666666664,362.61833333333323,362.73416666666657,362.81374999999997,362.86874999999998,362.95999999999998,363.08625000000001,363.17208333333332,363.23416666666657,363.31124999999997,363.3845833333333,363.46416666666659,363.58374999999995,363.73583333333329],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(255,127,14,1)","line":{"color":"rgba(255,127,14,1)"}},"error_y":{"color":"rgba(255,127,14,1)"},"error_x":{"color":"rgba(255,127,14,1)"},"xaxis":"x2","yaxis":"y2","frame":null},{"x":[1,1.0833333333333333,1.1666666666666667,1.25,1.3333333333333333,1.4166666666666665,1.5,1.5833333333333333,1.6666666666666665,1.75,1.8333333333333333,1.9166666666666665,2,2.083333333333333,2.1666666666666665,2.25,2.333333333333333,2.4166666666666665,2.5,2.583333333333333,2.6666666666666665,2.75,2.833333333333333,2.9166666666666665,3,3.083333333333333,3.1666666666666665,3.25,3.333333333333333,3.4166666666666665,3.5,3.583333333333333,3.6666666666666665,3.75,3.833333333333333,3.9166666666666665,4,4.083333333333333,4.1666666666666661,4.25,4.333333333333333,4.4166666666666661,4.5,4.583333333333333,4.6666666666666661,4.75,4.833333333333333,4.9166666666666661,5,5.083333333333333,5.1666666666666661,5.25,5.333333333333333,5.4166666666666661,5.5,5.583333333333333,5.6666666666666661,5.75,5.833333333333333,5.9166666666666661,6,6.083333333333333,6.1666666666666661,6.25,6.333333333333333,6.4166666666666661,6.5,6.583333333333333,6.6666666666666661,6.75,6.833333333333333,6.9166666666666661,7,7.083333333333333,7.1666666666666661,7.25,7.333333333333333,7.4166666666666661,7.5,7.583333333333333,7.6666666666666661,7.75,7.833333333333333,7.9166666666666661,8,8.0833333333333321,8.1666666666666661,8.25,8.3333333333333321,8.4166666666666661,8.5,8.5833333333333321,8.6666666666666661,8.75,8.8333333333333321,8.9166666666666661,9,9.0833333333333321,9.1666666666666661,9.25,9.3333333333333321,9.4166666666666661,9.5,9.5833333333333321,9.6666666666666661,9.75,9.8333333333333321,9.9166666666666661,10,10.083333333333332,10.166666666666666,10.25,10.333333333333332,10.416666666666666,10.5,10.583333333333332,10.666666666666666,10.75,10.833333333333332,10.916666666666666,11,11.083333333333332,11.166666666666666,11.25,11.333333333333332,11.416666666666666,11.5,11.583333333333332,11.666666666666666,11.75,11.833333333333332,11.916666666666666,12,12.083333333333332,12.166666666666666,12.25,12.333333333333332,12.416666666666666,12.5,12.583333333333332,12.666666666666666,12.75,12.833333333333332,12.916666666666666,13,13.083333333333332,13.166666666666666,13.25,13.333333333333332,13.416666666666666,13.5,13.583333333333332,13.666666666666666,13.75,13.833333333333332,13.916666666666666,14,14.083333333333332,14.166666666666666,14.25,14.333333333333332,14.416666666666666,14.5,14.583333333333332,14.666666666666666,14.75,14.833333333333332,14.916666666666666,15,15.083333333333332,15.166666666666666,15.25,15.333333333333332,15.416666666666666,15.5,15.583333333333332,15.666666666666666,15.75,15.833333333333332,15.916666666666666,16,16.083333333333332,16.166666666666664,16.25,16.333333333333332,16.416666666666664,16.5,16.583333333333332,16.666666666666664,16.75,16.833333333333332,16.916666666666664,17,17.083333333333332,17.166666666666664,17.25,17.333333333333332,17.416666666666664,17.5,17.583333333333332,17.666666666666664,17.75,17.833333333333332,17.916666666666664,18,18.083333333333332,18.166666666666664,18.25,18.333333333333332,18.416666666666664,18.5,18.583333333333332,18.666666666666664,18.75,18.833333333333332,18.916666666666664,19,19.083333333333332,19.166666666666664,19.25,19.333333333333332,19.416666666666664,19.5,19.583333333333332,19.666666666666664,19.75,19.833333333333332,19.916666666666664,20,20.083333333333332,20.166666666666664,20.25,20.333333333333332,20.416666666666664,20.5,20.583333333333332,20.666666666666664,20.75,20.833333333333332,20.916666666666664,21,21.083333333333332,21.166666666666664,21.25,21.333333333333332,21.416666666666664,21.5,21.583333333333332,21.666666666666664,21.75,21.833333333333332,21.916666666666664,22,22.083333333333332,22.166666666666664,22.25,22.333333333333332,22.416666666666664,22.5,22.583333333333332,22.666666666666664,22.75,22.833333333333332,22.916666666666664,23,23.083333333333332,23.166666666666664,23.25,23.333333333333332,23.416666666666664,23.5,23.583333333333332,23.666666666666664,23.75,23.833333333333332,23.916666666666664,24,24.083333333333332,24.166666666666664,24.25,24.333333333333332,24.416666666666664,24.5,24.583333333333332,24.666666666666664,24.75,24.833333333333332,24.916666666666664,25,25.083333333333332,25.166666666666664,25.25,25.333333333333332,25.416666666666664,25.5,25.583333333333332,25.666666666666664,25.75,25.833333333333332,25.916666666666664,26,26.083333333333332,26.166666666666664,26.25,26.333333333333332,26.416666666666664,26.5,26.583333333333332,26.666666666666664,26.75,26.833333333333332,26.916666666666664,27,27.083333333333332,27.166666666666664,27.25,27.333333333333332,27.416666666666664,27.5,27.583333333333332,27.666666666666664,27.75,27.833333333333332,27.916666666666664,28,28.083333333333332,28.166666666666664,28.25,28.333333333333332,28.416666666666664,28.5,28.583333333333332,28.666666666666664,28.75,28.833333333333332,28.916666666666664,29,29.083333333333332,29.166666666666664,29.25,29.333333333333332,29.416666666666664,29.5,29.583333333333332,29.666666666666664,29.75,29.833333333333332,29.916666666666664,30,30.083333333333332,30.166666666666664,30.25,30.333333333333332,30.416666666666664,30.5,30.583333333333332,30.666666666666664,30.75,30.833333333333332,30.916666666666664,31,31.083333333333332,31.166666666666664,31.25,31.333333333333332,31.416666666666664,31.5,31.583333333333332,31.666666666666664,31.75,31.833333333333332,31.916666666666664,32,32.083333333333329,32.166666666666664,32.25,32.333333333333329,32.416666666666664,32.5,32.583333333333329,32.666666666666664,32.75,32.833333333333329,32.916666666666664,33,33.083333333333329,33.166666666666664,33.25,33.333333333333329,33.416666666666664,33.5,33.583333333333329,33.666666666666664,33.75,33.833333333333329,33.916666666666664,34,34.083333333333329,34.166666666666664,34.25,34.333333333333329,34.416666666666664,34.5,34.583333333333329,34.666666666666664,34.75,34.833333333333329,34.916666666666664,35,35.083333333333329,35.166666666666664,35.25,35.333333333333329,35.416666666666664,35.5,35.583333333333329,35.666666666666664,35.75,35.833333333333329,35.916666666666664,36,36.083333333333329,36.166666666666664,36.25,36.333333333333329,36.416666666666664,36.5,36.583333333333329,36.666666666666664,36.75,36.833333333333329,36.916666666666664,37,37.083333333333329,37.166666666666664,37.25,37.333333333333329,37.416666666666664,37.5,37.583333333333329,37.666666666666664,37.75,37.833333333333329,37.916666666666664,38,38.083333333333329,38.166666666666664,38.25,38.333333333333329,38.416666666666664,38.5,38.583333333333329,38.666666666666664,38.75,38.833333333333329,38.916666666666664,39,39.083333333333329,39.166666666666664,39.25,39.333333333333329,39.416666666666664,39.5,39.583333333333329,39.666666666666664,39.75,39.833333333333329,39.916666666666664],"y":[-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153,-0.053596491228076595,0.61055921052631346,1.3756469298245722,2.5168201754385917,3.000285087719301,2.3292105263157983,0.81293859649122635,-1.2505263157894819,-3.0545833333333285,-3.25194078947368,-2.0696929824561443,-0.96512061403509153],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(44,160,44,1)","line":{"color":"rgba(44,160,44,1)"}},"error_y":{"color":"rgba(44,160,44,1)"},"error_x":{"color":"rgba(44,160,44,1)"},"xaxis":"x3","yaxis":"y3","frame":null},{"x":[1.5,1.5833333333333333,1.6666666666666665,1.75,1.8333333333333333,1.9166666666666665,2,2.083333333333333,2.1666666666666665,2.25,2.333333333333333,2.4166666666666665,2.5,2.583333333333333,2.6666666666666665,2.75,2.833333333333333,2.9166666666666665,3,3.083333333333333,3.1666666666666665,3.25,3.333333333333333,3.4166666666666665,3.5,3.583333333333333,3.6666666666666665,3.75,3.833333333333333,3.9166666666666665,4,4.083333333333333,4.1666666666666661,4.25,4.333333333333333,4.4166666666666661,4.5,4.583333333333333,4.6666666666666661,4.75,4.833333333333333,4.9166666666666661,5,5.083333333333333,5.1666666666666661,5.25,5.333333333333333,5.4166666666666661,5.5,5.583333333333333,5.6666666666666661,5.75,5.833333333333333,5.9166666666666661,6,6.083333333333333,6.1666666666666661,6.25,6.333333333333333,6.4166666666666661,6.5,6.583333333333333,6.6666666666666661,6.75,6.833333333333333,6.9166666666666661,7,7.083333333333333,7.1666666666666661,7.25,7.333333333333333,7.4166666666666661,7.5,7.583333333333333,7.6666666666666661,7.75,7.833333333333333,7.9166666666666661,8,8.0833333333333321,8.1666666666666661,8.25,8.3333333333333321,8.4166666666666661,8.5,8.5833333333333321,8.6666666666666661,8.75,8.8333333333333321,8.9166666666666661,9,9.0833333333333321,9.1666666666666661,9.25,9.3333333333333321,9.4166666666666661,9.5,9.5833333333333321,9.6666666666666661,9.75,9.8333333333333321,9.9166666666666661,10,10.083333333333332,10.166666666666666,10.25,10.333333333333332,10.416666666666666,10.5,10.583333333333332,10.666666666666666,10.75,10.833333333333332,10.916666666666666,11,11.083333333333332,11.166666666666666,11.25,11.333333333333332,11.416666666666666,11.5,11.583333333333332,11.666666666666666,11.75,11.833333333333332,11.916666666666666,12,12.083333333333332,12.166666666666666,12.25,12.333333333333332,12.416666666666666,12.5,12.583333333333332,12.666666666666666,12.75,12.833333333333332,12.916666666666666,13,13.083333333333332,13.166666666666666,13.25,13.333333333333332,13.416666666666666,13.5,13.583333333333332,13.666666666666666,13.75,13.833333333333332,13.916666666666666,14,14.083333333333332,14.166666666666666,14.25,14.333333333333332,14.416666666666666,14.5,14.583333333333332,14.666666666666666,14.75,14.833333333333332,14.916666666666666,15,15.083333333333332,15.166666666666666,15.25,15.333333333333332,15.416666666666666,15.5,15.583333333333332,15.666666666666666,15.75,15.833333333333332,15.916666666666666,16,16.083333333333332,16.166666666666664,16.25,16.333333333333332,16.416666666666664,16.5,16.583333333333332,16.666666666666664,16.75,16.833333333333332,16.916666666666664,17,17.083333333333332,17.166666666666664,17.25,17.333333333333332,17.416666666666664,17.5,17.583333333333332,17.666666666666664,17.75,17.833333333333332,17.916666666666664,18,18.083333333333332,18.166666666666664,18.25,18.333333333333332,18.416666666666664,18.5,18.583333333333332,18.666666666666664,18.75,18.833333333333332,18.916666666666664,19,19.083333333333332,19.166666666666664,19.25,19.333333333333332,19.416666666666664,19.5,19.583333333333332,19.666666666666664,19.75,19.833333333333332,19.916666666666664,20,20.083333333333332,20.166666666666664,20.25,20.333333333333332,20.416666666666664,20.5,20.583333333333332,20.666666666666664,20.75,20.833333333333332,20.916666666666664,21,21.083333333333332,21.166666666666664,21.25,21.333333333333332,21.416666666666664,21.5,21.583333333333332,21.666666666666664,21.75,21.833333333333332,21.916666666666664,22,22.083333333333332,22.166666666666664,22.25,22.333333333333332,22.416666666666664,22.5,22.583333333333332,22.666666666666664,22.75,22.833333333333332,22.916666666666664,23,23.083333333333332,23.166666666666664,23.25,23.333333333333332,23.416666666666664,23.5,23.583333333333332,23.666666666666664,23.75,23.833333333333332,23.916666666666664,24,24.083333333333332,24.166666666666664,24.25,24.333333333333332,24.416666666666664,24.5,24.583333333333332,24.666666666666664,24.75,24.833333333333332,24.916666666666664,25,25.083333333333332,25.166666666666664,25.25,25.333333333333332,25.416666666666664,25.5,25.583333333333332,25.666666666666664,25.75,25.833333333333332,25.916666666666664,26,26.083333333333332,26.166666666666664,26.25,26.333333333333332,26.416666666666664,26.5,26.583333333333332,26.666666666666664,26.75,26.833333333333332,26.916666666666664,27,27.083333333333332,27.166666666666664,27.25,27.333333333333332,27.416666666666664,27.5,27.583333333333332,27.666666666666664,27.75,27.833333333333332,27.916666666666664,28,28.083333333333332,28.166666666666664,28.25,28.333333333333332,28.416666666666664,28.5,28.583333333333332,28.666666666666664,28.75,28.833333333333332,28.916666666666664,29,29.083333333333332,29.166666666666664,29.25,29.333333333333332,29.416666666666664,29.5,29.583333333333332,29.666666666666664,29.75,29.833333333333332,29.916666666666664,30,30.083333333333332,30.166666666666664,30.25,30.333333333333332,30.416666666666664,30.5,30.583333333333332,30.666666666666664,30.75,30.833333333333332,30.916666666666664,31,31.083333333333332,31.166666666666664,31.25,31.333333333333332,31.416666666666664,31.5,31.583333333333332,31.666666666666664,31.75,31.833333333333332,31.916666666666664,32,32.083333333333329,32.166666666666664,32.25,32.333333333333329,32.416666666666664,32.5,32.583333333333329,32.666666666666664,32.75,32.833333333333329,32.916666666666664,33,33.083333333333329,33.166666666666664,33.25,33.333333333333329,33.416666666666664,33.5,33.583333333333329,33.666666666666664,33.75,33.833333333333329,33.916666666666664,34,34.083333333333329,34.166666666666664,34.25,34.333333333333329,34.416666666666664,34.5,34.583333333333329,34.666666666666664,34.75,34.833333333333329,34.916666666666664,35,35.083333333333329,35.166666666666664,35.25,35.333333333333329,35.416666666666664,35.5,35.583333333333329,35.666666666666664,35.75,35.833333333333329,35.916666666666664,36,36.083333333333329,36.166666666666664,36.25,36.333333333333329,36.416666666666664,36.5,36.583333333333329,36.666666666666664,36.75,36.833333333333329,36.916666666666664,37,37.083333333333329,37.166666666666664,37.25,37.333333333333329,37.416666666666664,37.5,37.583333333333329,37.666666666666664,37.75,37.833333333333329,37.916666666666664,38,38.083333333333329,38.166666666666664,38.25,38.333333333333329,38.416666666666664,38.5,38.583333333333329,38.666666666666664,38.75,38.833333333333329,38.916666666666664,39,39.083333333333329,39.166666666666664,39.25,39.333333333333329,39.416666666666664],"y":[-0.28418859649127626,-0.016973684210483952,0.75791666666668789,0.36235745614033021,0.53302631578952742,0.066370614035122344,-0.13223684210527153,-0.36930921052629628,-0.58314692982457927,-0.30848684210525334,0.17971491228070136,0.3782894736842195,0.43039473684217455,0.17427631578948422,0.16791666666665606,-0.013059210526250808,-0.076557017543905204,-0.021546052631549628,-0.2576535087719094,-0.16597587719297735,-0.16273026315792549,-0.47015350877194351,0.048881578947430171,-0.17004385964912672,0.078311403508791955,0.27219298245609025,0.19249999999999545,0.62569078947376511,0.15927631578949786,-0.088212719298269349,-0.14765350877189576,-0.26055921052636677,0.025186403508769217,-0.2839035087718571,-0.36653508771922816,-0.1483771929825366,0.30622807017539344,0.11469298245617665,0.75,0.066940789473619589,0.060109649122864539,-0.13154605263162011,-0.034320175438551814,-0.37889254385970617,-0.3764802631578732,-0.018486842105232881,0.31888157894741198,0.17620614035087101,-0.10002192982454972,-0.089057017543836992,0.063750000000027285,-0.0097258771929773502,-0.11864035087717184,0.050120614035051858,0.30234649122809287,0.23069078947366961,0.076436403508751027,-0.46182017543861775,-0.34778508771927363,-0.047127192982429733,0.00039473684211088766,0.33094298245617892,0.12666666666666515,0.47069078947367871,0.087192982456087975,0.0059539473684253608,-0.21723684210530791,0.089024122807018102,-0.27981359649118076,-0.24557017543855864,-0.76570175438598653,-0.46254385964920175,0.31497807017547075,-0.059057017543864276,0.58458333333339851,0.13402412280703402,0.36677631578942282,-0.34571271929826253,-0.17515350877198443,0.019024122807024924,-0.042313596491226235,0.05901315789481032,-0.12653508771927591,0.11828947368417175,0.14581140350873056,0.060109649122807696,0.079166666666708352,-0.32014254385967433,0.11969298245622895,0.20262061403508369,0.57109649122810424,0.047774122807027197,-0.22648026315795278,-0.077653508771845736,-0.074035087719380499,-0.38046052631580096,-0.46252192982456108,-0.055723684210477131,0.025833333333366681,0.30235745614038478,0.3909429824561812,0.4497039473684481,0.018596491228038303,-0.17180921052630538,-0.29148026315789366,-0.38307017543854727,-0.38695175438596152,0.019956140350814167,0.21747807017544574,0.13844298245612663,0.047083333333375776,0.013607456140277918,-0.2423903508772014,0.10178728070172838,0.15192982456136406,-0.21930921052637586,0.076019736842113161,-0.18390350877189121,-0.084868421052647136,-0.19796052631579641,0.40372807017553214,0.13802631578954561,0.54291666666665606,0.024857456140409795,-0.17780701754384154,-0.09154605263159965,-0.12223684210528063,0.08152412280696808,0.19393640350875785,0.16984649122815654,-0.47528508771927136,-0.30462719298242291,-0.19710526315782317,0.1409429824561812,0.30625000000003411,0.47819078947367188,0.22510964912282816,0.15762061403506777,0.21609649122808605,-0.021392543859633406,-0.32856359649122169,-0.89182017543856773,-0.28861842105260394,-0.047127192982486577,0.20747807017545483,0.27635964912286681,-0.05333333333334167,0.23944078947369007,0.15885964912285999,0.20512061403508142,-0.0064035087719389594,0.13402412280709086,-0.61981359649126944,0.089013157894783035,-0.1940350877193282,-0.63837719298254569,-0.30002192982459519,-0.11072368421048395,0.026250000000004547,0.40319078947362641,0.34677631578949786,0.067620614035092785,-0.10557017543862912,0.018190789473692348,-0.24273026315790958,-0.38765350877190485,-0.042368421052572103,0.10453947368415584,0.34164473684217,0.77344298245611753,0.68041666666664469,0.45069078947364005,0.16510964912288273,-0.48237938596491858,-0.71432017543861548,-0.024725877193020551,-0.019813596491303542,-0.0055701754385495406,-0.069451754385966069,-0.2896271929824934,0.074144736842129078,0.28469298245613572,0.076666666666596939,0.16360745614031202,-0.0028070175438301703,-0.080296052631524617,-0.25807017543854727,0.039857456140339309,-0.18023026315790958,-0.13848684210523743,-0.044868421052569829,0.16412280701757709,-0.12502192982452698,0.0046929824561630085,0.2004166666666265,0.054024122806993091,-0.069057017543855181,0.027620614035072322,0.026929824561364057,0.088190789473628683,0.19601973684206087,0.078596491228154264,-0.1644517543860502,-0.10629385964909943,0.042478070175491212,-0.098223684210495321,-0.0095833333334098825,-0.28430921052631675,-0.24614035087722641,-0.12862938596492768,0.031513157894778487,-0.29639254385961067,0.057686403508796502,0.099846491228106515,0.10721491228071045,0.13078947368421723,0.13164473684213363,-0.14280701754387337,0.32791666666656738,-0.065975877193011456,-0.11155701754381653,0.10345394736845037,0.17734649122809287,-0.21389254385957202,0.14185307017544346,0.013179824561404985,-0.34153508771930774,0.10078947368424451,0.16914473684209952,0.26344298245618347,0.045416666666710626,-0.078892543859637954,0.0013596491228327068,-0.19237938596489812,0.058179824561364057,-0.1743092105263031,0.15393640350879423,-0.17015350877193214,-0.17570175438589786,0.1841228070175589,-0.008355263157909576,0.27385964912286909,-0.24708333333336441,-0.26680921052627582,-0.19072368421052488,-0.016546052631611019,0.19734649122801784,-0.25597587719300918,0.55393640350877149,-0.068486842105187407,-0.02653508771925317,0.21745614035091876,0.011228070175434368,-0.024057017543839265,-0.072083333333296196,0.11902412280699082,-0.10572368421043166,-0.20571271929827617,-0.18098684210531246,0.32152412280703402,0.39851973684204722,0.30901315789475348,0.14804824561400665,0.048289473684235418,-0.31668859649118986,-0.42364035087712182,-0.4620833333333394,-0.20389254385963795,0.028859649122864539,0.07762061403508369,0.18526315789472392,0.26819078947369235,0.48143640350872374,0.1044298245614641,0.11138157894737333,-0.07171052631576913,0.081644736842065413,-0.14905701754389611,-0.23958333333342807,-0.23639254385966524,-0.1436403508771491,-0.16737938596492086,-0.3609868421052056,-0.062225877192929602,-0.43231359649121259,0.099429824561411806,0.25846491228060131,0.30662280701756117,0.2920614035087965,0.57635964912282134,-0.31291666666669471,-0.16430921052625536,-0.34405701754371876,0.26012061403514508,-0.071820175438631395,-0.022225877193022825,-0.09523026315793004,0.42651315789470345,0.18054824561403393,0.094956140350802798,0.10747807017548894,-0.054057017543755137,-0.61125000000004093,-0.27680921052626672,0.045109649122878182,0.058037280701739746,-0.21223684210519878,0.046940789473637778,0.56935307017539571,0.20401315789479213,0.17804824561397936,0.070789473684158111,-0.21377192982453153,-0.11530701754384154,0.040833333333296196,-0.1297258771929819,0.024276315789506953,0.13178728070175794,-0.16140350877191167,-0.26389254385969707,-0.25314692982465203,0.16526315789479895,0.22554824561410669,0.1216228070175589,-0.10002192982454972,-0.20155701754384836,0.42499999999995453,-0.19180921052628719,-0.011557017543850634,-0.014879385964889025,0.057346491227974639,-0.31347587719301373,-0.29606359649130809,-0.024736842105255619,0.17054824561404303,0.075789473684153563,-0.33418859649123078,0.083442982456119807,-0.015416666666681067,-0.13430921052628264,-0.064473684210440751,-0.23446271929833529,0.097346491228051946,0.5048574561403143,0.056853070175463927,0.074846491228072409,0.020964912280703629,0.077456140350818714,-0.0041885964911898554,-0.046140350877124092,-0.081250000000011369,0.14735745614041207,0.016359649122819064,0.063870614035067774,0.45234649122812698,-0.0076425438596743334,-0.26023026315800735,0.23692982456140044,-0.084035087719314561,-0.063793859649081242,0.14539473684214954,-0.12655701754380289,-0.34125000000000227,-0.057225877192990993,-0.023640350877201399,-0.0057127192982875385,0.12859649122805195,0.42444078947369235,0.2385197368421359,-0.19223684210521697,0.16929824561407258,-0.22504385964919038,-0.22502192982460656,-0.16197368421052261,-0.4179166666667129,-0.1772258771929387,0.096359649122859992,0.19387061403506323,-0.34098684210528063,-0.071392543859644775,0.46393640350873966,0.67692982456145501,0.84929824561402256,0.34662280701746795,-0.28502192982460883,-0.45697368421053852,-0.59333333333330529,-0.38930921052633494,-0.081140350877205947,0.0055372807017306513,0.0035964912281087891,0.011107456140337035,0.25726973684214727,0.38234649122807696,0.34346491228075138,0.5674561403509415,-0.19585526315790958,-0.20322368421045667,-0.42374999999998408,0.024440789473715085,-0.33905701754389383,-0.24654605263162921,0.10151315789471482,-0.14055921052630538,0.26060307017542073,0.14901315789478531,0.40513157894730512,0.28537280701755208,-0.35002192982454972,-0.48239035087709681,-0.63083333333327118,-0.29805921052627582,-0.26697368421048395,-0.0094627192983125497,0.4969298245613345,0.21485745614029383,0.33560307017540936,0.31859649122810652,0.0742982456140453,-0.1746271929824843,-0.21127192982459064,-0.36530701754384154,-0.3716666666666697,-0.17847587719290914,0.046776315789429646,0.21428728070173975,0.034846491228051946,0.23735745614033021,-0.076063596491223961,0.4331798245614209,0.13054824561402256,0.12703947368419222,0.12497807017547302,-0.43364035087716957,-0.21375000000000455,-0.47972587719294779,0.026776315789504679,-0.086962719298242064,0.20692982456137088,0.58444078947360367,0.44601973684211771,-0.13057017543860638,-0.0507017543859547,0.062456140350946043,0.15289473684219956,-0.023223684210449846,-0.30416666666667425,-0.058059210526323568,-0.21655701754383472,0.17303728070174884,0.049429824561514124,0.1381907894736969,-0.15023026315788002,0.41901315789482396,0.25596491228071727,-0.38504385964910171],"mode":"lines","line":{"color":"#00526d","width":2,"dash":[]},"type":"scatter","marker":{"color":"rgba(214,39,40,1)","line":{"color":"rgba(214,39,40,1)"}},"error_y":{"color":"rgba(214,39,40,1)"},"error_x":{"color":"rgba(214,39,40,1)"},"xaxis":"x4","yaxis":"y4","frame":null}],"layout":{"xaxis":{"domain":[0,1],"automargin":true,"showgrid":false,"range":[1,39.916666666666664],"showline":true,"showticklabels":false,"anchor":"y"},"xaxis2":{"domain":[0,1],"automargin":true,"showgrid":false,"range":[1,39.916666666666664],"showline":true,"showticklabels":false,"anchor":"y2"},"xaxis3":{"domain":[0,1],"automargin":true,"showgrid":false,"range":[1,39.916666666666664],"showline":true,"showticklabels":false,"anchor":"y3"},"xaxis4":{"domain":[0,1],"automargin":true,"showgrid":false,"range":[1,39.916666666666664],"showline":true,"anchor":"y4"},"yaxis4":{"domain":[0,0.23000000000000001],"automargin":true,"title":"Random","showgrid":false,"anchor":"x4"},"yaxis3":{"domain":[0.27000000000000002,0.47999999999999998],"automargin":true,"title":"Seasonal","showgrid":false,"anchor":"x3"},"yaxis2":{"domain":[0.52000000000000002,0.72999999999999998],"automargin":true,"title":"Trend","showgrid":false,"anchor":"x2"},"yaxis":{"domain":[0.77000000000000002,1],"automargin":true,"title":"Observed","showgrid":false,"anchor":"x"},"annotations":[],"shapes":[],"images":[],"margin":{"b":40,"l":60,"t":25,"r":10},"title":"Decomposition of additive time series - ts(co2, frequency = 12)","hovermode":"closest","showlegend":false},"attrs":{"1bd064c155c9":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1bd069d26280":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1bd0ce74597":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"},"1bd04b5bcc5":{"x":{},"y":{},"mode":"lines","line":{"width":2,"dash":null,"color":"#00526d"},"alpha_stroke":1,"sizes":[10,100],"spans":[1,20],"type":"scatter"}},"source":"A","config":{"modeBarButtonsToAdd":["hoverclosest","hovercompare"],"showSendToCloud":false},"highlight":{"on":"plotly_click","persistent":false,"dynamic":false,"selectize":false,"opacityDim":0.20000000000000001,"selected":{"opacity":1},"debounce":0},"subplot":true,".hideLegend":true,"shinyEvents":["plotly_hover","plotly_click","plotly_selected","plotly_relayout","plotly_brushed","plotly_brushing","plotly_clickannotation","plotly_doubleclick","plotly_deselect","plotly_afterplot","plotly_sunburstclick"],"base_url":"https://plot.ly"},"evals":[],"jsHooks":[]}</script>
</div>
</div>
<p>季節性・トレンドの成分をさらに詳しく評価したい場合には、facebook（Meta）の技術者が開発した<a href="https://facebook.github.io/prophet/"><code>prophet</code></a>パッケージを用いるとよいでしょう。<code>prophet</code>は<a href="https://cran.r-project.org/web/packages/rstan/index.html"><code>rstan</code></a>パッケージ<span class="citation" data-cites="rstan_bib">(<a href="references.html#ref-rstan_bib" role="doc-biblioref">Stan Development Team 2023</a>)</span>（もしくは<a href="https://github.com/stan-dev/cmdstanr"><code>cmdstanr</code></a>パッケージ<span class="citation" data-cites="cmdstanr_bib">(<a href="references.html#ref-cmdstanr_bib" role="doc-biblioref">Gabry, Cesnovar, and Johnson 2023</a>)</span>）を用いて時系列を解析するアルゴリズムを使用しています。このアルゴリズムでは、下に説明する状態空間モデルとは少し異なるアプローチ（<a href="https://peerj.com/preprints/3190/#">論文</a>に記載の通り、一般化加法モデル（<a href="./chapter26.html">26章参照</a>）で分析）を取っています。<code>prophet</code>を用いれば、季節性やトレンドの分離、予測、休日の影響やデータの欠測の処理などを比較的簡単に取り扱うことができます。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>prophetパッケージでデータを取り扱う</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(rstan, prophet)</span>
<span id="cb77-2"><a href="#cb77-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-3"><a href="#cb77-3" aria-hidden="true" tabindex="-1"></a>df <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(<span class="st">'https://raw.githubusercontent.com/facebook/prophet/main/examples/example_wp_log_peyton_manning.csv'</span>)</span>
<span id="cb77-4"><a href="#cb77-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-5"><a href="#cb77-5" aria-hidden="true" tabindex="-1"></a><span class="co"># 状態空間モデルの推定（rstanパッケージが必要）</span></span>
<span id="cb77-6"><a href="#cb77-6" aria-hidden="true" tabindex="-1"></a>m <span class="ot">&lt;-</span> <span class="fu">prophet</span>(df) </span>
<span id="cb77-7"><a href="#cb77-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-8"><a href="#cb77-8" aria-hidden="true" tabindex="-1"></a><span class="co"># 未来の365日分のデータフレームを作成</span></span>
<span id="cb77-9"><a href="#cb77-9" aria-hidden="true" tabindex="-1"></a>future <span class="ot">&lt;-</span> <span class="fu">make_future_dataframe</span>(m, <span class="at">periods =</span> <span class="dv">365</span>) </span>
<span id="cb77-10"><a href="#cb77-10" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(future)</span>
<span id="cb77-11"><a href="#cb77-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-12"><a href="#cb77-12" aria-hidden="true" tabindex="-1"></a><span class="co"># predictで将来予測</span></span>
<span id="cb77-13"><a href="#cb77-13" aria-hidden="true" tabindex="-1"></a>forecast <span class="ot">&lt;-</span> <span class="fu">predict</span>(m, future)</span>
<span id="cb77-14"><a href="#cb77-14" aria-hidden="true" tabindex="-1"></a><span class="fu">tail</span>(forecast[<span class="fu">c</span>(<span class="st">'ds'</span>, <span class="st">'yhat'</span>, <span class="st">'yhat_lower'</span>, <span class="st">'yhat_upper'</span>)])</span>
<span id="cb77-15"><a href="#cb77-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-16"><a href="#cb77-16" aria-hidden="true" tabindex="-1"></a><span class="co"># 推定値をプロット</span></span>
<span id="cb77-17"><a href="#cb77-17" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(m, forecast)</span>
<span id="cb77-18"><a href="#cb77-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb77-19"><a href="#cb77-19" aria-hidden="true" tabindex="-1"></a><span class="co"># 季節性、トレンドを分けて表示</span></span>
<span id="cb77-20"><a href="#cb77-20" aria-hidden="true" tabindex="-1"></a><span class="fu">prophet_plot_components</span>(m, forecast)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</div>
</section>
<section id="状態空間モデル" class="level2" data-number="29.15">
<h2 data-number="29.15" class="anchored" data-anchor-id="状態空間モデル"><span class="header-section-number">29.15</span> 状態空間モデル</h2>
<p><strong>状態空間モデル（state space model）</strong>は時系列データや地理空間データの統計に用いられる統計モデルの一つです。状態空間モデルでは、時系列データを以下の図のように、真の値の系列である<strong>状態モデル</strong>と、その真の値を我々が観測したときのばらつきを含む<strong>観測モデル</strong>からなるものであるとします。</p>
<p><a href="./image/state_space.png" class="lightbox" data-gallery="quarto-lightbox-gallery-23"><img src="./image/state_space.png" class="img-fluid"></a></p>
<p>真の値を示す状態モデルでは、時点tの値は時点t-1の値によく似ているとする、AR(1)モデルに似たような構造を持つとします。</p>
<p><span class="math display">\[\mu_{t}=\mu_{t-1}+\epsilon_{t}\]</span> <span class="math display">\[\epsilon_{t} \sim Normal(0, \sigma)\]</span></p>
<p>観測モデルは、状態モデルに観測時に起こるばらつきが含まれるものであるとします。</p>
<p><span class="math display">\[Y_{t}=\mu_{t}+\eta_{t}\]</span> <span class="math display">\[\eta_{t} \sim Normal(0, \sigma)\]</span></p>
<p>我々が観測したデータ、つまり時系列データは、この観測モデルの左辺、Y<sub>t</sub>となります。Y<sub>t</sub>からμ<sub>t</sub>を求めることで観測等のばらつきを取り除いた真の状態の変化を調べようとするのが状態空間モデルの概略です。</p>
<p>この状態空間モデルのいいところは、モデルをある程度自由に決められることです。状態モデルをAR(1)モデルっぽくしてもAR(2)モデルっぽくしても良いですし、切片項や係数を設定しても良いですし、季節性や説明変数の項を追加することもできます。ただし、<code>auto.arima</code>関数のように、「自動的にモデルを選択してくれる」ような手法ではないため、データをよく見て適したモデルを自分で選択する必要があります。また、上に説明したような分析手法よりはるかに計算が複雑で、計算に時間がかかります。</p>
<section id="カルマンフィルタ" class="level3" data-number="29.15.1">
<h3 data-number="29.15.1" class="anchored" data-anchor-id="カルマンフィルタ"><span class="header-section-number">29.15.1</span> カルマンフィルタ</h3>
<p>この状態空間モデルを用いた分析手法の一つが<strong>カルマンフィルタ</strong>です。カルマンフィルタは、GPSのような、時系列データに大きなノイズが乗っているようなデータを取り扱う時に、ノイズの成分を減らして真のシグナル（GPSなら真の位置や方角）を求めるために利用されています。カルマンフィルタは、ノイズを減らす<strong>フィルタリング</strong>、長期的な変動を滑らかな曲線として示すための<strong>平滑化</strong>、将来の変動を予測する<strong>予測</strong>の3つの目的で用いられます。フィルタリング・平滑化・予測ではそれぞれ以下のような変換を行います。</p>
<ul>
<li>フィルタリング：<span class="math inline">\(E(y_{t}|Y_{t})\)</span> 今の値から今の値の代表値を推定</li>
<li>平滑化：<span class="math inline">\(E(y_{t}|Y_{T})\)</span> 測定済みのすべての値から、ある時点の代表値を推定</li>
<li>予測：<span class="math inline">\(E(y_{t}|Y_{t-1})\)</span> 今までの値から次の値を予測</li>
</ul>
<p>E(y<sub>t</sub>)というのが変換後の値、Y<sub>t</sub>はその時点での測定値、Y<sub>T</sub>はその時点までのすべての測定値を指します。したがって、フィルタリング・平滑化・予測を図で示すと以下のようになります。</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><a href="./image/karmanfilter.png" class="lightbox" data-glightbox="description: .lightbox-desc-24" data-gallery="quarto-lightbox-gallery-24" title="図2：カルマルフィルタのイメージ"><img src="./image/karmanfilter.png" class="img-fluid figure-img" alt="図2：カルマルフィルタのイメージ"></a></p>
<figcaption>図2：カルマルフィルタのイメージ</figcaption>
</figure>
</div>
<p>Rでは、<a href="https://cran.r-project.org/web/packages/dlm/index.html"><code>dlm</code></a>パッケージ<span class="citation" data-cites="dlm_bib1 dlm_bib2">(<a href="references.html#ref-dlm_bib1" role="doc-biblioref">Petris 2010</a>; <a href="references.html#ref-dlm_bib2" role="doc-biblioref">Petris, Petrone, and Campagnoli 2009</a>)</span>や<a href="https://cran.r-project.org/web/packages/KFAS/index.html"><code>KFAS</code></a>パッケージ<span class="citation" data-cites="KFAS_bib">(<a href="references.html#ref-KFAS_bib" role="doc-biblioref">Helske 2017</a>)</span>を用いることでカルマンフィルタの計算を行うことができます。以下に<code>dlm</code>パッケージでのカルマンフィルタの例を示します。</p>
<div class="cell">
<div class="code-with-filename">
<div class="code-with-filename-file">
<pre><strong>dlmパッケージでカルマンフィルタ</strong></pre>
</div>
<div class="sourceCode cell-code" id="cb78"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="co"># ?dlm::dlmFilter（dlmFilterのヘルプ）に記載されている使用例</span></span>
<span id="cb78-2"><a href="#cb78-2" aria-hidden="true" tabindex="-1"></a>pacman<span class="sc">::</span><span class="fu">p_load</span>(dlm)</span>
<span id="cb78-3"><a href="#cb78-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-4"><a href="#cb78-4" aria-hidden="true" tabindex="-1"></a>nileBuild <span class="ot">&lt;-</span> <span class="cf">function</span>(par){</span>
<span id="cb78-5"><a href="#cb78-5" aria-hidden="true" tabindex="-1"></a><span class="fu">dlmModPoly</span>(<span class="dv">1</span>, <span class="at">dV =</span> <span class="fu">exp</span>(par[<span class="dv">1</span>]), <span class="at">dW =</span> <span class="fu">exp</span>(par[<span class="dv">2</span>]))</span>
<span id="cb78-6"><a href="#cb78-6" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb78-7"><a href="#cb78-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-8"><a href="#cb78-8" aria-hidden="true" tabindex="-1"></a>nileMLE <span class="ot">&lt;-</span> <span class="fu">dlmMLE</span>(Nile, <span class="fu">rep</span>(<span class="dv">0</span>, <span class="dv">2</span>), nileBuild)</span>
<span id="cb78-9"><a href="#cb78-9" aria-hidden="true" tabindex="-1"></a>nileMod <span class="ot">&lt;-</span> <span class="fu">nileBuild</span>(nileMLE<span class="sc">$</span>par)</span>
<span id="cb78-10"><a href="#cb78-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb78-11"><a href="#cb78-11" aria-hidden="true" tabindex="-1"></a>nileFilt <span class="ot">&lt;-</span> <span class="fu">dlmFilter</span>(Nile, nileMod) <span class="co"># フィルタリング</span></span>
<span id="cb78-12"><a href="#cb78-12" aria-hidden="true" tabindex="-1"></a>nileSmooth <span class="ot">&lt;-</span> <span class="fu">dlmSmooth</span>(nileFilt) <span class="co"># 平滑化</span></span>
<span id="cb78-13"><a href="#cb78-13" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="fu">cbind</span>(Nile, nileFilt<span class="sc">$</span>m[<span class="sc">-</span><span class="dv">1</span>], nileSmooth<span class="sc">$</span>s[<span class="sc">-</span><span class="dv">1</span>]), <span class="at">plot.type =</span> <span class="st">'s'</span>,</span>
<span id="cb78-14"><a href="#cb78-14" aria-hidden="true" tabindex="-1"></a><span class="at">col =</span> <span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>), <span class="at">ylab =</span> <span class="st">"Level"</span>, <span class="at">main =</span> <span class="st">"Nile river"</span>, <span class="at">lwd =</span> <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">2</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><a href="chapter29_files/figure-html/unnamed-chunk-75-1.png" class="lightbox" data-gallery="quarto-lightbox-gallery-25"><img src="chapter29_files/figure-html/unnamed-chunk-75-1.png" class="img-fluid figure-img" width="672"></a></p>
</figure>
</div>
</div>
</div>
<p>カルマンフィルタについては詳しい教科書がたくさんあるので（例えばRでは<a href="https://www.amazon.co.jp/%E3%82%AB%E3%83%AB%E3%83%9E%E3%83%B3%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF-%E2%80%95R%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E6%99%82%E7%B3%BB%E5%88%97%E4%BA%88%E6%B8%AC%E3%81%A8%E7%8A%B6%E6%85%8B%E7%A9%BA%E9%96%93%E3%83%A2%E3%83%87%E3%83%AB%E2%80%95-%E7%B5%B1%E8%A8%88%E5%AD%A6One-Point-2/dp/4320112539/ref=sr_1_4?crid=233OUDUP4SFDE&amp;dib=eyJ2IjoiMSJ9.7-FBe3-RRCTGU8ggjWIe4tvBgUWVWh18GMV2Kl_vI7aYbSmT9ej3GDICdlLMVNb4zvIyc3KzQtSbCb0ZgDIJdak8cG-Pg_OeVY9ma6W_C18ZW2YGZKoSpspId8PqPG1EDkEod9rNwwiStNAKL6WS9vmmXobUFa-YIV-aY97KD_8wHHmS7HMiZGtK0KNqL2MA6JiGwemrlKYX8p3GEF5QeQxLuwowak1BFYzf-jPfm3mpx7ctone_Bn_r47mduTlz9OiLCXHtuFEp1cvrYZ_cMdESsAGAC324M3rRSpHxhA1ZgH5n0-URMBH8iwHQSmLZCZ-zU9cl6_OJKamTHjdhTLVk9Kf2EMNicw9jet-kD1FVZbC7XqDwiJWO_La8iZey0ofUzli1sxNbgQH1liWIiD_8Md78wk0H_FpM7C36N2gs0JUHc0LEOxjpRzaJP8_Y.dln_u6oLODP_bFkzqLIBrFfc_FQuosGBZh3v8_jvOvc&amp;dib_tag=se&amp;keywords=%E3%82%AB%E3%83%AB%E3%83%9E%E3%83%B3%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF&amp;qid=1742085164&amp;sprefix=%E3%82%AB%E3%83%AB%E3%83%9E%E3%83%B3%2Caps%2C181&amp;sr=8-4">この教科書など</a> <span class="citation" data-cites="野村俊一2016-09-08">(<a href="references.html#ref-野村俊一2016-09-08" role="doc-biblioref">野村 2016</a>)</span>）、詳しく学びたい方は教科書を一読されることをおススメいたします。</p>
</section>
<section id="stan" class="level3" data-number="29.15.2">
<h3 data-number="29.15.2" class="anchored" data-anchor-id="stan"><span class="header-section-number">29.15.2</span> Stan</h3>
<p>もっと複雑で自由度の高い状態空間モデルを用いる場合には、<a href="https://mc-stan.org/">Stan</a>という統計モデリングの言語を用いることになります。Rでは上記の<code>prophet</code>の部分で少し紹介した<code>rstan</code>または<code>cmdstanr</code>パッケージを用いて、Stan言語の統計モデルを書き、計算することになります。Stanについては入門として紹介するには複雑すぎるためココには記載しませんが、興味のある方は<a href="https://statmodeling.hatenablog.com/archive">Stanについてのホームページ</a>や<a href="https://www.kyoritsu-pub.co.jp/book/b10003786.html">教科書</a><span class="citation" data-cites="松浦健太郎2016-10-25">(<a href="references.html#ref-松浦健太郎2016-10-25" role="doc-biblioref">松浦 and 石田 2016</a>)</span>を読むことをおすすめします。</p>


<!-- -->

<div class="hidden" aria-hidden="true">
<span class="glightbox-desc lightbox-desc-10">図1：自己相関のイメージ</span>
<span class="glightbox-desc lightbox-desc-24">図2：カルマルフィルタのイメージ</span>
</div>
<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list" style="display: none">
<div id="ref-cmdstanr_bib" class="csl-entry" role="listitem">
Gabry, Jonah, Rok Cesnovar, and Andrew Johnson. 2023. <em>Cmdstanr: R Interface to ’CmdStan’</em>. <a href="https://mc-stan.org/cmdstanr/">https://mc-stan.org/cmdstanr/</a>.
</div>
<div id="ref-KFAS_bib" class="csl-entry" role="listitem">
Helske, Jouni. 2017. <span>“<span>KFAS</span>: Exponential Family State Space Models in <span>R</span>.”</span> <em>Journal of Statistical Software</em> 78 (10): 1–39. <a href="https://doi.org/10.18637/jss.v078.i10">https://doi.org/10.18637/jss.v078.i10</a>.
</div>
<div id="ref-TSstudio_bib" class="csl-entry" role="listitem">
Krispin, Rami. 2023. <em>TSstudio: Functions for Time Series Analysis and Forecasting</em>. <a href="https://CRAN.R-project.org/package=TSstudio">https://CRAN.R-project.org/package=TSstudio</a>.
</div>
<div id="ref-CADFtest_bib" class="csl-entry" role="listitem">
Lupi, Claudio. 2009. <span>“Unit Root CADF Testing with <span>R</span>.”</span> <em>Journal of Statistical Software</em> 32 (2): 20.
</div>
<div id="ref-dlm_bib1" class="csl-entry" role="listitem">
Petris, Giovanni. 2010. <span>“An <span>R</span> Package for Dynamic Linear Models.”</span> <em>Journal of Statistical Software</em> 36 (12): 1–16. <a href="https://www.jstatsoft.org/v36/i12/">https://www.jstatsoft.org/v36/i12/</a>.
</div>
<div id="ref-dlm_bib2" class="csl-entry" role="listitem">
Petris, Giovanni, Sonia Petrone, and Patrizia Campagnoli. 2009. <em>Dynamic Linear Models with r</em>. useR! Springer-Verlag, New York.
</div>
<div id="ref-vars_bib2" class="csl-entry" role="listitem">
Pfaff, B. 2008. <em>Analysis of Integrated and Cointegrated Time Series with r</em>. Second. New York: Springer. <a href="https://www.pfaffikus.de">https://www.pfaffikus.de</a>.
</div>
<div id="ref-vars_bib1" class="csl-entry" role="listitem">
Pfaff, Bernhard. 2008. <span>“VAR, SVAR and SVEC Models: Implementation Within <span>R</span> Package <span class="nocase">vars</span>.”</span> <em>Journal of Statistical Software</em> 27 (4). <a href="https://www.jstatsoft.org/v27/i04/">https://www.jstatsoft.org/v27/i04/</a>.
</div>
<div id="ref-rstan_bib" class="csl-entry" role="listitem">
Stan Development Team. 2023. <span>“<span>RStan</span>: The <span>R</span> Interface to <span>Stan</span>.”</span> <a href="https://mc-stan.org/">https://mc-stan.org/</a>.
</div>
<div id="ref-tseries_bib" class="csl-entry" role="listitem">
Trapletti, Adrian, and Kurt Hornik. 2023. <em>Tseries: Time Series Analysis and Computational Finance</em>. <a href="https://CRAN.R-project.org/package=tseries">https://CRAN.R-project.org/package=tseries</a>.
</div>
<div id="ref-fGarch_bib" class="csl-entry" role="listitem">
Wuertz, Diethelm, Yohan Chalabi, Tobias Setz, Martin Maechler, and Georgi N. Boshnakov. 2023. <em>fGarch: Rmetrics - Autoregressive Conditional Heteroskedastic Modelling</em>. <a href="https://CRAN.R-project.org/package=fGarch">https://CRAN.R-project.org/package=fGarch</a>.
</div>
<div id="ref-zoo_bib" class="csl-entry" role="listitem">
Zeileis, Achim, and Gabor Grothendieck. 2005. <span>“Zoo: S3 Infrastructure for Regular and Irregular Time Series.”</span> <em>Journal of Statistical Software</em> 14 (6): 1–27. <a href="https://doi.org/10.18637/jss.v014.i06">https://doi.org/10.18637/jss.v014.i06</a>.
</div>
<div id="ref-松浦健太郎2016-10-25" class="csl-entry" role="listitem">
松浦健太郎, and 石田基広. 2016. <em>StanとRでベイズ統計モデリング (Wonderful r 2)</em>. Edited by 市川太祐, 高橋康介, 高柳慎一, and 福島真太朗. 単行本. 共立出版. <a href="https://www.amazon.co.jp/dp/4320112423/">https://www.amazon.co.jp/dp/4320112423/</a>.
</div>
<div id="ref-野村俊一2016-09-08" class="csl-entry" role="listitem">
野村俊一. 2016. <em>カルマンフィルタ ーrを使った時系列予測と状態空間モデルー (統計学One Point 2)</em>. 単行本. 共立出版. <a href="https://lead.to/amazon/jp/?op=bt&amp;la=ja&amp;key=4320112539">https://lead.to/amazon/jp/?op=bt&amp;la=ja&amp;key=4320112539</a>.
</div>
</div>
</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./chapter28.html" class="pagination-link" aria-label="教師なし学習">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">28</span>&nbsp; <span class="chapter-title">教師なし学習</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./chapter30.html" class="pagination-link" aria-label="生存時間解析">
        <span class="nav-page-text"><span class="chapter-number">30</span>&nbsp; <span class="chapter-title">生存時間解析</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb79" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># 時系列分析</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, setup, include=FALSE, echo=FALSE}</span></span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a><span class="in">knitr::opts_chunk$set(</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a><span class="in">  collapse = TRUE</span></span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a><span class="in">)</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-8"><a href="#cb79-8" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tidyverse, lubridate, zoo, CADFtest, TSstudio, forecast)</span></span>
<span id="cb79-9"><a href="#cb79-9" aria-hidden="true" tabindex="-1"></a><span class="in">set.seed(0)</span></span>
<span id="cb79-10"><a href="#cb79-10" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-11"><a href="#cb79-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-12"><a href="#cb79-12" aria-hidden="true" tabindex="-1"></a>**時系列**とは、<span class="co">[</span><span class="ot">17章</span><span class="co">](./chapter17.html)</span>で少し説明した通り、時間と共に変化する量を繰り返し測定したデータのことです。例えば、日経平均株価の推移は典型的な時系列の例です。Rでは、以下に示す<span class="in">`Nile`</span>データセットが時系列の例としてよく用いられています。</span>
<span id="cb79-13"><a href="#cb79-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-14"><a href="#cb79-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="時系列データの例：Nileデータセット"}</span></span>
<span id="cb79-15"><a href="#cb79-15" aria-hidden="true" tabindex="-1"></a><span class="in">Nile |&gt; plot()</span></span>
<span id="cb79-16"><a href="#cb79-16" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-17"><a href="#cb79-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-18"><a href="#cb79-18" aria-hidden="true" tabindex="-1"></a><span class="in">`Nile`</span>はナイル川の水量を1871～1970年にかけて測定したデータです。各時点（各年）には、その時点の数値が登録されています。<span class="in">`Nile`</span>では時間間隔は1年おきと一定で、取得されたデータは1種類（ナイル川の水量）です。</span>
<span id="cb79-19"><a href="#cb79-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-20"><a href="#cb79-20" aria-hidden="true" tabindex="-1"></a>時系列データは<span class="in">`Nile`</span>のように時間間隔が一定で1種類のデータとなる場合が多いです。ただし、時間間隔が一定ではない場合や、データの抜けがある場合（休業時間帯や休日などでデータが取れなかったりする場合）、目的とするデータ（目的変数）だけでなく、目的変数を説明するためのデータ（説明変数）を含んでいる場合もあります。このような違いがあっても、いずれも時系列データとして取り扱われます。</span>
<span id="cb79-21"><a href="#cb79-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-22"><a href="#cb79-22" aria-hidden="true" tabindex="-1"></a>このような時系列データを取り扱い、分析する統計方法のことを、**時系列分析**と呼びます。時系列分析には時系列分析のみを取り扱う教科書がたくさん出ており、ココですべてを説明することはできません。説明は基礎の要点のみとし、Rでの統計手法の利用方法の説明にとどめます。</span>
<span id="cb79-23"><a href="#cb79-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-24"><a href="#cb79-24" aria-hidden="true" tabindex="-1"></a>まずは、典型的な時系列データの例として、**ホワイトノイズ**と**ランダムウォーク**について説明します。</span>
<span id="cb79-25"><a href="#cb79-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-26"><a href="#cb79-26" aria-hidden="true" tabindex="-1"></a><span class="fu">## ホワイトノイズ</span></span>
<span id="cb79-27"><a href="#cb79-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-28"><a href="#cb79-28" aria-hidden="true" tabindex="-1"></a>測定したすべての期間の平均値が一定で、一定の分散（標準偏差、ばらつき）を持つ時系列データのことを、**ホワイトノイズ**と呼びます。典型的なホワイトノイズの例はラジオやテレビのノイズです。ホワイトノイズを数式で表すと以下のようになります。</span>
<span id="cb79-29"><a href="#cb79-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-30"><a href="#cb79-30" aria-hidden="true" tabindex="-1"></a>$$y_{t}=c+\epsilon_{t}$$</span>
<span id="cb79-31"><a href="#cb79-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-32"><a href="#cb79-32" aria-hidden="true" tabindex="-1"></a>y~t~は時点tにおける値、cは切片、ε~t~は下に示すように、平均0、標準偏差σの正規分布に従う誤差項です。cが0であれば、y~t~は平均0、標準偏差σの正規分布に従うランダムな値となります。</span>
<span id="cb79-33"><a href="#cb79-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-34"><a href="#cb79-34" aria-hidden="true" tabindex="-1"></a>$$\epsilon_{t} \sim Normal(0, \sigma) $$</span>
<span id="cb79-35"><a href="#cb79-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-36"><a href="#cb79-36" aria-hidden="true" tabindex="-1"></a>ホワイトノイズをグラフで示したものが以下の図です。時間<span class="in">`t`</span>に伴い<span class="in">`y`</span>の値は上下に揺れますが、平均すると概ね一定で、ばらつきの幅も一定となります。</span>
<span id="cb79-37"><a href="#cb79-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-38"><a href="#cb79-38" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ホワイトノイズ"}</span></span>
<span id="cb79-39"><a href="#cb79-39" aria-hidden="true" tabindex="-1"></a><span class="in">t &lt;- seq(1:200)</span></span>
<span id="cb79-40"><a href="#cb79-40" aria-hidden="true" tabindex="-1"></a><span class="in">y &lt;- rnorm(200, 0, 0.5)</span></span>
<span id="cb79-41"><a href="#cb79-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-42"><a href="#cb79-42" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(</span></span>
<span id="cb79-43"><a href="#cb79-43" aria-hidden="true" tabindex="-1"></a><span class="in">  data.frame(t, y),</span></span>
<span id="cb79-44"><a href="#cb79-44" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(x = t, y = y)</span></span>
<span id="cb79-45"><a href="#cb79-45" aria-hidden="true" tabindex="-1"></a><span class="in">)+</span></span>
<span id="cb79-46"><a href="#cb79-46" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-47"><a href="#cb79-47" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)</span></span>
<span id="cb79-48"><a href="#cb79-48" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-49"><a href="#cb79-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-50"><a href="#cb79-50" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォーク</span></span>
<span id="cb79-51"><a href="#cb79-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-52"><a href="#cb79-52" aria-hidden="true" tabindex="-1"></a>上に示したε~t~を時間tまで合計し、切片項cを足したものを**ランダムウォーク**と呼びます。ランダムウォークはその名の通り、上にふらふら、下にふらふら移動する、予想のつきにくい変動をする時系列データです。ランダムウォークの時系列は以下の式で表すことができます。</span>
<span id="cb79-53"><a href="#cb79-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-54"><a href="#cb79-54" aria-hidden="true" tabindex="-1"></a>$$y_{t}=c+\sum_{i=1}^{t} \epsilon_{i}$$</span>
<span id="cb79-55"><a href="#cb79-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-56"><a href="#cb79-56" aria-hidden="true" tabindex="-1"></a>ランダムウォークは時点tと時点t-1の値の**差分系列**（1階差分、$y_{t}-y_{t-1}$）を取ると、ε~t~、つまりホワイトノイズになるという性質を持ちます。</span>
<span id="cb79-57"><a href="#cb79-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-58"><a href="#cb79-58" aria-hidden="true" tabindex="-1"></a>$$y_{t} - y_{t-1}=\epsilon_{t}$$</span>
<span id="cb79-59"><a href="#cb79-59" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-60"><a href="#cb79-60" aria-hidden="true" tabindex="-1"></a>ランダムウォークをグラフで示したものが以下の図です。値が上下にギザギザと動くだけでなく、時に大きく値が変動します。ランダムウォークでは平均値が一定とならず、分散も一定とはなりません。株価や為替変動などが典型的なランダムウォークの時系列データの例です。</span>
<span id="cb79-61"><a href="#cb79-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-62"><a href="#cb79-62" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ランダムウォーク"}</span></span>
<span id="cb79-63"><a href="#cb79-63" aria-hidden="true" tabindex="-1"></a><span class="in">y1 &lt;- NULL</span></span>
<span id="cb79-64"><a href="#cb79-64" aria-hidden="true" tabindex="-1"></a><span class="in">temp &lt;- 0</span></span>
<span id="cb79-65"><a href="#cb79-65" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:200){</span></span>
<span id="cb79-66"><a href="#cb79-66" aria-hidden="true" tabindex="-1"></a><span class="in">  temp &lt;- temp + y[i]</span></span>
<span id="cb79-67"><a href="#cb79-67" aria-hidden="true" tabindex="-1"></a><span class="in">  y1 &lt;- c(y1, temp)</span></span>
<span id="cb79-68"><a href="#cb79-68" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb79-69"><a href="#cb79-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-70"><a href="#cb79-70" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(</span></span>
<span id="cb79-71"><a href="#cb79-71" aria-hidden="true" tabindex="-1"></a><span class="in">  data.frame(t, y1),</span></span>
<span id="cb79-72"><a href="#cb79-72" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(x = t, y = y1)</span></span>
<span id="cb79-73"><a href="#cb79-73" aria-hidden="true" tabindex="-1"></a><span class="in">)+</span></span>
<span id="cb79-74"><a href="#cb79-74" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-75"><a href="#cb79-75" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)</span></span>
<span id="cb79-76"><a href="#cb79-76" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-77"><a href="#cb79-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-78"><a href="#cb79-78" aria-hidden="true" tabindex="-1"></a><span class="fu">## 季節性</span></span>
<span id="cb79-79"><a href="#cb79-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-80"><a href="#cb79-80" aria-hidden="true" tabindex="-1"></a>時系列には、一定の周期ごとに値が似ている場合があります。例えば、アイスクリームの売上には夏に高く、冬に低いような周期があります。このような周期性のことを、**季節性**と呼びます。季節性には色々な形のものがあり、年次の周期（4半期周期や12ヶ月周期）、週の周期（曜日ごとの周期）などがあります。季節性のあるデータは、ランダムなばらつきを持ちつつ、ある周期で上下する、以下の図のような変動を持ちます。</span>
<span id="cb79-81"><a href="#cb79-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-82"><a href="#cb79-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="季節性", warning=FALSE}</span></span>
<span id="cb79-83"><a href="#cb79-83" aria-hidden="true" tabindex="-1"></a><span class="in"># 季節性ありのデータ</span></span>
<span id="cb79-84"><a href="#cb79-84" aria-hidden="true" tabindex="-1"></a><span class="in">ys &lt;- y + rep(c(0, 0.5, 1.5, 2.5, 3, 2.5, 1.5, 0.5, 0, 0, 0, 0), 10)</span></span>
<span id="cb79-85"><a href="#cb79-85" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(</span></span>
<span id="cb79-86"><a href="#cb79-86" aria-hidden="true" tabindex="-1"></a><span class="in">  data.frame(t, ys),</span></span>
<span id="cb79-87"><a href="#cb79-87" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(x = t, y = ys)</span></span>
<span id="cb79-88"><a href="#cb79-88" aria-hidden="true" tabindex="-1"></a><span class="in">)+</span></span>
<span id="cb79-89"><a href="#cb79-89" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-90"><a href="#cb79-90" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)</span></span>
<span id="cb79-91"><a href="#cb79-91" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-92"><a href="#cb79-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-93"><a href="#cb79-93" aria-hidden="true" tabindex="-1"></a><span class="fu">## トレンド</span></span>
<span id="cb79-94"><a href="#cb79-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-95"><a href="#cb79-95" aria-hidden="true" tabindex="-1"></a>時系列データには、時間とともに徐々に値が大きくなったり小さくなったりするものがあります。例えば、<span class="co">[</span><span class="ot">ダウ平均株価</span><span class="co">](https://www.kaggle.com/datasets/mnassrib/dow-jones-industrial-average)</span>を2000年ぐらいから調べると、下の図のようにその値が徐々に大きくなっていることがわかるかと思います。このような、時間とともに徐々に上昇・下降していくような傾向のことを**トレンド**と呼びます。</span>
<span id="cb79-96"><a href="#cb79-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-97"><a href="#cb79-97" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="トレンドを持つデータ：ダウ平均株価の推移"}</span></span>
<span id="cb79-98"><a href="#cb79-98" aria-hidden="true" tabindex="-1"></a><span class="in"># kaggleよりデータを取得</span></span>
<span id="cb79-99"><a href="#cb79-99" aria-hidden="true" tabindex="-1"></a><span class="in">#（https://www.kaggle.com/datasets/mnassrib/dow-jones-industrial-average）</span></span>
<span id="cb79-100"><a href="#cb79-100" aria-hidden="true" tabindex="-1"></a><span class="in">djm &lt;- read_csv("./data/Dow Jones Industrial Average Historical Data.csv")</span></span>
<span id="cb79-101"><a href="#cb79-101" aria-hidden="true" tabindex="-1"></a><span class="in">djm$Date &lt;- lubridate::mdy(djm$Date)</span></span>
<span id="cb79-102"><a href="#cb79-102" aria-hidden="true" tabindex="-1"></a><span class="in">djm$Price &lt;- djm$Price |&gt; str_remove_all(",") |&gt; as.numeric()</span></span>
<span id="cb79-103"><a href="#cb79-103" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(djm, aes(x = Date, y = Price))+</span></span>
<span id="cb79-104"><a href="#cb79-104" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5)</span></span>
<span id="cb79-105"><a href="#cb79-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-106"><a href="#cb79-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-107"><a href="#cb79-107" aria-hidden="true" tabindex="-1"></a>トレンドを持つデータは、季節性やホワイトノイズに時間とともに変化するような関数を足し合わせたような形を持つ、以下のようなデータとなります。</span>
<span id="cb79-108"><a href="#cb79-108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-109"><a href="#cb79-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="トレンド"}</span></span>
<span id="cb79-110"><a href="#cb79-110" aria-hidden="true" tabindex="-1"></a><span class="in">yt &lt;- ys + t * 0.1</span></span>
<span id="cb79-111"><a href="#cb79-111" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(</span></span>
<span id="cb79-112"><a href="#cb79-112" aria-hidden="true" tabindex="-1"></a><span class="in">  data.frame(t, yt),</span></span>
<span id="cb79-113"><a href="#cb79-113" aria-hidden="true" tabindex="-1"></a><span class="in">  aes(x = t, y = yt)</span></span>
<span id="cb79-114"><a href="#cb79-114" aria-hidden="true" tabindex="-1"></a><span class="in">)+</span></span>
<span id="cb79-115"><a href="#cb79-115" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-116"><a href="#cb79-116" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)</span></span>
<span id="cb79-117"><a href="#cb79-117" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-118"><a href="#cb79-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-119"><a href="#cb79-119" aria-hidden="true" tabindex="-1"></a><span class="fu">### TSstudioパッケージで季節性・トレンドを図示</span></span>
<span id="cb79-120"><a href="#cb79-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-121"><a href="#cb79-121" aria-hidden="true" tabindex="-1"></a>季節性とトレンドを持つデータの例としては、大気中二酸化炭素（CO~2~）濃度の変化があります。</span>
<span id="cb79-122"><a href="#cb79-122" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-123"><a href="#cb79-123" aria-hidden="true" tabindex="-1"></a>1950年頃からマウナロア（ハワイの活火山）で大気中CO~2~濃度が<span class="co">[</span><span class="ot">データとして取得</span><span class="co">](https://gml.noaa.gov/ccgg/trends/weekly.html)</span>されており、Rでは<span class="in">`co2`</span>データセットとして登録されています。<span class="in">`co2`</span>は1959～1997年の毎月のCO~2~濃度を記録したデータセットで、単位はppm（μmol/mol）です。</span>
<span id="cb79-124"><a href="#cb79-124" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-125"><a href="#cb79-125" aria-hidden="true" tabindex="-1"></a>大気中のCO~2~濃度は、北半球の夏に合わせて減少し、冬に合わせて増加する傾向があります（実際には少し遅れて、10月頃に最小、5月頃に最大となります）。これは、北半球の針葉樹林（タイガ）のCO~2~吸収量が夏季に大きく、冬季に小さくなるためです。また、CO~2~濃度は化石燃料の消費と共に増加しており、20世紀末で360ppm、2023年時点では420ppm程度になっています。1960～2000年の伸びが50ppm程度ですので、CO~2~の増加が倍程度に加速していることがわかります。この「夏季に低く冬季に高い」傾向が季節性、「化石燃料の消費と共に増加」の部分がトレンドに当たります。</span>
<span id="cb79-126"><a href="#cb79-126" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-127"><a href="#cb79-127" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">`TSstudio`</span><span class="co">](https://ramikrispin.github.io/TSstudio/)</span>パッケージ<span class="co">[</span><span class="ot">@TSstudio_bib</span><span class="co">]</span>は時系列データを<span class="in">`plotly`</span>を用いてグラフにする関数を備えたライブラリです。<span class="in">`ts_plot`</span>関数は時系列をそのままプロットする、<span class="in">`ts_seasonal`</span>関数は季節ごとの値を、<span class="in">`ts_heatmap`</span>は年と月の季節性をそれぞれヒートマップとして表示する関数です。いずれも季節性やトレンドを持つデータをグラフにする、データの傾向を捉える場合に便利な関数です。いずれも<span class="co">[</span><span class="ot">17章</span><span class="co">](./chapter17.html)</span>で紹介した<span class="in">`ts`</span>クラスの時系列データを引数に取ります。</span>
<span id="cb79-128"><a href="#cb79-128" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-129"><a href="#cb79-129" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="co2データセット：TSstudioの関数で季節性データを表示", message=FALSE, warning=FALSE}</span></span>
<span id="cb79-130"><a href="#cb79-130" aria-hidden="true" tabindex="-1"></a><span class="in">co2 |&gt; class() # tsクラスのオブジェクト</span></span>
<span id="cb79-131"><a href="#cb79-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-132"><a href="#cb79-132" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(TSstudio)</span></span>
<span id="cb79-133"><a href="#cb79-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-134"><a href="#cb79-134" aria-hidden="true" tabindex="-1"></a><span class="in">co2 |&gt; ts_plot() # 時系列をplotlyでプロット</span></span>
<span id="cb79-135"><a href="#cb79-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-136"><a href="#cb79-136" aria-hidden="true" tabindex="-1"></a><span class="in">co2 |&gt; ts_seasonal() # 時系列を季節で分離してグラフ化</span></span>
<span id="cb79-137"><a href="#cb79-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-138"><a href="#cb79-138" aria-hidden="true" tabindex="-1"></a><span class="in">co2 |&gt; ts_heatmap() # 時系列をヒートマップで表示</span></span>
<span id="cb79-139"><a href="#cb79-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-140"><a href="#cb79-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-141"><a href="#cb79-141" aria-hidden="true" tabindex="-1"></a><span class="fu">## 定常性</span></span>
<span id="cb79-142"><a href="#cb79-142" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-143"><a href="#cb79-143" aria-hidden="true" tabindex="-1"></a>ここまでにホワイトノイズ、ランダムウォーク、季節性、トレンドと4つの時系列の要素について説明しました。多くの時系列データは、この4つが様々なバランスで合わさったような形をしています。</span>
<span id="cb79-144"><a href="#cb79-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-145"><a href="#cb79-145" aria-hidden="true" tabindex="-1"></a>$$時系列データ=ノイズ+季節性+トレンド+(ランダムウォーク)$$</span>
<span id="cb79-146"><a href="#cb79-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-147"><a href="#cb79-147" aria-hidden="true" tabindex="-1"></a>このような時系列データを統計的に適切に取り扱えればいいのですが、時系列を解析する最も基本的な統計の枠組み（ARIMAモデル）では、基本的には**定常性**という特徴を持つデータを取り扱うこととなっており、この定常性を持たないデータは統計的に取り扱いにくいとされています。</span>
<span id="cb79-148"><a href="#cb79-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-149"><a href="#cb79-149" aria-hidden="true" tabindex="-1"></a>定常性とは、時系列データをある時間間隔で切り取ったとき、**どの時期を切り取っても値の平均値と分散（ばらつき）がおおむね一定**であることを指します。</span>
<span id="cb79-150"><a href="#cb79-150" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-151"><a href="#cb79-151" aria-hidden="true" tabindex="-1"></a>ホワイトノイズは乱数の系列ですので、どの時間でも平均値は一定で、分散も一定となります。したがって、ホワイトノイズは定常過程となります。一方で、ランダムウォークやトレンドを持つデータは、平均値が移動するため定常では無い時系列データ、つまり非定常過程となります。季節性に関しては、ある程度長めの系列では平均値と分散は一定ですが、短い期間で切ると平均値と分散が上下する、非定常過程となります。</span>
<span id="cb79-152"><a href="#cb79-152" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-153"><a href="#cb79-153" aria-hidden="true" tabindex="-1"></a><span class="fu">## 自己回帰（AR）モデル</span></span>
<span id="cb79-154"><a href="#cb79-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-155"><a href="#cb79-155" aria-hidden="true" tabindex="-1"></a>**自己回帰（Auto regression、AR）**とは、簡単に説明すると、**時点tの値がそれ以前の値（時点t-1や時点t-2）によく似ている**、という性質を持つ時系列データのことを指します。数式で書くと、AR(p)モデルは以下のような形で書くことができます。</span>
<span id="cb79-156"><a href="#cb79-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-157"><a href="#cb79-157" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\alpha_{1} \cdot y_{t-1}+\alpha_{2} \cdot y_{t-2}+ \cdots \alpha_{p} \cdot y_{t-p}+\epsilon_{t}$$</span>
<span id="cb79-158"><a href="#cb79-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-159"><a href="#cb79-159" aria-hidden="true" tabindex="-1"></a>AR(p)のpを**次数（order）**と呼びます。AR(1)モデルであれば、$\alpha_{1} \cdot y_{t-1}$のみ、AR(2)モデルでは$\alpha_{1} \cdot y_{t-1}+\alpha_{2} \cdot y_{t-2}$となります。αは係数です。AR(1)モデルで、かつα~1~が1である場合には、以下のようにランダムウォークとなります。</span>
<span id="cb79-160"><a href="#cb79-160" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-161"><a href="#cb79-161" aria-hidden="true" tabindex="-1"></a>$$y_{t} =1 \cdot y_{t-1}+\epsilon_{t}$$</span>
<span id="cb79-162"><a href="#cb79-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-163"><a href="#cb79-163" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-164"><a href="#cb79-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-165"><a href="#cb79-165" aria-hidden="true" tabindex="-1"></a><span class="fu">## 時系列データの生成：arima.sim関数について</span></span>
<span id="cb79-166"><a href="#cb79-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-167"><a href="#cb79-167" aria-hidden="true" tabindex="-1"></a><span class="in">`arima.sim`</span>関数は、後に説明するARモデル、MAモデル、和分（I）を用いてシミュレーションした時系列データを生成する関数です。AR、I、MAの次数を<span class="in">`order`</span>、AR、MAの係数を<span class="in">`ar`</span>、<span class="in">`ma`</span>として、以下のようにリストで引数<span class="in">`model`</span>に与えることで、時系列データを生成することができます。また、時系列の長さは引数<span class="in">`n`</span>に指定します。以下の例では、AR(2)、I(0)、MA(0)のモデルで、ARの係数が<span class="in">`0.5`</span>、<span class="in">`0.5`</span>の場合の時系列データ200時点分を生成しています。</span>
<span id="cb79-168"><a href="#cb79-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-169"><a href="#cb79-169" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="arima.sim関数", eval=FALSE}</span></span>
<span id="cb79-170"><a href="#cb79-170" aria-hidden="true" tabindex="-1"></a><span class="in">arima.sim(model = list(order = c(2, 0, 0), ar = c(0.5, 0.5)), n = 200)</span></span>
<span id="cb79-171"><a href="#cb79-171" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-172"><a href="#cb79-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-173"><a href="#cb79-173" aria-hidden="true" tabindex="-1"></a>ただし、この関数では定常過程となるARの係数を指定する必要があります（定常過程とならない係数を指定した場合にはエラーが出ます）。MAは常に定常過程なので、様々な係数を設定することができます。定常過程となる条件は以下の計算式（特性方程式の解が1以上であることの判定式）が<span class="in">`TRUE`</span>となることです。</span>
<span id="cb79-174"><a href="#cb79-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-175"><a href="#cb79-175" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ARの係数から定常過程であるか判定する"}</span></span>
<span id="cb79-176"><a href="#cb79-176" aria-hidden="true" tabindex="-1"></a><span class="in">ar &lt;- c(0.2, 0.2, 0.5) # ARの係数のベクター</span></span>
<span id="cb79-177"><a href="#cb79-177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-178"><a href="#cb79-178" aria-hidden="true" tabindex="-1"></a><span class="in"># ARの係数が定常過程となるかどうかの判定（FALSEなら非定常）</span></span>
<span id="cb79-179"><a href="#cb79-179" aria-hidden="true" tabindex="-1"></a><span class="in">min(Mod(polyroot(c(1, -ar)))) &gt; 1</span></span>
<span id="cb79-180"><a href="#cb79-180" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-181"><a href="#cb79-181" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-182"><a href="#cb79-182" aria-hidden="true" tabindex="-1"></a>以下のAR、MAの例では、この<span class="in">`arima.sim`</span>関数を用いてAR、MAの時系列を生成しています。</span>
<span id="cb79-183"><a href="#cb79-183" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-184"><a href="#cb79-184" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-185"><a href="#cb79-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-186"><a href="#cb79-186" aria-hidden="true" tabindex="-1"></a>ARモデルの例として、AR(1)モデル、AR(2)モデル、AR(3)モデルの時系列をそれぞれ以下に図示します。</span>
<span id="cb79-187"><a href="#cb79-187" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-188"><a href="#cb79-188" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb79-189"><a href="#cb79-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-190"><a href="#cb79-190" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(1)モデル</span></span>
<span id="cb79-191"><a href="#cb79-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-192"><a href="#cb79-192" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\alpha_{1} \cdot y_{t-1}+\epsilon_{t}$$</span>
<span id="cb79-193"><a href="#cb79-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-194"><a href="#cb79-194" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="AR(1)に従うモデル"}</span></span>
<span id="cb79-195"><a href="#cb79-195" aria-hidden="true" tabindex="-1"></a><span class="in">y1a &lt;- arima.sim(model = list(order = c(1, 0, 0), ar = 0.6), 200)</span></span>
<span id="cb79-196"><a href="#cb79-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-197"><a href="#cb79-197" aria-hidden="true" tabindex="-1"></a><span class="in">plot(y1a)</span></span>
<span id="cb79-198"><a href="#cb79-198" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-199"><a href="#cb79-199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-200"><a href="#cb79-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-201"><a href="#cb79-201" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(2)モデル</span></span>
<span id="cb79-202"><a href="#cb79-202" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-203"><a href="#cb79-203" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\alpha_{2} \cdot y_{t-2} +  \alpha_{1} \cdot y_{t-1} + \epsilon_{t}$$</span>
<span id="cb79-204"><a href="#cb79-204" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-205"><a href="#cb79-205" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="AR(2)に従うモデル"}</span></span>
<span id="cb79-206"><a href="#cb79-206" aria-hidden="true" tabindex="-1"></a><span class="in">y2 &lt;- arima.sim(model = list(order = c(2, 0, 0), ar = c(0.1, 0.6)), 200)</span></span>
<span id="cb79-207"><a href="#cb79-207" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-208"><a href="#cb79-208" aria-hidden="true" tabindex="-1"></a><span class="in">plot(y2)</span></span>
<span id="cb79-209"><a href="#cb79-209" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-210"><a href="#cb79-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-211"><a href="#cb79-211" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(3)モデル</span></span>
<span id="cb79-212"><a href="#cb79-212" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-213"><a href="#cb79-213" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\alpha_{3} \cdot y_{t-3} + \alpha_{2} \cdot y_{t-2} + \alpha_{1} \cdot y_{t-1} + \epsilon_{t}$$</span>
<span id="cb79-214"><a href="#cb79-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-215"><a href="#cb79-215" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="AR(3)に従うモデル"}</span></span>
<span id="cb79-216"><a href="#cb79-216" aria-hidden="true" tabindex="-1"></a><span class="in">y3 &lt;- arima.sim(model = list(order = c(3, 0, 0), ar = c(0.1, 0.1, 0.6)), 200)</span></span>
<span id="cb79-217"><a href="#cb79-217" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-218"><a href="#cb79-218" aria-hidden="true" tabindex="-1"></a><span class="in">plot(y3)</span></span>
<span id="cb79-219"><a href="#cb79-219" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-220"><a href="#cb79-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-221"><a href="#cb79-221" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-222"><a href="#cb79-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-223"><a href="#cb79-223" aria-hidden="true" tabindex="-1"></a><span class="fu">## 自己相関と偏自己相関</span></span>
<span id="cb79-224"><a href="#cb79-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-225"><a href="#cb79-225" aria-hidden="true" tabindex="-1"></a>ARモデルは、時間tの値とそれ以前の値がよく似ている時系列です。この「よく似ている」度合いを評価するためのものが、**自己相関**と**偏自己相関**です。</span>
<span id="cb79-226"><a href="#cb79-226" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-227"><a href="#cb79-227" aria-hidden="true" tabindex="-1"></a>**自己相関**とは、時系列の値y~t~とp時点前の値y~t-p~の値の相関のことを指します。pには整数が入り、pのことをラグ（log）と呼びます。</span>
<span id="cb79-228"><a href="#cb79-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-229"><a href="#cb79-229" aria-hidden="true" tabindex="-1"></a><span class="al">![図1：自己相関のイメージ](./image/autocorrelation.png)</span></span>
<span id="cb79-230"><a href="#cb79-230" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-231"><a href="#cb79-231" aria-hidden="true" tabindex="-1"></a>自己相関は、Rでは以下のように計算することができます。</span>
<span id="cb79-232"><a href="#cb79-232" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-233"><a href="#cb79-233" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="自己相関の計算"}</span></span>
<span id="cb79-234"><a href="#cb79-234" aria-hidden="true" tabindex="-1"></a><span class="in"># y1はランダムウォークのデータ</span></span>
<span id="cb79-235"><a href="#cb79-235" aria-hidden="true" tabindex="-1"></a><span class="in">head(y1)</span></span>
<span id="cb79-236"><a href="#cb79-236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-237"><a href="#cb79-237" aria-hidden="true" tabindex="-1"></a><span class="in"># p = 1のとき</span></span>
<span id="cb79-238"><a href="#cb79-238" aria-hidden="true" tabindex="-1"></a><span class="in">cor(y1[1:199], y1[2:200])</span></span>
<span id="cb79-239"><a href="#cb79-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-240"><a href="#cb79-240" aria-hidden="true" tabindex="-1"></a><span class="in"># p = 2のとき</span></span>
<span id="cb79-241"><a href="#cb79-241" aria-hidden="true" tabindex="-1"></a><span class="in">cor(y1[1:198], y1[3:200])</span></span>
<span id="cb79-242"><a href="#cb79-242" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-243"><a href="#cb79-243" aria-hidden="true" tabindex="-1"></a><span class="in"># p = 3のとき</span></span>
<span id="cb79-244"><a href="#cb79-244" aria-hidden="true" tabindex="-1"></a><span class="in">cor(y1[1:197], y1[4:200])</span></span>
<span id="cb79-245"><a href="#cb79-245" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-246"><a href="#cb79-246" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-247"><a href="#cb79-247" aria-hidden="true" tabindex="-1"></a>上のスクリプトで用いている時系列はランダムウォークですが、ランダムウォークではpが大きくなると少しずつ自己相関が小さくなっていく傾向があります。これは、以下の式のように、時点tの値は時点t-1の値で、時点t-1の値は時点t-2の値で説明できることから、時点tの値は時点t-2の値にも依存するためです。</span>
<span id="cb79-248"><a href="#cb79-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-249"><a href="#cb79-249" aria-hidden="true" tabindex="-1"></a>$$y_{t} =1 \cdot y_{t-1}+\epsilon_{t}$$</span>
<span id="cb79-250"><a href="#cb79-250" aria-hidden="true" tabindex="-1"></a>$$y_{t-1} =1 \cdot y_{t-2}+\epsilon_{t-1}$$</span>
<span id="cb79-251"><a href="#cb79-251" aria-hidden="true" tabindex="-1"></a>$$y_{t} =1 \cdot y_{t-2}+\epsilon_{t}+\epsilon_{t-1}$$</span>
<span id="cb79-252"><a href="#cb79-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-253"><a href="#cb79-253" aria-hidden="true" tabindex="-1"></a>ただし、ランダムウォークでは1段階差の相関が最も重要です。このような、1段階差が似ているために2段階差以降にも自己相関が出てしまうような効果を取り除いたものを**偏自己相関**と呼びます。偏自己相関は自己相関ほどには簡単に求まりませんが、時系列が以前のどの時点とよく似ているのかを調べるのに有用です。</span>
<span id="cb79-254"><a href="#cb79-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-255"><a href="#cb79-255" aria-hidden="true" tabindex="-1"></a><span class="fu">### acf、pacf関数</span></span>
<span id="cb79-256"><a href="#cb79-256" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-257"><a href="#cb79-257" aria-hidden="true" tabindex="-1"></a>上記のように<span class="in">`cor`</span>関数を用いれば自己相関は求まりますが、各時点の自己相関・偏自己相関をいちいち<span class="in">`cor`</span>関数で計算するのは大変です。</span>
<span id="cb79-258"><a href="#cb79-258" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-259"><a href="#cb79-259" aria-hidden="true" tabindex="-1"></a>Rには、自己相関・偏自己相関を計算する関数として、<span class="in">`acf`</span>関数と<span class="in">`pacf`</span>関数が備わっています。いずれも時系列データを引数に取り、自己相関・偏自己相関の値を返す関数です。ただし、デフォルトでは<span class="in">`plot`</span>引数が<span class="in">`TRUE`</span>に設定されているため、<span class="in">`acf`</span>関数は**自己相関プロット**・`pacf`関数は**偏自己相関プロット**を自動的に表示します。数値として自己相関・偏自己相関を得る場合には、引数に<span class="in">`plot=FALSE`</span>を指定します。</span>
<span id="cb79-260"><a href="#cb79-260" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-261"><a href="#cb79-261" aria-hidden="true" tabindex="-1"></a>グラフの横軸は階差（ラグ、Lag）で、Lag=0は時点tの値と時点tの値の相関、つまり同じもの同士の相関ですので、必ず1になります。Lag=1が1段階差の（偏）自己相関、Lag=2だと2段階差の（偏）自己相関ということになります。</span>
<span id="cb79-262"><a href="#cb79-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-263"><a href="#cb79-263" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="acf関数とpacf関数"}</span></span>
<span id="cb79-264"><a href="#cb79-264" aria-hidden="true" tabindex="-1"></a><span class="in">acf(y1) # 自己相関（グラフが表示される、plot=FALSEとすると数値が返ってくる）</span></span>
<span id="cb79-265"><a href="#cb79-265" aria-hidden="true" tabindex="-1"></a><span class="in">pacf(y1) # 偏自己相関</span></span>
<span id="cb79-266"><a href="#cb79-266" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-267"><a href="#cb79-267" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-268"><a href="#cb79-268" aria-hidden="true" tabindex="-1"></a><span class="in">`TSstudio`</span>パッケージの<span class="in">`ts_cor`</span>関数を用いれば、自己相関と偏自己相関のグラフを一度に表示することができます。また、<span class="in">`ts_lags`</span>関数を用いると、引数<span class="in">`lag`</span>に指定したラグでの相関について、散布図を表示することもできます。</span>
<span id="cb79-269"><a href="#cb79-269" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-272"><a href="#cb79-272" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-273"><a href="#cb79-273" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_cor</span>(y1 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>()) <span class="co"># 自己相関と偏自己相関プロット</span></span>
<span id="cb79-274"><a href="#cb79-274" aria-hidden="true" tabindex="-1"></a><span class="fu">ts_lags</span>(y1 <span class="sc">|&gt;</span> <span class="fu">as.ts</span>(), <span class="at">lag =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) <span class="co"># lagで指定した系列との散布図</span></span>
<span id="cb79-275"><a href="#cb79-275" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-276"><a href="#cb79-276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-277"><a href="#cb79-277" aria-hidden="true" tabindex="-1"></a>以下に、ホワイトノイズ、ランダムウォーク、AR(1)、AR(2)、AR(3)モデル、季節性、トレンドの自己相関と偏自己相関を示します。</span>
<span id="cb79-278"><a href="#cb79-278" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-279"><a href="#cb79-279" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb79-280"><a href="#cb79-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-281"><a href="#cb79-281" aria-hidden="true" tabindex="-1"></a><span class="fu">## ホワイトノイズ</span></span>
<span id="cb79-282"><a href="#cb79-282" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-283"><a href="#cb79-283" aria-hidden="true" tabindex="-1"></a>ホワイトノイズでは、自己相関はLag=0だけ1となり、自己相関も偏自己相関も0に近い値となります。</span>
<span id="cb79-284"><a href="#cb79-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-285"><a href="#cb79-285" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ホワイトノイズの自己相関", warning=FALSE}</span></span>
<span id="cb79-286"><a href="#cb79-286" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(y |&gt; as.ts())</span></span>
<span id="cb79-287"><a href="#cb79-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-288"><a href="#cb79-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-289"><a href="#cb79-289" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォーク</span></span>
<span id="cb79-290"><a href="#cb79-290" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-291"><a href="#cb79-291" aria-hidden="true" tabindex="-1"></a>ランダムウォークでは、自己相関はLagが大きくなるほど減っていきます。偏自己相関はLag=1だけが高い値となります。</span>
<span id="cb79-292"><a href="#cb79-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-293"><a href="#cb79-293" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ランダムウォークの自己相関", warning=FALSE}</span></span>
<span id="cb79-294"><a href="#cb79-294" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(y1 |&gt; as.ts())</span></span>
<span id="cb79-295"><a href="#cb79-295" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-296"><a href="#cb79-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-297"><a href="#cb79-297" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(1)モデル</span></span>
<span id="cb79-298"><a href="#cb79-298" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-299"><a href="#cb79-299" aria-hidden="true" tabindex="-1"></a>AR(1)モデルはランダムウォークとよく似た自己相関・偏自己相関を示します。</span>
<span id="cb79-300"><a href="#cb79-300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-301"><a href="#cb79-301" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="AR(1)モデルの自己相関", warning=FALSE}</span></span>
<span id="cb79-302"><a href="#cb79-302" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(y1a |&gt; as.ts())</span></span>
<span id="cb79-303"><a href="#cb79-303" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-304"><a href="#cb79-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-305"><a href="#cb79-305" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(2)モデル</span></span>
<span id="cb79-306"><a href="#cb79-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-307"><a href="#cb79-307" aria-hidden="true" tabindex="-1"></a>AR(2)モデルでは、（係数によりますが）自己相関はlag2つ置きに高い値を示し、偏自己相関はlag=2で高くなります。</span>
<span id="cb79-308"><a href="#cb79-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-309"><a href="#cb79-309" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="AR(2)モデルの自己相関", warning=FALSE}</span></span>
<span id="cb79-310"><a href="#cb79-310" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(y2 |&gt; as.ts())</span></span>
<span id="cb79-311"><a href="#cb79-311" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-312"><a href="#cb79-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-313"><a href="#cb79-313" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(3)モデル</span></span>
<span id="cb79-314"><a href="#cb79-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-315"><a href="#cb79-315" aria-hidden="true" tabindex="-1"></a>AR(3)モデルでは、（係数によりますが）自己相関はlag3つ置きに高い値を示し、偏自己相関はlag=3で高くなります。</span>
<span id="cb79-316"><a href="#cb79-316" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-317"><a href="#cb79-317" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="AR(3)モデルの自己相関", warning=FALSE}</span></span>
<span id="cb79-318"><a href="#cb79-318" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(y3 |&gt; as.ts())</span></span>
<span id="cb79-319"><a href="#cb79-319" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-320"><a href="#cb79-320" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-321"><a href="#cb79-321" aria-hidden="true" tabindex="-1"></a><span class="fu">## 季節性あり</span></span>
<span id="cb79-322"><a href="#cb79-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-323"><a href="#cb79-323" aria-hidden="true" tabindex="-1"></a>季節性がある場合には、自己相関に季節周期の波が生じます。偏自己相関には際立った特徴はありません。</span>
<span id="cb79-324"><a href="#cb79-324" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-325"><a href="#cb79-325" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="季節性ありの自己相関", warning=FALSE}</span></span>
<span id="cb79-326"><a href="#cb79-326" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(ys |&gt; as.ts())</span></span>
<span id="cb79-327"><a href="#cb79-327" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-328"><a href="#cb79-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-329"><a href="#cb79-329" aria-hidden="true" tabindex="-1"></a><span class="fu">## トレンドあり</span></span>
<span id="cb79-330"><a href="#cb79-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-331"><a href="#cb79-331" aria-hidden="true" tabindex="-1"></a>トレンドの傾向にもよりますが、直線的なトレンドがある場合には、AR(1)とよく似た自己相関・偏自己相関を示します。</span>
<span id="cb79-332"><a href="#cb79-332" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-333"><a href="#cb79-333" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="トレンドありの自己相関", warning=FALSE}</span></span>
<span id="cb79-334"><a href="#cb79-334" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(yt |&gt; as.ts())</span></span>
<span id="cb79-335"><a href="#cb79-335" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-336"><a href="#cb79-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-337"><a href="#cb79-337" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-338"><a href="#cb79-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-339"><a href="#cb79-339" aria-hidden="true" tabindex="-1"></a><span class="fu">### ar関数でモデルを推定</span></span>
<span id="cb79-340"><a href="#cb79-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-341"><a href="#cb79-341" aria-hidden="true" tabindex="-1"></a>上記のように、「前の値とよく似ている」のがARモデルです。ただし、時系列データがARモデルを取っているということがあらかじめわかっているという場合は稀です。ですので、時系列データが取れたときに、その時系列がAR(1)モデルなのかAR(2)モデルなのか、ARの係数αがいくつなのか、といったことが求まる方が、その時系列の理解が深まります。</span>
<span id="cb79-342"><a href="#cb79-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-343"><a href="#cb79-343" aria-hidden="true" tabindex="-1"></a>時系列データが得られた時に、ARのモデルと係数をそれぞれ求めるための関数が<span class="in">`ar`</span>関数です。<span class="in">`ar`</span>関数は時系列データ（ベクター）を引数に取り、ARの次数と係数を返します。<span class="in">`ar`</span>関数はAICによるモデル選択でARの次数を求めています。以下に様々な時系列における<span class="in">`ar`</span>関数の計算結果を示します。必ずしも正しい次数・係数が求まるわけではありませんが、データが増えれば<span class="in">`ar`</span>関数でより正確にARモデルを求めることができます。</span>
<span id="cb79-344"><a href="#cb79-344" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-345"><a href="#cb79-345" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-346"><a href="#cb79-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-347"><a href="#cb79-347" aria-hidden="true" tabindex="-1"></a><span class="fu">## ホワイトノイズ</span></span>
<span id="cb79-348"><a href="#cb79-348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-349"><a href="#cb79-349" aria-hidden="true" tabindex="-1"></a>ホワイトノイズはARモデルで示せないため、次数（order）は0、係数は示されません。</span>
<span id="cb79-350"><a href="#cb79-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-353"><a href="#cb79-353" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-354"><a href="#cb79-354" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y)</span>
<span id="cb79-355"><a href="#cb79-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-356"><a href="#cb79-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-357"><a href="#cb79-357" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォーク</span></span>
<span id="cb79-358"><a href="#cb79-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-359"><a href="#cb79-359" aria-hidden="true" tabindex="-1"></a>ランダムウォークはAR(1)の特別な場合（$\alpha=1$）なので、Orderは1（AR(1)モデル）で、係数（Coefficients）はほぼ1となります。</span>
<span id="cb79-360"><a href="#cb79-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-363"><a href="#cb79-363" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-364"><a href="#cb79-364" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y1)</span>
<span id="cb79-365"><a href="#cb79-365" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-366"><a href="#cb79-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-367"><a href="#cb79-367" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(1)モデル</span></span>
<span id="cb79-368"><a href="#cb79-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-369"><a href="#cb79-369" aria-hidden="true" tabindex="-1"></a>AR(1)モデルのorderは1になるはずですが、lag=8の自己相関が大きめに出るためにAR(8)が選ばれています。1次の係数は設定した0.6に近い値を示します。</span>
<span id="cb79-370"><a href="#cb79-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-373"><a href="#cb79-373" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-374"><a href="#cb79-374" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y1a)</span>
<span id="cb79-375"><a href="#cb79-375" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-376"><a href="#cb79-376" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-377"><a href="#cb79-377" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(2)モデル</span></span>
<span id="cb79-378"><a href="#cb79-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-379"><a href="#cb79-379" aria-hidden="true" tabindex="-1"></a>AR(2)モデルのorderは2で、Coefficientsとして1次は0.08で設定値0.1に近い値、2次は0.68で設定値0.6に近い値となっています。</span>
<span id="cb79-380"><a href="#cb79-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-383"><a href="#cb79-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-384"><a href="#cb79-384" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y2)</span>
<span id="cb79-385"><a href="#cb79-385" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-386"><a href="#cb79-386" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-387"><a href="#cb79-387" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(3)モデル</span></span>
<span id="cb79-388"><a href="#cb79-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-389"><a href="#cb79-389" aria-hidden="true" tabindex="-1"></a>AR(3)モデルのorderは3で、Coeffientsは0.08、0.07、0.62と、設定値の0.1、0.1、0.6に近い値が得られています。</span>
<span id="cb79-390"><a href="#cb79-390" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-393"><a href="#cb79-393" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-394"><a href="#cb79-394" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(y3)</span>
<span id="cb79-395"><a href="#cb79-395" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-396"><a href="#cb79-396" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-397"><a href="#cb79-397" aria-hidden="true" tabindex="-1"></a><span class="fu">## 季節性あり</span></span>
<span id="cb79-398"><a href="#cb79-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-399"><a href="#cb79-399" aria-hidden="true" tabindex="-1"></a>12ごとの周期性のある季節性データでは、AR(12)が選ばれています。</span>
<span id="cb79-400"><a href="#cb79-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-403"><a href="#cb79-403" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-404"><a href="#cb79-404" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(ys)</span>
<span id="cb79-405"><a href="#cb79-405" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-406"><a href="#cb79-406" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-407"><a href="#cb79-407" aria-hidden="true" tabindex="-1"></a><span class="fu">## トレンドあり</span></span>
<span id="cb79-408"><a href="#cb79-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-409"><a href="#cb79-409" aria-hidden="true" tabindex="-1"></a>季節性とトレンドを含むデータでは、AR(14)が選ばれ、1次の係数が1に近い値（0.9908）になっています。</span>
<span id="cb79-410"><a href="#cb79-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-413"><a href="#cb79-413" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-414"><a href="#cb79-414" aria-hidden="true" tabindex="-1"></a><span class="fu">ar</span>(yt)</span>
<span id="cb79-415"><a href="#cb79-415" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-416"><a href="#cb79-416" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-417"><a href="#cb79-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-418"><a href="#cb79-418" aria-hidden="true" tabindex="-1"></a><span class="fu">## 移動平均</span></span>
<span id="cb79-419"><a href="#cb79-419" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-420"><a href="#cb79-420" aria-hidden="true" tabindex="-1"></a>時系列データでは、通常ホワイトノイズに準じたばらつきが生じます。このばらつきが大きい場合には、全体としての時系列のトレンドがはっきりとしなくなる場合があります。ばらつきの大きい時系列データでは、このようなばらつきを**平滑化**して、時系列のトレンドが明確になるようにすることがあります。</span>
<span id="cb79-421"><a href="#cb79-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-422"><a href="#cb79-422" aria-hidden="true" tabindex="-1"></a>平滑化の方法には様々なものがありますが、最も簡単な平滑化の手法が**移動平均（rolling mean）**です。移動平均では、y~1~、y~2~、y~3~、... y~t~の時系列データがあった時、例えばy~1~、y~2~、y~3~の平均、y~2~、y~3~、y~4~の平均、y~3~、y~4~、y~5~の平均...といった風に、一定の時間間隔のデータを平均していきます。このとき、3つの平均を取るときには3 rolling windowの移動平均を取る、といったように、英語では平均を取る個数のことを「窓（window）」で表現するのが一般的です。ただし、移動平均を取ると窓の幅に応じて時系列の長さが短くなるという特徴があります。</span>
<span id="cb79-423"><a href="#cb79-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-424"><a href="#cb79-424" aria-hidden="true" tabindex="-1"></a>Rでは、<span class="co">[</span><span class="ot">`zoo`</span><span class="co">](https://cran.r-project.org/web/packages/zoo/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@zoo_bib</span><span class="co">]</span>の<span class="in">`rollmean`</span>関数で移動平均を計算することができます。<span class="in">`rollmean`</span>関数は第一引数に時系列、第二引数にwindow（引数名は<span class="in">`k`</span>）を取り、移動平均計算の結果を返します。以下に移動平均を5、10、20のwindowの設定で計算した結果を示します。windowを大きく設定するほど時系列は短くなり、よりギザギザのない、平滑な線になっていくのがわかります。</span>
<span id="cb79-425"><a href="#cb79-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-426"><a href="#cb79-426" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-427"><a href="#cb79-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-428"><a href="#cb79-428" aria-hidden="true" tabindex="-1"></a><span class="fu">## もとのデータ</span></span>
<span id="cb79-429"><a href="#cb79-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-430"><a href="#cb79-430" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb79-431"><a href="#cb79-431" aria-hidden="true" tabindex="-1"></a><span class="in">y2.1 &lt;- y2</span></span>
<span id="cb79-432"><a href="#cb79-432" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-433"><a href="#cb79-433" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data.frame(t, y2.1), aes(x = t, y = y2.1))+</span></span>
<span id="cb79-434"><a href="#cb79-434" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-435"><a href="#cb79-435" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)+</span></span>
<span id="cb79-436"><a href="#cb79-436" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_limits(x = 0)</span></span>
<span id="cb79-437"><a href="#cb79-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-438"><a href="#cb79-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-439"><a href="#cb79-439" aria-hidden="true" tabindex="-1"></a><span class="fu">## 5時点の移動平均</span></span>
<span id="cb79-440"><a href="#cb79-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-441"><a href="#cb79-441" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb79-442"><a href="#cb79-442" aria-hidden="true" tabindex="-1"></a><span class="in">y2.5 &lt;- zoo::rollmean(y2, 5)</span></span>
<span id="cb79-443"><a href="#cb79-443" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-444"><a href="#cb79-444" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data.frame(t = t[5:200], y2.5), aes(x = t, y = y2.5))+</span></span>
<span id="cb79-445"><a href="#cb79-445" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-446"><a href="#cb79-446" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)+</span></span>
<span id="cb79-447"><a href="#cb79-447" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_limits(x = 0)</span></span>
<span id="cb79-448"><a href="#cb79-448" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-449"><a href="#cb79-449" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-450"><a href="#cb79-450" aria-hidden="true" tabindex="-1"></a><span class="fu">## 10時点の移動平均</span></span>
<span id="cb79-451"><a href="#cb79-451" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-452"><a href="#cb79-452" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb79-453"><a href="#cb79-453" aria-hidden="true" tabindex="-1"></a><span class="in">y2.10 &lt;- zoo::rollmean(y2, 10)</span></span>
<span id="cb79-454"><a href="#cb79-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-455"><a href="#cb79-455" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data.frame(t = t[10:200], y2.10), aes(x = t, y = y2.10))+</span></span>
<span id="cb79-456"><a href="#cb79-456" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-457"><a href="#cb79-457" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)+</span></span>
<span id="cb79-458"><a href="#cb79-458" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_limits(x = 0)</span></span>
<span id="cb79-459"><a href="#cb79-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-460"><a href="#cb79-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-461"><a href="#cb79-461" aria-hidden="true" tabindex="-1"></a><span class="fu">## 20時点の移動平均</span></span>
<span id="cb79-462"><a href="#cb79-462" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-463"><a href="#cb79-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, message=FALSE}</span></span>
<span id="cb79-464"><a href="#cb79-464" aria-hidden="true" tabindex="-1"></a><span class="in">y2.20 &lt;- zoo::rollmean(y2, 20)</span></span>
<span id="cb79-465"><a href="#cb79-465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-466"><a href="#cb79-466" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot(data.frame(t = t[20:200], y2.20), aes(x = t, y = y2.20))+</span></span>
<span id="cb79-467"><a href="#cb79-467" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_point(size = 2, alpha = 0.5)+</span></span>
<span id="cb79-468"><a href="#cb79-468" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(linewidth = 0.5, alpha = 0.5)+</span></span>
<span id="cb79-469"><a href="#cb79-469" aria-hidden="true" tabindex="-1"></a><span class="in">  expand_limits(x = 0)</span></span>
<span id="cb79-470"><a href="#cb79-470" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-471"><a href="#cb79-471" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-472"><a href="#cb79-472" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-473"><a href="#cb79-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-474"><a href="#cb79-474" aria-hidden="true" tabindex="-1"></a><span class="fu">## MAモデル</span></span>
<span id="cb79-475"><a href="#cb79-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-476"><a href="#cb79-476" aria-hidden="true" tabindex="-1"></a>移動平均と日本語では同じ名前の時系列モデルとして、**MA（Moving average）モデル**というものがあります。MAモデルは上で説明したrolling meanとは少し異なり、時間tにおける値y~t~が正規分布に従う乱数εと係数の積を足した値に従うようなモデルとなります。以下の数式では、**MA(q)モデル**として、係数とεの積をq個足しあわせた式を示します。</span>
<span id="cb79-477"><a href="#cb79-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-478"><a href="#cb79-478" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1}  + \cdots \theta_{q} \cdot \epsilon_{t-q}$$</span>
<span id="cb79-479"><a href="#cb79-479" aria-hidden="true" tabindex="-1"></a>$$\epsilon_{t} \sim Normal(0, \sigma)$$</span>
<span id="cb79-480"><a href="#cb79-480" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-481"><a href="#cb79-481" aria-hidden="true" tabindex="-1"></a>以下に、MA(1)～MA(3)モデルの式とグラフ、自己相関・偏自己相関を示します。MAモデルは定常過程で、平均値や分散が時間とともに大きく変化しないような過程となります。MAモデルでは、自己相関にはあまり特徴がなく、偏自己相関には比較的大きい値が維持されるような傾向をもちます。</span>
<span id="cb79-482"><a href="#cb79-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-483"><a href="#cb79-483" aria-hidden="true" tabindex="-1"></a>::: {.panel-tabset}</span>
<span id="cb79-484"><a href="#cb79-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-485"><a href="#cb79-485" aria-hidden="true" tabindex="-1"></a><span class="fu">## MA(1)モデル</span></span>
<span id="cb79-486"><a href="#cb79-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-487"><a href="#cb79-487" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1} $$</span>
<span id="cb79-488"><a href="#cb79-488" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-489"><a href="#cb79-489" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="MA(1)モデルの例"}</span></span>
<span id="cb79-490"><a href="#cb79-490" aria-hidden="true" tabindex="-1"></a><span class="in">ym1 &lt;- arima.sim(model = list(order = c(0, 0, 1), ma = 0.8), 200)</span></span>
<span id="cb79-491"><a href="#cb79-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-492"><a href="#cb79-492" aria-hidden="true" tabindex="-1"></a><span class="in">plot(ym1)</span></span>
<span id="cb79-493"><a href="#cb79-493" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-494"><a href="#cb79-494" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-495"><a href="#cb79-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb79-496"><a href="#cb79-496" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(ym1 |&gt; as.ts())</span></span>
<span id="cb79-497"><a href="#cb79-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-498"><a href="#cb79-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-499"><a href="#cb79-499" aria-hidden="true" tabindex="-1"></a><span class="fu">## MA(2)モデル</span></span>
<span id="cb79-500"><a href="#cb79-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-501"><a href="#cb79-501" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1}  + \theta_{2} \cdot \epsilon_{t-2}$$</span>
<span id="cb79-502"><a href="#cb79-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-503"><a href="#cb79-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="MA(2)モデルの例"}</span></span>
<span id="cb79-504"><a href="#cb79-504" aria-hidden="true" tabindex="-1"></a><span class="in">ym2 &lt;- arima.sim(model = list(order = c(0, 0, 2), ma = c(0.3, 0.7)), 200)</span></span>
<span id="cb79-505"><a href="#cb79-505" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-506"><a href="#cb79-506" aria-hidden="true" tabindex="-1"></a><span class="in">plot(ym2)</span></span>
<span id="cb79-507"><a href="#cb79-507" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-508"><a href="#cb79-508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-509"><a href="#cb79-509" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb79-510"><a href="#cb79-510" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(ym2 |&gt; as.ts())</span></span>
<span id="cb79-511"><a href="#cb79-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-512"><a href="#cb79-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-513"><a href="#cb79-513" aria-hidden="true" tabindex="-1"></a><span class="fu">## MA(3)モデル</span></span>
<span id="cb79-514"><a href="#cb79-514" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-515"><a href="#cb79-515" aria-hidden="true" tabindex="-1"></a>$$y_{t}=\epsilon_{t} + \theta_{1} \cdot \epsilon_{t-1}  + \theta_{2} \cdot \epsilon_{t-2}  + \theta_{3} \cdot \epsilon_{t-3}$$</span>
<span id="cb79-516"><a href="#cb79-516" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-517"><a href="#cb79-517" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="MA(3)モデルの例"}</span></span>
<span id="cb79-518"><a href="#cb79-518" aria-hidden="true" tabindex="-1"></a><span class="in">ym3 &lt;- arima.sim(model = list(order = c(0, 0, 3), ma = c(0.2, 0.2, 0.4)), 200)</span></span>
<span id="cb79-519"><a href="#cb79-519" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-520"><a href="#cb79-520" aria-hidden="true" tabindex="-1"></a><span class="in">plot(ym3)</span></span>
<span id="cb79-521"><a href="#cb79-521" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-522"><a href="#cb79-522" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-523"><a href="#cb79-523" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, warning=FALSE}</span></span>
<span id="cb79-524"><a href="#cb79-524" aria-hidden="true" tabindex="-1"></a><span class="in">ts_cor(ym3 |&gt; as.ts())</span></span>
<span id="cb79-525"><a href="#cb79-525" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-526"><a href="#cb79-526" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-527"><a href="#cb79-527" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-528"><a href="#cb79-528" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-529"><a href="#cb79-529" aria-hidden="true" tabindex="-1"></a><span class="fu">## 単位根過程と反転可能性</span></span>
<span id="cb79-530"><a href="#cb79-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-531"><a href="#cb79-531" aria-hidden="true" tabindex="-1"></a><span class="fu">### 単位根過程</span></span>
<span id="cb79-532"><a href="#cb79-532" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-533"><a href="#cb79-533" aria-hidden="true" tabindex="-1"></a>**単位根過程（unit root）**とは、特性方程式というものの解が1を含むような過程のことを指します。特性方程式とは以下のような式で、Φについて解くことで解を求めます。</span>
<span id="cb79-534"><a href="#cb79-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-535"><a href="#cb79-535" aria-hidden="true" tabindex="-1"></a>$$1-\alpha_{1}\phi - \alpha_{2}\phi^2 -\alpha_{3}\phi^3 \cdots -\alpha_{p}\phi^p=0$$</span>
<span id="cb79-536"><a href="#cb79-536" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-537"><a href="#cb79-537" aria-hidden="true" tabindex="-1"></a>上の<span class="in">`arima.sim`</span>関数の説明で、以下のようにARの係数から定常過程の判定を行うRのスクリプトを記載していますが、この下の式の一部が特性方程式の解を求めるスクリプトになっています。特性方程式の解の最小値が1以上なら定常過程、解に1を含むなら単位根過程となります。</span>
<span id="cb79-538"><a href="#cb79-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-539"><a href="#cb79-539" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="特性方程式の解"}</span></span>
<span id="cb79-540"><a href="#cb79-540" aria-hidden="true" tabindex="-1"></a><span class="in">ar &lt;- c(0.2, 0.2, 0.5) # ARの係数のベクター</span></span>
<span id="cb79-541"><a href="#cb79-541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-542"><a href="#cb79-542" aria-hidden="true" tabindex="-1"></a><span class="in"># これが特性方程式の解の最小値を求める計算式</span></span>
<span id="cb79-543"><a href="#cb79-543" aria-hidden="true" tabindex="-1"></a><span class="in"># （正確には解の原点からの距離の最小値）</span></span>
<span id="cb79-544"><a href="#cb79-544" aria-hidden="true" tabindex="-1"></a><span class="in">min(Mod(polyroot(c(1, -ar))))</span></span>
<span id="cb79-545"><a href="#cb79-545" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-546"><a href="#cb79-546" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-547"><a href="#cb79-547" aria-hidden="true" tabindex="-1"></a>...定義上はこのように単位根過程であるかどうかを判定するのですが、正直よくわからないと思います。我々が最低限知っておくべきこととしては、**ランダムウォークが単位根過程**であることです。以下の2つの式から分かる通り、ランダムウォークはAR(1)でかつα~1~=1なので、特性方程式Φの解が1になります。</span>
<span id="cb79-548"><a href="#cb79-548" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-549"><a href="#cb79-549" aria-hidden="true" tabindex="-1"></a>$$y_{t}=y_{t-1}+\epsilon_{t}$$</span>
<span id="cb79-550"><a href="#cb79-550" aria-hidden="true" tabindex="-1"></a>$$1 - 1 \cdot \phi = 0$$</span>
<span id="cb79-551"><a href="#cb79-551" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-552"><a href="#cb79-552" aria-hidden="true" tabindex="-1"></a><span class="fu">### 独立な単位根過程同士で相関を取る</span></span>
<span id="cb79-553"><a href="#cb79-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-554"><a href="#cb79-554" aria-hidden="true" tabindex="-1"></a>単位根過程である時系列データには、**「2つの独立な単位根過程では、その2つの相関を取ると有意な相関が得られる」**、という特殊な性質があります。この相関には全く意味は無いので、時系列データ同士の相関を取る場合には注意が必要です。</span>
<span id="cb79-555"><a href="#cb79-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-556"><a href="#cb79-556" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="独立な単位根過程間の相関"}</span></span>
<span id="cb79-557"><a href="#cb79-557" aria-hidden="true" tabindex="-1"></a><span class="in"># y1とy1_2は乱数から作った2つの独立な単位根過程</span></span>
<span id="cb79-558"><a href="#cb79-558" aria-hidden="true" tabindex="-1"></a><span class="in">y1_2 &lt;- NULL</span></span>
<span id="cb79-559"><a href="#cb79-559" aria-hidden="true" tabindex="-1"></a><span class="in">temp &lt;- 0</span></span>
<span id="cb79-560"><a href="#cb79-560" aria-hidden="true" tabindex="-1"></a><span class="in">for(i in 1:200){</span></span>
<span id="cb79-561"><a href="#cb79-561" aria-hidden="true" tabindex="-1"></a><span class="in">  temp &lt;- temp+rnorm(1, 0, 1)</span></span>
<span id="cb79-562"><a href="#cb79-562" aria-hidden="true" tabindex="-1"></a><span class="in">  y1_2 &lt;- c(y1_2, temp)</span></span>
<span id="cb79-563"><a href="#cb79-563" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb79-564"><a href="#cb79-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-565"><a href="#cb79-565" aria-hidden="true" tabindex="-1"></a><span class="in"># 相関係数が-0.6</span></span>
<span id="cb79-566"><a href="#cb79-566" aria-hidden="true" tabindex="-1"></a><span class="in">cor(y1, y1_2) </span></span>
<span id="cb79-567"><a href="#cb79-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-568"><a href="#cb79-568" aria-hidden="true" tabindex="-1"></a><span class="in"># 相関の有意性を検定すると有意になる</span></span>
<span id="cb79-569"><a href="#cb79-569" aria-hidden="true" tabindex="-1"></a><span class="in">cor.test(y1, y1_2)</span></span>
<span id="cb79-570"><a href="#cb79-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-571"><a href="#cb79-571" aria-hidden="true" tabindex="-1"></a><span class="in"># バラバラしているけど相関がある</span></span>
<span id="cb79-572"><a href="#cb79-572" aria-hidden="true" tabindex="-1"></a><span class="in">plot(y1, y1_2)</span></span>
<span id="cb79-573"><a href="#cb79-573" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-574"><a href="#cb79-574" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-575"><a href="#cb79-575" aria-hidden="true" tabindex="-1"></a>例えば、トルコリラの為替変動と日経平均株価は共にランダムウォークの過程ですが、相関を取ると有意な相関がある、という結果が得られます。だからといって、トルコリラが上がった（又は下がった）から日経平均株価も上がるだろうと想定して株を買い込むと痛い目にあいます。</span>
<span id="cb79-576"><a href="#cb79-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-577"><a href="#cb79-577" aria-hidden="true" tabindex="-1"></a><span class="fu">### 単位根検定</span></span>
<span id="cb79-578"><a href="#cb79-578" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-579"><a href="#cb79-579" aria-hidden="true" tabindex="-1"></a>とは言っても、時系列データが単位根過程であるか判定するための特性方程式はα~p~、つまりARモデルの係数がわからないと解くことができませんし、時系列データが得られればα~p~が求まるというものでもありません。得られた時系列データが単位根過程であるかどうかを判定する場合には、特性方程式を解くのではなく、通常は**単位根検定**という検定手法を用いることになります。</span>
<span id="cb79-580"><a href="#cb79-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-581"><a href="#cb79-581" aria-hidden="true" tabindex="-1"></a>時系列データが単位根過程であるかどうかは、**ADF検定**というものを用いて検定します。ADF検定は「単位根過程である」場合を帰無仮説とし、棄却された場合、つまりp値が十分に小さい場合には「単位根過程である」という帰無仮説を棄却して、「単位根過程ではない」という対立仮説を採用する検定手法です。要は**p値が小さい場合には単位根過程では無い**と判断します。</span>
<span id="cb79-582"><a href="#cb79-582" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-583"><a href="#cb79-583" aria-hidden="true" tabindex="-1"></a>Rでは<span class="co">[</span><span class="ot">`CADFtest`</span><span class="co">](https://cran.r-project.org/web/packages/CADFtest/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@CADFtest_bib</span><span class="co">]</span>の<span class="in">`CADFtest`</span>関数を用いてADF検定を行います。</span>
<span id="cb79-584"><a href="#cb79-584" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-585"><a href="#cb79-585" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="ADF検定で単位根過程の判定"}</span></span>
<span id="cb79-586"><a href="#cb79-586" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(CADFtest)</span></span>
<span id="cb79-587"><a href="#cb79-587" aria-hidden="true" tabindex="-1"></a><span class="in">CADFtest(y1)</span></span>
<span id="cb79-588"><a href="#cb79-588" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-589"><a href="#cb79-589" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-590"><a href="#cb79-590" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-591"><a href="#cb79-591" aria-hidden="true" tabindex="-1"></a>以下に、CADFtest関数を用いた各種時系列データの検定結果を示します。</span>
<span id="cb79-592"><a href="#cb79-592" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-593"><a href="#cb79-593" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb79-594"><a href="#cb79-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-595"><a href="#cb79-595" aria-hidden="true" tabindex="-1"></a><span class="fu">## ホワイトノイズ</span></span>
<span id="cb79-596"><a href="#cb79-596" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-597"><a href="#cb79-597" aria-hidden="true" tabindex="-1"></a>ホワイトノイズは単位根過程ではないので、帰無仮説は棄却されます。</span>
<span id="cb79-598"><a href="#cb79-598" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-601"><a href="#cb79-601" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-602"><a href="#cb79-602" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y)</span>
<span id="cb79-603"><a href="#cb79-603" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-604"><a href="#cb79-604" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-605"><a href="#cb79-605" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォーク</span></span>
<span id="cb79-606"><a href="#cb79-606" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-607"><a href="#cb79-607" aria-hidden="true" tabindex="-1"></a>ランダムウォークは単位根過程なので、帰無仮説は棄却されません。</span>
<span id="cb79-608"><a href="#cb79-608" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-611"><a href="#cb79-611" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-612"><a href="#cb79-612" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1)</span>
<span id="cb79-613"><a href="#cb79-613" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-614"><a href="#cb79-614" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-615"><a href="#cb79-615" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォークの差分</span></span>
<span id="cb79-616"><a href="#cb79-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-617"><a href="#cb79-617" aria-hidden="true" tabindex="-1"></a>ランダムウォークの差分系列を取ると、ホワイトノイズとなるため、単位根過程ではなくなります。</span>
<span id="cb79-618"><a href="#cb79-618" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-621"><a href="#cb79-621" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-622"><a href="#cb79-622" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1 <span class="sc">|&gt;</span>  <span class="fu">diff</span>())</span>
<span id="cb79-623"><a href="#cb79-623" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-624"><a href="#cb79-624" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-625"><a href="#cb79-625" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(1)モデル</span></span>
<span id="cb79-626"><a href="#cb79-626" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-627"><a href="#cb79-627" aria-hidden="true" tabindex="-1"></a>AR(1)モデルでかつαが1でない場合には、単位根過程ではありません。</span>
<span id="cb79-628"><a href="#cb79-628" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-631"><a href="#cb79-631" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-632"><a href="#cb79-632" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y1a)</span>
<span id="cb79-633"><a href="#cb79-633" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-634"><a href="#cb79-634" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-635"><a href="#cb79-635" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(2)モデル</span></span>
<span id="cb79-636"><a href="#cb79-636" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-637"><a href="#cb79-637" aria-hidden="true" tabindex="-1"></a>AR(2)モデル以降は係数によって単位根過程かどうかが変わります。以下の例は単位根過程ではない場合です。</span>
<span id="cb79-638"><a href="#cb79-638" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-641"><a href="#cb79-641" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-642"><a href="#cb79-642" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y2)</span>
<span id="cb79-643"><a href="#cb79-643" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-644"><a href="#cb79-644" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-645"><a href="#cb79-645" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(3)モデル</span></span>
<span id="cb79-646"><a href="#cb79-646" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-647"><a href="#cb79-647" aria-hidden="true" tabindex="-1"></a>AR(3)モデルも係数によって単位根過程かどうかが変わります。以下の例は単位根過程ではない場合です。</span>
<span id="cb79-648"><a href="#cb79-648" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-651"><a href="#cb79-651" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-652"><a href="#cb79-652" aria-hidden="true" tabindex="-1"></a><span class="fu">CADFtest</span>(y3)</span>
<span id="cb79-653"><a href="#cb79-653" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-654"><a href="#cb79-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-655"><a href="#cb79-655" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-656"><a href="#cb79-656" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-657"><a href="#cb79-657" aria-hidden="true" tabindex="-1"></a>単位根検定には他に**KPSS検定**と呼ばれる、帰無仮説が「単位根過程ではない」、つまり**棄却された場合に単位根過程である**とされる検定もあります。Rでは、<span class="co">[</span><span class="ot">`tseries`</span><span class="co">](https://cran.r-project.org/web/packages/tseries/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@tseries_bib</span><span class="co">]</span>の<span class="in">`kpss.test`</span>関数を用いてKPSS検定を行うことができます。</span>
<span id="cb79-658"><a href="#cb79-658" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-659"><a href="#cb79-659" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="tseries::kpss.testでKPSS検定"}</span></span>
<span id="cb79-660"><a href="#cb79-660" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(tseries)</span></span>
<span id="cb79-661"><a href="#cb79-661" aria-hidden="true" tabindex="-1"></a><span class="in">kpss.test(y1)</span></span>
<span id="cb79-662"><a href="#cb79-662" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-663"><a href="#cb79-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-664"><a href="#cb79-664" aria-hidden="true" tabindex="-1"></a><span class="fu">### 反転可能性</span></span>
<span id="cb79-665"><a href="#cb79-665" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-666"><a href="#cb79-666" aria-hidden="true" tabindex="-1"></a>MAモデルの一部は、AR(∞)モデルの形に書き換えることができます。このAR(∞)モデルに書き換えることができることを**反転可能性**と呼びます。反転可能なMAモデルは反転不可能なモデルよりも統計的には取り扱いやすいとされています。</span>
<span id="cb79-667"><a href="#cb79-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-668"><a href="#cb79-668" aria-hidden="true" tabindex="-1"></a>反転可能性の条件は以下の特性方程式の解がすべて1以上となることです。</span>
<span id="cb79-669"><a href="#cb79-669" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-670"><a href="#cb79-670" aria-hidden="true" tabindex="-1"></a>$$1+\theta_{1}\phi + \theta_{2}\phi^2 +\theta_{3}\phi^3 \cdots +\theta_{q}\phi^q=0$$</span>
<span id="cb79-671"><a href="#cb79-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-672"><a href="#cb79-672" aria-hidden="true" tabindex="-1"></a>ARモデルの特性方程式と同じように、MAモデルの特性方程式も以下のスクリプトで計算することができ、下の式が<span class="in">`TRUE`</span>になる場合は反転可能、<span class="in">`FALSE`</span>になる場合は反転不可能となります。</span>
<span id="cb79-673"><a href="#cb79-673" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-674"><a href="#cb79-674" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="MAモデル：特性方程式の解"}</span></span>
<span id="cb79-675"><a href="#cb79-675" aria-hidden="true" tabindex="-1"></a><span class="in">ma &lt;- c(0.2, 0.2, 0.5) # MAの係数のベクター</span></span>
<span id="cb79-676"><a href="#cb79-676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-677"><a href="#cb79-677" aria-hidden="true" tabindex="-1"></a><span class="in"># 特性方程式の解の最小値が1以上なら反転可能</span></span>
<span id="cb79-678"><a href="#cb79-678" aria-hidden="true" tabindex="-1"></a><span class="in">min(Mod(polyroot(c(1, ma)))) &gt; 1</span></span>
<span id="cb79-679"><a href="#cb79-679" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-680"><a href="#cb79-680" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-681"><a href="#cb79-681" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARMAモデル</span></span>
<span id="cb79-682"><a href="#cb79-682" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-683"><a href="#cb79-683" aria-hidden="true" tabindex="-1"></a>以上のように、ARモデルやMAモデルで時系列データを説明することはできるのですが、では時系列データが得られた時にARの次数（order）がいくつで、MAの次数がいくつで、それぞれの係数はいくつになるのか、というのはよくわからないままです。このAR・MAの次数や係数を定めるときに用いられるのが**ARMAモデル**です。</span>
<span id="cb79-684"><a href="#cb79-684" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-685"><a href="#cb79-685" aria-hidden="true" tabindex="-1"></a>ARMAモデルは、その名の通りARモデルとMAモデルを含んだ時系列モデルです。平均値一定で分散が時間とともに大きく変化しない、定常性を持つ時系列データはこのARMAモデルで記述することができます。ARMAモデルは、ARの次数pとMAの次数qを用いて、**ARMA(p,q)**という形で示します。例えば、ARMA(1,2)であれば、AR(1)モデルでかつMA(2)モデルであることを示しています。</span>
<span id="cb79-686"><a href="#cb79-686" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-687"><a href="#cb79-687" aria-hidden="true" tabindex="-1"></a>上に示した<span class="in">`ar`</span>関数では、ARモデルの次数と係数を求めることができましたが、MAモデルが混じっているARMAモデルの次数と係数を求めることはできません。</span>
<span id="cb79-688"><a href="#cb79-688" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-689"><a href="#cb79-689" aria-hidden="true" tabindex="-1"></a>RでARMAモデルの次数と係数を求めるときには、<span class="in">`tseries`</span>パッケージの<span class="in">`arma`</span>関数を用います。<span class="in">`arma`</span>関数は時系列データ（ベクターや<span class="in">`ts`</span>オブジェクト）と次数を引数に取り、AR、MAの係数、切片項（intercept）をそれぞれ計算してくれます。ただし、<span class="in">`arma`</span>関数は次数を与えずに計算させるとARMA(1,1)であるとして計算してしまうので、可能であれば次数を<span class="in">`order`</span>引数に与える必要があります。以下に、各種時系列データを<span class="in">`arma`</span>関数で分析したときの結果を示します。</span>
<span id="cb79-690"><a href="#cb79-690" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-691"><a href="#cb79-691" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb79-692"><a href="#cb79-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-693"><a href="#cb79-693" aria-hidden="true" tabindex="-1"></a><span class="fu">## ホワイトノイズ</span></span>
<span id="cb79-694"><a href="#cb79-694" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-697"><a href="#cb79-697" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-698"><a href="#cb79-698" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>)) <span class="co"># 切片項だけが得られる</span></span>
<span id="cb79-699"><a href="#cb79-699" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-700"><a href="#cb79-700" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-701"><a href="#cb79-701" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォーク</span></span>
<span id="cb79-702"><a href="#cb79-702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-705"><a href="#cb79-705" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-706"><a href="#cb79-706" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y1, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="co"># ランダムウォークはARMA(1,0)</span></span>
<span id="cb79-707"><a href="#cb79-707" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-708"><a href="#cb79-708" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-709"><a href="#cb79-709" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(1)モデル</span></span>
<span id="cb79-710"><a href="#cb79-710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-713"><a href="#cb79-713" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-714"><a href="#cb79-714" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y1a, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">0</span>)) <span class="co"># AR(1)モデルはARMA(1,0)</span></span>
<span id="cb79-715"><a href="#cb79-715" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-716"><a href="#cb79-716" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-717"><a href="#cb79-717" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(2)モデル</span></span>
<span id="cb79-718"><a href="#cb79-718" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-721"><a href="#cb79-721" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-722"><a href="#cb79-722" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y2, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">0</span>)) <span class="co"># AR(2)モデルはARMA(2,0)</span></span>
<span id="cb79-723"><a href="#cb79-723" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-724"><a href="#cb79-724" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-725"><a href="#cb79-725" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(3)モデル</span></span>
<span id="cb79-726"><a href="#cb79-726" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-729"><a href="#cb79-729" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-730"><a href="#cb79-730" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(y3, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">0</span>)) <span class="co"># AR(3)モデルはARMA(3,0)</span></span>
<span id="cb79-731"><a href="#cb79-731" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-732"><a href="#cb79-732" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-733"><a href="#cb79-733" aria-hidden="true" tabindex="-1"></a><span class="fu">## MA(1)モデル</span></span>
<span id="cb79-734"><a href="#cb79-734" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-737"><a href="#cb79-737" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-738"><a href="#cb79-738" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(ym1, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>)) <span class="co"># MA(1)モデルはARMA(0,1)</span></span>
<span id="cb79-739"><a href="#cb79-739" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-740"><a href="#cb79-740" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-741"><a href="#cb79-741" aria-hidden="true" tabindex="-1"></a><span class="fu">## MA(2)モデル</span></span>
<span id="cb79-742"><a href="#cb79-742" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-745"><a href="#cb79-745" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-746"><a href="#cb79-746" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(ym2, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">2</span>)) <span class="co"># MA(2)モデルはARMA(0,2)</span></span>
<span id="cb79-747"><a href="#cb79-747" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-748"><a href="#cb79-748" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-749"><a href="#cb79-749" aria-hidden="true" tabindex="-1"></a><span class="fu">## MA(3)モデル</span></span>
<span id="cb79-750"><a href="#cb79-750" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-753"><a href="#cb79-753" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-754"><a href="#cb79-754" aria-hidden="true" tabindex="-1"></a><span class="fu">arma</span>(ym3, <span class="at">order=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">3</span>)) <span class="co"># MA(3)モデルはARMA(0,3)</span></span>
<span id="cb79-755"><a href="#cb79-755" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-756"><a href="#cb79-756" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-757"><a href="#cb79-757" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-758"><a href="#cb79-758" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-759"><a href="#cb79-759" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARIMAモデル</span></span>
<span id="cb79-760"><a href="#cb79-760" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-761"><a href="#cb79-761" aria-hidden="true" tabindex="-1"></a>ARMAは基本的に定常過程を対象とするモデルです。しかし、単位根過程となる時系列は定常過程ではなく、ARMAでは取り扱いにくい場合があります。このような単位根過程となる時系列にも対応したモデルが**ARIMA（auto-regression integrated moving average）モデル**です。ARIMAモデルは、ARモデルとMAモデルに**和分(I)**を付け加えたモデルとなります。</span>
<span id="cb79-762"><a href="#cb79-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-763"><a href="#cb79-763" aria-hidden="true" tabindex="-1"></a>典型的な単位根過程であるランダムウォークの差分を取るとホワイトノイズとなるように、**単位根過程の何段階かの差分を取ると、定常過程**を得ることができます。このことから、単位根過程である時系列は、定常過程を足し合わせたもの、つまり**和分**であるとすることができます。</span>
<span id="cb79-764"><a href="#cb79-764" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-765"><a href="#cb79-765" aria-hidden="true" tabindex="-1"></a>単位根過程の時系列データで、d階差分を取ると定常過程となる場合、そのデータは**I(d)**、つまり**d次の和分**であるとします。この和分I(d)をARMAモデルに加えたものがARIMAモデルで、AR(p)、I(d)、MA(q)のぞれぞれの次数を合わせて**ARIMA(p,d,q)**という形でモデルを表現します。</span>
<span id="cb79-766"><a href="#cb79-766" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-767"><a href="#cb79-767" aria-hidden="true" tabindex="-1"></a>ARIMAモデルの計算では、まず時系列が単位根過程であるかを判定し、その後I(d)のdの次数を決定します。その後差分系列のAR、MAの次数と係数を決定するという過程で、ARIMA(p,d,q)のp、d、qの部分を求めます。Rでは、<span class="in">`arima`</span>関数でARIMAモデルの係数を求めることができます。ただし、<span class="in">`arima`</span>関数ではあらかじめ(p,d,q)の次数を引数に与える必要があります。</span>
<span id="cb79-768"><a href="#cb79-768" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-769"><a href="#cb79-769" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="arima関数"}</span></span>
<span id="cb79-770"><a href="#cb79-770" aria-hidden="true" tabindex="-1"></a><span class="in">arima(y1, c(1, 0, 0)) # ARIMA(1, 0, 0)として係数を求める</span></span>
<span id="cb79-771"><a href="#cb79-771" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-772"><a href="#cb79-772" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-773"><a href="#cb79-773" aria-hidden="true" tabindex="-1"></a>しかし、時系列データを得た時に、そのデータがARIMA(1,1,0)である、といった風に、次数をあらかじめ決めることは普通はできません。Rには次数を含めてARIMAモデルを計算してくれる、<span class="in">`auto.arima`</span>関数が備わっています。実際に時系列分析を行う際には、<span class="in">`arima`</span>関数を用いることはほぼなく、<span class="in">`auto.arima`</span>関数を用いることになります。<span class="in">`auto.arima`</span>関数はAICに従いモデル選択を行う関数で、<span class="co">[</span><span class="ot">26章</span><span class="co">](./chapter26.html)</span>で説明したAICによるモデル選択における<span class="in">`step`</span>関数のARIMA版のようなものになります。</span>
<span id="cb79-774"><a href="#cb79-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-775"><a href="#cb79-775" aria-hidden="true" tabindex="-1"></a><span class="in">`auto.arima`</span>関数には、モデルを総当り計算するかステップワイズな計算をするかを決定する<span class="in">`stepwise`</span>引数を設定できます。<span class="in">`stepwise=T`</span>とするとステップワイズ計算を行い、計算が速くなります。一方で<span class="in">`stepwise=F`</span>とすると、総当り計算を行うため計算は正確になりますが、モデルが複雑な場合には計算に時間がかかります。また、<span class="in">`trace`</span>引数を<span class="in">`TRUE`</span>に設定すると、繰り返し計算をすべて表示してくれます。</span>
<span id="cb79-776"><a href="#cb79-776" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-777"><a href="#cb79-777" aria-hidden="true" tabindex="-1"></a>以下に、<span class="in">`auto.arima`</span>関数を用いて各種の時系列データを分析した例を示します。</span>
<span id="cb79-778"><a href="#cb79-778" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-779"><a href="#cb79-779" aria-hidden="true" tabindex="-1"></a>:::{.panel-tabset}</span>
<span id="cb79-780"><a href="#cb79-780" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-781"><a href="#cb79-781" aria-hidden="true" tabindex="-1"></a><span class="fu">## ホワイトノイズ</span></span>
<span id="cb79-782"><a href="#cb79-782" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-783"><a href="#cb79-783" aria-hidden="true" tabindex="-1"></a>ホワイトノイズはARIMA(0,0,0)モデルですので、正しくモデルが求まっています。</span>
<span id="cb79-784"><a href="#cb79-784" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-787"><a href="#cb79-787" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-788"><a href="#cb79-788" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-789"><a href="#cb79-789" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-790"><a href="#cb79-790" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-791"><a href="#cb79-791" aria-hidden="true" tabindex="-1"></a><span class="fu">## ランダムウォーク</span></span>
<span id="cb79-792"><a href="#cb79-792" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-793"><a href="#cb79-793" aria-hidden="true" tabindex="-1"></a>ランダムウォークは単位根ありの和分過程ですので、ARIMA(0,1,0)となります。</span>
<span id="cb79-794"><a href="#cb79-794" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-797"><a href="#cb79-797" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-798"><a href="#cb79-798" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y1), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-799"><a href="#cb79-799" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-800"><a href="#cb79-800" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-801"><a href="#cb79-801" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(1)モデル</span></span>
<span id="cb79-802"><a href="#cb79-802" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-803"><a href="#cb79-803" aria-hidden="true" tabindex="-1"></a>単位根の無いAR(1)モデルはARIMA(1,0,0)ですが、ARIMA(2,0,1)と推定されています。</span>
<span id="cb79-804"><a href="#cb79-804" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-807"><a href="#cb79-807" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-808"><a href="#cb79-808" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y1a), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-809"><a href="#cb79-809" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-810"><a href="#cb79-810" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-811"><a href="#cb79-811" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(2)モデル</span></span>
<span id="cb79-812"><a href="#cb79-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-813"><a href="#cb79-813" aria-hidden="true" tabindex="-1"></a>AR(2)モデルはARIMA(2,0,0)モデルですが、ARIMA(3,0,0)と推定されています。</span>
<span id="cb79-814"><a href="#cb79-814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-817"><a href="#cb79-817" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-818"><a href="#cb79-818" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y2), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-819"><a href="#cb79-819" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-820"><a href="#cb79-820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-821"><a href="#cb79-821" aria-hidden="true" tabindex="-1"></a><span class="fu">## AR(3)モデル</span></span>
<span id="cb79-822"><a href="#cb79-822" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-823"><a href="#cb79-823" aria-hidden="true" tabindex="-1"></a>AR(3)モデルはARIMA(3,0,0)モデルですが、ARIMA(0,0,3)と推定されています。</span>
<span id="cb79-824"><a href="#cb79-824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-827"><a href="#cb79-827" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-828"><a href="#cb79-828" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(y3), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-829"><a href="#cb79-829" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-830"><a href="#cb79-830" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-831"><a href="#cb79-831" aria-hidden="true" tabindex="-1"></a><span class="fu">## MR(1)モデル</span></span>
<span id="cb79-832"><a href="#cb79-832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-833"><a href="#cb79-833" aria-hidden="true" tabindex="-1"></a>MA(1)モデルはARIMA(0,0,1)モデルなので、正しく推定されています。</span>
<span id="cb79-834"><a href="#cb79-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-837"><a href="#cb79-837" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-838"><a href="#cb79-838" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(ym1), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-839"><a href="#cb79-839" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-840"><a href="#cb79-840" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-841"><a href="#cb79-841" aria-hidden="true" tabindex="-1"></a><span class="fu">## MR(2)モデル</span></span>
<span id="cb79-842"><a href="#cb79-842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-843"><a href="#cb79-843" aria-hidden="true" tabindex="-1"></a>MA(2)モデルはARIMA(0,0,2)モデルなので、正しく推定されています。</span>
<span id="cb79-844"><a href="#cb79-844" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-847"><a href="#cb79-847" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-848"><a href="#cb79-848" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(ym2), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-849"><a href="#cb79-849" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-850"><a href="#cb79-850" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-851"><a href="#cb79-851" aria-hidden="true" tabindex="-1"></a><span class="fu">## MR(3)モデル</span></span>
<span id="cb79-852"><a href="#cb79-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-853"><a href="#cb79-853" aria-hidden="true" tabindex="-1"></a>MA(3)モデルはARIMA(0,0,3)モデルですが、ARIMA(3,0,1)モデルと推定されています。</span>
<span id="cb79-854"><a href="#cb79-854" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-857"><a href="#cb79-857" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb79-858"><a href="#cb79-858" aria-hidden="true" tabindex="-1"></a><span class="fu">auto.arima</span>(<span class="fu">ts</span>(ym3), <span class="at">stepwise =</span> T, <span class="at">trace =</span> F) <span class="sc">|&gt;</span> <span class="fu">summary</span>()</span>
<span id="cb79-859"><a href="#cb79-859" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-860"><a href="#cb79-860" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-861"><a href="#cb79-861" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-862"><a href="#cb79-862" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-863"><a href="#cb79-863" aria-hidden="true" tabindex="-1"></a>上記のように<span class="in">`auto.arima`</span>関数を用いれば必ず正しいモデルが計算できる、というわけではありませんし、MAモデルが反転可能な場合にはARとMAの次数が逆転することもありますが、時系列のデータ数が十分に多ければ、ある程度信頼できる結果を返してくれます。</span>
<span id="cb79-864"><a href="#cb79-864" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-865"><a href="#cb79-865" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-866"><a href="#cb79-866" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-867"><a href="#cb79-867" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARIMAモデルをシミュレートする</span></span>
<span id="cb79-868"><a href="#cb79-868" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-869"><a href="#cb79-869" aria-hidden="true" tabindex="-1"></a><span class="in">`auto.arima`</span>関数の結果と次数、データ数の関係をより調べたい方は、以下のリンクにあるシミュレーションを触ってみて下さい。また、下のスクリプトをRで実行することでもシミュレーションを動かすことができます。</span>
<span id="cb79-870"><a href="#cb79-870" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-871"><a href="#cb79-871" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">ARIMAシミュレーター</span><span class="co">](https://xjorv.shinyapps.io/ARIMA_simulator/)</span></span>
<span id="cb79-872"><a href="#cb79-872" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-873"><a href="#cb79-873" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb79-874"><a href="#cb79-874" aria-hidden="true" tabindex="-1"></a><span class="in">if(!require(shiny)){install.packages("shiny")};runGitHub("ARIMAsim", "sb8001at")</span></span>
<span id="cb79-875"><a href="#cb79-875" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-876"><a href="#cb79-876" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-877"><a href="#cb79-877" aria-hidden="true" tabindex="-1"></a>このシミュレーターでは、<span class="in">`arima.sim`</span>関数で生成した時系列に対して<span class="in">`auto.arima`</span>関数や単位根検定を行った結果を確認することができます。</span>
<span id="cb79-878"><a href="#cb79-878" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-879"><a href="#cb79-879" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-880"><a href="#cb79-880" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-881"><a href="#cb79-881" aria-hidden="true" tabindex="-1"></a><span class="fu">### ARIMAモデルを用いた予測</span></span>
<span id="cb79-882"><a href="#cb79-882" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-883"><a href="#cb79-883" aria-hidden="true" tabindex="-1"></a>上記のように、<span class="in">`auto.arima`</span>関数を用いれば、ARIMAモデルの次数と係数を求めることができます。とは言っても、次数と係数が求まったら何かわかるのかと言われると、イマイチよくわかりません。ARIMA(3,2,1)モデルがどんな形をしていて、どういう意味があるのか、パッと分かる人はなかなかいないでしょう。</span>
<span id="cb79-884"><a href="#cb79-884" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-885"><a href="#cb79-885" aria-hidden="true" tabindex="-1"></a>ARIMAモデルの意味がわからなくても、この計算したARIMAモデルがあれば、その**時系列の将来の変化を予測**することはできます。</span>
<span id="cb79-886"><a href="#cb79-886" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-887"><a href="#cb79-887" aria-hidden="true" tabindex="-1"></a>Rでは<span class="in">`forecast`</span>パッケージの<span class="in">`forecast`</span>関数を用いることで、ARIMAモデルでの予測を行うことができます。<span class="in">`forecast`</span>関数は第一引数に<span class="in">`auto.arima`</span>関数の返り値を、第二引数に予測する期間の長さ（<span class="in">`h`</span>）を取ります。<span class="in">`forecast`</span>関数の返り値はデータフレームで、予測値とその推定区間を返してくれます。予測区間を見るとわかりますが、明確なトレンドや季節性が無いデータでは、予測する時期が遠い未来になると点推定値も範囲推定値もほぼ一定になります。</span>
<span id="cb79-888"><a href="#cb79-888" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-889"><a href="#cb79-889" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="forecast関数で予測する"}</span></span>
<span id="cb79-890"><a href="#cb79-890" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load("forecast")</span></span>
<span id="cb79-891"><a href="#cb79-891" aria-hidden="true" tabindex="-1"></a><span class="in"># auto.arimaの返り値を変数に代入</span></span>
<span id="cb79-892"><a href="#cb79-892" aria-hidden="true" tabindex="-1"></a><span class="in">y1a_arima &lt;- auto.arima(ts(y1a), ic = "aic", stepwise = F, trace = F) </span></span>
<span id="cb79-893"><a href="#cb79-893" aria-hidden="true" tabindex="-1"></a><span class="in">fc &lt;- forecast(y1a_arima, h = 5, level = 95) # 5時点先まで予測する</span></span>
<span id="cb79-894"><a href="#cb79-894" aria-hidden="true" tabindex="-1"></a><span class="in"># 左から点推定値、95％下限推定値、95％上限推定値</span></span>
<span id="cb79-895"><a href="#cb79-895" aria-hidden="true" tabindex="-1"></a><span class="in">fc</span></span>
<span id="cb79-896"><a href="#cb79-896" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-897"><a href="#cb79-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-898"><a href="#cb79-898" aria-hidden="true" tabindex="-1"></a>:::{.callout-tip collapse="true"}</span>
<span id="cb79-899"><a href="#cb79-899" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-900"><a href="#cb79-900" aria-hidden="true" tabindex="-1"></a><span class="fu">## 下のグラフを描画するスクリプト</span></span>
<span id="cb79-901"><a href="#cb79-901" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-902"><a href="#cb79-902" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE}</span></span>
<span id="cb79-903"><a href="#cb79-903" aria-hidden="true" tabindex="-1"></a><span class="in">fc &lt;- forecast(y1a_arima, h = 100) |&gt; as.data.frame()</span></span>
<span id="cb79-904"><a href="#cb79-904" aria-hidden="true" tabindex="-1"></a><span class="in">fc$t &lt;- 201:300</span></span>
<span id="cb79-905"><a href="#cb79-905" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot()+</span></span>
<span id="cb79-906"><a href="#cb79-906" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(data = data.frame(t = 1:200, y1a), aes(x = t, y = y1a))+</span></span>
<span id="cb79-907"><a href="#cb79-907" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(data = fc, aes(x = t, y = `Point Forecast`, color = "red", linewidth=3))+</span></span>
<span id="cb79-908"><a href="#cb79-908" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(data = fc, aes(x = t, y = `Point Forecast`, ymax = `Hi 95`, ymin = `Lo 95`, color = "red", fill = "red", alpha = 0.2))+</span></span>
<span id="cb79-909"><a href="#cb79-909" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(caption = "赤の太線が点推定値、リボンが95%推定区間")</span></span>
<span id="cb79-910"><a href="#cb79-910" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-911"><a href="#cb79-911" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-912"><a href="#cb79-912" aria-hidden="true" tabindex="-1"></a>:::</span>
<span id="cb79-913"><a href="#cb79-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-914"><a href="#cb79-914" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, echo=FALSE, message=FALSE}</span></span>
<span id="cb79-915"><a href="#cb79-915" aria-hidden="true" tabindex="-1"></a><span class="in">fc &lt;- forecast(y1a_arima, h = 100) |&gt; as.data.frame()</span></span>
<span id="cb79-916"><a href="#cb79-916" aria-hidden="true" tabindex="-1"></a><span class="in">fc$t &lt;- 201:300</span></span>
<span id="cb79-917"><a href="#cb79-917" aria-hidden="true" tabindex="-1"></a><span class="in">ggplot()+</span></span>
<span id="cb79-918"><a href="#cb79-918" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(data = data.frame(t = 1:200, y1a), aes(x = t, y = y1a))+</span></span>
<span id="cb79-919"><a href="#cb79-919" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_line(data = fc, aes(x = t, y = `Point Forecast`, color = "red", linewidth=3))+</span></span>
<span id="cb79-920"><a href="#cb79-920" aria-hidden="true" tabindex="-1"></a><span class="in">  geom_ribbon(data = fc, aes(x = t, y = `Point Forecast`, ymax = `Hi 95`, ymin = `Lo 95`, color = "red", fill = "red", alpha = 0.2))+</span></span>
<span id="cb79-921"><a href="#cb79-921" aria-hidden="true" tabindex="-1"></a><span class="in">  labs(caption = "赤の太線が点推定値、リボンが95%推定区間")</span></span>
<span id="cb79-922"><a href="#cb79-922" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-923"><a href="#cb79-923" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-924"><a href="#cb79-924" aria-hidden="true" tabindex="-1"></a><span class="fu">## ARIMA以外の時系列分析手法</span></span>
<span id="cb79-925"><a href="#cb79-925" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-926"><a href="#cb79-926" aria-hidden="true" tabindex="-1"></a>上記のARIMAモデルが時系列分析手法では最も有名な手法の一つですが、時系列分析にはARIMAの他に、以下のような手法があります。</span>
<span id="cb79-927"><a href="#cb79-927" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-928"><a href="#cb79-928" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>SARIMA：季節性を含めたARIMAモデルの拡張</span>
<span id="cb79-929"><a href="#cb79-929" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>ARIMAX：共変量（例えば、Nileの例であればアスワンハイダムの建造など）を含めたARIMAモデルの拡張</span>
<span id="cb79-930"><a href="#cb79-930" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>VAR：複数の関連する時系列を一度に取り扱う、多変量時系列解析の手法</span>
<span id="cb79-931"><a href="#cb79-931" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>ARCH・GARCH：分散の変動（ボラティリティ、volatility）に注目した統計手法</span>
<span id="cb79-932"><a href="#cb79-932" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-933"><a href="#cb79-933" aria-hidden="true" tabindex="-1"></a>Rではそれぞれ以下のライブラリ・関数を用いて計算することができます。</span>
<span id="cb79-934"><a href="#cb79-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-935"><a href="#cb79-935" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>SARIMA：<span class="in">`auto.arima`</span>関数の<span class="in">`seasonal`</span>引数をTRUEに設定</span>
<span id="cb79-936"><a href="#cb79-936" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>ARIMAX：<span class="in">`auto.arima`</span>関数の<span class="in">`xreg`</span>引数に共変量をベクターで設定</span>
<span id="cb79-937"><a href="#cb79-937" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>VAR：<span class="co">[</span><span class="ot">vars</span><span class="co">](https://cran.r-project.org/web/packages/vars/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@vars_bib1; @vars_bib2</span><span class="co">]</span>の<span class="in">`VAR`</span>関数</span>
<span id="cb79-938"><a href="#cb79-938" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>ARCH・GARCH：<span class="co">[</span><span class="ot">fGarch</span><span class="co">](https://cran.r-project.org/web/packages/fGarch/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@fGarch_bib</span><span class="co">]</span>の<span class="in">`garchFit`</span>関数</span>
<span id="cb79-939"><a href="#cb79-939" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-940"><a href="#cb79-940" aria-hidden="true" tabindex="-1"></a><span class="fu">## 時系列の要素を分離する</span></span>
<span id="cb79-941"><a href="#cb79-941" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-942"><a href="#cb79-942" aria-hidden="true" tabindex="-1"></a>上に述べたARIMAやその他の分析が時系列分析手法の主なものになりますが、もうちょっと手軽に季節性やトレンドを評価する方法もあります。最も単純なものは、<span class="co">[</span><span class="ot">20章</span><span class="co">](./chapter20.html)</span>で説明した<span class="in">`decompose`</span>関数を用いる方法です。<span class="in">`decompose`</span>関数は時系列データをトレンド、季節性、ランダム要素の3つに分離してくれる関数です。<span class="in">`decompose`</span>関数の返り値をそのまま<span class="in">`plot`</span>関数に与えると、時系列データを分離してグラフにしてくれます。</span>
<span id="cb79-943"><a href="#cb79-943" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-944"><a href="#cb79-944" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="decompose関数でトレンド・季節性を分ける"}</span></span>
<span id="cb79-945"><a href="#cb79-945" aria-hidden="true" tabindex="-1"></a><span class="in">ts(co2, frequency = 12) |&gt; decompose() |&gt; plot()</span></span>
<span id="cb79-946"><a href="#cb79-946" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-947"><a href="#cb79-947" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-948"><a href="#cb79-948" aria-hidden="true" tabindex="-1"></a>同様の関数に、<span class="in">`TSstudio`</span>パッケージの<span class="in">`ts_decompose`</span>関数があります。こちらは<span class="in">`decompose`</span>関数で分離したものを<span class="in">`plotly`</span>でグラフにしてくれる関数です。</span>
<span id="cb79-949"><a href="#cb79-949" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-950"><a href="#cb79-950" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="TSstudio::ts_decompose関数"}</span></span>
<span id="cb79-951"><a href="#cb79-951" aria-hidden="true" tabindex="-1"></a><span class="in">ts_decompose(ts(co2, frequency = 12))</span></span>
<span id="cb79-952"><a href="#cb79-952" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-953"><a href="#cb79-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-954"><a href="#cb79-954" aria-hidden="true" tabindex="-1"></a>季節性・トレンドの成分をさらに詳しく評価したい場合には、facebook（Meta）の技術者が開発した<span class="co">[</span><span class="ot">`prophet`</span><span class="co">](https://facebook.github.io/prophet/)</span>パッケージを用いるとよいでしょう。<span class="in">`prophet`</span>は<span class="co">[</span><span class="ot">`rstan`</span><span class="co">](https://cran.r-project.org/web/packages/rstan/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@rstan_bib</span><span class="co">]</span>（もしくは<span class="co">[</span><span class="ot">`cmdstanr`</span><span class="co">](https://github.com/stan-dev/cmdstanr)</span>パッケージ<span class="co">[</span><span class="ot">@cmdstanr_bib</span><span class="co">]</span>）を用いて時系列を解析するアルゴリズムを使用しています。このアルゴリズムでは、下に説明する状態空間モデルとは少し異なるアプローチ（<span class="co">[</span><span class="ot">論文</span><span class="co">](https://peerj.com/preprints/3190/#)</span>に記載の通り、一般化加法モデル（<span class="co">[</span><span class="ot">26章参照</span><span class="co">](./chapter26.html)</span>）で分析）を取っています。<span class="in">`prophet`</span>を用いれば、季節性やトレンドの分離、予測、休日の影響やデータの欠測の処理などを比較的簡単に取り扱うことができます。</span>
<span id="cb79-955"><a href="#cb79-955" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-956"><a href="#cb79-956" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, eval=FALSE, filename="prophetパッケージでデータを取り扱う"}</span></span>
<span id="cb79-957"><a href="#cb79-957" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(rstan, prophet)</span></span>
<span id="cb79-958"><a href="#cb79-958" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-959"><a href="#cb79-959" aria-hidden="true" tabindex="-1"></a><span class="in">df &lt;- read.csv('https://raw.githubusercontent.com/facebook/prophet/main/examples/example_wp_log_peyton_manning.csv')</span></span>
<span id="cb79-960"><a href="#cb79-960" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-961"><a href="#cb79-961" aria-hidden="true" tabindex="-1"></a><span class="in"># 状態空間モデルの推定（rstanパッケージが必要）</span></span>
<span id="cb79-962"><a href="#cb79-962" aria-hidden="true" tabindex="-1"></a><span class="in">m &lt;- prophet(df) </span></span>
<span id="cb79-963"><a href="#cb79-963" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-964"><a href="#cb79-964" aria-hidden="true" tabindex="-1"></a><span class="in"># 未来の365日分のデータフレームを作成</span></span>
<span id="cb79-965"><a href="#cb79-965" aria-hidden="true" tabindex="-1"></a><span class="in">future &lt;- make_future_dataframe(m, periods = 365) </span></span>
<span id="cb79-966"><a href="#cb79-966" aria-hidden="true" tabindex="-1"></a><span class="in">tail(future)</span></span>
<span id="cb79-967"><a href="#cb79-967" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-968"><a href="#cb79-968" aria-hidden="true" tabindex="-1"></a><span class="in"># predictで将来予測</span></span>
<span id="cb79-969"><a href="#cb79-969" aria-hidden="true" tabindex="-1"></a><span class="in">forecast &lt;- predict(m, future)</span></span>
<span id="cb79-970"><a href="#cb79-970" aria-hidden="true" tabindex="-1"></a><span class="in">tail(forecast[c('ds', 'yhat', 'yhat_lower', 'yhat_upper')])</span></span>
<span id="cb79-971"><a href="#cb79-971" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-972"><a href="#cb79-972" aria-hidden="true" tabindex="-1"></a><span class="in"># 推定値をプロット</span></span>
<span id="cb79-973"><a href="#cb79-973" aria-hidden="true" tabindex="-1"></a><span class="in">plot(m, forecast)</span></span>
<span id="cb79-974"><a href="#cb79-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-975"><a href="#cb79-975" aria-hidden="true" tabindex="-1"></a><span class="in"># 季節性、トレンドを分けて表示</span></span>
<span id="cb79-976"><a href="#cb79-976" aria-hidden="true" tabindex="-1"></a><span class="in">prophet_plot_components(m, forecast)</span></span>
<span id="cb79-977"><a href="#cb79-977" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-978"><a href="#cb79-978" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-979"><a href="#cb79-979" aria-hidden="true" tabindex="-1"></a><span class="fu">## 状態空間モデル</span></span>
<span id="cb79-980"><a href="#cb79-980" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-981"><a href="#cb79-981" aria-hidden="true" tabindex="-1"></a>**状態空間モデル（state space model）**は時系列データや地理空間データの統計に用いられる統計モデルの一つです。状態空間モデルでは、時系列データを以下の図のように、真の値の系列である**状態モデル**と、その真の値を我々が観測したときのばらつきを含む**観測モデル**からなるものであるとします。</span>
<span id="cb79-982"><a href="#cb79-982" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-983"><a href="#cb79-983" aria-hidden="true" tabindex="-1"></a><span class="al">![](./image/state_space.png)</span></span>
<span id="cb79-984"><a href="#cb79-984" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-985"><a href="#cb79-985" aria-hidden="true" tabindex="-1"></a>真の値を示す状態モデルでは、時点tの値は時点t-1の値によく似ているとする、AR(1)モデルに似たような構造を持つとします。</span>
<span id="cb79-986"><a href="#cb79-986" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-987"><a href="#cb79-987" aria-hidden="true" tabindex="-1"></a>$$\mu_{t}=\mu_{t-1}+\epsilon_{t}$$</span>
<span id="cb79-988"><a href="#cb79-988" aria-hidden="true" tabindex="-1"></a>$$\epsilon_{t} \sim Normal(0, \sigma)$$</span>
<span id="cb79-989"><a href="#cb79-989" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-990"><a href="#cb79-990" aria-hidden="true" tabindex="-1"></a>観測モデルは、状態モデルに観測時に起こるばらつきが含まれるものであるとします。</span>
<span id="cb79-991"><a href="#cb79-991" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-992"><a href="#cb79-992" aria-hidden="true" tabindex="-1"></a>$$Y_{t}=\mu_{t}+\eta_{t}$$</span>
<span id="cb79-993"><a href="#cb79-993" aria-hidden="true" tabindex="-1"></a>$$\eta_{t} \sim Normal(0, \sigma)$$</span>
<span id="cb79-994"><a href="#cb79-994" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-995"><a href="#cb79-995" aria-hidden="true" tabindex="-1"></a>我々が観測したデータ、つまり時系列データは、この観測モデルの左辺、Y~t~となります。Y~t~からμ~t~を求めることで観測等のばらつきを取り除いた真の状態の変化を調べようとするのが状態空間モデルの概略です。</span>
<span id="cb79-996"><a href="#cb79-996" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-997"><a href="#cb79-997" aria-hidden="true" tabindex="-1"></a>この状態空間モデルのいいところは、モデルをある程度自由に決められることです。状態モデルをAR(1)モデルっぽくしてもAR(2)モデルっぽくしても良いですし、切片項や係数を設定しても良いですし、季節性や説明変数の項を追加することもできます。ただし、<span class="in">`auto.arima`</span>関数のように、「自動的にモデルを選択してくれる」ような手法ではないため、データをよく見て適したモデルを自分で選択する必要があります。また、上に説明したような分析手法よりはるかに計算が複雑で、計算に時間がかかります。</span>
<span id="cb79-998"><a href="#cb79-998" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-999"><a href="#cb79-999" aria-hidden="true" tabindex="-1"></a><span class="fu">### カルマンフィルタ</span></span>
<span id="cb79-1000"><a href="#cb79-1000" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1001"><a href="#cb79-1001" aria-hidden="true" tabindex="-1"></a>この状態空間モデルを用いた分析手法の一つが**カルマンフィルタ**です。カルマンフィルタは、GPSのような、時系列データに大きなノイズが乗っているようなデータを取り扱う時に、ノイズの成分を減らして真のシグナル（GPSなら真の位置や方角）を求めるために利用されています。カルマンフィルタは、ノイズを減らす**フィルタリング**、長期的な変動を滑らかな曲線として示すための**平滑化**、将来の変動を予測する**予測**の3つの目的で用いられます。フィルタリング・平滑化・予測ではそれぞれ以下のような変換を行います。</span>
<span id="cb79-1002"><a href="#cb79-1002" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1003"><a href="#cb79-1003" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>フィルタリング：$E(y_{t}|Y_{t})$  今の値から今の値の代表値を推定</span>
<span id="cb79-1004"><a href="#cb79-1004" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>平滑化：$E(y_{t}|Y_{T})$  測定済みのすべての値から、ある時点の代表値を推定</span>
<span id="cb79-1005"><a href="#cb79-1005" aria-hidden="true" tabindex="-1"></a><span class="ss">* </span>予測：$E(y_{t}|Y_{t-1})$  今までの値から次の値を予測</span>
<span id="cb79-1006"><a href="#cb79-1006" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1007"><a href="#cb79-1007" aria-hidden="true" tabindex="-1"></a>E(y~t~)というのが変換後の値、Y~t~はその時点での測定値、Y~T~はその時点までのすべての測定値を指します。したがって、フィルタリング・平滑化・予測を図で示すと以下のようになります。</span>
<span id="cb79-1008"><a href="#cb79-1008" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1009"><a href="#cb79-1009" aria-hidden="true" tabindex="-1"></a><span class="al">![図2：カルマルフィルタのイメージ](./image/karmanfilter.png)</span></span>
<span id="cb79-1010"><a href="#cb79-1010" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1011"><a href="#cb79-1011" aria-hidden="true" tabindex="-1"></a>Rでは、<span class="co">[</span><span class="ot">`dlm`</span><span class="co">](https://cran.r-project.org/web/packages/dlm/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@dlm_bib1; @dlm_bib2</span><span class="co">]</span>や<span class="co">[</span><span class="ot">`KFAS`</span><span class="co">](https://cran.r-project.org/web/packages/KFAS/index.html)</span>パッケージ<span class="co">[</span><span class="ot">@KFAS_bib</span><span class="co">]</span>を用いることでカルマンフィルタの計算を行うことができます。以下に<span class="in">`dlm`</span>パッケージでのカルマンフィルタの例を示します。</span>
<span id="cb79-1012"><a href="#cb79-1012" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1013"><a href="#cb79-1013" aria-hidden="true" tabindex="-1"></a><span class="in">```{r, filename="dlmパッケージでカルマンフィルタ"}</span></span>
<span id="cb79-1014"><a href="#cb79-1014" aria-hidden="true" tabindex="-1"></a><span class="in"># ?dlm::dlmFilter（dlmFilterのヘルプ）に記載されている使用例</span></span>
<span id="cb79-1015"><a href="#cb79-1015" aria-hidden="true" tabindex="-1"></a><span class="in">pacman::p_load(dlm)</span></span>
<span id="cb79-1016"><a href="#cb79-1016" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1017"><a href="#cb79-1017" aria-hidden="true" tabindex="-1"></a><span class="in">nileBuild &lt;- function(par){</span></span>
<span id="cb79-1018"><a href="#cb79-1018" aria-hidden="true" tabindex="-1"></a><span class="in">dlmModPoly(1, dV = exp(par[1]), dW = exp(par[2]))</span></span>
<span id="cb79-1019"><a href="#cb79-1019" aria-hidden="true" tabindex="-1"></a><span class="in">}</span></span>
<span id="cb79-1020"><a href="#cb79-1020" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1021"><a href="#cb79-1021" aria-hidden="true" tabindex="-1"></a><span class="in">nileMLE &lt;- dlmMLE(Nile, rep(0, 2), nileBuild)</span></span>
<span id="cb79-1022"><a href="#cb79-1022" aria-hidden="true" tabindex="-1"></a><span class="in">nileMod &lt;- nileBuild(nileMLE$par)</span></span>
<span id="cb79-1023"><a href="#cb79-1023" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1024"><a href="#cb79-1024" aria-hidden="true" tabindex="-1"></a><span class="in">nileFilt &lt;- dlmFilter(Nile, nileMod) # フィルタリング</span></span>
<span id="cb79-1025"><a href="#cb79-1025" aria-hidden="true" tabindex="-1"></a><span class="in">nileSmooth &lt;- dlmSmooth(nileFilt) # 平滑化</span></span>
<span id="cb79-1026"><a href="#cb79-1026" aria-hidden="true" tabindex="-1"></a><span class="in">plot(cbind(Nile, nileFilt$m[-1], nileSmooth$s[-1]), plot.type = 's',</span></span>
<span id="cb79-1027"><a href="#cb79-1027" aria-hidden="true" tabindex="-1"></a><span class="in">col = c("black", "red", "blue"), ylab = "Level", main = "Nile river", lwd = c(1, 2, 2))</span></span>
<span id="cb79-1028"><a href="#cb79-1028" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb79-1029"><a href="#cb79-1029" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1030"><a href="#cb79-1030" aria-hidden="true" tabindex="-1"></a>カルマンフィルタについては詳しい教科書がたくさんあるので（例えばRでは<span class="co">[</span><span class="ot">この教科書など</span><span class="co">](https://www.amazon.co.jp/%E3%82%AB%E3%83%AB%E3%83%9E%E3%83%B3%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF-%E2%80%95R%E3%82%92%E4%BD%BF%E3%81%A3%E3%81%9F%E6%99%82%E7%B3%BB%E5%88%97%E4%BA%88%E6%B8%AC%E3%81%A8%E7%8A%B6%E6%85%8B%E7%A9%BA%E9%96%93%E3%83%A2%E3%83%87%E3%83%AB%E2%80%95-%E7%B5%B1%E8%A8%88%E5%AD%A6One-Point-2/dp/4320112539/ref=sr_1_4?crid=233OUDUP4SFDE&amp;dib=eyJ2IjoiMSJ9.7-FBe3-RRCTGU8ggjWIe4tvBgUWVWh18GMV2Kl_vI7aYbSmT9ej3GDICdlLMVNb4zvIyc3KzQtSbCb0ZgDIJdak8cG-Pg_OeVY9ma6W_C18ZW2YGZKoSpspId8PqPG1EDkEod9rNwwiStNAKL6WS9vmmXobUFa-YIV-aY97KD_8wHHmS7HMiZGtK0KNqL2MA6JiGwemrlKYX8p3GEF5QeQxLuwowak1BFYzf-jPfm3mpx7ctone_Bn_r47mduTlz9OiLCXHtuFEp1cvrYZ_cMdESsAGAC324M3rRSpHxhA1ZgH5n0-URMBH8iwHQSmLZCZ-zU9cl6_OJKamTHjdhTLVk9Kf2EMNicw9jet-kD1FVZbC7XqDwiJWO_La8iZey0ofUzli1sxNbgQH1liWIiD_8Md78wk0H_FpM7C36N2gs0JUHc0LEOxjpRzaJP8_Y.dln_u6oLODP_bFkzqLIBrFfc_FQuosGBZh3v8_jvOvc&amp;dib_tag=se&amp;keywords=%E3%82%AB%E3%83%AB%E3%83%9E%E3%83%B3%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF&amp;qid=1742085164&amp;sprefix=%E3%82%AB%E3%83%AB%E3%83%9E%E3%83%B3%2Caps%2C181&amp;sr=8-4)</span> <span class="co">[</span><span class="ot">@野村俊一2016-09-08</span><span class="co">]</span>）、詳しく学びたい方は教科書を一読されることをおススメいたします。</span>
<span id="cb79-1031"><a href="#cb79-1031" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1032"><a href="#cb79-1032" aria-hidden="true" tabindex="-1"></a><span class="fu">### Stan</span></span>
<span id="cb79-1033"><a href="#cb79-1033" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb79-1034"><a href="#cb79-1034" aria-hidden="true" tabindex="-1"></a>もっと複雑で自由度の高い状態空間モデルを用いる場合には、<span class="co">[</span><span class="ot">Stan</span><span class="co">](https://mc-stan.org/)</span>という統計モデリングの言語を用いることになります。Rでは上記の<span class="in">`prophet`</span>の部分で少し紹介した<span class="in">`rstan`</span>または<span class="in">`cmdstanr`</span>パッケージを用いて、Stan言語の統計モデルを書き、計算することになります。Stanについては入門として紹介するには複雑すぎるためココには記載しませんが、興味のある方は<span class="co">[</span><span class="ot">Stanについてのホームページ</span><span class="co">](https://statmodeling.hatenablog.com/archive)</span>や<span class="co">[</span><span class="ot">教科書</span><span class="co">](https://www.kyoritsu-pub.co.jp/book/b10003786.html)[</span><span class="ot">@松浦健太郎2016-10-25</span><span class="co">]</span>を読むことをおすすめします。</span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      &nbsp;
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p><a href="https://quarto.org/">Quarto</a>を用いてこの本を作成しました</p>
</div>
  </div>
</footer>
<script>var lightboxQuarto = GLightbox({"openEffect":"zoom","descPosition":"bottom","closeEffect":"zoom","selector":".lightbox","loop":false});
window.onload = () => {
  lightboxQuarto.on('slide_before_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    const href = trigger.getAttribute('href');
    if (href !== null) {
      const imgEl = window.document.querySelector(`a[href="${href}"] img`);
      if (imgEl !== null) {
        const srcAttr = imgEl.getAttribute("src");
        if (srcAttr && srcAttr.startsWith("data:")) {
          slideConfig.href = srcAttr;
        }
      }
    } 
  });

  lightboxQuarto.on('slide_after_load', (data) => {
    const { slideIndex, slideNode, slideConfig, player, trigger } = data;
    if (window.Quarto?.typesetMath) {
      window.Quarto.typesetMath(slideNode);
    }
  });

};
          </script>




</body></html>